[0m18:39:25.745738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D32161D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D33D6B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D38A8D90>]}


============================== 18:39:25.764891 | 286c4c7d-cc7f-4182-8435-5b51b7e9f9be ==============================
[0m18:39:25.764891 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:39:25.765938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:39:27.955469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '286c4c7d-cc7f-4182-8435-5b51b7e9f9be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D38399D0>]}
[0m18:39:27.963487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '286c4c7d-cc7f-4182-8435-5b51b7e9f9be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D3369E50>]}
[0m18:39:27.971427 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:39:28.031312 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:39:28.032312 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:39:28.032312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '286c4c7d-cc7f-4182-8435-5b51b7e9f9be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D4EF6BD0>]}
[0m18:39:29.504855 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named my_second_dbt_model. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for my_second_dbt_model in one of these files:
   - models\staging\schema.yml
  models\example\schema.yml
[0m18:39:29.505853 [debug] [MainThread]: Command `dbt run` failed at 18:39:29.505853 after 3.78 seconds
[0m18:39:29.505853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D38A8D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D52B4AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D3E5B810>]}
[0m18:39:29.507247 [debug] [MainThread]: Flushing usage events
[0m18:39:51.244416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002516C16E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002516C18A0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002516C168690>]}


============================== 18:39:51.247375 | ce72b580-5ce3-44e6-85a0-6496f535f00b ==============================
[0m18:39:51.247375 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:39:51.248372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m staging', 'send_anonymous_usage_stats': 'True'}
[0m18:39:51.628938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce72b580-5ce3-44e6-85a0-6496f535f00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002516DD2A7D0>]}
[0m18:39:51.637915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce72b580-5ce3-44e6-85a0-6496f535f00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002516D92CD90>]}
[0m18:39:51.638909 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:39:51.685784 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:39:51.687778 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:39:51.687778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ce72b580-5ce3-44e6-85a0-6496f535f00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002516DCF6990>]}
[0m18:39:52.501590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce72b580-5ce3-44e6-85a0-6496f535f00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002516DD34D10>]}
[0m18:39:52.522255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce72b580-5ce3-44e6-85a0-6496f535f00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002516E010710>]}
[0m18:39:52.523252 [info ] [MainThread]: Found 3 models, 5 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:39:52.523252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce72b580-5ce3-44e6-85a0-6496f535f00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002516E087BD0>]}
[0m18:39:52.525246 [info ] [MainThread]: 
[0m18:39:52.526243 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:39:52.528238 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:39:52.529270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:57.769435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_oss-big-query-dashboard-prod, now create_oss-big-query-dashboard-prod_staging)
[0m18:39:57.770434 [debug] [ThreadPool]: Creating schema "database: "oss-big-query-dashboard-prod"
schema: "staging"
"
[0m18:39:57.780440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:39:57.781439 [debug] [ThreadPool]: On create_oss-big-query-dashboard-prod_staging: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "connection_name": "create_oss-big-query-dashboard-prod_staging"} */
create schema if not exists `oss-big-query-dashboard-prod`.`staging`
  
[0m18:39:59.190984 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3dbe5fdb-3df6-4155-9f55-4d105f7570c7&page=queryresults
[0m18:40:00.769918 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_test_dbt'
[0m18:40:00.770918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:00.772911 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:40:00.776907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:01.715422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce72b580-5ce3-44e6-85a0-6496f535f00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002516DDD8ED0>]}
[0m18:40:01.716420 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:40:01.717421 [info ] [MainThread]: 
[0m18:40:01.731893 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m18:40:01.732894 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_google_ads_campaign_stats .............. [RUN]
[0m18:40:01.733891 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m18:40:01.734889 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m18:40:01.744865 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m18:40:01.747855 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 18:40:01.734889 => 18:40:01.747855
[0m18:40:01.748851 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m18:40:01.783785 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m18:40:01.785755 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:40:01.786751 [debug] [Thread-1 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS()
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_cleaned_stats AS (
    SELECT
        date,
        
        --Dimensionen
        id,
        ad_network_type,
        device,

        --Basismetriken
        impressions,
        clicks,
        cost_micros/1000000 as cost,
        conversions,

        --Erweiterte Metriken
        conversions_value,
        interactions,
        view_through_conversions,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability  

    FROM _raw
    
),

_final AS(
    SELECT * FROM _cleaned_stats
)

SELECT * FROM _final;


[0m18:40:03.179126 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2aad5b5a-3d37-478d-ba76-5259ecba3f49&page=queryresults
[0m18:40:03.438133 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 18:40:01.749893 => 18:40:03.438133
[0m18:40:03.439095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce72b580-5ce3-44e6-85a0-6496f535f00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002516E062650>]}
[0m18:40:03.440090 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.stg_google_ads_campaign_stats ......... [[32mCREATE VIEW (0 processed)[0m in 1.71s]
[0m18:40:03.441327 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m18:40:03.443319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:40:03.443319 [debug] [MainThread]: Connection 'create_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:40:03.444316 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_test_dbt' was properly closed.
[0m18:40:03.444316 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:40:03.445313 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_ads_campaign_stats' was properly closed.
[0m18:40:03.445313 [info ] [MainThread]: 
[0m18:40:03.446311 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.92 seconds (10.92s).
[0m18:40:03.447309 [debug] [MainThread]: Command end result
[0m18:40:03.470498 [info ] [MainThread]: 
[0m18:40:03.471506 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:40:03.472579 [info ] [MainThread]: 
[0m18:40:03.473588 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:40:03.474585 [debug] [MainThread]: Command `dbt run` succeeded at 18:40:03.474585 after 12.24 seconds
[0m18:40:03.475582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002516CC5B810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002516C6A9E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025166E7DED0>]}
[0m18:40:03.475582 [debug] [MainThread]: Flushing usage events
[0m18:44:53.337467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E47C242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E47830690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E47C186D0>]}


============================== 18:44:53.341434 | ef071eab-8f99-425c-b869-f5f21782f7c6 ==============================
[0m18:44:53.341434 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:44:53.342432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test -m staging', 'send_anonymous_usage_stats': 'True'}
[0m18:44:53.702112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef071eab-8f99-425c-b869-f5f21782f7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E49331190>]}
[0m18:44:53.711601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef071eab-8f99-425c-b869-f5f21782f7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E48F13A10>]}
[0m18:44:53.713596 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:44:53.763497 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:44:53.830900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:44:53.831898 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:44:53.837882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef071eab-8f99-425c-b869-f5f21782f7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E48E7E050>]}
[0m18:44:53.850812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef071eab-8f99-425c-b869-f5f21782f7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E4934DF50>]}
[0m18:44:53.851811 [info ] [MainThread]: Found 3 models, 5 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:44:53.852808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef071eab-8f99-425c-b869-f5f21782f7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E48EEFC10>]}
[0m18:44:53.853807 [info ] [MainThread]: 
[0m18:44:53.854825 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:44:53.856823 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_test_dbt'
[0m18:44:53.856823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:53.857856 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:44:53.858817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:56.390972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef071eab-8f99-425c-b869-f5f21782f7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E477410D0>]}
[0m18:44:56.391936 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:44:56.392933 [info ] [MainThread]: 
[0m18:44:56.397919 [debug] [Thread-1 (]: Began running node test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27
[0m18:44:56.397919 [info ] [Thread-1 (]: 1 of 1 START test not_null_stg_google_ads_campaign_stats_id .................... [RUN]
[0m18:44:56.399914 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27'
[0m18:44:56.400915 [debug] [Thread-1 (]: Began compiling node test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27
[0m18:44:56.425363 [debug] [Thread-1 (]: Writing injected SQL for node "test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27"
[0m18:44:56.427357 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27 (compile): 18:44:56.401912 => 18:44:56.427357
[0m18:44:56.429362 [debug] [Thread-1 (]: Began executing node test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27
[0m18:44:56.453289 [debug] [Thread-1 (]: Writing runtime sql for node "test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27"
[0m18:44:56.455281 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:44:56.455281 [debug] [Thread-1 (]: On test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
where id is null



      
    ) dbt_internal_test
[0m18:45:00.205901 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:641eb8bc-c134-4a3b-9c90-63503752e073&page=queryresults
[0m18:45:00.610621 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27 (execute): 18:44:56.431346 => 18:45:00.610621
[0m18:45:00.612014 [info ] [Thread-1 (]: 1 of 1 PASS not_null_stg_google_ads_campaign_stats_id .......................... [[32mPASS[0m in 4.21s]
[0m18:45:00.613051 [debug] [Thread-1 (]: Finished running node test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27
[0m18:45:00.615682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:00.616676 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_test_dbt' was properly closed.
[0m18:45:00.616676 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:45:00.617640 [debug] [MainThread]: Connection 'test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27' was properly closed.
[0m18:45:00.617640 [info ] [MainThread]: 
[0m18:45:00.618639 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 6.76 seconds (6.76s).
[0m18:45:00.620667 [debug] [MainThread]: Command end result
[0m18:45:00.638190 [info ] [MainThread]: 
[0m18:45:00.639139 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:45:00.640160 [info ] [MainThread]: 
[0m18:45:00.641135 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:45:00.642131 [debug] [MainThread]: Command `dbt test` succeeded at 18:45:00.642131 after 7.32 seconds
[0m18:45:00.643129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E4825B290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E47C24F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E47C24150>]}
[0m18:45:00.643129 [debug] [MainThread]: Flushing usage events
[0m18:48:24.236001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94796E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E947E4C7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E947E4C1D0>]}


============================== 18:48:24.239989 | 28c93dc3-1d1e-4e96-9e71-95b03e147a53 ==============================
[0m18:48:24.239989 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:48:24.242023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m staging', 'send_anonymous_usage_stats': 'True'}
[0m18:48:24.628590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28c93dc3-1d1e-4e96-9e71-95b03e147a53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9490ADE50>]}
[0m18:48:24.637729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28c93dc3-1d1e-4e96-9e71-95b03e147a53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94796DC90>]}
[0m18:48:24.638747 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:48:24.690136 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:48:24.699809 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:48:24.700861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '28c93dc3-1d1e-4e96-9e71-95b03e147a53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E949850410>]}
[0m18:48:25.613489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28c93dc3-1d1e-4e96-9e71-95b03e147a53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9495EAAD0>]}
[0m18:48:25.626421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28c93dc3-1d1e-4e96-9e71-95b03e147a53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E949895F10>]}
[0m18:48:25.627420 [info ] [MainThread]: Found 3 models, 5 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:48:25.628416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28c93dc3-1d1e-4e96-9e71-95b03e147a53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9495E4750>]}
[0m18:48:25.629413 [info ] [MainThread]: 
[0m18:48:25.631432 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:48:25.632432 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:48:25.632432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:28.025426 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:48:28.027424 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_test_dbt'
[0m18:48:28.027424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:28.028456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:29.105452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28c93dc3-1d1e-4e96-9e71-95b03e147a53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94951C090>]}
[0m18:48:29.107448 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:48:29.108445 [info ] [MainThread]: 
[0m18:48:29.113432 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m18:48:29.114428 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_google_ads_campaign_stats .............. [RUN]
[0m18:48:29.116457 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m18:48:29.117455 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m18:48:29.128396 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m18:48:29.130387 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 18:48:29.118419 => 18:48:29.130387
[0m18:48:29.131385 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m18:48:29.167320 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m18:48:29.168318 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:48:29.169282 [debug] [Thread-1 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS(
      description="""A starter dbt model"""
    )
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_cleaned_stats AS (
    SELECT
        date,
        
        --Dimensionen
        id,
        ad_network_type,
        device,

        --Basismetriken
        impressions,
        clicks,
        cost_micros/1000000 as cost,
        conversions,

        --Erweiterte Metriken
        conversions_value,
        interactions,
        view_through_conversions,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability  

    FROM _raw
    
),

_final AS(
    SELECT * FROM _cleaned_stats
)

SELECT * FROM _final;


[0m18:48:30.601062 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:bb8b8d29-9016-45d5-925a-22821238c04f&page=queryresults
[0m18:48:31.214596 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 18:48:29.132418 => 18:48:31.213558
[0m18:48:31.215557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28c93dc3-1d1e-4e96-9e71-95b03e147a53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9495B3550>]}
[0m18:48:31.215557 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.stg_google_ads_campaign_stats ......... [[32mCREATE VIEW (0 processed)[0m in 2.10s]
[0m18:48:31.217550 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m18:48:31.218549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:31.219579 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:48:31.219579 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:48:31.220543 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_test_dbt' was properly closed.
[0m18:48:31.220543 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_ads_campaign_stats' was properly closed.
[0m18:48:31.221541 [info ] [MainThread]: 
[0m18:48:31.222539 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.59 seconds (5.59s).
[0m18:48:31.223536 [debug] [MainThread]: Command end result
[0m18:48:31.232936 [info ] [MainThread]: 
[0m18:48:31.233934 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:48:31.234934 [info ] [MainThread]: 
[0m18:48:31.235929 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:48:31.236927 [debug] [MainThread]: Command `dbt run` succeeded at 18:48:31.236927 after 7.01 seconds
[0m18:48:31.236927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94845AE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E947A1E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E947940B90>]}
[0m18:48:31.237923 [debug] [MainThread]: Flushing usage events
[0m18:50:41.701482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B71A1AB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B7158D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B71630550>]}


============================== 18:50:41.705460 | 1e066c9b-486a-4f75-8c72-a09607950c27 ==============================
[0m18:50:41.705460 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:50:41.706109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m staging', 'send_anonymous_usage_stats': 'True'}
[0m18:50:42.064916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e066c9b-486a-4f75-8c72-a09607950c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B72CD9FD0>]}
[0m18:50:42.074885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e066c9b-486a-4f75-8c72-a09607950c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B72C587D0>]}
[0m18:50:42.076881 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:50:42.142261 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:50:42.219703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:50:42.220705 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\schema.yml
[0m18:50:42.238655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e066c9b-486a-4f75-8c72-a09607950c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B731E1690>]}
[0m18:50:42.251585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e066c9b-486a-4f75-8c72-a09607950c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B7342DBD0>]}
[0m18:50:42.251585 [info ] [MainThread]: Found 3 models, 5 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:50:42.252583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e066c9b-486a-4f75-8c72-a09607950c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B730EEA90>]}
[0m18:50:42.254577 [info ] [MainThread]: 
[0m18:50:42.254936 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:50:42.256934 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:50:42.256934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:44.637737 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:50:44.638739 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_test_dbt'
[0m18:50:44.638739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:44.639732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:45.656031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e066c9b-486a-4f75-8c72-a09607950c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B73169690>]}
[0m18:50:45.657265 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:50:45.658267 [info ] [MainThread]: 
[0m18:50:45.662374 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m18:50:45.663382 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_google_ads_campaign_stats .............. [RUN]
[0m18:50:45.665639 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m18:50:45.666693 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m18:50:45.682904 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m18:50:45.684966 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 18:50:45.667720 => 18:50:45.683925
[0m18:50:45.686449 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m18:50:45.742000 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m18:50:45.744045 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:50:45.745043 [debug] [Thread-1 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS(
      description="""A starter dbt model"""
    )
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_cleaned_stats AS (
    SELECT
        date,
        
        --Dimensionen
        id,
        ad_network_type,
        device,

        --Basismetriken
        impressions,
        clicks,
        cost_micros/1000000 as cost,
        conversions,

        --Erweiterte Metriken
        conversions_value,
        interactions,
        view_through_conversions,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability  

    FROM _raw
    
),

_final AS(
    SELECT * FROM _cleaned_stats
)

SELECT * FROM _final;


[0m18:50:47.121634 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a22d1d2a-104c-40e5-a3b8-89ac14536e54&page=queryresults
[0m18:50:47.727283 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 18:50:45.686449 => 18:50:47.727283
[0m18:50:47.728398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e066c9b-486a-4f75-8c72-a09607950c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B734BD7D0>]}
[0m18:50:47.729455 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.stg_google_ads_campaign_stats ......... [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m18:50:47.731753 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m18:50:47.734267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:47.735273 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:50:47.736271 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:50:47.737269 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_test_dbt' was properly closed.
[0m18:50:47.738265 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_ads_campaign_stats' was properly closed.
[0m18:50:47.738265 [info ] [MainThread]: 
[0m18:50:47.740260 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.48 seconds (5.48s).
[0m18:50:47.742254 [debug] [MainThread]: Command end result
[0m18:50:47.755220 [info ] [MainThread]: 
[0m18:50:47.756217 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:50:47.757566 [info ] [MainThread]: 
[0m18:50:47.759980 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:50:47.761974 [debug] [MainThread]: Command `dbt run` succeeded at 18:50:47.760977 after 6.07 seconds
[0m18:50:47.762972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B72068E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B70EDB750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B6C227FD0>]}
[0m18:50:47.764174 [debug] [MainThread]: Flushing usage events
[0m19:09:58.098988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002866943E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002866941EC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002866941CD90>]}


============================== 19:09:58.103013 | 808200df-801c-4361-9169-5948a4918617 ==============================
[0m19:09:58.103013 [info ] [MainThread]: Running with dbt=1.6.2
[0m19:09:58.103960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test -m staging', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:09:58.462859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '808200df-801c-4361-9169-5948a4918617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002866A72C290>]}
[0m19:09:58.471833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '808200df-801c-4361-9169-5948a4918617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028668F69ED0>]}
[0m19:09:58.472830 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m19:09:58.523676 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m19:09:58.591981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m19:09:58.592979 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\google_ads\stg_google_ads_campaign_history.sql
[0m19:09:58.593976 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\schema.yml
[0m19:09:58.595008 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\google_ads\stg_google_ads_campaign_stats.sql
[0m19:09:58.655462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '808200df-801c-4361-9169-5948a4918617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002866AEE3BD0>]}
[0m19:09:58.670387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '808200df-801c-4361-9169-5948a4918617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002866AB5AE90>]}
[0m19:09:58.670387 [info ] [MainThread]: Found 4 models, 6 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m19:09:58.671384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '808200df-801c-4361-9169-5948a4918617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002866AAF8390>]}
[0m19:09:58.673413 [info ] [MainThread]: 
[0m19:09:58.674376 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:09:58.675409 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m19:09:58.676405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:58.677371 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_test_dbt'
[0m19:09:58.678402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:01.268571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '808200df-801c-4361-9169-5948a4918617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028664A24090>]}
[0m19:10:01.269568 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:10:01.271565 [info ] [MainThread]: 
[0m19:10:01.274556 [debug] [Thread-1 (]: Began running node test.bq_evo.not_null_stg_google_ads_campaign_history_id.c1e39bce7d
[0m19:10:01.275552 [debug] [Thread-2 (]: Began running node test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27
[0m19:10:01.276549 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_google_ads_campaign_history_id .................. [RUN]
[0m19:10:01.278545 [info ] [Thread-2 (]: 2 of 2 START test not_null_stg_google_ads_campaign_stats_id .................... [RUN]
[0m19:10:01.280540 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_stg_google_ads_campaign_history_id.c1e39bce7d'
[0m19:10:01.282535 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27'
[0m19:10:01.283531 [debug] [Thread-1 (]: Began compiling node test.bq_evo.not_null_stg_google_ads_campaign_history_id.c1e39bce7d
[0m19:10:01.284528 [debug] [Thread-2 (]: Began compiling node test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27
[0m19:10:01.306471 [debug] [Thread-1 (]: Writing injected SQL for node "test.bq_evo.not_null_stg_google_ads_campaign_history_id.c1e39bce7d"
[0m19:10:01.314449 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27"
[0m19:10:01.318438 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_stg_google_ads_campaign_history_id.c1e39bce7d (compile): 19:10:01.285526 => 19:10:01.318438
[0m19:10:01.320433 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27 (compile): 19:10:01.306471 => 19:10:01.319438
[0m19:10:01.321431 [debug] [Thread-1 (]: Began executing node test.bq_evo.not_null_stg_google_ads_campaign_history_id.c1e39bce7d
[0m19:10:01.322429 [debug] [Thread-2 (]: Began executing node test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27
[0m19:10:01.346921 [debug] [Thread-1 (]: Writing runtime sql for node "test.bq_evo.not_null_stg_google_ads_campaign_history_id.c1e39bce7d"
[0m19:10:01.349945 [debug] [Thread-2 (]: Writing runtime sql for node "test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27"
[0m19:10:01.350942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:10:01.352288 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:10:01.353286 [debug] [Thread-1 (]: On test.bq_evo.not_null_stg_google_ads_campaign_history_id.c1e39bce7d: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_stg_google_ads_campaign_history_id.c1e39bce7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
where id is null



      
    ) dbt_internal_test
[0m19:10:01.353286 [debug] [Thread-2 (]: On test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
where id is null



      
    ) dbt_internal_test
[0m19:10:02.113145 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:65fbff18-94d4-48d1-80fe-dce036380a26&page=queryresults
[0m19:10:02.114202 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_stg_google_ads_campaign_history_id.c1e39bce7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
where id is null



      
    ) dbt_internal_test
[0m19:10:02.115171 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table oss-big-query-dashboard-prod:staging.stg_google_ads_campaign_history was not found in location europe-west3

Location: europe-west3
Job ID: 65fbff18-94d4-48d1-80fe-dce036380a26

[0m19:10:02.116129 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_stg_google_ads_campaign_history_id.c1e39bce7d (execute): 19:10:01.323425 => 19:10:02.116129
[0m19:10:02.123112 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8ad4cb55-7d3c-4aca-9991-dfc9149978f9&page=queryresults
[0m19:10:02.124140 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
where id is null



      
    ) dbt_internal_test
[0m19:10:02.126101 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Table oss-big-query-dashboard-prod:staging.stg_google_ads_campaign_stats was not found in location europe-west3

Location: europe-west3
Job ID: 8ad4cb55-7d3c-4aca-9991-dfc9149978f9

[0m19:10:02.127099 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27 (execute): 19:10:01.346921 => 19:10:02.126101
[0m19:10:02.216983 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_google_ads_campaign_history_id (models\staging\schema.yml)
  404 Not found: Table oss-big-query-dashboard-prod:staging.stg_google_ads_campaign_history was not found in location europe-west3
  
  Location: europe-west3
  Job ID: 65fbff18-94d4-48d1-80fe-dce036380a26
  
[0m19:10:02.219012 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_google_ads_campaign_stats_id (models\staging\schema.yml)
  404 Not found: Table oss-big-query-dashboard-prod:staging.stg_google_ads_campaign_stats was not found in location europe-west3
  
  Location: europe-west3
  Job ID: 8ad4cb55-7d3c-4aca-9991-dfc9149978f9
  
[0m19:10:02.219975 [error] [Thread-1 (]: 1 of 2 ERROR not_null_stg_google_ads_campaign_history_id ....................... [[31mERROR[0m in 0.94s]
[0m19:10:02.220384 [error] [Thread-2 (]: 2 of 2 ERROR not_null_stg_google_ads_campaign_stats_id ......................... [[31mERROR[0m in 0.94s]
[0m19:10:02.221385 [debug] [Thread-1 (]: Finished running node test.bq_evo.not_null_stg_google_ads_campaign_history_id.c1e39bce7d
[0m19:10:02.222382 [debug] [Thread-2 (]: Finished running node test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27
[0m19:10:02.224376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:02.225412 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m19:10:02.225412 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_test_dbt' was properly closed.
[0m19:10:02.226371 [debug] [MainThread]: Connection 'test.bq_evo.not_null_stg_google_ads_campaign_history_id.c1e39bce7d' was properly closed.
[0m19:10:02.226371 [debug] [MainThread]: Connection 'test.bq_evo.not_null_stg_google_ads_campaign_stats_id.8e70867b27' was properly closed.
[0m19:10:02.227369 [info ] [MainThread]: 
[0m19:10:02.228366 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m19:10:02.229363 [debug] [MainThread]: Command end result
[0m19:10:02.239337 [info ] [MainThread]: 
[0m19:10:02.240338 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:10:02.241336 [info ] [MainThread]: 
[0m19:10:02.242333 [error] [MainThread]:   Runtime Error in test not_null_stg_google_ads_campaign_history_id (models\staging\schema.yml)
  404 Not found: Table oss-big-query-dashboard-prod:staging.stg_google_ads_campaign_history was not found in location europe-west3
  
  Location: europe-west3
  Job ID: 65fbff18-94d4-48d1-80fe-dce036380a26
  
[0m19:10:02.243331 [info ] [MainThread]: 
[0m19:10:02.244326 [error] [MainThread]:   Runtime Error in test not_null_stg_google_ads_campaign_stats_id (models\staging\schema.yml)
  404 Not found: Table oss-big-query-dashboard-prod:staging.stg_google_ads_campaign_stats was not found in location europe-west3
  
  Location: europe-west3
  Job ID: 8ad4cb55-7d3c-4aca-9991-dfc9149978f9
  
[0m19:10:02.246321 [info ] [MainThread]: 
[0m19:10:02.247319 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m19:10:02.249314 [debug] [MainThread]: Command `dbt test` failed at 19:10:02.249314 after 4.16 seconds
[0m19:10:02.249314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028668F3A3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028668F39E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028668F39550>]}
[0m19:10:02.251310 [debug] [MainThread]: Flushing usage events
[0m19:10:26.980218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF142461D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1426BD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1480B510>]}


============================== 19:10:26.983244 | 8676c221-1941-4024-9f5a-305d2da75e4d ==============================
[0m19:10:26.983244 [info ] [MainThread]: Running with dbt=1.6.2
[0m19:10:26.984227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:10:27.364480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8676c221-1941-4024-9f5a-305d2da75e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF14E4D490>]}
[0m19:10:27.373454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8676c221-1941-4024-9f5a-305d2da75e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF157A0BD0>]}
[0m19:10:27.374419 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m19:10:27.425870 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m19:10:27.497708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:10:27.498709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:10:27.504735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8676c221-1941-4024-9f5a-305d2da75e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF157A0A50>]}
[0m19:10:27.518212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8676c221-1941-4024-9f5a-305d2da75e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF16027610>]}
[0m19:10:27.518212 [info ] [MainThread]: Found 4 models, 6 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m19:10:27.519209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8676c221-1941-4024-9f5a-305d2da75e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF15415B90>]}
[0m19:10:27.521204 [info ] [MainThread]: 
[0m19:10:27.522232 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:10:27.524195 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m19:10:27.524195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:29.703945 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m19:10:29.706635 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_test_dbt'
[0m19:10:29.707589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:29.709584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:30.629945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8676c221-1941-4024-9f5a-305d2da75e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF15DF77D0>]}
[0m19:10:30.631980 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:10:30.633937 [info ] [MainThread]: 
[0m19:10:30.638953 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_ads_campaign_history
[0m19:10:30.638953 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m19:10:30.639951 [info ] [Thread-1 (]: 1 of 2 START sql view model staging.stg_google_ads_campaign_history ............ [RUN]
[0m19:10:30.641915 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_history'
[0m19:10:30.640917 [info ] [Thread-2 (]: 2 of 2 START sql view model staging.stg_google_ads_campaign_stats .............. [RUN]
[0m19:10:30.642910 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_history
[0m19:10:30.643910 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m19:10:30.652917 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_history"
[0m19:10:30.653882 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m19:10:30.656873 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m19:10:30.657878 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (compile): 19:10:30.643910 => 19:10:30.657878
[0m19:10:30.658870 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_ads_campaign_history
[0m19:10:30.659865 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 19:10:30.653882 => 19:10:30.659865
[0m19:10:30.691781 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_history"
[0m19:10:30.692776 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m19:10:30.697763 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m19:10:30.698836 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:10:30.699794 [debug] [Thread-1 (]: On model.bq_evo.stg_google_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_history`
),

_renamed_columns AS(
  SELECT
    _fivetran_start,
    id,
    _fivetran_active,
    _fivetran_end,
    _fivetran_synced,
    ad_serving_optimization_status,
    advertising_channel_subtype,
    advertising_channel_type,
    base_campaign_id,
    customer_id,
    end_date,
    experiment_type,
    final_url_suffix,
    frequency_caps,
    name as campaign,
    optimization_score,
    payment_mode,
    serving_status,
    start_date,
    status,
    tracking_url_template,
    updated_at,
    vanity_pharma_display_url_mode,
    vanity_pharma_text,
    video_brand_safety_suitability
  FROM _raw
),

_add_new_columns(
  SELECT 
    *,
    'google' as Source,
    'cpc' as Medium,
    (CASE
      WHEN MAX(customer_id) = 6607387807 THEN 'EVO'  
      ELSE '(null)'
    END) as Partner
  FROM _renamed_columns
),

_final AS(
  SELECT
    *,
    LOWER(CONCAT(campaign, Source, Medium, Partner)) as CampaignID
  FROM _campaigns
)

SELECT * FROM _final;


[0m19:10:30.700756 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:10:30.702750 [debug] [Thread-2 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Google Ads Kampagnen"""
    )
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_transformed_cost AS(
    SELECT
        _fivetran_id,
        customer_id,
        date,
        _fivetran_synced,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability,
        ad_network_type,
        base_campaign,
        clicks,
        conversions,
        conversions_value,
        cost_micros/1000000 as cost,
        device,
        id,
        impressions,
        interaction_event_types,
        interactions,
        view_through_conversions,
    FROM _raw
),

_final AS(
    SELECT * FROM _transformed_cost
)

SELECT * FROM _final;


[0m19:10:31.366599 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:720d6763-ff2b-42e5-9f79-352f53a76174&page=queryresults
[0m19:10:31.368592 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword AS but got "(" at [43:17]')
[0m19:10:31.529646 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:b0bac9a9-e11c-49e3-b94f-a157b3db32d0&page=queryresults
[0m19:10:31.985248 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2a18a8a2-2e5c-440c-999e-0bac5c147baa&page=queryresults
[0m19:10:31.986208 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2a18a8a2-2e5c-440c-999e-0bac5c147baa&page=queryresults
[0m19:10:31.987205 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (execute): 19:10:30.659865 => 19:10:31.987205
[0m19:10:32.005492 [debug] [Thread-1 (]: Database Error in model stg_google_ads_campaign_history (models\staging\google_ads\stg_google_ads_campaign_history.sql)
  Syntax error: Expected keyword AS but got "(" at [43:17]
  compiled Code at target\run\bq_evo\models\staging\google_ads\stg_google_ads_campaign_history.sql
[0m19:10:32.005492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8676c221-1941-4024-9f5a-305d2da75e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1575D4D0>]}
[0m19:10:32.006493 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model staging.stg_google_ads_campaign_history ... [[31mERROR[0m in 1.36s]
[0m19:10:32.008454 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_ads_campaign_history
[0m19:10:32.084414 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 19:10:30.693776 => 19:10:32.084414
[0m19:10:32.085408 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8676c221-1941-4024-9f5a-305d2da75e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1575D4D0>]}
[0m19:10:32.086373 [info ] [Thread-2 (]: 2 of 2 OK created sql view model staging.stg_google_ads_campaign_stats ......... [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m19:10:32.087370 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m19:10:32.089364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:32.089364 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m19:10:32.090361 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m19:10:32.090361 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_test_dbt' was properly closed.
[0m19:10:32.091359 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_ads_campaign_history' was properly closed.
[0m19:10:32.092357 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_ads_campaign_stats' was properly closed.
[0m19:10:32.093354 [info ] [MainThread]: 
[0m19:10:32.093354 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m19:10:32.095349 [debug] [MainThread]: Command end result
[0m19:10:32.104862 [info ] [MainThread]: 
[0m19:10:32.105859 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:10:32.106857 [info ] [MainThread]: 
[0m19:10:32.107854 [error] [MainThread]:   Database Error in model stg_google_ads_campaign_history (models\staging\google_ads\stg_google_ads_campaign_history.sql)
  Syntax error: Expected keyword AS but got "(" at [43:17]
  compiled Code at target\run\bq_evo\models\staging\google_ads\stg_google_ads_campaign_history.sql
[0m19:10:32.109852 [info ] [MainThread]: 
[0m19:10:32.110851 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m19:10:32.112845 [debug] [MainThread]: Command `dbt run` failed at 19:10:32.112845 after 5.15 seconds
[0m19:10:32.114839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1474C150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF14D5BA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1425A6D0>]}
[0m19:10:32.114839 [debug] [MainThread]: Flushing usage events
[0m19:11:53.788617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C040072850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C03FAA8510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C03FAA87D0>]}


============================== 19:11:53.792582 | 65d1de22-e507-4839-a777-bc7f1efb3b37 ==============================
[0m19:11:53.792582 [info ] [MainThread]: Running with dbt=1.6.2
[0m19:11:53.793030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m staging', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:11:54.153280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65d1de22-e507-4839-a777-bc7f1efb3b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C03FA23AD0>]}
[0m19:11:54.162255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65d1de22-e507-4839-a777-bc7f1efb3b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C040C707D0>]}
[0m19:11:54.163252 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m19:11:54.219623 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m19:11:54.286479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:11:54.286479 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\google_ads\stg_google_ads_campaign_history.sql
[0m19:11:54.344252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65d1de22-e507-4839-a777-bc7f1efb3b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C03F545E10>]}
[0m19:11:54.358216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65d1de22-e507-4839-a777-bc7f1efb3b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C041139E90>]}
[0m19:11:54.358216 [info ] [MainThread]: Found 4 models, 6 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m19:11:54.359213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65d1de22-e507-4839-a777-bc7f1efb3b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0411A1750>]}
[0m19:11:54.361612 [info ] [MainThread]: 
[0m19:11:54.362644 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:11:54.363606 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m19:11:54.364630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:56.595408 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m19:11:56.599395 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_test_dbt'
[0m19:11:56.601429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:56.601429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:57.543684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65d1de22-e507-4839-a777-bc7f1efb3b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C04112A410>]}
[0m19:11:57.544717 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:11:57.545678 [info ] [MainThread]: 
[0m19:11:57.550667 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_ads_campaign_history
[0m19:11:57.550667 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m19:11:57.551665 [info ] [Thread-1 (]: 1 of 2 START sql view model staging.stg_google_ads_campaign_history ............ [RUN]
[0m19:11:57.552660 [info ] [Thread-2 (]: 2 of 2 START sql view model staging.stg_google_ads_campaign_stats .............. [RUN]
[0m19:11:57.553660 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_history'
[0m19:11:57.554657 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m19:11:57.555656 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_history
[0m19:11:57.556652 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m19:11:57.563665 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_history"
[0m19:11:57.567621 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m19:11:57.569615 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (compile): 19:11:57.556652 => 19:11:57.568618
[0m19:11:57.569615 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_ads_campaign_history
[0m19:11:57.570613 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 19:11:57.564628 => 19:11:57.570613
[0m19:11:57.603462 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_history"
[0m19:11:57.603462 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m19:11:57.608160 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m19:11:57.608160 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:11:57.609199 [debug] [Thread-1 (]: On model.bq_evo.stg_google_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_history`
),

_renamed_columns AS(
  SELECT
    _fivetran_start,
    id,
    _fivetran_active,
    _fivetran_end,
    _fivetran_synced,
    ad_serving_optimization_status,
    advertising_channel_subtype,
    advertising_channel_type,
    base_campaign_id,
    customer_id,
    end_date,
    experiment_type,
    final_url_suffix,
    frequency_caps,
    name as campaign,
    optimization_score,
    payment_mode,
    serving_status,
    start_date,
    status,
    tracking_url_template,
    updated_at,
    vanity_pharma_display_url_mode,
    vanity_pharma_text,
    video_brand_safety_suitability
  FROM _raw
),

_add_new_columns(
  SELECT 
    *,
    'google' as Source,
    'cpc' as Medium,
    (CASE
      WHEN customer_id = 6607387807 THEN 'EVO'  
      ELSE '(null)'
    END) as Partner
  FROM _renamed_columns
),

_final AS(
  SELECT
    *,
    LOWER(CONCAT(campaign, Source, Medium, Partner)) as CampaignID
  FROM _campaigns
)

SELECT * FROM _final;


[0m19:11:57.610295 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:11:57.612674 [debug] [Thread-2 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Google Ads Kampagnen"""
    )
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_transformed_cost AS(
    SELECT
        _fivetran_id,
        customer_id,
        date,
        _fivetran_synced,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability,
        ad_network_type,
        base_campaign,
        clicks,
        conversions,
        conversions_value,
        cost_micros/1000000 as cost,
        device,
        id,
        impressions,
        interaction_event_types,
        interactions,
        view_through_conversions,
    FROM _raw
),

_final AS(
    SELECT * FROM _transformed_cost
)

SELECT * FROM _final;


[0m19:11:58.297737 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6d4d91bd-25e2-4ffe-9d85-a5bc7e621569&page=queryresults
[0m19:11:58.298689 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword AS but got "(" at [43:17]')
[0m19:11:58.354769 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2ed7a144-a5db-425b-ade1-67891db6996f&page=queryresults
[0m19:11:58.838513 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c2e98b31-84b9-43fd-9589-4ee2a4dcc2cd&page=queryresults
[0m19:11:58.856470 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c2e98b31-84b9-43fd-9589-4ee2a4dcc2cd&page=queryresults
[0m19:11:58.858464 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (execute): 19:11:57.570613 => 19:11:58.858464
[0m19:11:58.865477 [debug] [Thread-1 (]: Database Error in model stg_google_ads_campaign_history (models\staging\google_ads\stg_google_ads_campaign_history.sql)
  Syntax error: Expected keyword AS but got "(" at [43:17]
  compiled Code at target\run\bq_evo\models\staging\google_ads\stg_google_ads_campaign_history.sql
[0m19:11:58.865477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d1de22-e507-4839-a777-bc7f1efb3b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C04144CA90>]}
[0m19:11:58.866477 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model staging.stg_google_ads_campaign_history ... [[31mERROR[0m in 1.31s]
[0m19:11:58.867440 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_ads_campaign_history
[0m19:11:59.183694 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 19:11:57.604855 => 19:11:59.182699
[0m19:11:59.184714 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d1de22-e507-4839-a777-bc7f1efb3b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C03F5EEA90>]}
[0m19:11:59.185715 [info ] [Thread-2 (]: 2 of 2 OK created sql view model staging.stg_google_ads_campaign_stats ......... [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m19:11:59.186719 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m19:11:59.188671 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:59.189701 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m19:11:59.189701 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m19:11:59.190623 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_test_dbt' was properly closed.
[0m19:11:59.190623 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_ads_campaign_history' was properly closed.
[0m19:11:59.191623 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_ads_campaign_stats' was properly closed.
[0m19:11:59.191623 [info ] [MainThread]: 
[0m19:11:59.192622 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m19:11:59.193618 [debug] [MainThread]: Command end result
[0m19:11:59.203593 [info ] [MainThread]: 
[0m19:11:59.204591 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:11:59.205589 [info ] [MainThread]: 
[0m19:11:59.206585 [error] [MainThread]:   Database Error in model stg_google_ads_campaign_history (models\staging\google_ads\stg_google_ads_campaign_history.sql)
  Syntax error: Expected keyword AS but got "(" at [43:17]
  compiled Code at target\run\bq_evo\models\staging\google_ads\stg_google_ads_campaign_history.sql
[0m19:11:59.207586 [info ] [MainThread]: 
[0m19:11:59.208581 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m19:11:59.208581 [debug] [MainThread]: Command `dbt run` failed at 19:11:59.208581 after 5.44 seconds
[0m19:11:59.210115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C03FA21E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C04005EB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C03F56C150>]}
[0m19:11:59.210115 [debug] [MainThread]: Flushing usage events
[0m19:16:35.650865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD1A6D250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD1420590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD14F5610>]}


============================== 19:16:35.656979 | 8b702e25-f2e7-4e70-a6a0-ec9ce7fb8fb0 ==============================
[0m19:16:35.656979 [info ] [MainThread]: Running with dbt=1.6.2
[0m19:16:35.659286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m staging', 'send_anonymous_usage_stats': 'True'}
[0m19:16:36.084394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b702e25-f2e7-4e70-a6a0-ec9ce7fb8fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD2B31BD0>]}
[0m19:16:36.094814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b702e25-f2e7-4e70-a6a0-ec9ce7fb8fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD26D87D0>]}
[0m19:16:36.095844 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m19:16:36.152797 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m19:16:36.226998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:16:36.228331 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\google_ads\stg_google_ads_campaign_history.sql
[0m19:16:36.295846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b702e25-f2e7-4e70-a6a0-ec9ce7fb8fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD1415490>]}
[0m19:16:36.310954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b702e25-f2e7-4e70-a6a0-ec9ce7fb8fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD2EE12D0>]}
[0m19:16:36.312948 [info ] [MainThread]: Found 4 models, 6 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m19:16:36.313993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b702e25-f2e7-4e70-a6a0-ec9ce7fb8fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD2A31BD0>]}
[0m19:16:36.314993 [info ] [MainThread]: 
[0m19:16:36.315991 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:16:36.317021 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m19:16:36.318158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:38.765422 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_test_dbt'
[0m19:16:38.766454 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m19:16:38.767417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:38.768414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:39.746821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b702e25-f2e7-4e70-a6a0-ec9ce7fb8fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCCA24090>]}
[0m19:16:39.747795 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:16:39.748794 [info ] [MainThread]: 
[0m19:16:39.753164 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_ads_campaign_history
[0m19:16:39.754164 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m19:16:39.754164 [info ] [Thread-1 (]: 1 of 2 START sql view model staging.stg_google_ads_campaign_history ............ [RUN]
[0m19:16:39.756160 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_history'
[0m19:16:39.755187 [info ] [Thread-2 (]: 2 of 2 START sql view model staging.stg_google_ads_campaign_stats .............. [RUN]
[0m19:16:39.757157 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_history
[0m19:16:39.758156 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m19:16:39.765170 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_history"
[0m19:16:39.766169 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m19:16:39.770123 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m19:16:39.771119 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (compile): 19:16:39.758156 => 19:16:39.771119
[0m19:16:39.772116 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_ads_campaign_history
[0m19:16:39.784154 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 19:16:39.767131 => 19:16:39.784154
[0m19:16:39.806645 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_history"
[0m19:16:39.807676 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m19:16:39.811630 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m19:16:39.812629 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:16:39.812629 [debug] [Thread-1 (]: On model.bq_evo.stg_google_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_history`
),

_renamed_columns AS(
  SELECT
    _fivetran_start,
    id,
    _fivetran_active,
    _fivetran_end,
    _fivetran_synced,
    ad_serving_optimization_status,
    advertising_channel_subtype,
    advertising_channel_type,
    base_campaign_id,
    customer_id,
    end_date,
    experiment_type,
    final_url_suffix,
    frequency_caps,
    name as campaign,
    optimization_score,
    payment_mode,
    serving_status,
    start_date,
    status,
    tracking_url_template,
    updated_at,
    vanity_pharma_display_url_mode,
    vanity_pharma_text,
    video_brand_safety_suitability
  FROM _raw
),

_add_new_columns AS(
  SELECT 
    *,
    'google' as Source,
    'cpc' as Medium,
    (CASE
      WHEN customer_id = 6607387807 THEN 'EVO'  
      ELSE '(null)'
    END) as Partner
  FROM _renamed_columns
),

_final AS(
  SELECT
    *,
    LOWER(CONCAT(campaign, Source, Medium, Partner)) as CampaignID
  FROM _campaigns
)

SELECT * FROM _final;


[0m19:16:39.813625 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:16:39.816618 [debug] [Thread-2 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Google Ads Kampagnen"""
    )
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_transformed_cost AS(
    SELECT
        _fivetran_id,
        customer_id,
        date,
        _fivetran_synced,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability,
        ad_network_type,
        base_campaign,
        clicks,
        conversions,
        conversions_value,
        cost_micros/1000000 as cost,
        device,
        id,
        impressions,
        interaction_event_types,
        interactions,
        view_through_conversions,
    FROM _raw
),

_final AS(
    SELECT * FROM _transformed_cost
)

SELECT * FROM _final;


[0m19:16:40.509001 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c753ffb3-18f4-4200-b314-7961163fbe76&page=queryresults
[0m19:16:40.510997 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "_campaigns" must be qualified with a dataset (e.g. dataset.table).')
[0m19:16:40.606284 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:dfd1c5b8-cbbf-4592-a38d-a5cf88713c0f&page=queryresults
[0m19:16:40.978126 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6742df49-e5d3-4370-9c56-e2f7d089b8a0&page=queryresults
[0m19:16:40.979083 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6742df49-e5d3-4370-9c56-e2f7d089b8a0&page=queryresults
[0m19:16:40.981079 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (execute): 19:16:39.772116 => 19:16:40.981079
[0m19:16:40.991642 [debug] [Thread-1 (]: Database Error in model stg_google_ads_campaign_history (models\staging\google_ads\stg_google_ads_campaign_history.sql)
  Table "_campaigns" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target\run\bq_evo\models\staging\google_ads\stg_google_ads_campaign_history.sql
[0m19:16:40.992636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b702e25-f2e7-4e70-a6a0-ec9ce7fb8fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD2B31610>]}
[0m19:16:40.993600 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model staging.stg_google_ads_campaign_history ... [[31mERROR[0m in 1.24s]
[0m19:16:40.994597 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_ads_campaign_history
[0m19:16:41.142493 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 19:16:39.808639 => 19:16:41.142493
[0m19:16:41.143488 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b702e25-f2e7-4e70-a6a0-ec9ce7fb8fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD2B43110>]}
[0m19:16:41.144451 [info ] [Thread-2 (]: 2 of 2 OK created sql view model staging.stg_google_ads_campaign_stats ......... [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m19:16:41.145448 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m19:16:41.147475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:41.147475 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m19:16:41.148473 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_test_dbt' was properly closed.
[0m19:16:41.148473 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m19:16:41.149437 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_ads_campaign_history' was properly closed.
[0m19:16:41.149437 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_ads_campaign_stats' was properly closed.
[0m19:16:41.150435 [info ] [MainThread]: 
[0m19:16:41.150435 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m19:16:41.152430 [debug] [MainThread]: Command end result
[0m19:16:41.161908 [info ] [MainThread]: 
[0m19:16:41.162907 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:16:41.163903 [info ] [MainThread]: 
[0m19:16:41.164901 [error] [MainThread]:   Database Error in model stg_google_ads_campaign_history (models\staging\google_ads\stg_google_ads_campaign_history.sql)
  Table "_campaigns" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target\run\bq_evo\models\staging\google_ads\stg_google_ads_campaign_history.sql
[0m19:16:41.166160 [info ] [MainThread]: 
[0m19:16:41.166160 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m19:16:41.168161 [debug] [MainThread]: Command `dbt run` failed at 19:16:41.168161 after 5.55 seconds
[0m19:16:41.169156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD1408950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD1408610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD14087D0>]}
[0m19:16:41.169156 [debug] [MainThread]: Flushing usage events
[0m19:17:04.734610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245139161D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024514007990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024513D3C190>]}


============================== 19:17:04.737645 | 7a145e5e-f392-4c85-9eb2-c7d114c7b1b4 ==============================
[0m19:17:04.737645 [info ] [MainThread]: Running with dbt=1.6.2
[0m19:17:04.739596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:17:05.097045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a145e5e-f392-4c85-9eb2-c7d114c7b1b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002451541D8D0>]}
[0m19:17:05.106021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a145e5e-f392-4c85-9eb2-c7d114c7b1b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024514FF87D0>]}
[0m19:17:05.106983 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m19:17:05.155470 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m19:17:05.224318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:17:05.224318 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\google_ads\stg_google_ads_campaign_history.sql
[0m19:17:05.280778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a145e5e-f392-4c85-9eb2-c7d114c7b1b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002451595D9D0>]}
[0m19:17:05.293709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a145e5e-f392-4c85-9eb2-c7d114c7b1b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024515A3B090>]}
[0m19:17:05.293709 [info ] [MainThread]: Found 4 models, 6 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m19:17:05.294708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a145e5e-f392-4c85-9eb2-c7d114c7b1b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002451542CBD0>]}
[0m19:17:05.296773 [info ] [MainThread]: 
[0m19:17:05.297807 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:17:05.298809 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m19:17:05.299768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:07.462163 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_test_dbt'
[0m19:17:07.463160 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m19:17:07.463160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:07.464159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:08.434851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a145e5e-f392-4c85-9eb2-c7d114c7b1b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024515A3AED0>]}
[0m19:17:08.435818 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:17:08.436815 [info ] [MainThread]: 
[0m19:17:08.441181 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_ads_campaign_history
[0m19:17:08.442177 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m19:17:08.442177 [info ] [Thread-1 (]: 1 of 2 START sql view model staging.stg_google_ads_campaign_history ............ [RUN]
[0m19:17:08.444173 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_history'
[0m19:17:08.443174 [info ] [Thread-2 (]: 2 of 2 START sql view model staging.stg_google_ads_campaign_stats .............. [RUN]
[0m19:17:08.445170 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_history
[0m19:17:08.446169 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m19:17:08.453149 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_history"
[0m19:17:08.454652 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m19:17:08.458647 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m19:17:08.459680 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (compile): 19:17:08.446169 => 19:17:08.459680
[0m19:17:08.460646 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_ads_campaign_history
[0m19:17:08.469615 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 19:17:08.455654 => 19:17:08.469615
[0m19:17:08.496578 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_history"
[0m19:17:08.496578 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m19:17:08.500534 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m19:17:08.502529 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:17:08.503529 [debug] [Thread-1 (]: On model.bq_evo.stg_google_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_history`
),

_renamed_columns AS(
  SELECT
    _fivetran_start,
    id,
    _fivetran_active,
    _fivetran_end,
    _fivetran_synced,
    ad_serving_optimization_status,
    advertising_channel_subtype,
    advertising_channel_type,
    base_campaign_id,
    customer_id,
    end_date,
    experiment_type,
    final_url_suffix,
    frequency_caps,
    name as campaign,
    optimization_score,
    payment_mode,
    serving_status,
    start_date,
    status,
    tracking_url_template,
    updated_at,
    vanity_pharma_display_url_mode,
    vanity_pharma_text,
    video_brand_safety_suitability
  FROM _raw
),

_add_new_columns AS(
  SELECT 
    *,
    'google' as Source,
    'cpc' as Medium,
    (CASE
      WHEN customer_id = 6607387807 THEN 'EVO'  
      ELSE '(null)'
    END) as Partner
  FROM _renamed_columns
),

_final AS(
  SELECT
    *,
    LOWER(CONCAT(campaign, Source, Medium, Partner)) as CampaignID
  FROM _add_new_columns
)

SELECT * FROM _final;


[0m19:17:08.505522 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:17:08.508546 [debug] [Thread-2 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Google Ads Kampagnen"""
    )
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_transformed_cost AS(
    SELECT
        _fivetran_id,
        customer_id,
        date,
        _fivetran_synced,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability,
        ad_network_type,
        base_campaign,
        clicks,
        conversions,
        conversions_value,
        cost_micros/1000000 as cost,
        device,
        id,
        impressions,
        interaction_event_types,
        interactions,
        view_through_conversions,
    FROM _raw
),

_final AS(
    SELECT * FROM _transformed_cost
)

SELECT * FROM _final;


[0m19:17:09.214256 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:46fd0725-1c09-45c0-a0f9-c0e363d44e1a&page=queryresults
[0m19:17:09.269962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:b562ccae-64bb-47f1-b88e-336ba6cc98ac&page=queryresults
[0m19:17:09.789844 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (execute): 19:17:08.461637 => 19:17:09.788849
[0m19:17:09.791786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a145e5e-f392-4c85-9eb2-c7d114c7b1b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024513A5AB50>]}
[0m19:17:09.792784 [info ] [Thread-1 (]: 1 of 2 OK created sql view model staging.stg_google_ads_campaign_history ....... [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m19:17:09.793781 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_ads_campaign_history
[0m19:17:10.018100 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 19:17:08.497542 => 19:17:10.018100
[0m19:17:10.019099 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a145e5e-f392-4c85-9eb2-c7d114c7b1b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024514F72850>]}
[0m19:17:10.020095 [info ] [Thread-2 (]: 2 of 2 OK created sql view model staging.stg_google_ads_campaign_stats ......... [[32mCREATE VIEW (0 processed)[0m in 1.57s]
[0m19:17:10.021058 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m19:17:10.023053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:10.024084 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m19:17:10.024084 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_test_dbt' was properly closed.
[0m19:17:10.025058 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m19:17:10.025058 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_ads_campaign_history' was properly closed.
[0m19:17:10.026045 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_ads_campaign_stats' was properly closed.
[0m19:17:10.026045 [info ] [MainThread]: 
[0m19:17:10.028040 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m19:17:10.029038 [debug] [MainThread]: Command end result
[0m19:17:10.040539 [info ] [MainThread]: 
[0m19:17:10.041537 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:17:10.042535 [info ] [MainThread]: 
[0m19:17:10.043564 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:17:10.045531 [debug] [MainThread]: Command `dbt run` succeeded at 19:17:10.045531 after 5.32 seconds
[0m19:17:10.045531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002451455E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002451455D2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002450E4D2F90>]}
[0m19:17:10.046527 [debug] [MainThread]: Flushing usage events
[0m19:40:59.509143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148BA242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148BA24E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148BA130D0>]}


============================== 19:40:59.513636 | fae71fb7-3321-4c46-b42c-27affba2b403 ==============================
[0m19:40:59.513636 [info ] [MainThread]: Running with dbt=1.6.2
[0m19:40:59.514152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m intermediate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:40:59.873749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fae71fb7-3321-4c46-b42c-27affba2b403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148CD1C990>]}
[0m19:40:59.881727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fae71fb7-3321-4c46-b42c-27affba2b403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148B571E90>]}
[0m19:40:59.882723 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m19:40:59.932173 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m19:40:59.942119 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:40:59.943117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fae71fb7-3321-4c46-b42c-27affba2b403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148C0953D0>]}
[0m19:41:00.791576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fae71fb7-3321-4c46-b42c-27affba2b403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148D1CAAD0>]}
[0m19:41:00.806038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fae71fb7-3321-4c46-b42c-27affba2b403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148D4B05D0>]}
[0m19:41:00.806038 [info ] [MainThread]: Found 6 models, 9 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m19:41:00.807035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fae71fb7-3321-4c46-b42c-27affba2b403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148D408110>]}
[0m19:41:00.809064 [info ] [MainThread]: 
[0m19:41:00.810026 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:41:00.812021 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m19:41:00.812021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:03.150083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_oss-big-query-dashboard-prod, now create_oss-big-query-dashboard-prod_intermediate)
[0m19:41:03.157068 [debug] [ThreadPool]: Creating schema "database: "oss-big-query-dashboard-prod"
schema: "intermediate"
"
[0m19:41:03.170025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:41:03.170025 [debug] [ThreadPool]: On create_oss-big-query-dashboard-prod_intermediate: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "connection_name": "create_oss-big-query-dashboard-prod_intermediate"} */
create schema if not exists `oss-big-query-dashboard-prod`.`intermediate`
  
[0m19:41:03.852351 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4371042f-bbd7-471a-bd52-7cc00a12bb6e&page=queryresults
[0m19:41:05.949601 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_test_dbt'
[0m19:41:05.949601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:05.950599 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m19:41:05.951564 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m19:41:05.953559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:05.954555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:07.041469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fae71fb7-3321-4c46-b42c-27affba2b403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148D122B50>]}
[0m19:41:07.042508 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:41:07.043466 [info ] [MainThread]: 
[0m19:41:07.048058 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m19:41:07.048058 [info ] [Thread-1 (]: 1 of 2 START sql view model intermediate.int_google_ads_unique_campaigns ....... [RUN]
[0m19:41:07.050056 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_ads_unique_campaigns'
[0m19:41:07.051083 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m19:41:07.059031 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m19:41:07.063024 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 19:41:07.051083 => 19:41:07.063024
[0m19:41:07.064018 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m19:41:07.092942 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m19:41:07.096930 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:41:07.097929 [debug] [Thread-1 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        id,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        MAX(CampaignID) as CampaignID
    FROM _raw
    GROUP BY 1
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m19:41:07.788918 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:36de437a-710c-4033-87fb-56a68c4accf5&page=queryresults
[0m19:41:08.364339 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 19:41:07.064018 => 19:41:08.363311
[0m19:41:08.365336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae71fb7-3321-4c46-b42c-27affba2b403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148D1CAB10>]}
[0m19:41:08.365336 [info ] [Thread-1 (]: 1 of 2 OK created sql view model intermediate.int_google_ads_unique_campaigns .. [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m19:41:08.366331 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m19:41:08.368295 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m19:41:08.368295 [info ] [Thread-3 (]: 2 of 2 START sql view model intermediate.int_google_ads_campaign_stats ......... [RUN]
[0m19:41:08.370290 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_ads_campaign_stats'
[0m19:41:08.371287 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m19:41:08.377272 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m19:41:08.379267 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 19:41:08.371287 => 19:41:08.379267
[0m19:41:08.380264 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m19:41:08.384288 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m19:41:08.385284 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:41:08.386252 [debug] [Thread-3 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht der wichtigsten Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
)

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m19:41:08.967795 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5b0481fc-0dd9-41f1-84f2-d80dd1a93b59&page=queryresults
[0m19:41:08.968829 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "_unique_campaigns" at [40:1]')
[0m19:41:09.201299 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:d1e32906-65be-4721-8c85-501485d2e83e&page=queryresults
[0m19:41:09.201299 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:d1e32906-65be-4721-8c85-501485d2e83e&page=queryresults
[0m19:41:09.203260 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 19:41:08.381261 => 19:41:09.203260
[0m19:41:09.209265 [debug] [Thread-3 (]: Database Error in model int_google_ads_campaign_stats (models\intermediate\google_ads\int_google_ads_campaign_stats.sql)
  Syntax error: Unexpected identifier "_unique_campaigns" at [40:1]
  compiled Code at target\run\bq_evo\models\intermediate\google_ads\int_google_ads_campaign_stats.sql
[0m19:41:09.210241 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae71fb7-3321-4c46-b42c-27affba2b403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148D4AF8D0>]}
[0m19:41:09.211238 [error] [Thread-3 (]: 2 of 2 ERROR creating sql view model intermediate.int_google_ads_campaign_stats  [[31mERROR[0m in 0.84s]
[0m19:41:09.213234 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m19:41:09.215234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:09.216229 [debug] [MainThread]: Connection 'create_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m19:41:09.217226 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_test_dbt' was properly closed.
[0m19:41:09.218223 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m19:41:09.218223 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m19:41:09.219221 [debug] [MainThread]: Connection 'model.bq_evo.int_google_ads_unique_campaigns' was properly closed.
[0m19:41:09.219221 [debug] [MainThread]: Connection 'model.bq_evo.int_google_ads_campaign_stats' was properly closed.
[0m19:41:09.220218 [info ] [MainThread]: 
[0m19:41:09.220218 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 8.41 seconds (8.41s).
[0m19:41:09.222213 [debug] [MainThread]: Command end result
[0m19:41:09.233690 [info ] [MainThread]: 
[0m19:41:09.234689 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:41:09.235685 [info ] [MainThread]: 
[0m19:41:09.236682 [error] [MainThread]:   Database Error in model int_google_ads_campaign_stats (models\intermediate\google_ads\int_google_ads_campaign_stats.sql)
  Syntax error: Unexpected identifier "_unique_campaigns" at [40:1]
  compiled Code at target\run\bq_evo\models\intermediate\google_ads\int_google_ads_campaign_stats.sql
[0m19:41:09.236682 [info ] [MainThread]: 
[0m19:41:09.238677 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m19:41:09.239675 [debug] [MainThread]: Command `dbt run` failed at 19:41:09.239675 after 9.74 seconds
[0m19:41:09.240673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021487DB95D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148C05B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148D155D50>]}
[0m19:41:09.241670 [debug] [MainThread]: Flushing usage events
[0m19:41:52.601490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026743D71510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002674326C2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002674326E810>]}


============================== 19:41:52.605480 | 3734ad89-dedc-41b1-95cf-2eb2f7d95f90 ==============================
[0m19:41:52.605480 [info ] [MainThread]: Running with dbt=1.6.2
[0m19:41:52.606103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m intermediate', 'send_anonymous_usage_stats': 'True'}
[0m19:41:52.957500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3734ad89-dedc-41b1-95cf-2eb2f7d95f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026745032050>]}
[0m19:41:52.970460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3734ad89-dedc-41b1-95cf-2eb2f7d95f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026743E3BDD0>]}
[0m19:41:52.971462 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m19:41:53.023807 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m19:41:53.093469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:41:53.094509 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\google_ads\int_google_ads_campaign_stats.sql
[0m19:41:53.151109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3734ad89-dedc-41b1-95cf-2eb2f7d95f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026745046750>]}
[0m19:41:53.166583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3734ad89-dedc-41b1-95cf-2eb2f7d95f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267450048D0>]}
[0m19:41:53.167581 [info ] [MainThread]: Found 6 models, 9 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m19:41:53.168889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3734ad89-dedc-41b1-95cf-2eb2f7d95f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026744587C50>]}
[0m19:41:53.170277 [info ] [MainThread]: 
[0m19:41:53.171281 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:41:53.172329 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m19:41:53.173333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:55.342963 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m19:41:55.344957 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_test_dbt'
[0m19:41:55.345922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:55.346913 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m19:41:55.347950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:55.352927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:56.489717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3734ad89-dedc-41b1-95cf-2eb2f7d95f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026745241250>]}
[0m19:41:56.490713 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:41:56.491685 [info ] [MainThread]: 
[0m19:41:56.495674 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m19:41:56.496672 [info ] [Thread-1 (]: 1 of 2 START sql view model intermediate.int_google_ads_unique_campaigns ....... [RUN]
[0m19:41:56.497668 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_ads_unique_campaigns'
[0m19:41:56.498666 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m19:41:56.505651 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m19:41:56.506647 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 19:41:56.498666 => 19:41:56.506647
[0m19:41:56.507678 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m19:41:56.541102 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m19:41:56.543127 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:41:56.544094 [debug] [Thread-1 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        id,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        MAX(CampaignID) as CampaignID
    FROM _raw
    GROUP BY 1
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m19:41:57.265038 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:27a043e6-0629-46d7-ad9c-d8859943ba35&page=queryresults
[0m19:41:57.874617 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 19:41:56.508679 => 19:41:57.873626
[0m19:41:57.876614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3734ad89-dedc-41b1-95cf-2eb2f7d95f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002674522EED0>]}
[0m19:41:57.878572 [info ] [Thread-1 (]: 1 of 2 OK created sql view model intermediate.int_google_ads_unique_campaigns .. [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m19:41:57.881599 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m19:41:57.883555 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m19:41:57.884555 [info ] [Thread-3 (]: 2 of 2 START sql view model intermediate.int_google_ads_campaign_stats ......... [RUN]
[0m19:41:57.887543 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_ads_campaign_stats'
[0m19:41:57.888546 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m19:41:57.893560 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m19:41:57.894577 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 19:41:57.889542 => 19:41:57.894577
[0m19:41:57.895524 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m19:41:57.898547 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m19:41:57.900508 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:41:57.901506 [debug] [Thread-3 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht der wichtigsten Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
),

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m19:41:58.607734 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:36ac626f-5e55-4c69-9593-8d930fb37354&page=queryresults
[0m19:41:59.330137 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 19:41:57.895524 => 19:41:59.329136
[0m19:41:59.332127 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3734ad89-dedc-41b1-95cf-2eb2f7d95f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002674522EF50>]}
[0m19:41:59.334082 [info ] [Thread-3 (]: 2 of 2 OK created sql view model intermediate.int_google_ads_campaign_stats .... [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m19:41:59.335103 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m19:41:59.337070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:59.338068 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m19:41:59.339148 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m19:41:59.339148 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_test_dbt' was properly closed.
[0m19:41:59.340148 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m19:41:59.340148 [debug] [MainThread]: Connection 'model.bq_evo.int_google_ads_unique_campaigns' was properly closed.
[0m19:41:59.341145 [debug] [MainThread]: Connection 'model.bq_evo.int_google_ads_campaign_stats' was properly closed.
[0m19:41:59.341145 [info ] [MainThread]: 
[0m19:41:59.342142 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 6.17 seconds (6.17s).
[0m19:41:59.344137 [debug] [MainThread]: Command end result
[0m19:41:59.358101 [info ] [MainThread]: 
[0m19:41:59.359098 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:41:59.360234 [info ] [MainThread]: 
[0m19:41:59.361275 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:41:59.362287 [debug] [MainThread]: Command `dbt run` succeeded at 19:41:59.362287 after 6.77 seconds
[0m19:41:59.363308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026743D6B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026743D5E010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002674373C390>]}
[0m19:41:59.364270 [debug] [MainThread]: Flushing usage events
[0m19:42:08.879678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515DE72390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515D38C1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515D3FB510>]}


============================== 19:42:08.883835 | f00a6bd6-0650-4f5f-a69d-41118db96ca5 ==============================
[0m19:42:08.883835 [info ] [MainThread]: Running with dbt=1.6.2
[0m19:42:08.884482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test -m intermediate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:42:09.233678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f00a6bd6-0650-4f5f-a69d-41118db96ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515EABE910>]}
[0m19:42:09.241657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f00a6bd6-0650-4f5f-a69d-41118db96ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515D819A10>]}
[0m19:42:09.243651 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m19:42:09.301005 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m19:42:09.375452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:42:09.375452 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:42:09.382400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f00a6bd6-0650-4f5f-a69d-41118db96ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515F218A90>]}
[0m19:42:09.395365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f00a6bd6-0650-4f5f-a69d-41118db96ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515EF6B3D0>]}
[0m19:42:09.396363 [info ] [MainThread]: Found 6 models, 9 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m19:42:09.397373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f00a6bd6-0650-4f5f-a69d-41118db96ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515D5D7490>]}
[0m19:42:09.398392 [info ] [MainThread]: 
[0m19:42:09.399356 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:42:09.401383 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m19:42:09.402346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:09.403378 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m19:42:09.404357 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_test_dbt'
[0m19:42:09.404852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:09.404852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:12.164566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f00a6bd6-0650-4f5f-a69d-41118db96ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515EB2D210>]}
[0m19:42:12.165564 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:42:12.166562 [info ] [MainThread]: 
[0m19:42:12.171547 [debug] [Thread-1 (]: Began running node test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd
[0m19:42:12.171547 [debug] [Thread-2 (]: Began running node test.bq_evo.not_null_int_google_ads_unique_campaigns_id.be8133ba80
[0m19:42:12.172545 [debug] [Thread-3 (]: Began running node test.bq_evo.unique_int_google_ads_unique_campaigns_id.8dd96a4bf6
[0m19:42:12.173553 [info ] [Thread-1 (]: 1 of 3 START test not_null_int_google_ads_campaign_stats_CampaignID ............ [RUN]
[0m19:42:12.174540 [info ] [Thread-2 (]: 2 of 3 START test not_null_int_google_ads_unique_campaigns_id .................. [RUN]
[0m19:42:12.175538 [info ] [Thread-3 (]: 3 of 3 START test unique_int_google_ads_unique_campaigns_id .................... [RUN]
[0m19:42:12.176535 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd'
[0m19:42:12.178529 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_int_google_ads_unique_campaigns_id.be8133ba80'
[0m19:42:12.179528 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.bq_evo.unique_int_google_ads_unique_campaigns_id.8dd96a4bf6'
[0m19:42:12.180525 [debug] [Thread-1 (]: Began compiling node test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd
[0m19:42:12.180525 [debug] [Thread-2 (]: Began compiling node test.bq_evo.not_null_int_google_ads_unique_campaigns_id.be8133ba80
[0m19:42:12.182523 [debug] [Thread-3 (]: Began compiling node test.bq_evo.unique_int_google_ads_unique_campaigns_id.8dd96a4bf6
[0m19:42:12.200476 [debug] [Thread-1 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd"
[0m19:42:12.205457 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_ads_unique_campaigns_id.be8133ba80"
[0m19:42:12.212472 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_evo.unique_int_google_ads_unique_campaigns_id.8dd96a4bf6"
[0m19:42:12.217431 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd (compile): 19:42:12.183516 => 19:42:12.217431
[0m19:42:12.218422 [debug] [Thread-3 (]: Timing info for test.bq_evo.unique_int_google_ads_unique_campaigns_id.8dd96a4bf6 (compile): 19:42:12.206454 => 19:42:12.218422
[0m19:42:12.219421 [debug] [Thread-1 (]: Began executing node test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd
[0m19:42:12.220421 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_int_google_ads_unique_campaigns_id.be8133ba80 (compile): 19:42:12.201470 => 19:42:12.220421
[0m19:42:12.221418 [debug] [Thread-3 (]: Began executing node test.bq_evo.unique_int_google_ads_unique_campaigns_id.8dd96a4bf6
[0m19:42:12.239404 [debug] [Thread-1 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd"
[0m19:42:12.240425 [debug] [Thread-2 (]: Began executing node test.bq_evo.not_null_int_google_ads_unique_campaigns_id.be8133ba80
[0m19:42:12.243427 [debug] [Thread-3 (]: Writing runtime sql for node "test.bq_evo.unique_int_google_ads_unique_campaigns_id.8dd96a4bf6"
[0m19:42:12.246419 [debug] [Thread-2 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_ads_unique_campaigns_id.be8133ba80"
[0m19:42:12.247383 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:42:12.248379 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:42:12.249379 [debug] [Thread-1 (]: On test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
where CampaignID is null



      
    ) dbt_internal_test
[0m19:42:12.249379 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:42:12.250401 [debug] [Thread-3 (]: On test.bq_evo.unique_int_google_ads_unique_campaigns_id.8dd96a4bf6: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.unique_int_google_ads_unique_campaigns_id.8dd96a4bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:42:12.253443 [debug] [Thread-2 (]: On test.bq_evo.not_null_int_google_ads_unique_campaigns_id.be8133ba80: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_ads_unique_campaigns_id.be8133ba80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
where id is null



      
    ) dbt_internal_test
[0m19:42:13.300816 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8e94d026-11eb-4a8a-9849-c009c5c58998&page=queryresults
[0m19:42:13.365315 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:df87c91a-9679-4941-a876-487152c02f87&page=queryresults
[0m19:42:13.452318 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5135984d-553f-4a77-bc92-f521318a8869&page=queryresults
[0m19:42:13.675562 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_int_google_ads_unique_campaigns_id.be8133ba80 (execute): 19:42:12.244389 => 19:42:13.675562
[0m19:42:13.676528 [info ] [Thread-2 (]: 2 of 3 PASS not_null_int_google_ads_unique_campaigns_id ........................ [[32mPASS[0m in 1.50s]
[0m19:42:13.677525 [debug] [Thread-2 (]: Finished running node test.bq_evo.not_null_int_google_ads_unique_campaigns_id.be8133ba80
[0m19:42:13.723435 [debug] [Thread-3 (]: Timing info for test.bq_evo.unique_int_google_ads_unique_campaigns_id.8dd96a4bf6 (execute): 19:42:12.241398 => 19:42:13.723435
[0m19:42:13.724433 [info ] [Thread-3 (]: 3 of 3 PASS unique_int_google_ads_unique_campaigns_id .......................... [[32mPASS[0m in 1.55s]
[0m19:42:13.725434 [debug] [Thread-3 (]: Finished running node test.bq_evo.unique_int_google_ads_unique_campaigns_id.8dd96a4bf6
[0m19:42:13.847623 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd (execute): 19:42:12.221418 => 19:42:13.847623
[0m19:42:13.848621 [info ] [Thread-1 (]: 1 of 3 PASS not_null_int_google_ads_campaign_stats_CampaignID .................. [[32mPASS[0m in 1.67s]
[0m19:42:13.850615 [debug] [Thread-1 (]: Finished running node test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd
[0m19:42:13.852645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:13.852645 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m19:42:13.853609 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m19:42:13.853609 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_test_dbt' was properly closed.
[0m19:42:13.854606 [debug] [MainThread]: Connection 'test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd' was properly closed.
[0m19:42:13.855113 [debug] [MainThread]: Connection 'test.bq_evo.not_null_int_google_ads_unique_campaigns_id.be8133ba80' was properly closed.
[0m19:42:13.856115 [debug] [MainThread]: Connection 'test.bq_evo.unique_int_google_ads_unique_campaigns_id.8dd96a4bf6' was properly closed.
[0m19:42:13.856115 [info ] [MainThread]: 
[0m19:42:13.857112 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m19:42:13.859107 [debug] [MainThread]: Command end result
[0m19:42:13.869080 [info ] [MainThread]: 
[0m19:42:13.870076 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:42:13.871075 [info ] [MainThread]: 
[0m19:42:13.872072 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:42:13.873069 [debug] [MainThread]: Command `dbt test` succeeded at 19:42:13.873069 after 5.01 seconds
[0m19:42:13.874067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515D819A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515D216890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001515D8A4150>]}
[0m19:42:13.874067 [debug] [MainThread]: Flushing usage events
[0m20:00:48.633934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DC3A61D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DC9A8E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DCF70B90>]}


============================== 20:00:48.637888 | 4fb15161-4962-441d-9bad-25ce312dfa2e ==============================
[0m20:00:48.637888 [info ] [MainThread]: Running with dbt=1.6.2
[0m20:00:48.638473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m mart', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:00:49.021730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fb15161-4962-441d-9bad-25ce312dfa2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DCF70310>]}
[0m20:00:49.030671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fb15161-4962-441d-9bad-25ce312dfa2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DCF70B90>]}
[0m20:00:49.031668 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m20:00:49.080611 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m20:00:49.093615 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:00:49.095574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4fb15161-4962-441d-9bad-25ce312dfa2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DCF95090>]}
[0m20:00:49.938243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fb15161-4962-441d-9bad-25ce312dfa2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DE3CAE90>]}
[0m20:00:49.952206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fb15161-4962-441d-9bad-25ce312dfa2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DE40B290>]}
[0m20:00:49.953204 [info ] [MainThread]: Found 7 models, 10 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m20:00:49.954202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fb15161-4962-441d-9bad-25ce312dfa2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DE2E8390>]}
[0m20:00:49.955198 [info ] [MainThread]: 
[0m20:00:49.957194 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:00:49.958191 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m20:00:49.959188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:52.247397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_oss-big-query-dashboard-prod, now create_oss-big-query-dashboard-prod_mart)
[0m20:00:52.250388 [debug] [ThreadPool]: Creating schema "database: "oss-big-query-dashboard-prod"
schema: "mart"
"
[0m20:00:52.259364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:52.260362 [debug] [ThreadPool]: On create_oss-big-query-dashboard-prod_mart: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "connection_name": "create_oss-big-query-dashboard-prod_mart"} */
create schema if not exists `oss-big-query-dashboard-prod`.`mart`
  
[0m20:00:53.555774 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:13f4129f-0bf2-49e9-9423-7639f4c79b49&page=queryresults
[0m20:00:55.382521 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m20:00:55.383532 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m20:00:55.384517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:55.385517 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m20:00:55.385517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:55.386547 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_test_dbt'
[0m20:00:55.388507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:55.391534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:56.627171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fb15161-4962-441d-9bad-25ce312dfa2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DE3B1210>]}
[0m20:00:56.627171 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:00:56.628207 [info ] [MainThread]: 
[0m20:00:56.633181 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_google_ads_performancereporting
[0m20:00:56.633181 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.mrt_google_ads_performancereporting .......... [RUN]
[0m20:00:56.635149 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_ads_performancereporting'
[0m20:00:56.636180 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_google_ads_performancereporting
[0m20:00:56.645160 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_performancereporting"
[0m20:00:56.647117 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_ads_performancereporting (compile): 20:00:56.637146 => 20:00:56.647117
[0m20:00:56.648115 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_google_ads_performancereporting
[0m20:00:56.685017 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_performancereporting"
[0m20:00:56.688009 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:00:56.689006 [debug] [Thread-1 (]: On model.bq_evo.mrt_google_ads_performancereporting: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_performancereporting"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m20:00:57.458011 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:148805d6-0f6a-4ce9-ae2b-6beed2cfc06f&page=queryresults
[0m20:01:00.022635 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_ads_performancereporting (execute): 20:00:56.649119 => 20:01:00.022635
[0m20:01:00.024633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fb15161-4962-441d-9bad-25ce312dfa2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DE418FD0>]}
[0m20:01:00.024633 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.mrt_google_ads_performancereporting ..... [[32mCREATE TABLE (87.8k rows, 10.2 MiB processed)[0m in 3.39s]
[0m20:01:00.026627 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_google_ads_performancereporting
[0m20:01:00.028619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:00.029651 [debug] [MainThread]: Connection 'create_oss-big-query-dashboard-prod_mart' was properly closed.
[0m20:01:00.030613 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m20:01:00.030613 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m20:01:00.031685 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m20:01:00.031685 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_test_dbt' was properly closed.
[0m20:01:00.031685 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_ads_performancereporting' was properly closed.
[0m20:01:00.032683 [info ] [MainThread]: 
[0m20:01:00.033679 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.08 seconds (10.08s).
[0m20:01:00.034677 [debug] [MainThread]: Command end result
[0m20:01:00.044653 [info ] [MainThread]: 
[0m20:01:00.045648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:01:00.046647 [info ] [MainThread]: 
[0m20:01:00.046647 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:01:00.048643 [debug] [MainThread]: Command `dbt run` succeeded at 20:01:00.048643 after 11.43 seconds
[0m20:01:00.048643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DCF6B2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DCF5AE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216DC46C150>]}
[0m20:01:00.049638 [debug] [MainThread]: Flushing usage events
[0m20:10:02.273266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123FF73E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123FF2EE2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123FF7A8D10>]}


============================== 20:10:02.277257 | 5a30485f-d0cf-42ef-bde0-1fd6ec91456e ==============================
[0m20:10:02.277257 [info ] [MainThread]: Running with dbt=1.6.2
[0m20:10:02.278219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:10:02.628569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a30485f-d0cf-42ef-bde0-1fd6ec91456e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001238103C690>]}
[0m20:10:02.638543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a30485f-d0cf-42ef-bde0-1fd6ec91456e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123807D86D0>]}
[0m20:10:02.639541 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m20:10:02.689001 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m20:10:02.697944 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:10:02.699938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5a30485f-d0cf-42ef-bde0-1fd6ec91456e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001238075ED50>]}
[0m20:10:03.538439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a30485f-d0cf-42ef-bde0-1fd6ec91456e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012381052E90>]}
[0m20:10:03.555395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a30485f-d0cf-42ef-bde0-1fd6ec91456e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123810C0810>]}
[0m20:10:03.556395 [info ] [MainThread]: Found 7 models, 10 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m20:10:03.557419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a30485f-d0cf-42ef-bde0-1fd6ec91456e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001238120A250>]}
[0m20:10:03.559386 [info ] [MainThread]: 
[0m20:10:03.560420 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:10:03.561380 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m20:10:03.562413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:05.797503 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_test_dbt'
[0m20:10:05.798503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:05.799531 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m20:10:05.800532 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m20:10:05.802493 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m20:10:05.803495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:05.803495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:05.804489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:07.032533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a30485f-d0cf-42ef-bde0-1fd6ec91456e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001238112FF50>]}
[0m20:10:07.033533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:07.034531 [info ] [MainThread]: 
[0m20:10:07.039656 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_google_ads_performancereporting
[0m20:10:07.040687 [info ] [Thread-1 (]: 1 of 1 START sql incremental model mart.mrt_google_ads_performancereporting .... [RUN]
[0m20:10:07.042647 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_ads_performancereporting'
[0m20:10:07.043647 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_google_ads_performancereporting
[0m20:10:07.056645 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_performancereporting"
[0m20:10:07.057646 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_ads_performancereporting (compile): 20:10:07.043647 => 20:10:07.057646
[0m20:10:07.058606 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_google_ads_performancereporting
[0m20:10:07.126258 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:10:07.127257 [debug] [Thread-1 (]: On model.bq_evo.mrt_google_ads_performancereporting: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_performancereporting"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

      

        WHERE
        --Update table for the past seven days + today
        date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m20:10:07.897270 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:29ec8112-bb6a-410a-8257-f39a53afaf9b&page=queryresults
[0m20:10:09.841757 [debug] [Thread-1 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:10:09.865733 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_performancereporting"
[0m20:10:09.866727 [debug] [Thread-1 (]: On model.bq_evo.mrt_google_ads_performancereporting: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_performancereporting"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.Date = DBT_INTERNAL_DEST.Date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m20:10:10.170965 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:0a44be2d-0a68-42ca-85f8-018dd40db820&page=queryresults
[0m20:10:12.609140 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_ads_performancereporting (execute): 20:10:07.059602 => 20:10:12.609140
[0m20:10:12.610099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a30485f-d0cf-42ef-bde0-1fd6ec91456e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123FF7202D0>]}
[0m20:10:12.611096 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model mart.mrt_google_ads_performancereporting  [[32mMERGE (175.0 rows, 11.3 MiB processed)[0m in 5.57s]
[0m20:10:12.612095 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_google_ads_performancereporting
[0m20:10:12.614089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:12.614089 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m20:10:12.615120 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_test_dbt' was properly closed.
[0m20:10:12.615120 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m20:10:12.616083 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m20:10:12.616083 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m20:10:12.617080 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_ads_performancereporting' was properly closed.
[0m20:10:12.617080 [info ] [MainThread]: 
[0m20:10:12.618078 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.06 seconds (9.06s).
[0m20:10:12.619075 [debug] [MainThread]: Command end result
[0m20:10:12.629324 [info ] [MainThread]: 
[0m20:10:12.631320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:12.631320 [info ] [MainThread]: 
[0m20:10:12.632319 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:10:12.633314 [debug] [MainThread]: Command `dbt run` succeeded at 20:10:12.633314 after 10.37 seconds
[0m20:10:12.634349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123FF7A8CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123FFD5B490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123FF74C150>]}
[0m20:10:12.634349 [debug] [MainThread]: Flushing usage events
[0m15:04:09.187946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8DD717D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8DD72190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8DD6B010>]}


============================== 15:04:09.206857 | 1892e699-44dd-48cf-93ab-9e03b133e023 ==============================
[0m15:04:09.206857 [info ] [MainThread]: Running with dbt=1.6.2
[0m15:04:09.207858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:04:11.172661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1892e699-44dd-48cf-93ab-9e03b133e023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8F932B50>]}
[0m15:04:11.181676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1892e699-44dd-48cf-93ab-9e03b133e023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8DE307D0>]}
[0m15:04:11.186668 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m15:04:11.245552 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m15:04:11.868192 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 5 files added, 5 files changed.
[0m15:04:11.869190 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\bing_ads\int_bing_ads_campaign_performance_joined_campaign_names.sql
[0m15:04:11.870187 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\bing_ads\mrt_bing_ads_performancereporting.sql
[0m15:04:11.871184 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\bing_ads\int_bing_ads_unique_campaigns.sql
[0m15:04:11.871184 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\bing_ads\stg_bing_ads_campaign_performance_daily_report.sql
[0m15:04:11.872182 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\bing_ads\stg_bing_ads_campaign_history.sql
[0m15:04:11.873213 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\schema.yml
[0m15:04:11.874177 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\sources.yml
[0m15:04:11.874177 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\mart\schema.yml
[0m15:04:11.875174 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\schema.yml
[0m15:04:11.876177 [debug] [MainThread]: Partial parsing: deleted file: bq_evo://models\example\my_second_dbt_model.sql
[0m15:04:11.876177 [debug] [MainThread]: Partial parsing: deleted file: bq_evo://models\example\my_first_dbt_model.sql
[0m15:04:11.877260 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\mart\google_ads\mrt_google_ads_performancereporting.sql
[0m15:04:11.968042 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bq_evo.stg_bing_ads_campaign_performance_daily_report' (models\staging\bing_ads\stg_bing_ads_campaign_performance_daily_report.sql) depends on a source named 'bingads_evo.campaign_performance_daily_report' which was not found
[0m15:04:11.970297 [debug] [MainThread]: Command `dbt run` failed at 15:04:11.970297 after 2.81 seconds
[0m15:04:11.971305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8E2FF3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8DD5B310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8E869890>]}
[0m15:04:11.971305 [debug] [MainThread]: Flushing usage events
[0m15:04:57.251502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1DF746D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1D913190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1D9A87D0>]}


============================== 15:04:57.255492 | 22ae877c-dcce-4a40-b5ae-9b08075daf6f ==============================
[0m15:04:57.255492 [info ] [MainThread]: Running with dbt=1.6.2
[0m15:04:57.256488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:04:57.599972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22ae877c-dcce-4a40-b5ae-9b08075daf6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1F232250>]}
[0m15:04:57.608946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22ae877c-dcce-4a40-b5ae-9b08075daf6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1E9587D0>]}
[0m15:04:57.609943 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m15:04:57.659811 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m15:04:57.734244 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 5 files added, 5 files changed.
[0m15:04:57.735200 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\bing_ads\int_bing_ads_campaign_performance_joined_campaign_names.sql
[0m15:04:57.735200 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\bing_ads\mrt_bing_ads_performancereporting.sql
[0m15:04:57.736232 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\bing_ads\int_bing_ads_unique_campaigns.sql
[0m15:04:57.736232 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\bing_ads\stg_bing_ads_campaign_history.sql
[0m15:04:57.737195 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\bing_ads\stg_bing_ads_campaign_performance_daily_report.sql
[0m15:04:57.738132 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\sources.yml
[0m15:04:57.739132 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\schema.yml
[0m15:04:57.739132 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\mart\schema.yml
[0m15:04:57.740130 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\schema.yml
[0m15:04:57.740130 [debug] [MainThread]: Partial parsing: deleted file: bq_evo://models\example\my_second_dbt_model.sql
[0m15:04:57.741127 [debug] [MainThread]: Partial parsing: deleted file: bq_evo://models\example\my_first_dbt_model.sql
[0m15:04:57.741127 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\mart\google_ads\mrt_google_ads_performancereporting.sql
[0m15:04:57.843508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22ae877c-dcce-4a40-b5ae-9b08075daf6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1F23B010>]}
[0m15:04:57.864225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22ae877c-dcce-4a40-b5ae-9b08075daf6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1E9D8210>]}
[0m15:04:57.865640 [info ] [MainThread]: Found 10 models, 11 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:04:57.866644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ae877c-dcce-4a40-b5ae-9b08075daf6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1D0E0ED0>]}
[0m15:04:57.868799 [info ] [MainThread]: 
[0m15:04:57.869803 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:04:57.870933 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:04:57.871959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:57.871959 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:04:57.873321 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:04:57.874361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:57.875368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:01.670335 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m15:05:01.671368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:01.672366 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m15:05:01.674358 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m15:05:01.675355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:01.676320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:02.418907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ae877c-dcce-4a40-b5ae-9b08075daf6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1B5F5E10>]}
[0m15:05:02.420936 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:02.421898 [info ] [MainThread]: 
[0m15:05:02.435862 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_bing_ads_campaign_history
[0m15:05:02.436858 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:05:02.436858 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_google_ads_campaign_history
[0m15:05:02.437856 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m15:05:02.437856 [info ] [Thread-1 (]: 1 of 10 START sql view model staging.stg_bing_ads_campaign_history ............. [RUN]
[0m15:05:02.438852 [info ] [Thread-2 (]: 2 of 10 START sql view model staging.stg_bing_ads_campaign_performance_daily_report  [RUN]
[0m15:05:02.439851 [info ] [Thread-3 (]: 3 of 10 START sql view model staging.stg_google_ads_campaign_history ........... [RUN]
[0m15:05:02.440849 [info ] [Thread-4 (]: 4 of 10 START sql view model staging.stg_google_ads_campaign_stats ............. [RUN]
[0m15:05:02.442844 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_history'
[0m15:05:02.443840 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_performance_daily_report'
[0m15:05:02.444839 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_history'
[0m15:05:02.445834 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m15:05:02.446844 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_history
[0m15:05:02.447831 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:05:02.448827 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_history
[0m15:05:02.449855 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m15:05:02.457802 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m15:05:02.460795 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m15:05:02.464783 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_history"
[0m15:05:02.468808 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m15:05:02.471766 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (compile): 15:05:02.450822 => 15:05:02.470769
[0m15:05:02.471766 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (compile): 15:05:02.461792 => 15:05:02.471766
[0m15:05:02.472762 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (compile): 15:05:02.457802 => 15:05:02.472762
[0m15:05:02.473760 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 15:05:02.464783 => 15:05:02.473760
[0m15:05:02.473760 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_history
[0m15:05:02.474757 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_google_ads_campaign_history
[0m15:05:02.475762 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:05:02.476761 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m15:05:02.511773 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m15:05:02.515880 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_history"
[0m15:05:02.518010 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m15:05:02.521636 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m15:05:02.523791 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:05:02.524797 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:05:02.525795 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:02.526791 [debug] [Thread-3 (]: On model.bq_evo.stg_google_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_history`
),

_renamed_columns AS(
  SELECT
    _fivetran_start,
    id,
    _fivetran_active,
    _fivetran_end,
    _fivetran_synced,
    ad_serving_optimization_status,
    advertising_channel_subtype,
    advertising_channel_type,
    base_campaign_id,
    customer_id,
    end_date,
    experiment_type,
    final_url_suffix,
    frequency_caps,
    name as campaign,
    optimization_score,
    payment_mode,
    serving_status,
    start_date,
    status,
    tracking_url_template,
    updated_at,
    vanity_pharma_display_url_mode,
    vanity_pharma_text,
    video_brand_safety_suitability
  FROM _raw
),

_add_new_columns AS(
  SELECT 
    *,
    'google' as Source,
    'cpc' as Medium,
    (CASE
      WHEN customer_id = 6607387807 THEN 'EVO'  
      ELSE '(null)'
    END) as Partner
  FROM _renamed_columns
),

_final AS(
  SELECT
    *,
    LOWER(CONCAT(campaign, Source, Medium, Partner)) as CampaignID
  FROM _add_new_columns
)

SELECT * FROM _final;


[0m15:05:02.527789 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:05:02.528791 [debug] [Thread-1 (]: On model.bq_evo.stg_bing_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_history`
),


_added_columns AS (
    SELECT
        *,
        'cpc' as Medium,
        'bing' as Source,
        (CASE 
            WHEN account_id = 156001989 THEN 'EVO'
            ELSE NULL) as Partner,
    FROM _raw
),

_added_campaignid AS (
    SELECT 
        *,
        LOWER (CONCAT(name, Source, Medium, Partner)) as CampaignID
    FROM _added_columns
),

_final AS(
    SELECT *
    FROM _added_campaignid
)

SELECT * FROM _final;


[0m15:05:02.529786 [debug] [Thread-2 (]: On model.bq_evo.stg_bing_ads_campaign_performance_daily_report: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_performance_daily_report`
),

_renamed_columns AS(
    SELECT 
        _fivetran_id,
        _fivetran_synced,
        account_id,
        ad_distribution,
        ad_relevance,
        all_conversions,
        all_return_on_ad_spend,
        all_revenue,
        assists,
        average_cpc,
        average_position,
        bid_match_type,
        budget_association_status,
        campaign_id,
        campaign_status,
        clicks as Clicks,
        conversions,
        ctr,
        currency_code,
        date as Date,
        delivered_match_type,
        device_os,
        device_type,
        expected_ctr,
        historical_ad_relevance,
        historical_expected_ctr,
        historical_landing_page_experience,
        historical_quality_score,
        impressions as Impressions,
        landing_page_experience,
        low_quality_clicks,
        low_quality_clicks_percent,
        low_quality_conversion_rate,
        low_quality_conversions,
        low_quality_general_clicks,
        low_quality_impressions,
        low_quality_impressions_percent,
        low_quality_sophisticated_clicks,
        network,
        phone_calls,
        phone_impressions,
        quality_score,
        return_on_ad_spend,
        revenue,
        spend as Cost,
        top_vs_other,
        view_through_conversions,
        all_conversion_rate,
        conversion_rate,
        campaign_name,
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m15:05:02.532905 [debug] [Thread-4 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Google Ads Kampagnen"""
    )
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_transformed_cost AS(
    SELECT
        _fivetran_id,
        customer_id,
        date,
        _fivetran_synced,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability,
        ad_network_type,
        base_campaign,
        clicks,
        conversions,
        conversions_value,
        cost_micros/1000000 as cost,
        device,
        id,
        impressions,
        interaction_event_types,
        interactions,
        view_through_conversions,
    FROM _raw
),

_final AS(
    SELECT * FROM _transformed_cost
)

SELECT * FROM _final;


[0m15:05:03.348618 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7e04de9f-465f-4254-8005-bd7ede842763&page=queryresults
[0m15:05:03.349617 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [21:22]')
[0m15:05:03.382562 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5571d04b-2328-4064-b199-a79f663bf063&page=queryresults
[0m15:05:03.429021 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:9b265c00-b17b-411d-a97a-b17193f7dc69&page=queryresults
[0m15:05:03.448004 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:d6c77aef-c6da-4f81-aca5-cc21ac43db2d&page=queryresults
[0m15:05:03.664339 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: all_conversion_rate; Did you mean all_conversions? at [62:9]')
[0m15:05:03.937016 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:0bf915d2-1e2b-445b-9d6f-7ff370dd232a&page=queryresults
[0m15:05:03.937016 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:0bf915d2-1e2b-445b-9d6f-7ff370dd232a&page=queryresults
[0m15:05:03.939011 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (execute): 15:05:02.477751 => 15:05:03.939011
[0m15:05:04.039366 [debug] [Thread-1 (]: Database Error in model stg_bing_ads_campaign_history (models\staging\bing_ads\stg_bing_ads_campaign_history.sql)
  Syntax error: Unexpected ")" at [21:22]
  compiled Code at target\run\bq_evo\models\staging\bing_ads\stg_bing_ads_campaign_history.sql
[0m15:05:04.040361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ae877c-dcce-4a40-b5ae-9b08075daf6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1EFF7290>]}
[0m15:05:04.041328 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model staging.stg_bing_ads_campaign_history .... [[31mERROR[0m in 1.60s]
[0m15:05:04.042373 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_history
[0m15:05:04.043322 [debug] [Thread-1 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:05:04.044320 [info ] [Thread-1 (]: 5 of 10 SKIP relation intermediate.int_bing_ads_unique_campaigns ............... [[33mSKIP[0m]
[0m15:05:04.045317 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:05:04.114993 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 15:05:02.519368 => 15:05:04.113995
[0m15:05:04.116025 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ae877c-dcce-4a40-b5ae-9b08075daf6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1F339C50>]}
[0m15:05:04.116988 [info ] [Thread-4 (]: 4 of 10 OK created sql view model staging.stg_google_ads_campaign_stats ........ [[32mCREATE VIEW (0 processed)[0m in 1.67s]
[0m15:05:04.118019 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m15:05:04.252664 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (execute): 15:05:02.512860 => 15:05:04.251618
[0m15:05:04.253676 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ae877c-dcce-4a40-b5ae-9b08075daf6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1F4DB590>]}
[0m15:05:04.253676 [info ] [Thread-3 (]: 3 of 10 OK created sql view model staging.stg_google_ads_campaign_history ...... [[32mCREATE VIEW (0 processed)[0m in 1.81s]
[0m15:05:04.254680 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_google_ads_campaign_history
[0m15:05:04.255683 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m15:05:04.256687 [info ] [Thread-1 (]: 6 of 10 START sql view model intermediate.int_google_ads_unique_campaigns ...... [RUN]
[0m15:05:04.257683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_history, now model.bq_evo.int_google_ads_unique_campaigns)
[0m15:05:04.258682 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m15:05:04.261705 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m15:05:04.262670 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 15:05:04.258682 => 15:05:04.262670
[0m15:05:04.263668 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m15:05:04.266692 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m15:05:04.268654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:04.269652 [debug] [Thread-1 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        id,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        MAX(CampaignID) as CampaignID
    FROM _raw
    GROUP BY 1
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m15:05:04.553331 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:91ea0534-3512-40c0-84b7-378848b01c8a&page=queryresults
[0m15:05:04.786978 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:91ea0534-3512-40c0-84b7-378848b01c8a&page=queryresults
[0m15:05:04.787942 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (execute): 15:05:02.515880 => 15:05:04.787942
[0m15:05:04.791970 [debug] [Thread-2 (]: Database Error in model stg_bing_ads_campaign_performance_daily_report (models\staging\bing_ads\stg_bing_ads_campaign_performance_daily_report.sql)
  Unrecognized name: all_conversion_rate; Did you mean all_conversions? at [62:9]
  compiled Code at target\run\bq_evo\models\staging\bing_ads\stg_bing_ads_campaign_performance_daily_report.sql
[0m15:05:04.792965 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ae877c-dcce-4a40-b5ae-9b08075daf6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1F475ED0>]}
[0m15:05:04.793965 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model staging.stg_bing_ads_campaign_performance_daily_report  [[31mERROR[0m in 2.35s]
[0m15:05:04.794963 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:05:04.795958 [debug] [Thread-3 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:05:04.796956 [info ] [Thread-3 (]: 7 of 10 SKIP relation intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[33mSKIP[0m]
[0m15:05:04.797953 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:05:04.798973 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_bing_ads_performancereporting
[0m15:05:04.799949 [info ] [Thread-2 (]: 8 of 10 SKIP relation mart.mrt_bing_ads_performancereporting ................... [[33mSKIP[0m]
[0m15:05:04.800950 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_bing_ads_performancereporting
[0m15:05:05.224246 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5a7de8c6-5733-4ec0-a9cc-ddaf919eed43&page=queryresults
[0m15:05:05.968179 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 15:05:04.263668 => 15:05:05.968179
[0m15:05:05.969177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ae877c-dcce-4a40-b5ae-9b08075daf6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1F332D50>]}
[0m15:05:05.970175 [info ] [Thread-1 (]: 6 of 10 OK created sql view model intermediate.int_google_ads_unique_campaigns . [[32mCREATE VIEW (0 processed)[0m in 1.71s]
[0m15:05:05.971172 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m15:05:05.972170 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m15:05:05.973166 [info ] [Thread-3 (]: 9 of 10 START sql view model intermediate.int_google_ads_campaign_stats ........ [RUN]
[0m15:05:05.974165 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_ads_campaign_history, now model.bq_evo.int_google_ads_campaign_stats)
[0m15:05:05.975162 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m15:05:05.978153 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m15:05:05.979152 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 15:05:05.975162 => 15:05:05.979152
[0m15:05:05.980148 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m15:05:05.987129 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m15:05:05.989122 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:05:05.989122 [debug] [Thread-3 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
),

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m15:05:06.753714 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:252fac90-f419-4bcc-8c22-092885de0f1e&page=queryresults
[0m15:05:07.515387 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 15:05:05.981145 => 15:05:07.515387
[0m15:05:07.517390 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ae877c-dcce-4a40-b5ae-9b08075daf6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1F370510>]}
[0m15:05:07.517390 [info ] [Thread-3 (]: 9 of 10 OK created sql view model intermediate.int_google_ads_campaign_stats ... [[32mCREATE VIEW (0 processed)[0m in 1.54s]
[0m15:05:07.519377 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m15:05:07.520374 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_google_ads_performancereporting
[0m15:05:07.521370 [info ] [Thread-2 (]: 10 of 10 START sql incremental model mart.mrt_google_ads_performancereporting .. [RUN]
[0m15:05:07.522382 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_performance_daily_report, now model.bq_evo.mrt_google_ads_performancereporting)
[0m15:05:07.523407 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_google_ads_performancereporting
[0m15:05:07.528386 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_performancereporting"
[0m15:05:07.530346 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_ads_performancereporting (compile): 15:05:07.523407 => 15:05:07.530346
[0m15:05:07.531357 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_google_ads_performancereporting
[0m15:05:07.590186 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:07.591183 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_ads_performancereporting: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_performancereporting"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

      

        WHERE
        --Update table for the past seven days + today
        date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m15:05:08.298840 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ffaf22cd-7338-413d-b1b7-6ce2b8c7a0ee&page=queryresults
[0m15:05:10.383124 [debug] [Thread-2 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:05:10.407094 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_performancereporting"
[0m15:05:10.408088 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_ads_performancereporting: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_performancereporting"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.date = DBT_INTERNAL_DEST.date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m15:05:10.682444 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7e3e8d4e-6d4b-4634-ac3c-a5f20920dacd&page=queryresults
[0m15:05:13.660291 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_ads_performancereporting (execute): 15:05:07.531357 => 15:05:13.660291
[0m15:05:13.661292 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ae877c-dcce-4a40-b5ae-9b08075daf6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1F2E6E90>]}
[0m15:05:13.662254 [info ] [Thread-2 (]: 10 of 10 OK created sql incremental model mart.mrt_google_ads_performancereporting  [[32mMERGE (179.0 rows, 11.3 MiB processed)[0m in 6.14s]
[0m15:05:13.663251 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_google_ads_performancereporting
[0m15:05:13.665247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:13.666275 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:05:13.666275 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:05:13.667241 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:05:13.667241 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m15:05:13.669235 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m15:05:13.670178 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m15:05:13.670178 [debug] [MainThread]: Connection 'model.bq_evo.int_google_ads_unique_campaigns' was properly closed.
[0m15:05:13.671178 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_ads_performancereporting' was properly closed.
[0m15:05:13.671178 [debug] [MainThread]: Connection 'model.bq_evo.int_google_ads_campaign_stats' was properly closed.
[0m15:05:13.672174 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_ads_campaign_stats' was properly closed.
[0m15:05:13.672174 [info ] [MainThread]: 
[0m15:05:13.673172 [info ] [MainThread]: Finished running 8 view models, 2 incremental models in 0 hours 0 minutes and 15.80 seconds (15.80s).
[0m15:05:13.676166 [debug] [MainThread]: Command end result
[0m15:05:13.686138 [info ] [MainThread]: 
[0m15:05:13.687135 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:05:13.689130 [info ] [MainThread]: 
[0m15:05:13.690127 [error] [MainThread]:   Database Error in model stg_bing_ads_campaign_history (models\staging\bing_ads\stg_bing_ads_campaign_history.sql)
  Syntax error: Unexpected ")" at [21:22]
  compiled Code at target\run\bq_evo\models\staging\bing_ads\stg_bing_ads_campaign_history.sql
[0m15:05:13.691124 [info ] [MainThread]: 
[0m15:05:13.693121 [error] [MainThread]:   Database Error in model stg_bing_ads_campaign_performance_daily_report (models\staging\bing_ads\stg_bing_ads_campaign_performance_daily_report.sql)
  Unrecognized name: all_conversion_rate; Did you mean all_conversions? at [62:9]
  compiled Code at target\run\bq_evo\models\staging\bing_ads\stg_bing_ads_campaign_performance_daily_report.sql
[0m15:05:13.694124 [info ] [MainThread]: 
[0m15:05:13.695114 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=3 TOTAL=10
[0m15:05:13.696111 [debug] [MainThread]: Command `dbt run` failed at 15:05:13.696111 after 16.46 seconds
[0m15:05:13.697109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1D48C0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1D91E3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED1D115C10>]}
[0m15:05:13.698113 [debug] [MainThread]: Flushing usage events
[0m15:09:16.223083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2147C6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E214E460D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2153F1C90>]}


============================== 15:09:16.227073 | f9e5c782-2830-42b5-ab3b-744bc3586827 ==============================
[0m15:09:16.227073 [info ] [MainThread]: Running with dbt=1.6.2
[0m15:09:16.228731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:09:16.569739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9e5c782-2830-42b5-ab3b-744bc3586827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E215336A50>]}
[0m15:09:16.578301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9e5c782-2830-42b5-ab3b-744bc3586827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2153351D0>]}
[0m15:09:16.579298 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m15:09:16.632158 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m15:09:16.707577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:09:16.708576 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\bing_ads\stg_bing_ads_campaign_history.sql
[0m15:09:16.709574 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\bing_ads\stg_bing_ads_campaign_performance_daily_report.sql
[0m15:09:16.770449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9e5c782-2830-42b5-ab3b-744bc3586827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E216E0C790>]}
[0m15:09:16.784967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9e5c782-2830-42b5-ab3b-744bc3586827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E213362D10>]}
[0m15:09:16.784967 [info ] [MainThread]: Found 10 models, 11 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:09:16.786000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9e5c782-2830-42b5-ab3b-744bc3586827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E216C67E10>]}
[0m15:09:16.788955 [info ] [MainThread]: 
[0m15:09:16.789985 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:09:16.791979 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:09:16.792977 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:09:16.792977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:16.793940 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:09:16.794938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:16.795936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:19.530788 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m15:09:19.532825 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m15:09:19.532825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:19.535455 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m15:09:19.536021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:19.540019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:20.240686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9e5c782-2830-42b5-ab3b-744bc3586827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E216C3AB90>]}
[0m15:09:20.241685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:09:20.242681 [info ] [MainThread]: 
[0m15:09:20.246688 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_bing_ads_campaign_history
[0m15:09:20.247667 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:09:20.247667 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_google_ads_campaign_history
[0m15:09:20.248664 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m15:09:20.248664 [info ] [Thread-1 (]: 1 of 10 START sql view model staging.stg_bing_ads_campaign_history ............. [RUN]
[0m15:09:20.250663 [info ] [Thread-2 (]: 2 of 10 START sql view model staging.stg_bing_ads_campaign_performance_daily_report  [RUN]
[0m15:09:20.251656 [info ] [Thread-3 (]: 3 of 10 START sql view model staging.stg_google_ads_campaign_history ........... [RUN]
[0m15:09:20.252656 [info ] [Thread-4 (]: 4 of 10 START sql view model staging.stg_google_ads_campaign_stats ............. [RUN]
[0m15:09:20.253654 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_history'
[0m15:09:20.254650 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_performance_daily_report'
[0m15:09:20.255648 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_history'
[0m15:09:20.257642 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m15:09:20.258638 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_history
[0m15:09:20.259642 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:09:20.260637 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_history
[0m15:09:20.261631 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m15:09:20.268648 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m15:09:20.272605 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m15:09:20.278187 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_history"
[0m15:09:20.282179 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m15:09:20.283176 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (compile): 15:09:20.261631 => 15:09:20.283176
[0m15:09:20.284174 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (compile): 15:09:20.269648 => 15:09:20.284174
[0m15:09:20.285179 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_history
[0m15:09:20.287166 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (compile): 15:09:20.273601 => 15:09:20.286175
[0m15:09:20.287166 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 15:09:20.279220 => 15:09:20.287166
[0m15:09:20.288164 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:09:20.320113 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m15:09:20.321075 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_google_ads_campaign_history
[0m15:09:20.322075 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m15:09:20.325098 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m15:09:20.329054 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_history"
[0m15:09:20.330087 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:09:20.333043 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m15:09:20.334042 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:09:20.335040 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:09:20.335040 [debug] [Thread-1 (]: On model.bq_evo.stg_bing_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_history`
),


_added_columns AS (
    SELECT
        *,
        'cpc' as Medium,
        'bing' as Source,
        (CASE 
            WHEN account_id = 156001989 THEN 'EVO'
        ) as Partner,
    FROM _raw
),

_added_campaignid AS (
    SELECT 
        *,
        LOWER (CONCAT(name, Source, Medium, Partner)) as CampaignID
    FROM _added_columns
),

_final AS(
    SELECT *
    FROM _added_campaignid
)

SELECT * FROM _final;


[0m15:09:20.337033 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:09:20.338030 [debug] [Thread-2 (]: On model.bq_evo.stg_bing_ads_campaign_performance_daily_report: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_performance_daily_report`
),

_renamed_columns AS(
    SELECT 
        _fivetran_id,
        _fivetran_synced,
        account_id,
        ad_distribution,
        ad_relevance,
        all_conversions,
        all_conversions_qualified,
        all_return_on_ad_spend,
        all_revenue,
        assists,
        average_cpc,
        average_position,
        bid_match_type,
        budget_association_status,
        campaign_id,
        campaign_name,
        campaign_status,
        clicks as Clicks,
        conversions,
        conversions_qualified,
        ctr,
        currency_code,
        date as Date,
        delivered_match_type,
        device_os,
        device_type,
        expected_ctr,
        historical_ad_relevance,
        historical_expected_ctr,
        historical_landing_page_experience,
        historical_quality_score,
        impressions as Impressionns,
        landing_page_experience,
        low_quality_clicks,
        low_quality_clicks_percent,
        low_quality_conversion_rate,
        low_quality_conversions,
        low_quality_conversions_qualified,
        low_quality_general_clicks,
        low_quality_impressions,
        low_quality_impressions_percent,
        low_quality_sophisticated_clicks,
        network,
        phone_calls,
        phone_impressions,
        quality_score,
        return_on_ad_spend,
        revenue,
        spend as Cost,
        top_vs_other,
        view_through_conversions
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m15:09:20.339555 [debug] [Thread-3 (]: On model.bq_evo.stg_google_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_history`
),

_renamed_columns AS(
  SELECT
    _fivetran_start,
    id,
    _fivetran_active,
    _fivetran_end,
    _fivetran_synced,
    ad_serving_optimization_status,
    advertising_channel_subtype,
    advertising_channel_type,
    base_campaign_id,
    customer_id,
    end_date,
    experiment_type,
    final_url_suffix,
    frequency_caps,
    name as campaign,
    optimization_score,
    payment_mode,
    serving_status,
    start_date,
    status,
    tracking_url_template,
    updated_at,
    vanity_pharma_display_url_mode,
    vanity_pharma_text,
    video_brand_safety_suitability
  FROM _raw
),

_add_new_columns AS(
  SELECT 
    *,
    'google' as Source,
    'cpc' as Medium,
    (CASE
      WHEN customer_id = 6607387807 THEN 'EVO'  
      ELSE '(null)'
    END) as Partner
  FROM _renamed_columns
),

_final AS(
  SELECT
    *,
    LOWER(CONCAT(campaign, Source, Medium, Partner)) as CampaignID
  FROM _add_new_columns
)

SELECT * FROM _final;


[0m15:09:20.343582 [debug] [Thread-4 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Google Ads Kampagnen"""
    )
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_transformed_cost AS(
    SELECT
        _fivetran_id,
        customer_id,
        date,
        _fivetran_synced,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability,
        ad_network_type,
        base_campaign,
        clicks,
        conversions,
        conversions_value,
        cost_micros/1000000 as cost,
        device,
        id,
        impressions,
        interaction_event_types,
        interactions,
        view_through_conversions,
    FROM _raw
),

_final AS(
    SELECT * FROM _transformed_cost
)

SELECT * FROM _final;


[0m15:09:21.112279 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e8543c5a-4a8f-45e0-b999-a75667bdc053&page=queryresults
[0m15:09:21.113237 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ELSE or keyword END but got ")" at [21:9]')
[0m15:09:21.176139 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e1e2f020-3ead-4496-9c64-5fd6d5e90ca3&page=queryresults
[0m15:09:21.185686 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6108887b-4e85-41a1-86ec-fff7f7fd92d6&page=queryresults
[0m15:09:21.192635 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7824557f-855c-4409-b67a-de49c585bce4&page=queryresults
[0m15:09:21.423946 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (execute): 15:09:20.322075 => 15:09:21.423946
[0m15:09:21.425940 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9e5c782-2830-42b5-ab3b-744bc3586827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E216D5BD50>]}
[0m15:09:21.425940 [info ] [Thread-2 (]: 2 of 10 OK created sql view model staging.stg_bing_ads_campaign_performance_daily_report  [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m15:09:21.427900 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:09:21.663588 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:b67003ca-49ac-42f2-9f8e-aea5f24fc068&page=queryresults
[0m15:09:21.665531 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:b67003ca-49ac-42f2-9f8e-aea5f24fc068&page=queryresults
[0m15:09:21.667567 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (execute): 15:09:20.289164 => 15:09:21.666571
[0m15:09:21.673549 [debug] [Thread-1 (]: Database Error in model stg_bing_ads_campaign_history (models\staging\bing_ads\stg_bing_ads_campaign_history.sql)
  Syntax error: Expected keyword ELSE or keyword END but got ")" at [21:9]
  compiled Code at target\run\bq_evo\models\staging\bing_ads\stg_bing_ads_campaign_history.sql
[0m15:09:21.674551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9e5c782-2830-42b5-ab3b-744bc3586827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E216D5BA10>]}
[0m15:09:21.675520 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model staging.stg_bing_ads_campaign_history .... [[31mERROR[0m in 1.42s]
[0m15:09:21.676512 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_history
[0m15:09:21.677520 [debug] [Thread-2 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:09:21.678502 [info ] [Thread-2 (]: 5 of 10 SKIP relation intermediate.int_bing_ads_unique_campaigns ............... [[33mSKIP[0m]
[0m15:09:21.679014 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:09:21.680527 [debug] [Thread-1 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:09:21.680527 [info ] [Thread-1 (]: 6 of 10 SKIP relation intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[33mSKIP[0m]
[0m15:09:21.681665 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:09:21.682666 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_bing_ads_performancereporting
[0m15:09:21.683872 [info ] [Thread-2 (]: 7 of 10 SKIP relation mart.mrt_bing_ads_performancereporting ................... [[33mSKIP[0m]
[0m15:09:21.684994 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_bing_ads_performancereporting
[0m15:09:21.715573 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (execute): 15:09:20.326098 => 15:09:21.714610
[0m15:09:21.716605 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 15:09:20.330087 => 15:09:21.715573
[0m15:09:21.716605 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9e5c782-2830-42b5-ab3b-744bc3586827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E216E57E90>]}
[0m15:09:21.717568 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9e5c782-2830-42b5-ab3b-744bc3586827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E216E1B210>]}
[0m15:09:21.718598 [info ] [Thread-3 (]: 3 of 10 OK created sql view model staging.stg_google_ads_campaign_history ...... [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m15:09:21.720561 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_google_ads_campaign_history
[0m15:09:21.719594 [info ] [Thread-4 (]: 4 of 10 OK created sql view model staging.stg_google_ads_campaign_stats ........ [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m15:09:21.721557 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m15:09:21.722553 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m15:09:21.723551 [info ] [Thread-1 (]: 8 of 10 START sql view model intermediate.int_google_ads_unique_campaigns ...... [RUN]
[0m15:09:21.724548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_history, now model.bq_evo.int_google_ads_unique_campaigns)
[0m15:09:21.725580 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m15:09:21.728571 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m15:09:21.730532 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 15:09:21.726546 => 15:09:21.729569
[0m15:09:21.730532 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m15:09:21.734522 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m15:09:21.735551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:21.736516 [debug] [Thread-1 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        id,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        MAX(CampaignID) as CampaignID
    FROM _raw
    GROUP BY 1
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m15:09:22.614155 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:94de5baa-214d-4b03-8729-6ac3a235fb3f&page=queryresults
[0m15:09:23.082457 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 15:09:21.731529 => 15:09:23.080910
[0m15:09:23.085458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9e5c782-2830-42b5-ab3b-744bc3586827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E216D75790>]}
[0m15:09:23.085458 [info ] [Thread-1 (]: 8 of 10 OK created sql view model intermediate.int_google_ads_unique_campaigns . [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m15:09:23.087448 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m15:09:23.088445 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m15:09:23.089444 [info ] [Thread-3 (]: 9 of 10 START sql view model intermediate.int_google_ads_campaign_stats ........ [RUN]
[0m15:09:23.090470 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_ads_campaign_history, now model.bq_evo.int_google_ads_campaign_stats)
[0m15:09:23.091438 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m15:09:23.094431 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m15:09:23.096432 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 15:09:23.091438 => 15:09:23.095466
[0m15:09:23.096432 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m15:09:23.099449 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m15:09:23.101410 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:09:23.101410 [debug] [Thread-3 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
),

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m15:09:23.798712 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:04cd3b1c-2acc-4182-b3cb-05a9276cd11c&page=queryresults
[0m15:09:24.226674 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 15:09:23.097457 => 15:09:24.225677
[0m15:09:24.227671 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9e5c782-2830-42b5-ab3b-744bc3586827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E216D4D090>]}
[0m15:09:24.228669 [info ] [Thread-3 (]: 9 of 10 OK created sql view model intermediate.int_google_ads_campaign_stats ... [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m15:09:24.229677 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m15:09:24.230678 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_google_ads_performancereporting
[0m15:09:24.231659 [info ] [Thread-4 (]: 10 of 10 START sql incremental model mart.mrt_google_ads_performancereporting .. [RUN]
[0m15:09:24.232692 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_ads_campaign_stats, now model.bq_evo.mrt_google_ads_performancereporting)
[0m15:09:24.232692 [debug] [Thread-4 (]: Began compiling node model.bq_evo.mrt_google_ads_performancereporting
[0m15:09:24.242631 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_performancereporting"
[0m15:09:24.244627 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_ads_performancereporting (compile): 15:09:24.233653 => 15:09:24.244627
[0m15:09:24.245627 [debug] [Thread-4 (]: Began executing node model.bq_evo.mrt_google_ads_performancereporting
[0m15:09:24.304765 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:09:24.304765 [debug] [Thread-4 (]: On model.bq_evo.mrt_google_ads_performancereporting: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_performancereporting"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

      

        WHERE
        --Update table for the past seven days + today
        date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m15:09:25.049088 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:b11f6521-2046-409c-a97c-0f934f929b79&page=queryresults
[0m15:09:26.890417 [debug] [Thread-4 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:09:26.913338 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_performancereporting"
[0m15:09:26.915323 [debug] [Thread-4 (]: On model.bq_evo.mrt_google_ads_performancereporting: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_performancereporting"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.date = DBT_INTERNAL_DEST.date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m15:09:27.152667 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a37c5fa7-bfd3-4332-909a-7f0df6cdf22b&page=queryresults
[0m15:09:29.787909 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_ads_performancereporting (execute): 15:09:24.246632 => 15:09:29.787909
[0m15:09:29.788909 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9e5c782-2830-42b5-ab3b-744bc3586827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E216D58B10>]}
[0m15:09:29.789906 [info ] [Thread-4 (]: 10 of 10 OK created sql incremental model mart.mrt_google_ads_performancereporting  [[32mMERGE (179.0 rows, 11.3 MiB processed)[0m in 5.56s]
[0m15:09:29.790906 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_google_ads_performancereporting
[0m15:09:29.793158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:29.794154 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:09:29.794154 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:09:29.795151 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:09:29.795655 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m15:09:29.795655 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m15:09:29.795655 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m15:09:29.796654 [debug] [MainThread]: Connection 'model.bq_evo.int_google_ads_unique_campaigns' was properly closed.
[0m15:09:29.797652 [debug] [MainThread]: Connection 'model.bq_evo.stg_bing_ads_campaign_performance_daily_report' was properly closed.
[0m15:09:29.798651 [debug] [MainThread]: Connection 'model.bq_evo.int_google_ads_campaign_stats' was properly closed.
[0m15:09:29.798651 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_ads_performancereporting' was properly closed.
[0m15:09:29.799647 [info ] [MainThread]: 
[0m15:09:29.800644 [info ] [MainThread]: Finished running 8 view models, 2 incremental models in 0 hours 0 minutes and 13.01 seconds (13.01s).
[0m15:09:29.802640 [debug] [MainThread]: Command end result
[0m15:09:29.813610 [info ] [MainThread]: 
[0m15:09:29.814608 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:09:29.815604 [info ] [MainThread]: 
[0m15:09:29.816603 [error] [MainThread]:   Database Error in model stg_bing_ads_campaign_history (models\staging\bing_ads\stg_bing_ads_campaign_history.sql)
  Syntax error: Expected keyword ELSE or keyword END but got ")" at [21:9]
  compiled Code at target\run\bq_evo\models\staging\bing_ads\stg_bing_ads_campaign_history.sql
[0m15:09:29.817599 [info ] [MainThread]: 
[0m15:09:29.818635 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=3 TOTAL=10
[0m15:09:29.819595 [debug] [MainThread]: Command `dbt run` failed at 15:09:29.819595 after 13.61 seconds
[0m15:09:29.820625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E214E45F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2159657D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E214D16790>]}
[0m15:09:29.821588 [debug] [MainThread]: Flushing usage events
[0m15:10:12.167408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DBE446410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DBE46F790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DBEF68210>]}


============================== 15:10:12.171396 | 259ea51d-c405-4ef9-9430-be17df57da1b ==============================
[0m15:10:12.171396 [info ] [MainThread]: Running with dbt=1.6.2
[0m15:10:12.172394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:10:12.514815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DBFCBD8D0>]}
[0m15:10:12.523783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DBEF75610>]}
[0m15:10:12.524779 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m15:10:12.579753 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m15:10:12.657252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:12.658250 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\bing_ads\stg_bing_ads_campaign_history.sql
[0m15:10:12.714852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DBE4460D0>]}
[0m15:10:12.729534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DC052EC10>]}
[0m15:10:12.730532 [info ] [MainThread]: Found 10 models, 11 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:10:12.732106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DBFCBE410>]}
[0m15:10:12.734137 [info ] [MainThread]: 
[0m15:10:12.735101 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:10:12.737132 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:10:12.738125 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:10:12.739089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:12.739089 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:10:12.740087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:12.742083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:15.478940 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m15:10:15.479939 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m15:10:15.479939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:15.480973 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m15:10:15.481969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:15.483953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:16.184821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DBE71EB90>]}
[0m15:10:16.185857 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:10:16.186819 [info ] [MainThread]: 
[0m15:10:16.192351 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_bing_ads_campaign_history
[0m15:10:16.193371 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:10:16.194348 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_google_ads_campaign_history
[0m15:10:16.194348 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m15:10:16.195344 [info ] [Thread-1 (]: 1 of 10 START sql view model staging.stg_bing_ads_campaign_history ............. [RUN]
[0m15:10:16.197339 [info ] [Thread-2 (]: 2 of 10 START sql view model staging.stg_bing_ads_campaign_performance_daily_report  [RUN]
[0m15:10:16.198336 [info ] [Thread-3 (]: 3 of 10 START sql view model staging.stg_google_ads_campaign_history ........... [RUN]
[0m15:10:16.199331 [info ] [Thread-4 (]: 4 of 10 START sql view model staging.stg_google_ads_campaign_stats ............. [RUN]
[0m15:10:16.200331 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_history'
[0m15:10:16.202325 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_performance_daily_report'
[0m15:10:16.203321 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_history'
[0m15:10:16.204319 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m15:10:16.205346 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_history
[0m15:10:16.206313 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:10:16.206313 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_history
[0m15:10:16.207311 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m15:10:16.215290 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m15:10:16.219604 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m15:10:16.222595 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_history"
[0m15:10:16.225553 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m15:10:16.227550 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (compile): 15:10:16.208308 => 15:10:16.227550
[0m15:10:16.229545 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (compile): 15:10:16.216286 => 15:10:16.228555
[0m15:10:16.230541 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_history
[0m15:10:16.231538 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (compile): 15:10:16.219604 => 15:10:16.230541
[0m15:10:16.232535 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:10:16.232535 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 15:10:16.222595 => 15:10:16.232535
[0m15:10:16.264483 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m15:10:16.264483 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_google_ads_campaign_history
[0m15:10:16.268507 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m15:10:16.268507 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m15:10:16.272497 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_history"
[0m15:10:16.272497 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:10:16.276453 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m15:10:16.276453 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:10:16.277450 [debug] [Thread-1 (]: On model.bq_evo.stg_bing_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_history`
),


_added_columns AS (
    SELECT
        *,
        'cpc' as Medium,
        'bing' as Source,
        (CASE 
            WHEN account_id = 156001989 THEN 'EVO'
        END) as Partner,
    FROM _raw
),

_added_campaignid AS (
    SELECT 
        *,
        LOWER (CONCAT(name, Source, Medium, Partner)) as CampaignID
    FROM _added_columns
),

_final AS(
    SELECT *
    FROM _added_campaignid
)

SELECT * FROM _final;


[0m15:10:16.278448 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:10:16.279956 [debug] [Thread-2 (]: On model.bq_evo.stg_bing_ads_campaign_performance_daily_report: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_performance_daily_report`
),

_renamed_columns AS(
    SELECT 
        _fivetran_id,
        _fivetran_synced,
        account_id,
        ad_distribution,
        ad_relevance,
        all_conversions,
        all_conversions_qualified,
        all_return_on_ad_spend,
        all_revenue,
        assists,
        average_cpc,
        average_position,
        bid_match_type,
        budget_association_status,
        campaign_id,
        campaign_name,
        campaign_status,
        clicks as Clicks,
        conversions,
        conversions_qualified,
        ctr,
        currency_code,
        date as Date,
        delivered_match_type,
        device_os,
        device_type,
        expected_ctr,
        historical_ad_relevance,
        historical_expected_ctr,
        historical_landing_page_experience,
        historical_quality_score,
        impressions as Impressionns,
        landing_page_experience,
        low_quality_clicks,
        low_quality_clicks_percent,
        low_quality_conversion_rate,
        low_quality_conversions,
        low_quality_conversions_qualified,
        low_quality_general_clicks,
        low_quality_impressions,
        low_quality_impressions_percent,
        low_quality_sophisticated_clicks,
        network,
        phone_calls,
        phone_impressions,
        quality_score,
        return_on_ad_spend,
        revenue,
        spend as Cost,
        top_vs_other,
        view_through_conversions
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m15:10:16.280957 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:10:16.283993 [debug] [Thread-3 (]: On model.bq_evo.stg_google_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_history`
),

_renamed_columns AS(
  SELECT
    _fivetran_start,
    id,
    _fivetran_active,
    _fivetran_end,
    _fivetran_synced,
    ad_serving_optimization_status,
    advertising_channel_subtype,
    advertising_channel_type,
    base_campaign_id,
    customer_id,
    end_date,
    experiment_type,
    final_url_suffix,
    frequency_caps,
    name as campaign,
    optimization_score,
    payment_mode,
    serving_status,
    start_date,
    status,
    tracking_url_template,
    updated_at,
    vanity_pharma_display_url_mode,
    vanity_pharma_text,
    video_brand_safety_suitability
  FROM _raw
),

_add_new_columns AS(
  SELECT 
    *,
    'google' as Source,
    'cpc' as Medium,
    (CASE
      WHEN customer_id = 6607387807 THEN 'EVO'  
      ELSE '(null)'
    END) as Partner
  FROM _renamed_columns
),

_final AS(
  SELECT
    *,
    LOWER(CONCAT(campaign, Source, Medium, Partner)) as CampaignID
  FROM _add_new_columns
)

SELECT * FROM _final;


[0m15:10:16.285943 [debug] [Thread-4 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Google Ads Kampagnen"""
    )
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_transformed_cost AS(
    SELECT
        _fivetran_id,
        customer_id,
        date,
        _fivetran_synced,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability,
        ad_network_type,
        base_campaign,
        clicks,
        conversions,
        conversions_value,
        cost_micros/1000000 as cost,
        device,
        id,
        impressions,
        interaction_event_types,
        interactions,
        view_through_conversions,
    FROM _raw
),

_final AS(
    SELECT * FROM _transformed_cost
)

SELECT * FROM _final;


[0m15:10:17.172605 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:1f27e40b-a743-4ab8-ab54-84574a2b9264&page=queryresults
[0m15:10:17.197052 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3379e173-8466-434a-add7-6c950f8ed70b&page=queryresults
[0m15:10:17.208717 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:0743e307-5f4e-4859-b27c-8112c64ab44a&page=queryresults
[0m15:10:17.273901 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:fb28752c-fc49-441e-aa65-0e208309ba94&page=queryresults
[0m15:10:17.468175 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (execute): 15:10:16.265516 => 15:10:17.467130
[0m15:10:17.470166 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DC05EE610>]}
[0m15:10:17.471163 [info ] [Thread-2 (]: 2 of 10 OK created sql view model staging.stg_bing_ads_campaign_performance_daily_report  [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m15:10:17.474153 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:10:17.682465 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (execute): 15:10:16.233532 => 15:10:17.682465
[0m15:10:17.683498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DC050CC90>]}
[0m15:10:17.684463 [info ] [Thread-1 (]: 1 of 10 OK created sql view model staging.stg_bing_ads_campaign_history ........ [[32mCREATE VIEW (0 processed)[0m in 1.48s]
[0m15:10:17.685493 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_history
[0m15:10:17.686458 [debug] [Thread-2 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:10:17.686458 [info ] [Thread-2 (]: 5 of 10 START sql view model intermediate.int_bing_ads_unique_campaigns ........ [RUN]
[0m15:10:17.688453 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_performance_daily_report, now model.bq_evo.int_bing_ads_unique_campaigns)
[0m15:10:17.688453 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:10:17.692443 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m15:10:17.694438 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (compile): 15:10:17.689450 => 15:10:17.693440
[0m15:10:17.694438 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:10:17.698426 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m15:10:17.700456 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (execute): 15:10:16.269507 => 15:10:17.700456
[0m15:10:17.702413 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DC0618C90>]}
[0m15:10:17.705407 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 15:10:16.273461 => 15:10:17.704411
[0m15:10:17.703412 [info ] [Thread-3 (]: 3 of 10 OK created sql view model staging.stg_google_ads_campaign_history ...... [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m15:10:17.705407 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:10:17.706406 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DC05BF650>]}
[0m15:10:17.707425 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_google_ads_campaign_history
[0m15:10:17.708399 [debug] [Thread-2 (]: On model.bq_evo.int_bing_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Bing Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        id,
        MAX(name) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        MAX(CampaignID) as CampaignID
    FROM _raw
    GROUP BY 1
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m15:10:17.709397 [info ] [Thread-4 (]: 4 of 10 OK created sql view model staging.stg_google_ads_campaign_stats ........ [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m15:10:17.710394 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m15:10:17.712388 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m15:10:17.714386 [info ] [Thread-1 (]: 6 of 10 START sql view model intermediate.int_google_ads_unique_campaigns ...... [RUN]
[0m15:10:17.716377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_history, now model.bq_evo.int_google_ads_unique_campaigns)
[0m15:10:17.716377 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m15:10:17.720399 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m15:10:17.722362 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 15:10:17.717407 => 15:10:17.722362
[0m15:10:17.723363 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m15:10:17.726350 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m15:10:17.728344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:17.729343 [debug] [Thread-1 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        id,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        MAX(CampaignID) as CampaignID
    FROM _raw
    GROUP BY 1
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m15:10:18.432086 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6c95f405-ee48-42d7-be95-65f3654004c7&page=queryresults
[0m15:10:18.697413 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:f7dc045d-d89a-4002-9861-d1e1c8312a73&page=queryresults
[0m15:10:18.876353 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (execute): 15:10:17.695435 => 15:10:18.875356
[0m15:10:18.878347 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DC041D2D0>]}
[0m15:10:18.879341 [info ] [Thread-2 (]: 5 of 10 OK created sql view model intermediate.int_bing_ads_unique_campaigns ... [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m15:10:18.880341 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:10:18.881335 [debug] [Thread-3 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:10:18.882335 [info ] [Thread-3 (]: 7 of 10 START sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [RUN]
[0m15:10:18.883333 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_ads_campaign_history, now model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names)
[0m15:10:18.884328 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:10:18.886896 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m15:10:18.888883 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (compile): 15:10:18.884866 => 15:10:18.888883
[0m15:10:18.889858 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:10:18.892849 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m15:10:18.895839 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:10:18.896836 [debug] [Thread-3 (]: On model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne inkl. Klartext der Kampagne."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m15:10:19.380198 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 15:10:17.724356 => 15:10:19.379203
[0m15:10:19.381193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DC06B6610>]}
[0m15:10:19.382156 [info ] [Thread-1 (]: 6 of 10 OK created sql view model intermediate.int_google_ads_unique_campaigns . [[32mCREATE VIEW (0 processed)[0m in 1.67s]
[0m15:10:19.383187 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m15:10:19.384149 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m15:10:19.385650 [info ] [Thread-2 (]: 8 of 10 START sql view model intermediate.int_google_ads_campaign_stats ........ [RUN]
[0m15:10:19.387135 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_unique_campaigns, now model.bq_evo.int_google_ads_campaign_stats)
[0m15:10:19.387135 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m15:10:19.391125 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m15:10:19.392122 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 15:10:19.387135 => 15:10:19.392122
[0m15:10:19.393121 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m15:10:19.401100 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m15:10:19.402096 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:10:19.403093 [debug] [Thread-2 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
),

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m15:10:19.577427 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e1faa906-6c0e-401d-9e51-63e17f5301e9&page=queryresults
[0m15:10:20.101959 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:dac40915-fbc6-40e7-98f0-afa2ae4cb9e7&page=queryresults
[0m15:10:20.248175 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (execute): 15:10:18.889858 => 15:10:20.248175
[0m15:10:20.249169 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DC0440950>]}
[0m15:10:20.250133 [info ] [Thread-3 (]: 7 of 10 OK created sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m15:10:20.251129 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:10:20.252129 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_bing_ads_performancereporting
[0m15:10:20.253159 [info ] [Thread-1 (]: 9 of 10 START sql incremental model mart.mrt_bing_ads_performancereporting ..... [RUN]
[0m15:10:20.254133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_unique_campaigns, now model.bq_evo.mrt_bing_ads_performancereporting)
[0m15:10:20.255230 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_bing_ads_performancereporting
[0m15:10:20.261216 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_bing_ads_performancereporting"
[0m15:10:20.263211 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_bing_ads_performancereporting (compile): 15:10:20.255230 => 15:10:20.263211
[0m15:10:20.264226 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_bing_ads_performancereporting
[0m15:10:20.324560 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_bing_ads_performancereporting"
[0m15:10:20.325558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:20.326757 [debug] [Thread-1 (]: On model.bq_evo.mrt_bing_ads_performancereporting: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_performancereporting"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_performancereporting`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`

      
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m15:10:20.827457 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 15:10:19.393121 => 15:10:20.827457
[0m15:10:20.828488 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DC05ECBD0>]}
[0m15:10:20.829486 [info ] [Thread-2 (]: 8 of 10 OK created sql view model intermediate.int_google_ads_campaign_stats ... [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m15:10:20.830482 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m15:10:20.831448 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_google_ads_performancereporting
[0m15:10:20.832447 [info ] [Thread-3 (]: 10 of 10 START sql incremental model mart.mrt_google_ads_performancereporting .. [RUN]
[0m15:10:20.834439 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names, now model.bq_evo.mrt_google_ads_performancereporting)
[0m15:10:20.835475 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_google_ads_performancereporting
[0m15:10:20.839428 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_performancereporting"
[0m15:10:20.840425 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_ads_performancereporting (compile): 15:10:20.835475 => 15:10:20.840425
[0m15:10:20.841423 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_google_ads_performancereporting
[0m15:10:20.846409 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:10:20.847406 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_ads_performancereporting: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_performancereporting"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

      

        WHERE
        --Update table for the past seven days + today
        date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m15:10:21.072037 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:1ad7bbb9-3b8c-4d9c-bf43-306ef5296aaf&page=queryresults
[0m15:10:21.203867 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: Impressions; Did you mean Impressionns? at [36:5]')
[0m15:10:21.527726 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:997220c7-ffeb-4146-84cd-726dd1046763&page=queryresults
[0m15:10:22.382010 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:d891ffb0-4184-4329-b702-e2a40c997be4&page=queryresults
[0m15:10:22.477407 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:d891ffb0-4184-4329-b702-e2a40c997be4&page=queryresults
[0m15:10:22.478372 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_bing_ads_performancereporting (execute): 15:10:20.265205 => 15:10:22.478372
[0m15:10:22.484356 [debug] [Thread-1 (]: Database Error in model mrt_bing_ads_performancereporting (models\mart\bing_ads\mrt_bing_ads_performancereporting.sql)
  Unrecognized name: Impressions; Did you mean Impressionns? at [36:5]
  compiled Code at target\run\bq_evo\models\mart\bing_ads\mrt_bing_ads_performancereporting.sql
[0m15:10:22.485353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DC0557090>]}
[0m15:10:22.486371 [error] [Thread-1 (]: 9 of 10 ERROR creating sql incremental model mart.mrt_bing_ads_performancereporting  [[31mERROR[0m in 2.23s]
[0m15:10:22.487354 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_bing_ads_performancereporting
[0m15:10:23.353760 [debug] [Thread-3 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:10:23.377682 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_performancereporting"
[0m15:10:23.379728 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_ads_performancereporting: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_performancereporting"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.date = DBT_INTERNAL_DEST.date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m15:10:23.596202 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6da41a3b-35df-4c6a-a3c7-04d0062ca0ff&page=queryresults
[0m15:10:25.875276 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_ads_performancereporting (execute): 15:10:20.842418 => 15:10:25.875276
[0m15:10:25.876272 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259ea51d-c405-4ef9-9430-be17df57da1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DC07F9B10>]}
[0m15:10:25.877235 [info ] [Thread-3 (]: 10 of 10 OK created sql incremental model mart.mrt_google_ads_performancereporting  [[32mMERGE (179.0 rows, 11.3 MiB processed)[0m in 5.04s]
[0m15:10:25.878233 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_google_ads_performancereporting
[0m15:10:25.881224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:25.881224 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:10:25.882223 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:10:25.882223 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:10:25.883220 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m15:10:25.883220 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m15:10:25.884218 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m15:10:25.885235 [debug] [MainThread]: Connection 'model.bq_evo.mrt_bing_ads_performancereporting' was properly closed.
[0m15:10:25.885235 [debug] [MainThread]: Connection 'model.bq_evo.int_google_ads_campaign_stats' was properly closed.
[0m15:10:25.886247 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_ads_performancereporting' was properly closed.
[0m15:10:25.886247 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_ads_campaign_stats' was properly closed.
[0m15:10:25.887211 [info ] [MainThread]: 
[0m15:10:25.888208 [info ] [MainThread]: Finished running 8 view models, 2 incremental models in 0 hours 0 minutes and 13.15 seconds (13.15s).
[0m15:10:25.891201 [debug] [MainThread]: Command end result
[0m15:10:25.906739 [info ] [MainThread]: 
[0m15:10:25.907736 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:10:25.908736 [info ] [MainThread]: 
[0m15:10:25.909733 [error] [MainThread]:   Database Error in model mrt_bing_ads_performancereporting (models\mart\bing_ads\mrt_bing_ads_performancereporting.sql)
  Unrecognized name: Impressions; Did you mean Impressionns? at [36:5]
  compiled Code at target\run\bq_evo\models\mart\bing_ads\mrt_bing_ads_performancereporting.sql
[0m15:10:25.911726 [info ] [MainThread]: 
[0m15:10:25.912723 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m15:10:25.913724 [debug] [MainThread]: Command `dbt run` failed at 15:10:25.913724 after 13.76 seconds
[0m15:10:25.914719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DBE113E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DBE45BBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DBE458D10>]}
[0m15:10:25.914719 [debug] [MainThread]: Flushing usage events
[0m15:12:29.540661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1D8FA3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1DDF9B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1DDEB410>]}


============================== 15:12:29.544612 | 524c5fa8-5860-4448-a427-28d1e7a5f72b ==============================
[0m15:12:29.544612 [info ] [MainThread]: Running with dbt=1.6.2
[0m15:12:29.545610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:12:29.894172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1EFA13D0>]}
[0m15:12:29.903146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1E41D690>]}
[0m15:12:29.904143 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m15:12:29.954049 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m15:12:30.030394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:12:30.031357 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\bing_ads\stg_bing_ads_campaign_performance_daily_report.sql
[0m15:12:30.067809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1F6D7250>]}
[0m15:12:30.083766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1F3F6010>]}
[0m15:12:30.084763 [info ] [MainThread]: Found 10 models, 11 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:12:30.085762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1F642750>]}
[0m15:12:30.088753 [info ] [MainThread]: 
[0m15:12:30.090134 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:12:30.092161 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:12:30.092161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:30.093162 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:12:30.094121 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:12:30.095118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:30.095118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:32.816836 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m15:12:32.817833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:32.818831 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m15:12:32.820789 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m15:12:32.823817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:32.824777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:33.485997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1EFBC950>]}
[0m15:12:33.488045 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:12:33.488991 [info ] [MainThread]: 
[0m15:12:33.496006 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_bing_ads_campaign_history
[0m15:12:33.496006 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:12:33.496969 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_google_ads_campaign_history
[0m15:12:33.497965 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m15:12:33.498963 [info ] [Thread-1 (]: 1 of 10 START sql view model staging.stg_bing_ads_campaign_history ............. [RUN]
[0m15:12:33.500959 [info ] [Thread-2 (]: 2 of 10 START sql view model staging.stg_bing_ads_campaign_performance_daily_report  [RUN]
[0m15:12:33.501962 [info ] [Thread-3 (]: 3 of 10 START sql view model staging.stg_google_ads_campaign_history ........... [RUN]
[0m15:12:33.503952 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_history'
[0m15:12:33.502954 [info ] [Thread-4 (]: 4 of 10 START sql view model staging.stg_google_ads_campaign_stats ............. [RUN]
[0m15:12:33.505943 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_performance_daily_report'
[0m15:12:33.506977 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_history'
[0m15:12:33.507940 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_history
[0m15:12:33.509936 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m15:12:33.509936 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:12:33.510967 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_history
[0m15:12:33.518909 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m15:12:33.519906 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m15:12:33.522932 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m15:12:33.525893 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_history"
[0m15:12:33.530876 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m15:12:33.531876 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (compile): 15:12:33.511929 => 15:12:33.530876
[0m15:12:33.533876 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (compile): 15:12:33.519906 => 15:12:33.532873
[0m15:12:33.534867 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (compile): 15:12:33.523896 => 15:12:33.533876
[0m15:12:33.534867 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_history
[0m15:12:33.535864 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 15:12:33.526924 => 15:12:33.535864
[0m15:12:33.535864 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:12:33.536861 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_google_ads_campaign_history
[0m15:12:33.568848 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m15:12:33.569824 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m15:12:33.573411 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m15:12:33.576371 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_history"
[0m15:12:33.579593 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m15:12:33.580634 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:12:33.581800 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:12:33.582854 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:12:33.583851 [debug] [Thread-1 (]: On model.bq_evo.stg_bing_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_history`
),


_added_columns AS (
    SELECT
        *,
        'cpc' as Medium,
        'bing' as Source,
        (CASE 
            WHEN account_id = 156001989 THEN 'EVO'
        END) as Partner,
    FROM _raw
),

_added_campaignid AS (
    SELECT 
        *,
        LOWER (CONCAT(name, Source, Medium, Partner)) as CampaignID
    FROM _added_columns
),

_final AS(
    SELECT *
    FROM _added_campaignid
)

SELECT * FROM _final;


[0m15:12:33.585134 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:12:33.585134 [debug] [Thread-2 (]: On model.bq_evo.stg_bing_ads_campaign_performance_daily_report: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_performance_daily_report`
),

_renamed_columns AS(
    SELECT 
        _fivetran_id,
        _fivetran_synced,
        account_id,
        ad_distribution,
        ad_relevance,
        all_conversions,
        all_conversions_qualified,
        all_return_on_ad_spend,
        all_revenue,
        assists,
        average_cpc,
        average_position,
        bid_match_type,
        budget_association_status,
        campaign_id,
        campaign_name,
        campaign_status,
        clicks as Clicks,
        conversions,
        conversions_qualified,
        ctr,
        currency_code,
        date as Date,
        delivered_match_type,
        device_os,
        device_type,
        expected_ctr,
        historical_ad_relevance,
        historical_expected_ctr,
        historical_landing_page_experience,
        historical_quality_score,
        impressions as Impressions,
        landing_page_experience,
        low_quality_clicks,
        low_quality_clicks_percent,
        low_quality_conversion_rate,
        low_quality_conversions,
        low_quality_conversions_qualified,
        low_quality_general_clicks,
        low_quality_impressions,
        low_quality_impressions_percent,
        low_quality_sophisticated_clicks,
        network,
        phone_calls,
        phone_impressions,
        quality_score,
        return_on_ad_spend,
        revenue,
        spend as Cost,
        top_vs_other,
        view_through_conversions
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m15:12:33.586143 [debug] [Thread-3 (]: On model.bq_evo.stg_google_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_history`
),

_renamed_columns AS(
  SELECT
    _fivetran_start,
    id,
    _fivetran_active,
    _fivetran_end,
    _fivetran_synced,
    ad_serving_optimization_status,
    advertising_channel_subtype,
    advertising_channel_type,
    base_campaign_id,
    customer_id,
    end_date,
    experiment_type,
    final_url_suffix,
    frequency_caps,
    name as campaign,
    optimization_score,
    payment_mode,
    serving_status,
    start_date,
    status,
    tracking_url_template,
    updated_at,
    vanity_pharma_display_url_mode,
    vanity_pharma_text,
    video_brand_safety_suitability
  FROM _raw
),

_add_new_columns AS(
  SELECT 
    *,
    'google' as Source,
    'cpc' as Medium,
    (CASE
      WHEN customer_id = 6607387807 THEN 'EVO'  
      ELSE '(null)'
    END) as Partner
  FROM _renamed_columns
),

_final AS(
  SELECT
    *,
    LOWER(CONCAT(campaign, Source, Medium, Partner)) as CampaignID
  FROM _add_new_columns
)

SELECT * FROM _final;


[0m15:12:33.588378 [debug] [Thread-4 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Google Ads Kampagnen"""
    )
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_transformed_cost AS(
    SELECT
        _fivetran_id,
        customer_id,
        date,
        _fivetran_synced,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability,
        ad_network_type,
        base_campaign,
        clicks,
        conversions,
        conversions_value,
        cost_micros/1000000 as cost,
        device,
        id,
        impressions,
        interaction_event_types,
        interactions,
        view_through_conversions,
    FROM _raw
),

_final AS(
    SELECT * FROM _transformed_cost
)

SELECT * FROM _final;


[0m15:12:34.464883 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:97e846f0-b68e-4591-b750-a154a202482d&page=queryresults
[0m15:12:34.465881 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4b42e663-f2ff-406b-8189-5b68470e56a5&page=queryresults
[0m15:12:34.467911 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:b0655307-5bea-4b5b-bf4d-f702fca9484f&page=queryresults
[0m15:12:34.473860 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8df91b60-5a69-4511-afa0-77f151cd34b0&page=queryresults
[0m15:12:34.875015 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (execute): 15:12:33.569824 => 15:12:34.874476
[0m15:12:34.876015 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1DD17110>]}
[0m15:12:34.877012 [info ] [Thread-2 (]: 2 of 10 OK created sql view model staging.stg_bing_ads_campaign_performance_daily_report  [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m15:12:34.881037 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:12:34.966829 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (execute): 15:12:33.573411 => 15:12:34.966829
[0m15:12:34.968824 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1F66B150>]}
[0m15:12:34.968824 [info ] [Thread-3 (]: 3 of 10 OK created sql view model staging.stg_google_ads_campaign_history ...... [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m15:12:34.970819 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_google_ads_campaign_history
[0m15:12:34.971815 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m15:12:34.971815 [info ] [Thread-2 (]: 5 of 10 START sql view model intermediate.int_google_ads_unique_campaigns ...... [RUN]
[0m15:12:34.973844 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_performance_daily_report, now model.bq_evo.int_google_ads_unique_campaigns)
[0m15:12:34.974358 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m15:12:34.978350 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m15:12:34.980346 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 15:12:34.975358 => 15:12:34.980346
[0m15:12:34.981342 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m15:12:34.986330 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m15:12:34.987328 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:12:34.988325 [debug] [Thread-2 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        id,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        MAX(CampaignID) as CampaignID
    FROM _raw
    GROUP BY 1
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m15:12:35.185238 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 15:12:33.577112 => 15:12:35.185238
[0m15:12:35.186234 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1F80DB90>]}
[0m15:12:35.187230 [info ] [Thread-4 (]: 4 of 10 OK created sql view model staging.stg_google_ads_campaign_stats ........ [[32mCREATE VIEW (0 processed)[0m in 1.68s]
[0m15:12:35.188230 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m15:12:35.194213 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (execute): 15:12:33.537858 => 15:12:35.193218
[0m15:12:35.194213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1F6D5310>]}
[0m15:12:35.195177 [info ] [Thread-1 (]: 1 of 10 OK created sql view model staging.stg_bing_ads_campaign_history ........ [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m15:12:35.196209 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_history
[0m15:12:35.197172 [debug] [Thread-3 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:12:35.198171 [info ] [Thread-3 (]: 6 of 10 START sql view model intermediate.int_bing_ads_unique_campaigns ........ [RUN]
[0m15:12:35.200168 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_ads_campaign_history, now model.bq_evo.int_bing_ads_unique_campaigns)
[0m15:12:35.200168 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:12:35.204156 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m15:12:35.205153 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (compile): 15:12:35.201164 => 15:12:35.205153
[0m15:12:35.206151 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:12:35.213162 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m15:12:35.214159 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:12:35.215126 [debug] [Thread-3 (]: On model.bq_evo.int_bing_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Bing Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        id,
        MAX(name) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        MAX(CampaignID) as CampaignID
    FROM _raw
    GROUP BY 1
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m15:12:35.727379 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:47f6eb70-2c67-487d-96c9-6673e4031ec7&page=queryresults
[0m15:12:35.886980 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:49bb4c03-20ad-4cd1-9874-5b45d6df4988&page=queryresults
[0m15:12:36.322302 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (execute): 15:12:35.206151 => 15:12:36.321305
[0m15:12:36.323300 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1F666C10>]}
[0m15:12:36.325291 [info ] [Thread-3 (]: 6 of 10 OK created sql view model intermediate.int_bing_ads_unique_campaigns ... [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m15:12:36.326288 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:12:36.327287 [debug] [Thread-1 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:12:36.328282 [info ] [Thread-1 (]: 7 of 10 START sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [RUN]
[0m15:12:36.329278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_history, now model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names)
[0m15:12:36.330276 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:12:36.333268 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m15:12:36.335263 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (compile): 15:12:36.330276 => 15:12:36.334265
[0m15:12:36.336261 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:12:36.342244 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m15:12:36.345237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:36.346235 [debug] [Thread-1 (]: On model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne inkl. Klartext der Kampagne."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m15:12:36.428063 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 15:12:34.982339 => 15:12:36.428063
[0m15:12:36.429060 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1F88D310>]}
[0m15:12:36.430057 [info ] [Thread-2 (]: 5 of 10 OK created sql view model intermediate.int_google_ads_unique_campaigns . [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m15:12:36.431055 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m15:12:36.432052 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m15:12:36.433050 [info ] [Thread-3 (]: 8 of 10 START sql view model intermediate.int_google_ads_campaign_stats ........ [RUN]
[0m15:12:36.434047 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_unique_campaigns, now model.bq_evo.int_google_ads_campaign_stats)
[0m15:12:36.435044 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m15:12:36.438072 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m15:12:36.439034 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 15:12:36.435044 => 15:12:36.439034
[0m15:12:36.440029 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m15:12:36.443057 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m15:12:36.445017 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:12:36.446017 [debug] [Thread-3 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
),

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m15:12:37.167015 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:f6c0a58c-3fa2-4d3e-abe2-cf1e95d744bf&page=queryresults
[0m15:12:37.191586 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:b2276f52-1808-44f4-bff9-d4366fce11c4&page=queryresults
[0m15:12:37.682838 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (execute): 15:12:36.337258 => 15:12:37.681458
[0m15:12:37.685052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1F8B0B50>]}
[0m15:12:37.687048 [info ] [Thread-1 (]: 7 of 10 OK created sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m15:12:37.690038 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:12:37.692033 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_bing_ads_performancereporting
[0m15:12:37.693030 [info ] [Thread-2 (]: 9 of 10 START sql incremental model mart.mrt_bing_ads_performancereporting ..... [RUN]
[0m15:12:37.697465 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_unique_campaigns, now model.bq_evo.mrt_bing_ads_performancereporting)
[0m15:12:37.699465 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_bing_ads_performancereporting
[0m15:12:37.730391 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_bing_ads_performancereporting"
[0m15:12:37.734384 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_bing_ads_performancereporting (compile): 15:12:37.703455 => 15:12:37.733385
[0m15:12:37.739713 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_bing_ads_performancereporting
[0m15:12:37.962695 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_bing_ads_performancereporting"
[0m15:12:37.964717 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 15:12:36.440029 => 15:12:37.964717
[0m15:12:37.966993 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1F8CB650>]}
[0m15:12:37.971381 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:12:37.969386 [info ] [Thread-3 (]: 8 of 10 OK created sql view model intermediate.int_google_ads_campaign_stats ... [[32mCREATE VIEW (0 processed)[0m in 1.53s]
[0m15:12:37.973376 [debug] [Thread-2 (]: On model.bq_evo.mrt_bing_ads_performancereporting: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_performancereporting"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_performancereporting`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`

      
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m15:12:37.975370 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m15:12:37.980357 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_google_ads_performancereporting
[0m15:12:37.981373 [info ] [Thread-1 (]: 10 of 10 START sql incremental model mart.mrt_google_ads_performancereporting .. [RUN]
[0m15:12:37.984117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names, now model.bq_evo.mrt_google_ads_performancereporting)
[0m15:12:37.986111 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_google_ads_performancereporting
[0m15:12:37.995290 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_performancereporting"
[0m15:12:37.998474 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_ads_performancereporting (compile): 15:12:37.987109 => 15:12:37.997477
[0m15:12:38.000469 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_google_ads_performancereporting
[0m15:12:38.017513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:38.960331 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_performancereporting"
[0m15:12:38.962328 [debug] [Thread-1 (]: On model.bq_evo.mrt_google_ads_performancereporting: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_performancereporting"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_performancereporting`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

      
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m15:12:39.145406 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e6b07cdf-614b-4fe3-8f1a-ef66d37bc71c&page=queryresults
[0m15:12:39.243776 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3eeee413-4c01-4307-add9-4af9b510a422&page=queryresults
[0m15:12:41.283829 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_bing_ads_performancereporting (execute): 15:12:37.741665 => 15:12:41.283829
[0m15:12:41.284826 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1F943550>]}
[0m15:12:41.285836 [info ] [Thread-2 (]: 9 of 10 OK created sql incremental model mart.mrt_bing_ads_performancereporting  [[32mCREATE TABLE (3.2k rows, 957.9 KiB processed)[0m in 3.59s]
[0m15:12:41.286822 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_bing_ads_performancereporting
[0m15:12:41.912301 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_ads_performancereporting (execute): 15:12:38.002554 => 15:12:41.912301
[0m15:12:41.913298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524c5fa8-5860-4448-a427-28d1e7a5f72b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1F641D90>]}
[0m15:12:41.914263 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model mart.mrt_google_ads_performancereporting  [[32mCREATE TABLE (87.8k rows, 10.2 MiB processed)[0m in 3.93s]
[0m15:12:41.915261 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_google_ads_performancereporting
[0m15:12:41.918260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:41.919250 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:12:41.920248 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:12:41.920248 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:12:41.921247 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m15:12:41.921247 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m15:12:41.922243 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m15:12:41.923240 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_ads_performancereporting' was properly closed.
[0m15:12:41.923240 [debug] [MainThread]: Connection 'model.bq_evo.mrt_bing_ads_performancereporting' was properly closed.
[0m15:12:41.924252 [debug] [MainThread]: Connection 'model.bq_evo.int_google_ads_campaign_stats' was properly closed.
[0m15:12:41.924252 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_ads_campaign_stats' was properly closed.
[0m15:12:41.925235 [info ] [MainThread]: 
[0m15:12:41.926232 [info ] [MainThread]: Finished running 8 view models, 2 incremental models in 0 hours 0 minutes and 11.84 seconds (11.84s).
[0m15:12:41.930223 [debug] [MainThread]: Command end result
[0m15:12:41.941192 [info ] [MainThread]: 
[0m15:12:41.943188 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:12:41.945182 [info ] [MainThread]: 
[0m15:12:41.946179 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m15:12:41.948174 [debug] [MainThread]: Command `dbt run` succeeded at 15:12:41.947177 after 12.42 seconds
[0m15:12:41.948174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE18127210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1816FC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1833DD90>]}
[0m15:12:41.949171 [debug] [MainThread]: Flushing usage events
[0m10:22:17.580475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B087DFDF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0882A8F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B08617BC10>]}


============================== 10:22:17.598261 | 762f060c-7688-4d81-a6c7-8f6fa2090672 ==============================
[0m10:22:17.598261 [info ] [MainThread]: Running with dbt=1.6.2
[0m10:22:17.599295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh -m stg_google_analytics_352128287', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:22:19.612693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '762f060c-7688-4d81-a6c7-8f6fa2090672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B088241110>]}
[0m10:22:19.622634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '762f060c-7688-4d81-a6c7-8f6fa2090672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B087D6ECD0>]}
[0m10:22:19.627655 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m10:22:19.686024 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m10:22:20.370319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m10:22:20.371313 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\google_analytics\stg_google_analytics_352128287.sql
[0m10:22:20.372277 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\schema.yml
[0m10:22:20.373274 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\sources.yml
[0m10:22:20.429281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '762f060c-7688-4d81-a6c7-8f6fa2090672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B089C277D0>]}
[0m10:22:20.452216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '762f060c-7688-4d81-a6c7-8f6fa2090672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0898F6F90>]}
[0m10:22:20.453178 [info ] [MainThread]: Found 11 models, 11 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m10:22:20.453178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '762f060c-7688-4d81-a6c7-8f6fa2090672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0899AFB90>]}
[0m10:22:20.455172 [info ] [MainThread]: 
[0m10:22:20.456492 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:22:20.458487 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m10:22:20.458487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:23.774182 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m10:22:23.775183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:23.776193 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m10:22:23.779205 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m10:22:23.780171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:23.780171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:24.525873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '762f060c-7688-4d81-a6c7-8f6fa2090672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B089930BD0>]}
[0m10:22:24.526871 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:22:24.527870 [info ] [MainThread]: 
[0m10:22:24.543885 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_analytics_352128287
[0m10:22:24.543885 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_google_analytics_352128287 ............. [RUN]
[0m10:22:24.545883 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_analytics_352128287'
[0m10:22:24.545883 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_analytics_352128287
[0m10:22:24.554859 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_352128287"
[0m10:22:24.558682 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (compile): 10:22:24.546918 => 10:22:24.557685
[0m10:22:24.559682 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_analytics_352128287
[0m10:22:24.590145 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_352128287"
[0m10:22:24.592106 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:22:24.595098 [debug] [Thread-1 (]: On model.bq_evo.stg_google_analytics_352128287: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_352128287"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
  OPTIONS(
      description="""Enth\u00e4lt alle GA4-Events in Tabellenform ohne Schachtelung. Bereinigt fehlerhafte Events ohne Session-ID."""
    )
  as WITH _source AS(
  SELECT
    PARSE_DATE('%Y%m%d', event_date) as event_date,
    TIMESTAMP_MICROS(event_timestamp) as event_ts,
    
    MAX(CASE WHEN params.key = 'ga_session_id' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_id,
    user_pseudo_id,
    TIMESTAMP_MICROS(user_first_touch_timestamp) as user_first_touch_ts,

    event_name,

    params.key as params_key,
    params.value.string_value as params_string_value,
    params.value.int_value as params_int_value,
    params.value.float_value as params_float_value,
    params.value.double_value as params_double_value,

    (CASE WHEN traffic_source.name IS NULL THEN '(not set)' ELSE traffic_source.name END) as utm_campaign,
    (CASE WHEN traffic_source.medium IS NULL THEN '(not set)' ELSE traffic_source.medium END) as utm_medium,
    (CASE WHEN traffic_source.source IS NULL THEN '(not set)' ELSE traffic_source.source END) as utm_source,
    'EVO' as Partner,

    MAX(CASE WHEN params.key = 'page_title' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_title,
    MAX(CASE WHEN params.key = 'page_location' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_location,
    MAX(CASE WHEN params.key = 'page_referrer' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_referrer,
    MAX(CASE WHEN params.key = 'page_path' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_path,
    MAX(CASE WHEN params.key = 'percent_scrolled' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as percent_scrolled,
    MAX(CASE WHEN params.key = 'session_engaged' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_engaged,

    privacy_info.analytics_storage as analytics_storage,
    privacy_info.ads_storage as ads_storage,
    privacy_info.uses_transient_token as uses_transient_token,

    user_ltv.revenue as ltv_revenue,
    user_ltv.currency as ltv_currency,

    device.category as device_category,
    device.mobile_brand_name as device_brand,
    device.mobile_model_name as device_model_name,
    device.mobile_marketing_name as device_marketing_name,
    device.mobile_os_hardware_model as device_mobile_os_hardware_model,
    device.operating_system as device_os,
    device.operating_system_version as device_os_version,
    device.vendor_id as device_vendor_id,
    device.advertising_id as device_advertising_id,
    device.language as device_language,
    device.is_limited_ad_tracking as device_is_limited_ad_tracking,
    device.time_zone_offset_seconds as device_time_zone_offset_seconds,
    device.browser as device_browser,
    device.browser_version as device_browser_version,
    device.web_info.browser as device_web_info_browser,
    device.web_info.browser_version as device_web_info_browser_version,
    device.web_info.hostname as browser_web_info_hostname

    geo.continent as continent,
    geo.country as country,
    geo.region as region,
    geo.city as city,
    geo.sub_continent as sub_continent,
    geo.metro as metropolitan_area,

    app_info.id as app_id,
    app_info.version as app_version,
    app_info.install_store as app_install_store,
    app_info.firebase_app_id as app_firebase_app_id,
    app_info.install_source as app_install_source,

    event_dimensions.hostname as event_hostname,

    ecommerce.total_item_quantity as total_item_quantity,
    ecommerce.purchase_revenue_in_usd as purchase_revenue_in_usd,
    ecommerce.purchase_revenue as purchase_revenue,
    ecommerce.refund_value_in_usd as refund_value_in_usd,
    ecommerce.refund_value as refund_value,
    ecommerce.shipping_value_in_usd as shipping_value_in_usd,
    ecommerce.shipping_value as shipping_value,
    ecommerce.tax_value_in_usd as tax_value_in_usd,
    ecommerce.tax_value as tax_value,
    ecommerce.unique_items as unique_items,
    ecommerce.transaction_id as transaction_id,
    
    items.item_id as item_id,
    items.item_name as item_name,
    items.item_brand as item_brand,
    items.item_variant as item_variant,
    items.item_category as item_category,
    items.item_category2 as item_category2,
    items.item_category3 as item_category3,
    items.item_category4 as item_category4,
    items.item_category5 as item_category5,
    items.price_in_usd as price_in_usd,
    items.price as price,
    items.quantity as quantity,
    items.item_revenue_in_usd as item_revenue_in_usd,
    items.item_revenue as item_revenue,
    items.item_refund_in_usd as item_refund_in_usd,
    items.item_refund as item_refund,
    items.coupon as coupon,
    items.affiliation as affiliation,
    items.location_id as location_id,
    items.item_list_id as item_list_id,
    items.item_list_name as item_list_name,
    items.item_list_index as item_list_index,
    items.promotion_id as promotion_id,
    items.promotion_name as promotion_name,
    items.creative_name as creative_name,
    items.creative_slot as creative_slot,

    collected_traffic_source.manual_campaign_id as manual_campaign_id,
    collected_traffic_source.manual_campaign_name as manual_campaign_name,
    collected_traffic_source.manual_source as manual_source,
    collected_traffic_source.manual_medium as manual_medium,
    collected_traffic_source.manual_term as manual_term,
    collected_traffic_source.manual_content as manual_content,
    collected_traffic_source.gclid as gclid,
    collected_traffic_source.dclid as dclid,
    collected_traffic_source.srsltid as srsltid

  FROM `oss-big-query-dashboard-prod`.`analytics_352128287`.`events_*` as events
  LEFT JOIN UNNEST (event_params) as params
  /*LEFT JOIN UNNEST (privacy_info) as privacy_info
  LEFT JOIN UNNEST (user_ltv) as user_ltv*/
  LEFT JOIN UNNEST(items) as items 
),

events_aggregated as (
  SELECT
    event_date,
    event_ts,
    session_id,
    user_pseudo_id,
    user_first_touch_ts,
    event_name,

--Kampagneninformationen
    MAX(utm_campaign) as utm_campaign,
    MAX(utm_medium) as utm_medium,
    (CASE WHEN MAX(utm_source) = 'ig' THEN 'instagram' ELSE MAX(utm_source) END) as utm_source,
  --  (CASE WHEN MAX(utm_campaign) IS NULL THEN '(not set)' ELSE MAX(utm_campaign) END) as utm_campaign,
  --  (CASE WHEN MAX(utm_medium) IS NULL THEN '(not set)' ELSE MAX(utm_medium) END) as utm_medium,
  --  (CASE WHEN MAX(utm_source) IS NULL THEN '(not set)' ELSE MAX(utm_source) END) as utm_source,

--Seiteninformationen
    MAX(page_title) as page_title,
    MAX(page_location) as page_location,
    MAX(page_referrer) as page_referrer,
    MAX(page_path) as page_path,
    MAX(percent_scrolled) as percent_scrolled,
    MAX(session_engaged) as session_engaged,

--Privacy-Infos
    MAX(analytics_storage) as analytics_storage,
    MAX(ads_storage) as ads_storage,
    MAX(uses_transient_token) as uses_transient_token,

--Kundenwertinformationen
    MAX(ltv_revenue) as ltv_revenue,
    MAX(ltv_currency) as ltv_currency,

--Geräteinformationen
    MAX(device_category) as device_category,
    MAX(device_brand) as device_brand,
    MAX(device_model_name) as device_model_name,
    MAX(device_marketing_name) as device_marketing_name,
    MAX(device_mobile_os_hardware_model) as device_mobile_os_hardware_model,
    MAX(device_os) as device_os,
    MAX(device_os_version) as device_os_version,
    MAX(device_vendor_id) as device_vendor_id,
    MAX(device_advertising_id) as device_advertising_id,
    MAX(device_language) as device_language,
    MAX(device_is_limited_ad_tracking) as device_is_limited_ad_tracking,
    MAX(device_time_zone_offset_seconds) as device_time_zone_offset_seconds,
    MAX(device_browser) as device_browser,
    MAX(device_browser_version) as device_browser_version,
    MAX(device_web_info_browser) as device_web_info_browser,
    MAX(device_web_info_browser_version) as device_web_info_browser_version,
    MAX(browser_web_info_hostnam) as browser_web_info_hostnam,

--Gebietsinformationen
    MAX(continent) as continent,
    MAX(country) as country,
    MAX(region) as region,
    MAX(city) as city,
    MAX(sub_continent) as sub_continent,
    MAX(metropolitan_area) as metropolitan_area,

--App-Informationen
    MAX(app_id) as app_id,
    MAX(app_version) as app_version,
    MAX(app_install_store) as app_install_store,
    MAX(app_firebase_app_id) as app_firebase_app_id,
    MAX(app_install_source) as app_install_source,

    MAX(event_hostname) as event_hostname,

--E-Commerceinformationen
    MAX(total_item_quantity) as total_item_quantity,
    MAX(purchase_revenue_in_usd) as purchase_revenue_in_usd,
    MAX(purchase_revenue) as purchase_revenue,
    MAX(refund_value_in_usd) as refund_value_in_usd,
    MAX(refund_value) as refund_value,
    MAX(shipping_value_in_usd) as shipping_value_in_usd,
    MAX(shipping_value) as shipping_value,
    MAX(tax_value_in_usd) as tax_value_in_usd,
    MAX(tax_value) as tax_value,
    MAX(unique_items) as unique_items,
    MAX(transaction_id) as transaction_id,

--Warenkorbinformationen
    MAX(item_id) as item_id,
    MAX(item_name) as item_name,
    MAX(item_brand) as item_brand,
    MAX(item_variant) as item_variant,
    MAX(item_category) as item_category,
    MAX(item_category2) as item_category2,
    MAX(item_category3) as item_category3,
    MAX(item_category4) as item_category4,
    MAX(item_category5) as item_category5,
    MAX(price_in_usd) as price_in_usd,
    MAX(price) as price,
    MAX(quantity) as quantity,
    MAX(item_revenue_in_usd) as item_revenue_in_usd,
    MAX(item_revenue) as item_revenue,
    MAX(item_refund_in_usd) as item_refund_in_usd,
    MAX(item_refund) as item_refund,
    MAX(coupon) as coupon,
    MAX(affiliation) as affiliation,
    MAX(location_id) as location_id,
    MAX(item_list_id) as item_list_id,
    MAX(item_list_name) as item_list_name,
    MAX(item_list_index) as item_list_index,
    MAX(promotion_id) as promotion_id,
    MAX(promotion_name) as promotion_name,
    MAX(creative_name) as creative_name,
    MAX(creative_slot) as creative_slot,

--Manuelle Trackingparameter
    MAX(manual_campaign_id) as manual_campaign_id,
    MAX(manual_campaign_name) as manual_campaign_name,
    MAX(manual_source) as manual_source,
    MAX(manual_medium) as manual_medium,
    MAX(manual_term) as manual_term,
    MAX(manual_content) as manual_content,
    MAX(gclid) as gclid,
    MAX(dclid) as dclid,
    MAX(srslti) as srslti

  FROM _source
  WHERE session_id <> 0
  GROUP BY 1,2,3,4,5,6
)

SELECT *
  --DISTINCT event_date
FROM events_aggregated;


[0m10:22:25.216778 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:27f87f55-96e9-4c34-8ae0-69ba10ca3ab9&page=queryresults
[0m10:22:25.217815 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "geo" at [62:5]')
[0m10:22:25.887446 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:34e3eb04-9f80-41a9-8915-434e69a3ae8e&page=queryresults
[0m10:22:25.888481 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:34e3eb04-9f80-41a9-8915-434e69a3ae8e&page=queryresults
[0m10:22:25.889444 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (execute): 10:22:24.560187 => 10:22:25.889444
[0m10:22:25.986111 [debug] [Thread-1 (]: Database Error in model stg_google_analytics_352128287 (models\staging\google_analytics\stg_google_analytics_352128287.sql)
  Syntax error: Expected ")" but got identifier "geo" at [62:5]
  compiled Code at target\run\bq_evo\models\staging\google_analytics\stg_google_analytics_352128287.sql
[0m10:22:25.987108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '762f060c-7688-4d81-a6c7-8f6fa2090672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B089D2E050>]}
[0m10:22:25.987108 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_google_analytics_352128287 .... [[31mERROR[0m in 1.44s]
[0m10:22:25.989138 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_analytics_352128287
[0m10:22:25.991131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:25.991131 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m10:22:25.992104 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m10:22:25.992104 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m10:22:25.992104 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m10:22:25.993127 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_analytics_352128287' was properly closed.
[0m10:22:25.993127 [info ] [MainThread]: 
[0m10:22:25.994090 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.54 seconds (5.54s).
[0m10:22:25.996086 [debug] [MainThread]: Command end result
[0m10:22:26.006058 [info ] [MainThread]: 
[0m10:22:26.008055 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:22:26.009051 [info ] [MainThread]: 
[0m10:22:26.010050 [error] [MainThread]:   Database Error in model stg_google_analytics_352128287 (models\staging\google_analytics\stg_google_analytics_352128287.sql)
  Syntax error: Expected ")" but got identifier "geo" at [62:5]
  compiled Code at target\run\bq_evo\models\staging\google_analytics\stg_google_analytics_352128287.sql
[0m10:22:26.011045 [info ] [MainThread]: 
[0m10:22:26.012042 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:22:26.014038 [debug] [MainThread]: Command `dbt run` failed at 10:22:26.014038 after 8.46 seconds
[0m10:22:26.015068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B088240FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B087D8C150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0876C6D50>]}
[0m10:22:26.016066 [debug] [MainThread]: Flushing usage events
[0m10:23:11.369929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6A16AFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC698DF690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC698DF150>]}


============================== 10:23:11.373918 | f6de1cac-2818-4cd6-a90b-966f175d6f54 ==============================
[0m10:23:11.373918 [info ] [MainThread]: Running with dbt=1.6.2
[0m10:23:11.374950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh -m stg_google_analytics_352128287', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:23:11.719386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6de1cac-2818-4cd6-a90b-966f175d6f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B41FFD0>]}
[0m10:23:11.728833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6de1cac-2818-4cd6-a90b-966f175d6f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6AB6E490>]}
[0m10:23:11.729830 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m10:23:11.778699 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m10:23:11.860033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:23:11.861030 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\google_analytics\stg_google_analytics_352128287.sql
[0m10:23:11.908169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6de1cac-2818-4cd6-a90b-966f175d6f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B4D7FD0>]}
[0m10:23:11.923880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6de1cac-2818-4cd6-a90b-966f175d6f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B1F6950>]}
[0m10:23:11.923880 [info ] [MainThread]: Found 11 models, 11 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m10:23:11.925321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6de1cac-2818-4cd6-a90b-966f175d6f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B4060D0>]}
[0m10:23:11.926866 [info ] [MainThread]: 
[0m10:23:11.927872 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:23:11.928916 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m10:23:11.929966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:14.120752 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m10:23:14.122747 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m10:23:14.122747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:14.124740 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m10:23:14.124740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:14.127743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:14.862713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6de1cac-2818-4cd6-a90b-966f175d6f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6991F7D0>]}
[0m10:23:14.865703 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:23:14.866700 [info ] [MainThread]: 
[0m10:23:14.873682 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_analytics_352128287
[0m10:23:14.875710 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_google_analytics_352128287 ............. [RUN]
[0m10:23:14.877670 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_analytics_352128287'
[0m10:23:14.878669 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_analytics_352128287
[0m10:23:14.888678 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_352128287"
[0m10:23:14.890707 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (compile): 10:23:14.878669 => 10:23:14.890707
[0m10:23:14.891637 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_analytics_352128287
[0m10:23:14.922598 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_352128287"
[0m10:23:14.924615 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:23:14.925580 [debug] [Thread-1 (]: On model.bq_evo.stg_google_analytics_352128287: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_352128287"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
  OPTIONS(
      description="""Enth\u00e4lt alle GA4-Events in Tabellenform ohne Schachtelung. Bereinigt fehlerhafte Events ohne Session-ID."""
    )
  as WITH _source AS(
  SELECT
    PARSE_DATE('%Y%m%d', event_date) as event_date,
    TIMESTAMP_MICROS(event_timestamp) as event_ts,
    
    MAX(CASE WHEN params.key = 'ga_session_id' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_id,
    user_pseudo_id,
    TIMESTAMP_MICROS(user_first_touch_timestamp) as user_first_touch_ts,

    event_name,

    params.key as params_key,
    params.value.string_value as params_string_value,
    params.value.int_value as params_int_value,
    params.value.float_value as params_float_value,
    params.value.double_value as params_double_value,

    (CASE WHEN traffic_source.name IS NULL THEN '(not set)' ELSE traffic_source.name END) as utm_campaign,
    (CASE WHEN traffic_source.medium IS NULL THEN '(not set)' ELSE traffic_source.medium END) as utm_medium,
    (CASE WHEN traffic_source.source IS NULL THEN '(not set)' ELSE traffic_source.source END) as utm_source,
    'EVO' as Partner,

    MAX(CASE WHEN params.key = 'page_title' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_title,
    MAX(CASE WHEN params.key = 'page_location' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_location,
    MAX(CASE WHEN params.key = 'page_referrer' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_referrer,
    MAX(CASE WHEN params.key = 'page_path' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_path,
    MAX(CASE WHEN params.key = 'percent_scrolled' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as percent_scrolled,
    MAX(CASE WHEN params.key = 'session_engaged' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_engaged,

    privacy_info.analytics_storage as analytics_storage,
    privacy_info.ads_storage as ads_storage,
    privacy_info.uses_transient_token as uses_transient_token,

    user_ltv.revenue as ltv_revenue,
    user_ltv.currency as ltv_currency,

    device.category as device_category,
    device.mobile_brand_name as device_brand,
    device.mobile_model_name as device_model_name,
    device.mobile_marketing_name as device_marketing_name,
    device.mobile_os_hardware_model as device_mobile_os_hardware_model,
    device.operating_system as device_os,
    device.operating_system_version as device_os_version,
    device.vendor_id as device_vendor_id,
    device.advertising_id as device_advertising_id,
    device.language as device_language,
    device.is_limited_ad_tracking as device_is_limited_ad_tracking,
    device.time_zone_offset_seconds as device_time_zone_offset_seconds,
    device.browser as device_browser,
    device.browser_version as device_browser_version,
    device.web_info.browser as device_web_info_browser,
    device.web_info.browser_version as device_web_info_browser_version,
    device.web_info.hostname as browser_web_info_hostname,

    geo.continent as continent,
    geo.country as country,
    geo.region as region,
    geo.city as city,
    geo.sub_continent as sub_continent,
    geo.metro as metropolitan_area,

    app_info.id as app_id,
    app_info.version as app_version,
    app_info.install_store as app_install_store,
    app_info.firebase_app_id as app_firebase_app_id,
    app_info.install_source as app_install_source,

    event_dimensions.hostname as event_hostname,

    ecommerce.total_item_quantity as total_item_quantity,
    ecommerce.purchase_revenue_in_usd as purchase_revenue_in_usd,
    ecommerce.purchase_revenue as purchase_revenue,
    ecommerce.refund_value_in_usd as refund_value_in_usd,
    ecommerce.refund_value as refund_value,
    ecommerce.shipping_value_in_usd as shipping_value_in_usd,
    ecommerce.shipping_value as shipping_value,
    ecommerce.tax_value_in_usd as tax_value_in_usd,
    ecommerce.tax_value as tax_value,
    ecommerce.unique_items as unique_items,
    ecommerce.transaction_id as transaction_id,
    
    items.item_id as item_id,
    items.item_name as item_name,
    items.item_brand as item_brand,
    items.item_variant as item_variant,
    items.item_category as item_category,
    items.item_category2 as item_category2,
    items.item_category3 as item_category3,
    items.item_category4 as item_category4,
    items.item_category5 as item_category5,
    items.price_in_usd as price_in_usd,
    items.price as price,
    items.quantity as quantity,
    items.item_revenue_in_usd as item_revenue_in_usd,
    items.item_revenue as item_revenue,
    items.item_refund_in_usd as item_refund_in_usd,
    items.item_refund as item_refund,
    items.coupon as coupon,
    items.affiliation as affiliation,
    items.location_id as location_id,
    items.item_list_id as item_list_id,
    items.item_list_name as item_list_name,
    items.item_list_index as item_list_index,
    items.promotion_id as promotion_id,
    items.promotion_name as promotion_name,
    items.creative_name as creative_name,
    items.creative_slot as creative_slot,

    collected_traffic_source.manual_campaign_id as manual_campaign_id,
    collected_traffic_source.manual_campaign_name as manual_campaign_name,
    collected_traffic_source.manual_source as manual_source,
    collected_traffic_source.manual_medium as manual_medium,
    collected_traffic_source.manual_term as manual_term,
    collected_traffic_source.manual_content as manual_content,
    collected_traffic_source.gclid as gclid,
    collected_traffic_source.dclid as dclid,
    collected_traffic_source.srsltid as srsltid

  FROM `oss-big-query-dashboard-prod`.`analytics_352128287`.`events_*` as events
  LEFT JOIN UNNEST (event_params) as params
  /*LEFT JOIN UNNEST (privacy_info) as privacy_info
  LEFT JOIN UNNEST (user_ltv) as user_ltv*/
  LEFT JOIN UNNEST(items) as items 
),

events_aggregated as (
  SELECT
    event_date,
    event_ts,
    session_id,
    user_pseudo_id,
    user_first_touch_ts,
    event_name,

--Kampagneninformationen
    MAX(utm_campaign) as utm_campaign,
    MAX(utm_medium) as utm_medium,
    (CASE WHEN MAX(utm_source) = 'ig' THEN 'instagram' ELSE MAX(utm_source) END) as utm_source,
  --  (CASE WHEN MAX(utm_campaign) IS NULL THEN '(not set)' ELSE MAX(utm_campaign) END) as utm_campaign,
  --  (CASE WHEN MAX(utm_medium) IS NULL THEN '(not set)' ELSE MAX(utm_medium) END) as utm_medium,
  --  (CASE WHEN MAX(utm_source) IS NULL THEN '(not set)' ELSE MAX(utm_source) END) as utm_source,

--Seiteninformationen
    MAX(page_title) as page_title,
    MAX(page_location) as page_location,
    MAX(page_referrer) as page_referrer,
    MAX(page_path) as page_path,
    MAX(percent_scrolled) as percent_scrolled,
    MAX(session_engaged) as session_engaged,

--Privacy-Infos
    MAX(analytics_storage) as analytics_storage,
    MAX(ads_storage) as ads_storage,
    MAX(uses_transient_token) as uses_transient_token,

--Kundenwertinformationen
    MAX(ltv_revenue) as ltv_revenue,
    MAX(ltv_currency) as ltv_currency,

--Geräteinformationen
    MAX(device_category) as device_category,
    MAX(device_brand) as device_brand,
    MAX(device_model_name) as device_model_name,
    MAX(device_marketing_name) as device_marketing_name,
    MAX(device_mobile_os_hardware_model) as device_mobile_os_hardware_model,
    MAX(device_os) as device_os,
    MAX(device_os_version) as device_os_version,
    MAX(device_vendor_id) as device_vendor_id,
    MAX(device_advertising_id) as device_advertising_id,
    MAX(device_language) as device_language,
    MAX(device_is_limited_ad_tracking) as device_is_limited_ad_tracking,
    MAX(device_time_zone_offset_seconds) as device_time_zone_offset_seconds,
    MAX(device_browser) as device_browser,
    MAX(device_browser_version) as device_browser_version,
    MAX(device_web_info_browser) as device_web_info_browser,
    MAX(device_web_info_browser_version) as device_web_info_browser_version,
    MAX(browser_web_info_hostnam) as browser_web_info_hostnam,

--Gebietsinformationen
    MAX(continent) as continent,
    MAX(country) as country,
    MAX(region) as region,
    MAX(city) as city,
    MAX(sub_continent) as sub_continent,
    MAX(metropolitan_area) as metropolitan_area,

--App-Informationen
    MAX(app_id) as app_id,
    MAX(app_version) as app_version,
    MAX(app_install_store) as app_install_store,
    MAX(app_firebase_app_id) as app_firebase_app_id,
    MAX(app_install_source) as app_install_source,

    MAX(event_hostname) as event_hostname,

--E-Commerceinformationen
    MAX(total_item_quantity) as total_item_quantity,
    MAX(purchase_revenue_in_usd) as purchase_revenue_in_usd,
    MAX(purchase_revenue) as purchase_revenue,
    MAX(refund_value_in_usd) as refund_value_in_usd,
    MAX(refund_value) as refund_value,
    MAX(shipping_value_in_usd) as shipping_value_in_usd,
    MAX(shipping_value) as shipping_value,
    MAX(tax_value_in_usd) as tax_value_in_usd,
    MAX(tax_value) as tax_value,
    MAX(unique_items) as unique_items,
    MAX(transaction_id) as transaction_id,

--Warenkorbinformationen
    MAX(item_id) as item_id,
    MAX(item_name) as item_name,
    MAX(item_brand) as item_brand,
    MAX(item_variant) as item_variant,
    MAX(item_category) as item_category,
    MAX(item_category2) as item_category2,
    MAX(item_category3) as item_category3,
    MAX(item_category4) as item_category4,
    MAX(item_category5) as item_category5,
    MAX(price_in_usd) as price_in_usd,
    MAX(price) as price,
    MAX(quantity) as quantity,
    MAX(item_revenue_in_usd) as item_revenue_in_usd,
    MAX(item_revenue) as item_revenue,
    MAX(item_refund_in_usd) as item_refund_in_usd,
    MAX(item_refund) as item_refund,
    MAX(coupon) as coupon,
    MAX(affiliation) as affiliation,
    MAX(location_id) as location_id,
    MAX(item_list_id) as item_list_id,
    MAX(item_list_name) as item_list_name,
    MAX(item_list_index) as item_list_index,
    MAX(promotion_id) as promotion_id,
    MAX(promotion_name) as promotion_name,
    MAX(creative_name) as creative_name,
    MAX(creative_slot) as creative_slot,

--Manuelle Trackingparameter
    MAX(manual_campaign_id) as manual_campaign_id,
    MAX(manual_campaign_name) as manual_campaign_name,
    MAX(manual_source) as manual_source,
    MAX(manual_medium) as manual_medium,
    MAX(manual_term) as manual_term,
    MAX(manual_content) as manual_content,
    MAX(gclid) as gclid,
    MAX(dclid) as dclid,
    MAX(srslti) as srslti

  FROM _source
  WHERE session_id <> 0
  GROUP BY 1,2,3,4,5,6
)

SELECT *
  --DISTINCT event_date
FROM events_aggregated;


[0m10:23:15.640357 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8e5a7c74-e297-4caf-8b2f-855807d156f4&page=queryresults
[0m10:23:15.881773 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: browser_web_info_hostnam; Did you mean browser_web_info_hostname? at [184:9]')
[0m10:23:16.363310 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:56ec6af6-6c98-48e9-9697-3bb168ea0d51&page=queryresults
[0m10:23:16.607205 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:56ec6af6-6c98-48e9-9697-3bb168ea0d51&page=queryresults
[0m10:23:16.609190 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (execute): 10:23:14.891637 => 10:23:16.608158
[0m10:23:16.617134 [debug] [Thread-1 (]: Database Error in model stg_google_analytics_352128287 (models\staging\google_analytics\stg_google_analytics_352128287.sql)
  Unrecognized name: browser_web_info_hostnam; Did you mean browser_web_info_hostname? at [184:9]
  compiled Code at target\run\bq_evo\models\staging\google_analytics\stg_google_analytics_352128287.sql
[0m10:23:16.618130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6de1cac-2818-4cd6-a90b-966f175d6f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6A24D810>]}
[0m10:23:16.618130 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_google_analytics_352128287 .... [[31mERROR[0m in 1.74s]
[0m10:23:16.620130 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_analytics_352128287
[0m10:23:16.622123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:23:16.623120 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m10:23:16.623120 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m10:23:16.624119 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m10:23:16.625116 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m10:23:16.626113 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_analytics_352128287' was properly closed.
[0m10:23:16.627111 [info ] [MainThread]: 
[0m10:23:16.628108 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.70 seconds (4.70s).
[0m10:23:16.630103 [debug] [MainThread]: Command end result
[0m10:23:16.647567 [info ] [MainThread]: 
[0m10:23:16.648563 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:23:16.649560 [info ] [MainThread]: 
[0m10:23:16.651554 [error] [MainThread]:   Database Error in model stg_google_analytics_352128287 (models\staging\google_analytics\stg_google_analytics_352128287.sql)
  Unrecognized name: browser_web_info_hostnam; Did you mean browser_web_info_hostname? at [184:9]
  compiled Code at target\run\bq_evo\models\staging\google_analytics\stg_google_analytics_352128287.sql
[0m10:23:16.653549 [info ] [MainThread]: 
[0m10:23:16.654548 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:23:16.656541 [debug] [MainThread]: Command `dbt run` failed at 10:23:16.655543 after 5.30 seconds
[0m10:23:16.657652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC69912D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6A15AC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6951C150>]}
[0m10:23:16.658538 [debug] [MainThread]: Flushing usage events
[0m10:24:16.820904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A101CFAB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A101C59590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A101F0C450>]}


============================== 10:24:16.825405 | 1b490879-50c8-4081-9ea8-bef2070b464f ==============================
[0m10:24:16.825405 [info ] [MainThread]: Running with dbt=1.6.2
[0m10:24:16.826455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh -m stg_google_analytics_352128287', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:24:17.169497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b490879-50c8-4081-9ea8-bef2070b464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A103A322D0>]}
[0m10:24:17.178473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b490879-50c8-4081-9ea8-bef2070b464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1036107D0>]}
[0m10:24:17.179474 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m10:24:17.232919 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m10:24:17.311746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:24:17.311746 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\google_analytics\stg_google_analytics_352128287.sql
[0m10:24:17.361193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b490879-50c8-4081-9ea8-bef2070b464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A103A0AE90>]}
[0m10:24:17.376151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b490879-50c8-4081-9ea8-bef2070b464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A103A7ED50>]}
[0m10:24:17.377115 [info ] [MainThread]: Found 11 models, 11 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m10:24:17.377115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b490879-50c8-4081-9ea8-bef2070b464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A101FA5810>]}
[0m10:24:17.379111 [info ] [MainThread]: 
[0m10:24:17.380150 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:24:17.381104 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m10:24:17.382101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:19.518417 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m10:24:19.518417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:19.519414 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m10:24:19.521445 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m10:24:19.522439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:19.523437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:20.252823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b490879-50c8-4081-9ea8-bef2070b464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1011A6A10>]}
[0m10:24:20.256860 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:24:20.259806 [info ] [MainThread]: 
[0m10:24:20.270777 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_analytics_352128287
[0m10:24:20.271807 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_google_analytics_352128287 ............. [RUN]
[0m10:24:20.274764 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_analytics_352128287'
[0m10:24:20.274764 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_analytics_352128287
[0m10:24:20.286765 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_352128287"
[0m10:24:20.288769 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (compile): 10:24:20.276761 => 10:24:20.288769
[0m10:24:20.289722 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_analytics_352128287
[0m10:24:20.321675 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_352128287"
[0m10:24:20.322674 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:24:20.323636 [debug] [Thread-1 (]: On model.bq_evo.stg_google_analytics_352128287: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_352128287"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
  OPTIONS(
      description="""Enth\u00e4lt alle GA4-Events in Tabellenform ohne Schachtelung. Bereinigt fehlerhafte Events ohne Session-ID."""
    )
  as WITH _source AS(
  SELECT
    PARSE_DATE('%Y%m%d', event_date) as event_date,
    TIMESTAMP_MICROS(event_timestamp) as event_ts,
    
    MAX(CASE WHEN params.key = 'ga_session_id' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_id,
    user_pseudo_id,
    TIMESTAMP_MICROS(user_first_touch_timestamp) as user_first_touch_ts,

    event_name,

    params.key as params_key,
    params.value.string_value as params_string_value,
    params.value.int_value as params_int_value,
    params.value.float_value as params_float_value,
    params.value.double_value as params_double_value,

    (CASE WHEN traffic_source.name IS NULL THEN '(not set)' ELSE traffic_source.name END) as utm_campaign,
    (CASE WHEN traffic_source.medium IS NULL THEN '(not set)' ELSE traffic_source.medium END) as utm_medium,
    (CASE WHEN traffic_source.source IS NULL THEN '(not set)' ELSE traffic_source.source END) as utm_source,
    'EVO' as Partner,

    MAX(CASE WHEN params.key = 'page_title' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_title,
    MAX(CASE WHEN params.key = 'page_location' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_location,
    MAX(CASE WHEN params.key = 'page_referrer' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_referrer,
    MAX(CASE WHEN params.key = 'page_path' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_path,
    MAX(CASE WHEN params.key = 'percent_scrolled' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as percent_scrolled,
    MAX(CASE WHEN params.key = 'session_engaged' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_engaged,

    privacy_info.analytics_storage as analytics_storage,
    privacy_info.ads_storage as ads_storage,
    privacy_info.uses_transient_token as uses_transient_token,

    user_ltv.revenue as ltv_revenue,
    user_ltv.currency as ltv_currency,

    device.category as device_category,
    device.mobile_brand_name as device_brand,
    device.mobile_model_name as device_model_name,
    device.mobile_marketing_name as device_marketing_name,
    device.mobile_os_hardware_model as device_mobile_os_hardware_model,
    device.operating_system as device_os,
    device.operating_system_version as device_os_version,
    device.vendor_id as device_vendor_id,
    device.advertising_id as device_advertising_id,
    device.language as device_language,
    device.is_limited_ad_tracking as device_is_limited_ad_tracking,
    device.time_zone_offset_seconds as device_time_zone_offset_seconds,
    device.browser as device_browser,
    device.browser_version as device_browser_version,
    device.web_info.browser as device_web_info_browser,
    device.web_info.browser_version as device_web_info_browser_version,
    device.web_info.hostname as browser_web_info_hostname,

    geo.continent as continent,
    geo.country as country,
    geo.region as region,
    geo.city as city,
    geo.sub_continent as sub_continent,
    geo.metro as metropolitan_area,

    app_info.id as app_id,
    app_info.version as app_version,
    app_info.install_store as app_install_store,
    app_info.firebase_app_id as app_firebase_app_id,
    app_info.install_source as app_install_source,

    event_dimensions.hostname as event_hostname,

    ecommerce.total_item_quantity as total_item_quantity,
    ecommerce.purchase_revenue_in_usd as purchase_revenue_in_usd,
    ecommerce.purchase_revenue as purchase_revenue,
    ecommerce.refund_value_in_usd as refund_value_in_usd,
    ecommerce.refund_value as refund_value,
    ecommerce.shipping_value_in_usd as shipping_value_in_usd,
    ecommerce.shipping_value as shipping_value,
    ecommerce.tax_value_in_usd as tax_value_in_usd,
    ecommerce.tax_value as tax_value,
    ecommerce.unique_items as unique_items,
    ecommerce.transaction_id as transaction_id,
    
    items.item_id as item_id,
    items.item_name as item_name,
    items.item_brand as item_brand,
    items.item_variant as item_variant,
    items.item_category as item_category,
    items.item_category2 as item_category2,
    items.item_category3 as item_category3,
    items.item_category4 as item_category4,
    items.item_category5 as item_category5,
    items.price_in_usd as price_in_usd,
    items.price as price,
    items.quantity as quantity,
    items.item_revenue_in_usd as item_revenue_in_usd,
    items.item_revenue as item_revenue,
    items.item_refund_in_usd as item_refund_in_usd,
    items.item_refund as item_refund,
    items.coupon as coupon,
    items.affiliation as affiliation,
    items.location_id as location_id,
    items.item_list_id as item_list_id,
    items.item_list_name as item_list_name,
    items.item_list_index as item_list_index,
    items.promotion_id as promotion_id,
    items.promotion_name as promotion_name,
    items.creative_name as creative_name,
    items.creative_slot as creative_slot,

    collected_traffic_source.manual_campaign_id as manual_campaign_id,
    collected_traffic_source.manual_campaign_name as manual_campaign_name,
    collected_traffic_source.manual_source as manual_source,
    collected_traffic_source.manual_medium as manual_medium,
    collected_traffic_source.manual_term as manual_term,
    collected_traffic_source.manual_content as manual_content,
    collected_traffic_source.gclid as gclid,
    collected_traffic_source.dclid as dclid,
    collected_traffic_source.srsltid as srsltid

  FROM `oss-big-query-dashboard-prod`.`analytics_352128287`.`events_*` as events
  LEFT JOIN UNNEST (event_params) as params
  /*LEFT JOIN UNNEST (privacy_info) as privacy_info
  LEFT JOIN UNNEST (user_ltv) as user_ltv*/
  LEFT JOIN UNNEST(items) as items 
),

events_aggregated as (
  SELECT
    event_date,
    event_ts,
    session_id,
    user_pseudo_id,
    user_first_touch_ts,
    event_name,

--Kampagneninformationen
    MAX(utm_campaign) as utm_campaign,
    MAX(utm_medium) as utm_medium,
    (CASE WHEN MAX(utm_source) = 'ig' THEN 'instagram' ELSE MAX(utm_source) END) as utm_source,
  --  (CASE WHEN MAX(utm_campaign) IS NULL THEN '(not set)' ELSE MAX(utm_campaign) END) as utm_campaign,
  --  (CASE WHEN MAX(utm_medium) IS NULL THEN '(not set)' ELSE MAX(utm_medium) END) as utm_medium,
  --  (CASE WHEN MAX(utm_source) IS NULL THEN '(not set)' ELSE MAX(utm_source) END) as utm_source,

--Seiteninformationen
    MAX(page_title) as page_title,
    MAX(page_location) as page_location,
    MAX(page_referrer) as page_referrer,
    MAX(page_path) as page_path,
    MAX(percent_scrolled) as percent_scrolled,
    MAX(session_engaged) as session_engaged,

--Privacy-Infos
    MAX(analytics_storage) as analytics_storage,
    MAX(ads_storage) as ads_storage,
    MAX(uses_transient_token) as uses_transient_token,

--Kundenwertinformationen
    MAX(ltv_revenue) as ltv_revenue,
    MAX(ltv_currency) as ltv_currency,

--Geräteinformationen
    MAX(device_category) as device_category,
    MAX(device_brand) as device_brand,
    MAX(device_model_name) as device_model_name,
    MAX(device_marketing_name) as device_marketing_name,
    MAX(device_mobile_os_hardware_model) as device_mobile_os_hardware_model,
    MAX(device_os) as device_os,
    MAX(device_os_version) as device_os_version,
    MAX(device_vendor_id) as device_vendor_id,
    MAX(device_advertising_id) as device_advertising_id,
    MAX(device_language) as device_language,
    MAX(device_is_limited_ad_tracking) as device_is_limited_ad_tracking,
    MAX(device_time_zone_offset_seconds) as device_time_zone_offset_seconds,
    MAX(device_browser) as device_browser,
    MAX(device_browser_version) as device_browser_version,
    MAX(device_web_info_browser) as device_web_info_browser,
    MAX(device_web_info_browser_version) as device_web_info_browser_version,
    MAX(browser_web_info_hostname) as browser_web_info_hostname,

--Gebietsinformationen
    MAX(continent) as continent,
    MAX(country) as country,
    MAX(region) as region,
    MAX(city) as city,
    MAX(sub_continent) as sub_continent,
    MAX(metropolitan_area) as metropolitan_area,

--App-Informationen
    MAX(app_id) as app_id,
    MAX(app_version) as app_version,
    MAX(app_install_store) as app_install_store,
    MAX(app_firebase_app_id) as app_firebase_app_id,
    MAX(app_install_source) as app_install_source,

    MAX(event_hostname) as event_hostname,

--E-Commerceinformationen
    MAX(total_item_quantity) as total_item_quantity,
    MAX(purchase_revenue_in_usd) as purchase_revenue_in_usd,
    MAX(purchase_revenue) as purchase_revenue,
    MAX(refund_value_in_usd) as refund_value_in_usd,
    MAX(refund_value) as refund_value,
    MAX(shipping_value_in_usd) as shipping_value_in_usd,
    MAX(shipping_value) as shipping_value,
    MAX(tax_value_in_usd) as tax_value_in_usd,
    MAX(tax_value) as tax_value,
    MAX(unique_items) as unique_items,
    MAX(transaction_id) as transaction_id,

--Warenkorbinformationen
    MAX(item_id) as item_id,
    MAX(item_name) as item_name,
    MAX(item_brand) as item_brand,
    MAX(item_variant) as item_variant,
    MAX(item_category) as item_category,
    MAX(item_category2) as item_category2,
    MAX(item_category3) as item_category3,
    MAX(item_category4) as item_category4,
    MAX(item_category5) as item_category5,
    MAX(price_in_usd) as price_in_usd,
    MAX(price) as price,
    MAX(quantity) as quantity,
    MAX(item_revenue_in_usd) as item_revenue_in_usd,
    MAX(item_revenue) as item_revenue,
    MAX(item_refund_in_usd) as item_refund_in_usd,
    MAX(item_refund) as item_refund,
    MAX(coupon) as coupon,
    MAX(affiliation) as affiliation,
    MAX(location_id) as location_id,
    MAX(item_list_id) as item_list_id,
    MAX(item_list_name) as item_list_name,
    MAX(item_list_index) as item_list_index,
    MAX(promotion_id) as promotion_id,
    MAX(promotion_name) as promotion_name,
    MAX(creative_name) as creative_name,
    MAX(creative_slot) as creative_slot,

--Manuelle Trackingparameter
    MAX(manual_campaign_id) as manual_campaign_id,
    MAX(manual_campaign_name) as manual_campaign_name,
    MAX(manual_source) as manual_source,
    MAX(manual_medium) as manual_medium,
    MAX(manual_term) as manual_term,
    MAX(manual_content) as manual_content,
    MAX(gclid) as gclid,
    MAX(dclid) as dclid,
    MAX(srslti) as srslti

  FROM _source
  WHERE session_id <> 0
  GROUP BY 1,2,3,4,5,6
)

SELECT *
  --DISTINCT event_date
FROM events_aggregated;


[0m10:24:21.177877 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4464fe14-2ece-4a58-aef3-d2657f0e54c2&page=queryresults
[0m10:24:21.399038 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: srslti; Did you mean srsltid? at [253:9]')
[0m10:24:22.221609 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:900560bf-c7fc-4fdc-888d-24452afd1876&page=queryresults
[0m10:24:22.432780 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:900560bf-c7fc-4fdc-888d-24452afd1876&page=queryresults
[0m10:24:22.434743 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (execute): 10:24:20.290719 => 10:24:22.433779
[0m10:24:22.440759 [debug] [Thread-1 (]: Database Error in model stg_google_analytics_352128287 (models\staging\google_analytics\stg_google_analytics_352128287.sql)
  Unrecognized name: srslti; Did you mean srsltid? at [253:9]
  compiled Code at target\run\bq_evo\models\staging\google_analytics\stg_google_analytics_352128287.sql
[0m10:24:22.440759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b490879-50c8-4081-9ea8-bef2070b464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1031DAED0>]}
[0m10:24:22.441769 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_google_analytics_352128287 .... [[31mERROR[0m in 2.17s]
[0m10:24:22.442721 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_analytics_352128287
[0m10:24:22.445714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:22.445714 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m10:24:22.446712 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m10:24:22.446712 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m10:24:22.447710 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m10:24:22.447710 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_analytics_352128287' was properly closed.
[0m10:24:22.448705 [info ] [MainThread]: 
[0m10:24:22.449731 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.07 seconds (5.07s).
[0m10:24:22.450736 [debug] [MainThread]: Command end result
[0m10:24:22.461710 [info ] [MainThread]: 
[0m10:24:22.463705 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:24:22.464705 [info ] [MainThread]: 
[0m10:24:22.465731 [error] [MainThread]:   Database Error in model stg_google_analytics_352128287 (models\staging\google_analytics\stg_google_analytics_352128287.sql)
  Unrecognized name: srslti; Did you mean srsltid? at [253:9]
  compiled Code at target\run\bq_evo\models\staging\google_analytics\stg_google_analytics_352128287.sql
[0m10:24:22.466697 [info ] [MainThread]: 
[0m10:24:22.467694 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:24:22.468693 [debug] [MainThread]: Command `dbt run` failed at 10:24:22.468693 after 5.66 seconds
[0m10:24:22.469687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A101FA5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A10275B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A101D06950>]}
[0m10:24:22.470688 [debug] [MainThread]: Flushing usage events
[0m10:24:49.698663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A53B80290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A53B5E390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A53A16A50>]}


============================== 10:24:49.702652 | 883d23aa-ce44-4c30-90ea-8ad586e22c11 ==============================
[0m10:24:49.702652 [info ] [MainThread]: Running with dbt=1.6.2
[0m10:24:49.703651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh -m stg_google_analytics_352128287', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:24:50.052536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '883d23aa-ce44-4c30-90ea-8ad586e22c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5517E5D0>]}
[0m10:24:50.060516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '883d23aa-ce44-4c30-90ea-8ad586e22c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5476DD10>]}
[0m10:24:50.061512 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m10:24:50.113926 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m10:24:50.195324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:24:50.196324 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\google_analytics\stg_google_analytics_352128287.sql
[0m10:24:50.243196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '883d23aa-ce44-4c30-90ea-8ad586e22c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A55B3BF90>]}
[0m10:24:50.257167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '883d23aa-ce44-4c30-90ea-8ad586e22c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A55AD7790>]}
[0m10:24:50.258123 [info ] [MainThread]: Found 11 models, 11 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m10:24:50.259120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '883d23aa-ce44-4c30-90ea-8ad586e22c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A55C43010>]}
[0m10:24:50.260117 [info ] [MainThread]: 
[0m10:24:50.261149 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:24:50.263109 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m10:24:50.263109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:52.429906 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m10:24:52.429906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:52.430949 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m10:24:52.433371 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m10:24:52.434642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:52.434642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:53.144507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '883d23aa-ce44-4c30-90ea-8ad586e22c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A53B42890>]}
[0m10:24:53.145536 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:24:53.145536 [info ] [MainThread]: 
[0m10:24:53.150574 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_analytics_352128287
[0m10:24:53.150574 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_google_analytics_352128287 ............. [RUN]
[0m10:24:53.151698 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_analytics_352128287'
[0m10:24:53.152701 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_analytics_352128287
[0m10:24:53.162673 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_352128287"
[0m10:24:53.164670 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (compile): 10:24:53.152701 => 10:24:53.164670
[0m10:24:53.165665 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_analytics_352128287
[0m10:24:53.199092 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_352128287"
[0m10:24:53.200090 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:24:53.202090 [debug] [Thread-1 (]: On model.bq_evo.stg_google_analytics_352128287: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_352128287"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
  OPTIONS(
      description="""Enth\u00e4lt alle GA4-Events in Tabellenform ohne Schachtelung. Bereinigt fehlerhafte Events ohne Session-ID."""
    )
  as WITH _source AS(
  SELECT
    PARSE_DATE('%Y%m%d', event_date) as event_date,
    TIMESTAMP_MICROS(event_timestamp) as event_ts,
    
    MAX(CASE WHEN params.key = 'ga_session_id' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_id,
    user_pseudo_id,
    TIMESTAMP_MICROS(user_first_touch_timestamp) as user_first_touch_ts,

    event_name,

    params.key as params_key,
    params.value.string_value as params_string_value,
    params.value.int_value as params_int_value,
    params.value.float_value as params_float_value,
    params.value.double_value as params_double_value,

    (CASE WHEN traffic_source.name IS NULL THEN '(not set)' ELSE traffic_source.name END) as utm_campaign,
    (CASE WHEN traffic_source.medium IS NULL THEN '(not set)' ELSE traffic_source.medium END) as utm_medium,
    (CASE WHEN traffic_source.source IS NULL THEN '(not set)' ELSE traffic_source.source END) as utm_source,
    'EVO' as Partner,

    MAX(CASE WHEN params.key = 'page_title' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_title,
    MAX(CASE WHEN params.key = 'page_location' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_location,
    MAX(CASE WHEN params.key = 'page_referrer' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_referrer,
    MAX(CASE WHEN params.key = 'page_path' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_path,
    MAX(CASE WHEN params.key = 'percent_scrolled' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as percent_scrolled,
    MAX(CASE WHEN params.key = 'session_engaged' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_engaged,

    privacy_info.analytics_storage as analytics_storage,
    privacy_info.ads_storage as ads_storage,
    privacy_info.uses_transient_token as uses_transient_token,

    user_ltv.revenue as ltv_revenue,
    user_ltv.currency as ltv_currency,

    device.category as device_category,
    device.mobile_brand_name as device_brand,
    device.mobile_model_name as device_model_name,
    device.mobile_marketing_name as device_marketing_name,
    device.mobile_os_hardware_model as device_mobile_os_hardware_model,
    device.operating_system as device_os,
    device.operating_system_version as device_os_version,
    device.vendor_id as device_vendor_id,
    device.advertising_id as device_advertising_id,
    device.language as device_language,
    device.is_limited_ad_tracking as device_is_limited_ad_tracking,
    device.time_zone_offset_seconds as device_time_zone_offset_seconds,
    device.browser as device_browser,
    device.browser_version as device_browser_version,
    device.web_info.browser as device_web_info_browser,
    device.web_info.browser_version as device_web_info_browser_version,
    device.web_info.hostname as browser_web_info_hostname,

    geo.continent as continent,
    geo.country as country,
    geo.region as region,
    geo.city as city,
    geo.sub_continent as sub_continent,
    geo.metro as metropolitan_area,

    app_info.id as app_id,
    app_info.version as app_version,
    app_info.install_store as app_install_store,
    app_info.firebase_app_id as app_firebase_app_id,
    app_info.install_source as app_install_source,

    event_dimensions.hostname as event_hostname,

    ecommerce.total_item_quantity as total_item_quantity,
    ecommerce.purchase_revenue_in_usd as purchase_revenue_in_usd,
    ecommerce.purchase_revenue as purchase_revenue,
    ecommerce.refund_value_in_usd as refund_value_in_usd,
    ecommerce.refund_value as refund_value,
    ecommerce.shipping_value_in_usd as shipping_value_in_usd,
    ecommerce.shipping_value as shipping_value,
    ecommerce.tax_value_in_usd as tax_value_in_usd,
    ecommerce.tax_value as tax_value,
    ecommerce.unique_items as unique_items,
    ecommerce.transaction_id as transaction_id,
    
    items.item_id as item_id,
    items.item_name as item_name,
    items.item_brand as item_brand,
    items.item_variant as item_variant,
    items.item_category as item_category,
    items.item_category2 as item_category2,
    items.item_category3 as item_category3,
    items.item_category4 as item_category4,
    items.item_category5 as item_category5,
    items.price_in_usd as price_in_usd,
    items.price as price,
    items.quantity as quantity,
    items.item_revenue_in_usd as item_revenue_in_usd,
    items.item_revenue as item_revenue,
    items.item_refund_in_usd as item_refund_in_usd,
    items.item_refund as item_refund,
    items.coupon as coupon,
    items.affiliation as affiliation,
    items.location_id as location_id,
    items.item_list_id as item_list_id,
    items.item_list_name as item_list_name,
    items.item_list_index as item_list_index,
    items.promotion_id as promotion_id,
    items.promotion_name as promotion_name,
    items.creative_name as creative_name,
    items.creative_slot as creative_slot,

    collected_traffic_source.manual_campaign_id as manual_campaign_id,
    collected_traffic_source.manual_campaign_name as manual_campaign_name,
    collected_traffic_source.manual_source as manual_source,
    collected_traffic_source.manual_medium as manual_medium,
    collected_traffic_source.manual_term as manual_term,
    collected_traffic_source.manual_content as manual_content,
    collected_traffic_source.gclid as gclid,
    collected_traffic_source.dclid as dclid,
    collected_traffic_source.srsltid as srsltid

  FROM `oss-big-query-dashboard-prod`.`analytics_352128287`.`events_*` as events
  LEFT JOIN UNNEST (event_params) as params
  /*LEFT JOIN UNNEST (privacy_info) as privacy_info
  LEFT JOIN UNNEST (user_ltv) as user_ltv*/
  LEFT JOIN UNNEST(items) as items 
),

events_aggregated as (
  SELECT
    event_date,
    event_ts,
    session_id,
    user_pseudo_id,
    user_first_touch_ts,
    event_name,

--Kampagneninformationen
    MAX(utm_campaign) as utm_campaign,
    MAX(utm_medium) as utm_medium,
    (CASE WHEN MAX(utm_source) = 'ig' THEN 'instagram' ELSE MAX(utm_source) END) as utm_source,
  --  (CASE WHEN MAX(utm_campaign) IS NULL THEN '(not set)' ELSE MAX(utm_campaign) END) as utm_campaign,
  --  (CASE WHEN MAX(utm_medium) IS NULL THEN '(not set)' ELSE MAX(utm_medium) END) as utm_medium,
  --  (CASE WHEN MAX(utm_source) IS NULL THEN '(not set)' ELSE MAX(utm_source) END) as utm_source,

--Seiteninformationen
    MAX(page_title) as page_title,
    MAX(page_location) as page_location,
    MAX(page_referrer) as page_referrer,
    MAX(page_path) as page_path,
    MAX(percent_scrolled) as percent_scrolled,
    MAX(session_engaged) as session_engaged,

--Privacy-Infos
    MAX(analytics_storage) as analytics_storage,
    MAX(ads_storage) as ads_storage,
    MAX(uses_transient_token) as uses_transient_token,

--Kundenwertinformationen
    MAX(ltv_revenue) as ltv_revenue,
    MAX(ltv_currency) as ltv_currency,

--Geräteinformationen
    MAX(device_category) as device_category,
    MAX(device_brand) as device_brand,
    MAX(device_model_name) as device_model_name,
    MAX(device_marketing_name) as device_marketing_name,
    MAX(device_mobile_os_hardware_model) as device_mobile_os_hardware_model,
    MAX(device_os) as device_os,
    MAX(device_os_version) as device_os_version,
    MAX(device_vendor_id) as device_vendor_id,
    MAX(device_advertising_id) as device_advertising_id,
    MAX(device_language) as device_language,
    MAX(device_is_limited_ad_tracking) as device_is_limited_ad_tracking,
    MAX(device_time_zone_offset_seconds) as device_time_zone_offset_seconds,
    MAX(device_browser) as device_browser,
    MAX(device_browser_version) as device_browser_version,
    MAX(device_web_info_browser) as device_web_info_browser,
    MAX(device_web_info_browser_version) as device_web_info_browser_version,
    MAX(browser_web_info_hostname) as browser_web_info_hostname,

--Gebietsinformationen
    MAX(continent) as continent,
    MAX(country) as country,
    MAX(region) as region,
    MAX(city) as city,
    MAX(sub_continent) as sub_continent,
    MAX(metropolitan_area) as metropolitan_area,

--App-Informationen
    MAX(app_id) as app_id,
    MAX(app_version) as app_version,
    MAX(app_install_store) as app_install_store,
    MAX(app_firebase_app_id) as app_firebase_app_id,
    MAX(app_install_source) as app_install_source,

    MAX(event_hostname) as event_hostname,

--E-Commerceinformationen
    MAX(total_item_quantity) as total_item_quantity,
    MAX(purchase_revenue_in_usd) as purchase_revenue_in_usd,
    MAX(purchase_revenue) as purchase_revenue,
    MAX(refund_value_in_usd) as refund_value_in_usd,
    MAX(refund_value) as refund_value,
    MAX(shipping_value_in_usd) as shipping_value_in_usd,
    MAX(shipping_value) as shipping_value,
    MAX(tax_value_in_usd) as tax_value_in_usd,
    MAX(tax_value) as tax_value,
    MAX(unique_items) as unique_items,
    MAX(transaction_id) as transaction_id,

--Warenkorbinformationen
    MAX(item_id) as item_id,
    MAX(item_name) as item_name,
    MAX(item_brand) as item_brand,
    MAX(item_variant) as item_variant,
    MAX(item_category) as item_category,
    MAX(item_category2) as item_category2,
    MAX(item_category3) as item_category3,
    MAX(item_category4) as item_category4,
    MAX(item_category5) as item_category5,
    MAX(price_in_usd) as price_in_usd,
    MAX(price) as price,
    MAX(quantity) as quantity,
    MAX(item_revenue_in_usd) as item_revenue_in_usd,
    MAX(item_revenue) as item_revenue,
    MAX(item_refund_in_usd) as item_refund_in_usd,
    MAX(item_refund) as item_refund,
    MAX(coupon) as coupon,
    MAX(affiliation) as affiliation,
    MAX(location_id) as location_id,
    MAX(item_list_id) as item_list_id,
    MAX(item_list_name) as item_list_name,
    MAX(item_list_index) as item_list_index,
    MAX(promotion_id) as promotion_id,
    MAX(promotion_name) as promotion_name,
    MAX(creative_name) as creative_name,
    MAX(creative_slot) as creative_slot,

--Manuelle Trackingparameter
    MAX(manual_campaign_id) as manual_campaign_id,
    MAX(manual_campaign_name) as manual_campaign_name,
    MAX(manual_source) as manual_source,
    MAX(manual_medium) as manual_medium,
    MAX(manual_term) as manual_term,
    MAX(manual_content) as manual_content,
    MAX(gclid) as gclid,
    MAX(dclid) as dclid,
    MAX(srsltid) as srsltid

  FROM _source
  WHERE session_id <> 0
  GROUP BY 1,2,3,4,5,6
)

SELECT *
  --DISTINCT event_date
FROM events_aggregated;


[0m10:24:53.802305 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7deb1c59-e7ca-44a9-964b-9ce6f6c172b5&page=queryresults
[0m10:24:54.603486 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (execute): 10:24:53.166661 => 10:24:54.602488
[0m10:24:54.604483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '883d23aa-ce44-4c30-90ea-8ad586e22c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A55B405D0>]}
[0m10:24:54.604483 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.stg_google_analytics_352128287 ........ [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m10:24:54.605480 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_analytics_352128287
[0m10:24:54.607475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:54.608472 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m10:24:54.608472 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m10:24:54.609470 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m10:24:54.609470 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m10:24:54.610467 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_analytics_352128287' was properly closed.
[0m10:24:54.610467 [info ] [MainThread]: 
[0m10:24:54.611465 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m10:24:54.613460 [debug] [MainThread]: Command end result
[0m10:24:54.630267 [info ] [MainThread]: 
[0m10:24:54.632393 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:24:54.633401 [info ] [MainThread]: 
[0m10:24:54.634406 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:24:54.635409 [debug] [MainThread]: Command `dbt run` succeeded at 10:24:54.635409 after 4.95 seconds
[0m10:24:54.636415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5467B010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A53C26E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A4E56FAD0>]}
[0m10:24:54.636415 [debug] [MainThread]: Flushing usage events
[0m10:28:25.069828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730DF3E750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730DF3C710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730DF3C650>]}


============================== 10:28:25.073822 | ba9dc5b1-49a1-458b-8095-423cd99cedf8 ==============================
[0m10:28:25.073822 [info ] [MainThread]: Running with dbt=1.6.2
[0m10:28:25.074736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh -m stg_google_analytics_352128287', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:28:25.419349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba9dc5b1-49a1-458b-8095-423cd99cedf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730F1F9110>]}
[0m10:28:25.427876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba9dc5b1-49a1-458b-8095-423cd99cedf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730DB16AD0>]}
[0m10:28:25.428872 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m10:28:25.481569 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m10:28:25.560837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:28:25.561835 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\schema.yml
[0m10:28:25.608985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba9dc5b1-49a1-458b-8095-423cd99cedf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730FA43250>]}
[0m10:28:25.623502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba9dc5b1-49a1-458b-8095-423cd99cedf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730FB40750>]}
[0m10:28:25.623502 [info ] [MainThread]: Found 11 models, 11 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m10:28:25.625010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba9dc5b1-49a1-458b-8095-423cd99cedf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730DB1C250>]}
[0m10:28:25.627087 [info ] [MainThread]: 
[0m10:28:25.627087 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:28:25.628577 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m10:28:25.629961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:27.898896 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m10:28:27.900925 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m10:28:27.900925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:27.901923 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m10:28:27.902919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:27.905913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:28.589925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba9dc5b1-49a1-458b-8095-423cd99cedf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730FA4D710>]}
[0m10:28:28.591915 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:28:28.592878 [info ] [MainThread]: 
[0m10:28:28.599313 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_analytics_352128287
[0m10:28:28.600314 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_google_analytics_352128287 ............. [RUN]
[0m10:28:28.601312 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_analytics_352128287'
[0m10:28:28.602309 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_analytics_352128287
[0m10:28:28.612284 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_352128287"
[0m10:28:28.613279 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (compile): 10:28:28.603308 => 10:28:28.613279
[0m10:28:28.614280 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_analytics_352128287
[0m10:28:28.645704 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_352128287"
[0m10:28:28.646701 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:28:28.648983 [debug] [Thread-1 (]: On model.bq_evo.stg_google_analytics_352128287: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_352128287"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
  OPTIONS(
      description="""Enth\u00e4lt alle GA4-Events in Tabellenform ohne Schachtelung. Bereinigt fehlerhafte Events ohne Session-ID. Offzielle Doku Google > https://support.google.com/analytics/answer/7029846?hl=en#zippy="""
    )
  as WITH _source AS(
  SELECT
    PARSE_DATE('%Y%m%d', event_date) as event_date,
    TIMESTAMP_MICROS(event_timestamp) as event_ts,
    
    MAX(CASE WHEN params.key = 'ga_session_id' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_id,
    user_pseudo_id,
    TIMESTAMP_MICROS(user_first_touch_timestamp) as user_first_touch_ts,

    event_name,

    params.key as params_key,
    params.value.string_value as params_string_value,
    params.value.int_value as params_int_value,
    params.value.float_value as params_float_value,
    params.value.double_value as params_double_value,

    (CASE WHEN traffic_source.name IS NULL THEN '(not set)' ELSE traffic_source.name END) as utm_campaign,
    (CASE WHEN traffic_source.medium IS NULL THEN '(not set)' ELSE traffic_source.medium END) as utm_medium,
    (CASE WHEN traffic_source.source IS NULL THEN '(not set)' ELSE traffic_source.source END) as utm_source,
    'EVO' as Partner,

    MAX(CASE WHEN params.key = 'page_title' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_title,
    MAX(CASE WHEN params.key = 'page_location' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_location,
    MAX(CASE WHEN params.key = 'page_referrer' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_referrer,
    MAX(CASE WHEN params.key = 'page_path' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_path,
    MAX(CASE WHEN params.key = 'percent_scrolled' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as percent_scrolled,
    MAX(CASE WHEN params.key = 'session_engaged' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_engaged,

    privacy_info.analytics_storage as analytics_storage,
    privacy_info.ads_storage as ads_storage,
    privacy_info.uses_transient_token as uses_transient_token,

    user_ltv.revenue as ltv_revenue,
    user_ltv.currency as ltv_currency,

    device.category as device_category,
    device.mobile_brand_name as device_brand,
    device.mobile_model_name as device_model_name,
    device.mobile_marketing_name as device_marketing_name,
    device.mobile_os_hardware_model as device_mobile_os_hardware_model,
    device.operating_system as device_os,
    device.operating_system_version as device_os_version,
    device.vendor_id as device_vendor_id,
    device.advertising_id as device_advertising_id,
    device.language as device_language,
    device.is_limited_ad_tracking as device_is_limited_ad_tracking,
    device.time_zone_offset_seconds as device_time_zone_offset_seconds,
    device.browser as device_browser,
    device.browser_version as device_browser_version,
    device.web_info.browser as device_web_info_browser,
    device.web_info.browser_version as device_web_info_browser_version,
    device.web_info.hostname as browser_web_info_hostname,

    geo.continent as continent,
    geo.country as country,
    geo.region as region,
    geo.city as city,
    geo.sub_continent as sub_continent,
    geo.metro as metropolitan_area,

    app_info.id as app_id,
    app_info.version as app_version,
    app_info.install_store as app_install_store,
    app_info.firebase_app_id as app_firebase_app_id,
    app_info.install_source as app_install_source,

    event_dimensions.hostname as event_hostname,

    ecommerce.total_item_quantity as total_item_quantity,
    ecommerce.purchase_revenue_in_usd as purchase_revenue_in_usd,
    ecommerce.purchase_revenue as purchase_revenue,
    ecommerce.refund_value_in_usd as refund_value_in_usd,
    ecommerce.refund_value as refund_value,
    ecommerce.shipping_value_in_usd as shipping_value_in_usd,
    ecommerce.shipping_value as shipping_value,
    ecommerce.tax_value_in_usd as tax_value_in_usd,
    ecommerce.tax_value as tax_value,
    ecommerce.unique_items as unique_items,
    ecommerce.transaction_id as transaction_id,
    
    items.item_id as item_id,
    items.item_name as item_name,
    items.item_brand as item_brand,
    items.item_variant as item_variant,
    items.item_category as item_category,
    items.item_category2 as item_category2,
    items.item_category3 as item_category3,
    items.item_category4 as item_category4,
    items.item_category5 as item_category5,
    items.price_in_usd as price_in_usd,
    items.price as price,
    items.quantity as quantity,
    items.item_revenue_in_usd as item_revenue_in_usd,
    items.item_revenue as item_revenue,
    items.item_refund_in_usd as item_refund_in_usd,
    items.item_refund as item_refund,
    items.coupon as coupon,
    items.affiliation as affiliation,
    items.location_id as location_id,
    items.item_list_id as item_list_id,
    items.item_list_name as item_list_name,
    items.item_list_index as item_list_index,
    items.promotion_id as promotion_id,
    items.promotion_name as promotion_name,
    items.creative_name as creative_name,
    items.creative_slot as creative_slot,

    collected_traffic_source.manual_campaign_id as manual_campaign_id,
    collected_traffic_source.manual_campaign_name as manual_campaign_name,
    collected_traffic_source.manual_source as manual_source,
    collected_traffic_source.manual_medium as manual_medium,
    collected_traffic_source.manual_term as manual_term,
    collected_traffic_source.manual_content as manual_content,
    collected_traffic_source.gclid as gclid,
    collected_traffic_source.dclid as dclid,
    collected_traffic_source.srsltid as srsltid

  FROM `oss-big-query-dashboard-prod`.`analytics_352128287`.`events_*` as events
  LEFT JOIN UNNEST (event_params) as params
  /*LEFT JOIN UNNEST (privacy_info) as privacy_info
  LEFT JOIN UNNEST (user_ltv) as user_ltv*/
  LEFT JOIN UNNEST(items) as items 
),

events_aggregated as (
  SELECT
    event_date,
    event_ts,
    session_id,
    user_pseudo_id,
    user_first_touch_ts,
    event_name,

--Kampagneninformationen
    MAX(utm_campaign) as utm_campaign,
    MAX(utm_medium) as utm_medium,
    (CASE WHEN MAX(utm_source) = 'ig' THEN 'instagram' ELSE MAX(utm_source) END) as utm_source,
  --  (CASE WHEN MAX(utm_campaign) IS NULL THEN '(not set)' ELSE MAX(utm_campaign) END) as utm_campaign,
  --  (CASE WHEN MAX(utm_medium) IS NULL THEN '(not set)' ELSE MAX(utm_medium) END) as utm_medium,
  --  (CASE WHEN MAX(utm_source) IS NULL THEN '(not set)' ELSE MAX(utm_source) END) as utm_source,

--Seiteninformationen
    MAX(page_title) as page_title,
    MAX(page_location) as page_location,
    MAX(page_referrer) as page_referrer,
    MAX(page_path) as page_path,
    MAX(percent_scrolled) as percent_scrolled,
    MAX(session_engaged) as session_engaged,

--Privacy-Infos
    MAX(analytics_storage) as analytics_storage,
    MAX(ads_storage) as ads_storage,
    MAX(uses_transient_token) as uses_transient_token,

--Kundenwertinformationen
    MAX(ltv_revenue) as ltv_revenue,
    MAX(ltv_currency) as ltv_currency,

--Geräteinformationen
    MAX(device_category) as device_category,
    MAX(device_brand) as device_brand,
    MAX(device_model_name) as device_model_name,
    MAX(device_marketing_name) as device_marketing_name,
    MAX(device_mobile_os_hardware_model) as device_mobile_os_hardware_model,
    MAX(device_os) as device_os,
    MAX(device_os_version) as device_os_version,
    MAX(device_vendor_id) as device_vendor_id,
    MAX(device_advertising_id) as device_advertising_id,
    MAX(device_language) as device_language,
    MAX(device_is_limited_ad_tracking) as device_is_limited_ad_tracking,
    MAX(device_time_zone_offset_seconds) as device_time_zone_offset_seconds,
    MAX(device_browser) as device_browser,
    MAX(device_browser_version) as device_browser_version,
    MAX(device_web_info_browser) as device_web_info_browser,
    MAX(device_web_info_browser_version) as device_web_info_browser_version,
    MAX(browser_web_info_hostname) as browser_web_info_hostname,

--Gebietsinformationen
    MAX(continent) as continent,
    MAX(country) as country,
    MAX(region) as region,
    MAX(city) as city,
    MAX(sub_continent) as sub_continent,
    MAX(metropolitan_area) as metropolitan_area,

--App-Informationen
    MAX(app_id) as app_id,
    MAX(app_version) as app_version,
    MAX(app_install_store) as app_install_store,
    MAX(app_firebase_app_id) as app_firebase_app_id,
    MAX(app_install_source) as app_install_source,

    MAX(event_hostname) as event_hostname,

--E-Commerceinformationen
    MAX(total_item_quantity) as total_item_quantity,
    MAX(purchase_revenue_in_usd) as purchase_revenue_in_usd,
    MAX(purchase_revenue) as purchase_revenue,
    MAX(refund_value_in_usd) as refund_value_in_usd,
    MAX(refund_value) as refund_value,
    MAX(shipping_value_in_usd) as shipping_value_in_usd,
    MAX(shipping_value) as shipping_value,
    MAX(tax_value_in_usd) as tax_value_in_usd,
    MAX(tax_value) as tax_value,
    MAX(unique_items) as unique_items,
    MAX(transaction_id) as transaction_id,

--Warenkorbinformationen
    MAX(item_id) as item_id,
    MAX(item_name) as item_name,
    MAX(item_brand) as item_brand,
    MAX(item_variant) as item_variant,
    MAX(item_category) as item_category,
    MAX(item_category2) as item_category2,
    MAX(item_category3) as item_category3,
    MAX(item_category4) as item_category4,
    MAX(item_category5) as item_category5,
    MAX(price_in_usd) as price_in_usd,
    MAX(price) as price,
    MAX(quantity) as quantity,
    MAX(item_revenue_in_usd) as item_revenue_in_usd,
    MAX(item_revenue) as item_revenue,
    MAX(item_refund_in_usd) as item_refund_in_usd,
    MAX(item_refund) as item_refund,
    MAX(coupon) as coupon,
    MAX(affiliation) as affiliation,
    MAX(location_id) as location_id,
    MAX(item_list_id) as item_list_id,
    MAX(item_list_name) as item_list_name,
    MAX(item_list_index) as item_list_index,
    MAX(promotion_id) as promotion_id,
    MAX(promotion_name) as promotion_name,
    MAX(creative_name) as creative_name,
    MAX(creative_slot) as creative_slot,

--Manuelle Trackingparameter
    MAX(manual_campaign_id) as manual_campaign_id,
    MAX(manual_campaign_name) as manual_campaign_name,
    MAX(manual_source) as manual_source,
    MAX(manual_medium) as manual_medium,
    MAX(manual_term) as manual_term,
    MAX(manual_content) as manual_content,
    MAX(gclid) as gclid,
    MAX(dclid) as dclid,
    MAX(srsltid) as srsltid

  FROM _source
  WHERE session_id <> 0
  GROUP BY 1,2,3,4,5,6
)

SELECT *
  --DISTINCT event_date
FROM events_aggregated;


[0m10:28:29.312830 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:9b27ec2f-941b-432d-99c3-1f7dfbfc01f6&page=queryresults
[0m10:28:29.869177 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (execute): 10:28:28.615277 => 10:28:29.869177
[0m10:28:29.871169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba9dc5b1-49a1-458b-8095-423cd99cedf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730F7F6A10>]}
[0m10:28:29.872168 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.stg_google_analytics_352128287 ........ [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m10:28:29.874123 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_analytics_352128287
[0m10:28:29.876150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:29.876150 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m10:28:29.877148 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m10:28:29.877148 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m10:28:29.878147 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m10:28:29.878147 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_analytics_352128287' was properly closed.
[0m10:28:29.879109 [info ] [MainThread]: 
[0m10:28:29.880107 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m10:28:29.881105 [debug] [MainThread]: Command end result
[0m10:28:29.891121 [info ] [MainThread]: 
[0m10:28:29.892075 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:28:29.893072 [info ] [MainThread]: 
[0m10:28:29.894070 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:28:29.896066 [debug] [MainThread]: Command `dbt run` succeeded at 10:28:29.895068 after 4.84 seconds
[0m10:28:29.897066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730DFAC150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027308527C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002730856FAD0>]}
[0m10:28:29.898060 [debug] [MainThread]: Flushing usage events
[0m10:47:26.366614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB6375AB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB63956E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB63C136D0>]}


============================== 10:47:26.370639 | 5a87e100-8e43-4cbb-bf4f-3c4fc9fb29da ==============================
[0m10:47:26.370639 [info ] [MainThread]: Running with dbt=1.6.2
[0m10:47:26.371600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh -m int_google_analytics_all_events', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:47:26.712578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a87e100-8e43-4cbb-bf4f-3c4fc9fb29da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB6521D8D0>]}
[0m10:47:26.721027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a87e100-8e43-4cbb-bf4f-3c4fc9fb29da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB64DBC210>]}
[0m10:47:26.722025 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m10:47:26.770705 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m10:47:26.850112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:47:26.851111 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\google_analytics\int_google_analytics_all_events.sql
[0m10:47:26.852074 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\schema.yml
[0m10:47:26.909953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a87e100-8e43-4cbb-bf4f-3c4fc9fb29da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB656BE750>]}
[0m10:47:26.925428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a87e100-8e43-4cbb-bf4f-3c4fc9fb29da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB653F5FD0>]}
[0m10:47:26.926425 [info ] [MainThread]: Found 12 models, 12 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m10:47:26.927421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a87e100-8e43-4cbb-bf4f-3c4fc9fb29da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB65755650>]}
[0m10:47:26.928421 [info ] [MainThread]: 
[0m10:47:26.929761 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:47:26.931760 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m10:47:26.931760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:29.256848 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m10:47:29.257847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:29.257847 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m10:47:29.259845 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m10:47:29.260853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:29.261871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:29.980598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a87e100-8e43-4cbb-bf4f-3c4fc9fb29da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB62E41510>]}
[0m10:47:29.984606 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:47:29.987549 [info ] [MainThread]: 
[0m10:47:29.998747 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m10:47:30.000749 [info ] [Thread-1 (]: 1 of 1 START sql view model intermediate.int_google_analytics_all_events ....... [RUN]
[0m10:47:30.003743 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_analytics_all_events'
[0m10:47:30.004772 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m10:47:30.014784 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m10:47:30.017749 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 10:47:30.004772 => 10:47:30.016749
[0m10:47:30.017749 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m10:47:30.049254 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m10:47:30.050285 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:47:30.051254 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_columns AS(
    SELECT 
        *,
        MAX(Partner) as Partner,
        MAX(LOWER (CONCAT(utm_campaign, utm_source, utm_medium, 'EVO'))) as CampaignID
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium
    FROM _added_columns
),

_final AS(
    SELECT *
    FROM _rename_columns
)

SELECT * FROM _final;


[0m10:47:31.045699 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c063b798-106e-4185-a115-fc6f5d4fa15f&page=queryresults
[0m10:47:31.261563 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: Partner at [16:13]')
[0m10:47:32.274979 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8655592c-4bdf-4ba8-b7a9-b73127c82a55&page=queryresults
[0m10:47:32.450355 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8655592c-4bdf-4ba8-b7a9-b73127c82a55&page=queryresults
[0m10:47:32.451330 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 10:47:30.018739 => 10:47:32.451330
[0m10:47:32.457337 [debug] [Thread-1 (]: Database Error in model int_google_analytics_all_events (models\intermediate\google_analytics\int_google_analytics_all_events.sql)
  Unrecognized name: Partner at [16:13]
  compiled Code at target\run\bq_evo\models\intermediate\google_analytics\int_google_analytics_all_events.sql
[0m10:47:32.458334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a87e100-8e43-4cbb-bf4f-3c4fc9fb29da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB658E2AD0>]}
[0m10:47:32.459309 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model intermediate.int_google_analytics_all_events  [[31mERROR[0m in 2.46s]
[0m10:47:32.460294 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m10:47:32.463290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:32.464285 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m10:47:32.464285 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m10:47:32.465282 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m10:47:32.465282 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m10:47:32.466278 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_events' was properly closed.
[0m10:47:32.467276 [info ] [MainThread]: 
[0m10:47:32.468274 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.54 seconds (5.54s).
[0m10:47:32.469271 [debug] [MainThread]: Command end result
[0m10:47:32.480242 [info ] [MainThread]: 
[0m10:47:32.481242 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:47:32.483233 [info ] [MainThread]: 
[0m10:47:32.484232 [error] [MainThread]:   Database Error in model int_google_analytics_all_events (models\intermediate\google_analytics\int_google_analytics_all_events.sql)
  Unrecognized name: Partner at [16:13]
  compiled Code at target\run\bq_evo\models\intermediate\google_analytics\int_google_analytics_all_events.sql
[0m10:47:32.485230 [info ] [MainThread]: 
[0m10:47:32.486227 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:47:32.488222 [debug] [MainThread]: Command `dbt run` failed at 10:47:32.487224 after 6.13 seconds
[0m10:47:32.488222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB63C3D450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB6426DF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB6426F610>]}
[0m10:47:32.489219 [debug] [MainThread]: Flushing usage events
[0m10:48:13.983266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484B813450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484B3696D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484B35B190>]}


============================== 10:48:13.987256 | c8d2a626-a87e-43ee-9a5a-a3c1f81c9357 ==============================
[0m10:48:13.987256 [info ] [MainThread]: Running with dbt=1.6.2
[0m10:48:13.988254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh -m int_google_analytics_all_events', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:48:14.331583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8d2a626-a87e-43ee-9a5a-a3c1f81c9357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484C9A1110>]}
[0m10:48:14.340635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8d2a626-a87e-43ee-9a5a-a3c1f81c9357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484BE91C10>]}
[0m10:48:14.341670 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m10:48:14.391179 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m10:48:14.470552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:48:14.472085 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\google_analytics\int_google_analytics_all_events.sql
[0m10:48:14.527540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8d2a626-a87e-43ee-9a5a-a3c1f81c9357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484D223210>]}
[0m10:48:14.543185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8d2a626-a87e-43ee-9a5a-a3c1f81c9357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484D206450>]}
[0m10:48:14.544182 [info ] [MainThread]: Found 12 models, 12 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m10:48:14.545058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8d2a626-a87e-43ee-9a5a-a3c1f81c9357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484C9BCF10>]}
[0m10:48:14.547090 [info ] [MainThread]: 
[0m10:48:14.548088 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:48:14.549050 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m10:48:14.550047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:16.686415 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m10:48:16.687415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:16.687415 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m10:48:16.690440 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m10:48:16.691418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:16.691418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:17.401825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8d2a626-a87e-43ee-9a5a-a3c1f81c9357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484B813710>]}
[0m10:48:17.404861 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:48:17.406812 [info ] [MainThread]: 
[0m10:48:17.413691 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m10:48:17.414658 [info ] [Thread-1 (]: 1 of 1 START sql view model intermediate.int_google_analytics_all_events ....... [RUN]
[0m10:48:17.416654 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_analytics_all_events'
[0m10:48:17.417651 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m10:48:17.427624 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m10:48:17.429619 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 10:48:17.418648 => 10:48:17.428621
[0m10:48:17.429619 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m10:48:17.460571 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m10:48:17.462532 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:48:17.463532 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_columns AS(
    SELECT 
        *,
        'EVO' as Partner,
        MAX(LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner))) as CampaignID
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium
    FROM _added_columns
),

_final AS(
    SELECT *
    FROM _rename_columns
)

SELECT * FROM _final;


[0m10:48:18.104826 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a9284540-9990-4bfe-8c73-552210ae3a57&page=queryresults
[0m10:48:18.269730 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: Partner at [17:65]')
[0m10:48:19.360371 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5dbc7847-f195-4933-925b-d238ed8db504&page=queryresults
[0m10:48:19.565137 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5dbc7847-f195-4933-925b-d238ed8db504&page=queryresults
[0m10:48:19.569124 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 10:48:17.430649 => 10:48:19.568076
[0m10:48:19.578080 [debug] [Thread-1 (]: Database Error in model int_google_analytics_all_events (models\intermediate\google_analytics\int_google_analytics_all_events.sql)
  Unrecognized name: Partner at [17:65]
  compiled Code at target\run\bq_evo\models\intermediate\google_analytics\int_google_analytics_all_events.sql
[0m10:48:19.578080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d2a626-a87e-43ee-9a5a-a3c1f81c9357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484D23A090>]}
[0m10:48:19.579077 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model intermediate.int_google_analytics_all_events  [[31mERROR[0m in 2.16s]
[0m10:48:19.580075 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m10:48:19.584030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:19.584030 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m10:48:19.585039 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m10:48:19.585039 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m10:48:19.586049 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m10:48:19.587029 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_events' was properly closed.
[0m10:48:19.587029 [info ] [MainThread]: 
[0m10:48:19.588020 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m10:48:19.590014 [debug] [MainThread]: Command end result
[0m10:48:19.603984 [info ] [MainThread]: 
[0m10:48:19.604983 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:48:19.605979 [info ] [MainThread]: 
[0m10:48:19.606982 [error] [MainThread]:   Database Error in model int_google_analytics_all_events (models\intermediate\google_analytics\int_google_analytics_all_events.sql)
  Unrecognized name: Partner at [17:65]
  compiled Code at target\run\bq_evo\models\intermediate\google_analytics\int_google_analytics_all_events.sql
[0m10:48:19.608970 [info ] [MainThread]: 
[0m10:48:19.609981 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:48:19.610967 [debug] [MainThread]: Command `dbt run` failed at 10:48:19.610967 after 5.64 seconds
[0m10:48:19.611966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484BE9BAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484BE7B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484B819E10>]}
[0m10:48:19.612977 [debug] [MainThread]: Flushing usage events
[0m10:49:29.122477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A7B445F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A7B4442D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A7B4DB190>]}


============================== 10:49:29.126469 | d511120e-1538-4e13-a29a-5fc4bdabfa9b ==============================
[0m10:49:29.126469 [info ] [MainThread]: Running with dbt=1.6.2
[0m10:49:29.127835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh -m int_google_analytics_all_events', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:49:29.469688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd511120e-1538-4e13-a29a-5fc4bdabfa9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A7B42BF50>]}
[0m10:49:29.477667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd511120e-1538-4e13-a29a-5fc4bdabfa9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A7AF5A550>]}
[0m10:49:29.478681 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m10:49:29.530099 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m10:49:29.608575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:49:29.608575 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\google_analytics\int_google_analytics_all_events.sql
[0m10:49:29.664164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd511120e-1538-4e13-a29a-5fc4bdabfa9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A7C5F4DD0>]}
[0m10:49:29.680635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd511120e-1538-4e13-a29a-5fc4bdabfa9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A7CE1C290>]}
[0m10:49:29.681636 [info ] [MainThread]: Found 12 models, 12 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m10:49:29.682665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd511120e-1538-4e13-a29a-5fc4bdabfa9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A7CB32550>]}
[0m10:49:29.684627 [info ] [MainThread]: 
[0m10:49:29.685625 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:49:29.686621 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m10:49:29.687597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:31.842119 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m10:49:31.843119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:31.843119 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m10:49:31.845113 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m10:49:31.846112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:31.847109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:32.545891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd511120e-1538-4e13-a29a-5fc4bdabfa9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A7CF64590>]}
[0m10:49:32.549879 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:49:32.551875 [info ] [MainThread]: 
[0m10:49:32.560084 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m10:49:32.561085 [info ] [Thread-1 (]: 1 of 1 START sql view model intermediate.int_google_analytics_all_events ....... [RUN]
[0m10:49:32.564071 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_analytics_all_events'
[0m10:49:32.564071 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m10:49:32.573086 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m10:49:32.575044 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 10:49:32.565106 => 10:49:32.575044
[0m10:49:32.577043 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m10:49:32.608972 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m10:49:32.609970 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:49:32.610933 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_final AS(
    SELECT *
    FROM _rename_columns
)

SELECT * FROM _final;


[0m10:49:33.299446 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6b127d4f-6dec-4092-9a68-06b636c3cd56&page=queryresults
[0m10:49:34.079659 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 10:49:32.578501 => 10:49:34.079659
[0m10:49:34.080688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd511120e-1538-4e13-a29a-5fc4bdabfa9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A7D020CD0>]}
[0m10:49:34.081652 [info ] [Thread-1 (]: 1 of 1 OK created sql view model intermediate.int_google_analytics_all_events .. [[32mCREATE VIEW (0 processed)[0m in 1.52s]
[0m10:49:34.083649 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m10:49:34.085641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:34.085641 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m10:49:34.086673 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m10:49:34.086673 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m10:49:34.088180 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m10:49:34.088180 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_events' was properly closed.
[0m10:49:34.089179 [info ] [MainThread]: 
[0m10:49:34.090177 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.40 seconds (4.40s).
[0m10:49:34.091174 [debug] [MainThread]: Command end result
[0m10:49:34.104141 [info ] [MainThread]: 
[0m10:49:34.105140 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:49:34.106134 [info ] [MainThread]: 
[0m10:49:34.107133 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:49:34.108129 [debug] [MainThread]: Command `dbt run` succeeded at 10:49:34.108129 after 5.00 seconds
[0m10:49:34.109126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A7B49CB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A7CF8F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A75B48A50>]}
[0m10:49:34.110125 [debug] [MainThread]: Flushing usage events
[0m10:52:07.427680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4CBD0DE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4CBD0DED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4CB9EE690>]}


============================== 10:52:07.431635 | dfb46040-dc33-4aa8-9f98-11be6495157d ==============================
[0m10:52:07.431635 [info ] [MainThread]: Running with dbt=1.6.2
[0m10:52:07.432633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test -m int_google_analytics_all_events', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:52:07.767202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfb46040-dc33-4aa8-9f98-11be6495157d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4CD229110>]}
[0m10:52:07.776180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfb46040-dc33-4aa8-9f98-11be6495157d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4CCDD8350>]}
[0m10:52:07.777176 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m10:52:07.829560 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m10:52:07.907864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:52:07.907864 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:52:07.915183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfb46040-dc33-4aa8-9f98-11be6495157d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4CC292890>]}
[0m10:52:07.929710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfb46040-dc33-4aa8-9f98-11be6495157d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4CD764FD0>]}
[0m10:52:07.930707 [info ] [MainThread]: Found 12 models, 12 tests, 9 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m10:52:07.931704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfb46040-dc33-4aa8-9f98-11be6495157d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4CD7E7FD0>]}
[0m10:52:07.932705 [info ] [MainThread]: 
[0m10:52:07.933699 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:52:07.936692 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m10:52:07.937690 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m10:52:07.937690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:07.939684 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m10:52:07.939684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:07.940681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:10.312845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfb46040-dc33-4aa8-9f98-11be6495157d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4CCA48790>]}
[0m10:52:10.313841 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:52:10.314849 [info ] [MainThread]: 
[0m10:52:10.318974 [debug] [Thread-1 (]: Began running node test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2
[0m10:52:10.320010 [info ] [Thread-1 (]: 1 of 1 START test not_null_int_google_analytics_all_events_CampaignID .......... [RUN]
[0m10:52:10.321010 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2'
[0m10:52:10.322010 [debug] [Thread-1 (]: Began compiling node test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2
[0m10:52:10.339993 [debug] [Thread-1 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2"
[0m10:52:10.341954 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2 (compile): 10:52:10.323010 => 10:52:10.340991
[0m10:52:10.342955 [debug] [Thread-1 (]: Began executing node test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2
[0m10:52:10.361905 [debug] [Thread-1 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2"
[0m10:52:10.363903 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:52:10.364893 [debug] [Thread-1 (]: On test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
where CampaignID is null



      
    ) dbt_internal_test
[0m10:52:11.021100 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:fb78d724-9a97-4d4f-9c92-d8bfc73bb2a6&page=queryresults
[0m10:52:18.014123 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2 (execute): 10:52:10.343950 => 10:52:18.013077
[0m10:52:18.016100 [info ] [Thread-1 (]: 1 of 1 PASS not_null_int_google_analytics_all_events_CampaignID ................ [[32mPASS[0m in 7.69s]
[0m10:52:18.017064 [debug] [Thread-1 (]: Finished running node test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2
[0m10:52:18.019067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:18.020064 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m10:52:18.020064 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m10:52:18.021062 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m10:52:18.021062 [debug] [MainThread]: Connection 'test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2' was properly closed.
[0m10:52:18.022059 [info ] [MainThread]: 
[0m10:52:18.023056 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 10.09 seconds (10.09s).
[0m10:52:18.025052 [debug] [MainThread]: Command end result
[0m10:52:18.037022 [info ] [MainThread]: 
[0m10:52:18.038020 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:52:18.039063 [info ] [MainThread]: 
[0m10:52:18.040012 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:52:18.040817 [debug] [MainThread]: Command `dbt test` succeeded at 10:52:18.040817 after 10.63 seconds
[0m10:52:18.041850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4CB03B090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4CBC11D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4CB76CA90>]}
[0m10:52:18.041850 [debug] [MainThread]: Flushing usage events
[0m11:07:08.250421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001528FE13490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001528F969290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001528F815490>]}


============================== 11:07:08.254820 | 03bce80c-1f2e-4efd-9a81-e91b630cf320 ==============================
[0m11:07:08.254820 [info ] [MainThread]: Running with dbt=1.6.2
[0m11:07:08.255822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh -m stg_google_analytics_historic_campaigns', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:07:08.640782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03bce80c-1f2e-4efd-9a81-e91b630cf320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015290F365D0>]}
[0m11:07:08.649756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03bce80c-1f2e-4efd-9a81-e91b630cf320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152914187D0>]}
[0m11:07:08.650721 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m11:07:08.698110 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m11:07:08.784356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m11:07:08.785394 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\google_analytics\stg_google_analytics_historic_campaigns.sql
[0m11:07:08.786407 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\sources.yml
[0m11:07:08.787417 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\schema.yml
[0m11:07:08.852301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03bce80c-1f2e-4efd-9a81-e91b630cf320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015291937150>]}
[0m11:07:08.871042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03bce80c-1f2e-4efd-9a81-e91b630cf320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152915F6990>]}
[0m11:07:08.871042 [info ] [MainThread]: Found 13 models, 12 tests, 10 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:07:08.872039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03bce80c-1f2e-4efd-9a81-e91b630cf320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015291935A10>]}
[0m11:07:08.874039 [info ] [MainThread]: 
[0m11:07:08.876029 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:07:08.877060 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m11:07:08.877956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:11.126934 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m11:07:11.127934 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m11:07:11.128931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:11.129253 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m11:07:11.130113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:11.131506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:11.823422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03bce80c-1f2e-4efd-9a81-e91b630cf320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001528FF0CE50>]}
[0m11:07:11.826453 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:07:11.828405 [info ] [MainThread]: 
[0m11:07:11.836450 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_analytics_historic_campaigns
[0m11:07:11.837492 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_google_analytics_historic_campaigns .... [RUN]
[0m11:07:11.839493 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_analytics_historic_campaigns'
[0m11:07:11.840489 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_campaigns
[0m11:07:11.849497 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_campaigns"
[0m11:07:11.852456 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_historic_campaigns (compile): 11:07:11.841485 => 11:07:11.851458
[0m11:07:11.853453 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_analytics_historic_campaigns
[0m11:07:11.884733 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_campaigns"
[0m11:07:11.887733 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:07:11.887733 [debug] [Thread-1 (]: On model.bq_evo.stg_google_analytics_historic_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle historischen Kampagnen aus Universal Analytics / GA3"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_campaigns`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m11:07:12.641441 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a659d6bd-f348-4192-881f-82355bb9a06c&page=queryresults
[0m11:07:13.221266 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_historic_campaigns (execute): 11:07:11.853453 => 11:07:13.220262
[0m11:07:13.223200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03bce80c-1f2e-4efd-9a81-e91b630cf320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015291A0E390>]}
[0m11:07:13.224229 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.stg_google_analytics_historic_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m11:07:13.225417 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_analytics_historic_campaigns
[0m11:07:13.227415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:13.228447 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m11:07:13.228447 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m11:07:13.229409 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m11:07:13.230406 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m11:07:13.230406 [debug] [MainThread]: Connection 'model.bq_evo.stg_google_analytics_historic_campaigns' was properly closed.
[0m11:07:13.231403 [info ] [MainThread]: 
[0m11:07:13.232401 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.36 seconds (4.36s).
[0m11:07:13.233399 [debug] [MainThread]: Command end result
[0m11:07:13.244369 [info ] [MainThread]: 
[0m11:07:13.245366 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:07:13.246365 [info ] [MainThread]: 
[0m11:07:13.247362 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:07:13.248393 [debug] [MainThread]: Command `dbt run` succeeded at 11:07:13.248393 after 5.01 seconds
[0m11:07:13.248393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001528FE12F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001528FF0CF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001528A36FB50>]}
[0m11:07:13.249356 [debug] [MainThread]: Flushing usage events
[0m11:19:08.215627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020932568210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020931A6DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020931D13190>]}


============================== 11:19:08.219615 | 67b5f401-067b-4ce6-a8b9-96857c8f2ce2 ==============================
[0m11:19:08.219615 [info ] [MainThread]: Running with dbt=1.6.2
[0m11:19:08.221443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh -m intermediate/google_analytics', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:19:08.562078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67b5f401-067b-4ce6-a8b9-96857c8f2ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209332BE5D0>]}
[0m11:19:08.571054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67b5f401-067b-4ce6-a8b9-96857c8f2ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209332A07D0>]}
[0m11:19:08.572052 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m11:19:08.620439 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m11:19:08.702838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:19:08.703803 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\google_analytics\int_google_analytics_all_campaigns.sql
[0m11:19:08.704833 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\schema.yml
[0m11:19:08.759692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67b5f401-067b-4ce6-a8b9-96857c8f2ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020933B37E10>]}
[0m11:19:08.779601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67b5f401-067b-4ce6-a8b9-96857c8f2ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209337AA6D0>]}
[0m11:19:08.780599 [info ] [MainThread]: Found 14 models, 13 tests, 10 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:19:08.781598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67b5f401-067b-4ce6-a8b9-96857c8f2ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209332531D0>]}
[0m11:19:08.783626 [warn ] [MainThread]: The selection criterion 'intermediate/google_analytics' does not match any nodes
[0m11:19:08.785655 [info ] [MainThread]: 
[0m11:19:08.785655 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:19:08.786632 [debug] [MainThread]: Command end result
[0m11:19:08.799766 [debug] [MainThread]: Command `dbt run` succeeded at 11:19:08.799766 after 0.60 seconds
[0m11:19:08.799766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020932561990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020932561250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092C427110>]}
[0m11:19:08.800777 [debug] [MainThread]: Flushing usage events
[0m11:19:25.201152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F977BA5F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F977BA5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F97835BAD0>]}


============================== 11:19:25.204169 | 46c16969-9e3d-49ec-b699-a700e935c7cb ==============================
[0m11:19:25.204169 [info ] [MainThread]: Running with dbt=1.6.2
[0m11:19:25.205118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh -m intermediate\\google_analytics', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:19:25.547461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46c16969-9e3d-49ec-b699-a700e935c7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F978DAE5D0>]}
[0m11:19:25.556433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46c16969-9e3d-49ec-b699-a700e935c7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F977B13950>]}
[0m11:19:25.557430 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m11:19:25.606298 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m11:19:25.687703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:19:25.687703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:19:25.694683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46c16969-9e3d-49ec-b699-a700e935c7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F97975E590>]}
[0m11:19:25.709611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46c16969-9e3d-49ec-b699-a700e935c7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9774E0FD0>]}
[0m11:19:25.710608 [info ] [MainThread]: Found 14 models, 13 tests, 10 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:19:25.711605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46c16969-9e3d-49ec-b699-a700e935c7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9793F5A10>]}
[0m11:19:25.713633 [warn ] [MainThread]: The selection criterion 'intermediate\google_analytics' does not match any nodes
[0m11:19:25.714596 [info ] [MainThread]: 
[0m11:19:25.715594 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:19:25.717589 [debug] [MainThread]: Command end result
[0m11:19:25.728561 [debug] [MainThread]: Command `dbt run` succeeded at 11:19:25.728561 after 0.54 seconds
[0m11:19:25.729592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F97785A090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F97835AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F977B24150>]}
[0m11:19:25.730592 [debug] [MainThread]: Flushing usage events
[0m11:19:48.811087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C71AA5F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C71B5A450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C720F4650>]}


============================== 11:19:48.814079 | a782e9f0-f575-4a86-87a6-3d30cfe3fea6 ==============================
[0m11:19:48.814079 [info ] [MainThread]: Running with dbt=1.6.2
[0m11:19:48.816050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh -m intermediate\\google_analytics', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:19:49.161334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a782e9f0-f575-4a86-87a6-3d30cfe3fea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C7325D9D0>]}
[0m11:19:49.169312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a782e9f0-f575-4a86-87a6-3d30cfe3fea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C7201E050>]}
[0m11:19:49.170312 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m11:19:49.221951 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m11:19:49.304355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:19:49.305352 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\google_analytics\schema.yml
[0m11:19:49.317321 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named int_google_ads_unique_campaigns. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for int_google_ads_unique_campaigns in one of these files:
   - models\intermediate\google_analytics\schema.yml
  models\intermediate\schema.yml
[0m11:19:49.319281 [debug] [MainThread]: Command `dbt run` failed at 11:19:49.319281 after 0.52 seconds
[0m11:19:49.320279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C71B41B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C7265DC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C720F4150>]}
[0m11:19:49.320279 [debug] [MainThread]: Flushing usage events
[0m11:20:23.716739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281322136D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812EDC8D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028131D90F50>]}


============================== 11:20:23.720728 | 60fc91a8-8b37-4296-b642-bf6209364874 ==============================
[0m11:20:23.720728 [info ] [MainThread]: Running with dbt=1.6.2
[0m11:20:23.722534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh -m intermediate\\google_analytics', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:20:24.062623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60fc91a8-8b37-4296-b642-bf6209364874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002813351E5D0>]}
[0m11:20:24.071601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60fc91a8-8b37-4296-b642-bf6209364874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281334707D0>]}
[0m11:20:24.072597 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m11:20:24.121434 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m11:20:24.202836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:20:24.203863 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\google_analytics\schema.yml
[0m11:20:24.204639 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\schema.yml
[0m11:20:24.264158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60fc91a8-8b37-4296-b642-bf6209364874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002813393AAD0>]}
[0m11:20:24.281062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60fc91a8-8b37-4296-b642-bf6209364874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281339B9D90>]}
[0m11:20:24.282085 [info ] [MainThread]: Found 14 models, 13 tests, 10 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:20:24.283104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60fc91a8-8b37-4296-b642-bf6209364874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028133C3E5D0>]}
[0m11:20:24.285075 [warn ] [MainThread]: The selection criterion 'intermediate\google_analytics' does not match any nodes
[0m11:20:24.286073 [info ] [MainThread]: 
[0m11:20:24.287084 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:20:24.289030 [debug] [MainThread]: Command end result
[0m11:20:24.300999 [debug] [MainThread]: Command `dbt run` succeeded at 11:20:24.300002 after 0.60 seconds
[0m11:20:24.301996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028131C16910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028131E268D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812C67FAD0>]}
[0m11:20:24.303009 [debug] [MainThread]: Flushing usage events
[0m12:22:19.365291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB9AC3B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB9B8A8810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB9B83EF90>]}


============================== 12:22:19.369283 | a41f77b1-20ed-49af-b206-c41f947c4a70 ==============================
[0m12:22:19.369283 [info ] [MainThread]: Running with dbt=1.6.2
[0m12:22:19.369835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh -m intermediate', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:22:19.769772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a41f77b1-20ed-49af-b206-c41f947c4a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB9BE90D10>]}
[0m12:22:19.778284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a41f77b1-20ed-49af-b206-c41f947c4a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB9B369190>]}
[0m12:22:19.779318 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m12:22:19.828706 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m12:22:19.913517 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 5 files added, 2 files changed.
[0m12:22:19.914512 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\bing_ads\mrt_bing_ads_basic_campaign_stats.sql
[0m12:22:19.915511 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\google_analytics\int_google_analytics_all_purchases_GA4.sql
[0m12:22:19.915511 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\google_analytics\mrt_google_analytics_campaign_webperformance.sql
[0m12:22:19.916492 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\google_ads\mrt_google_ads_basic_campaign_stats.sql
[0m12:22:19.916996 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\google_analytics\int_google_analytics_NDG_conversionevents_GA4.sql
[0m12:22:19.917998 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\schema.yml
[0m12:22:19.918996 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\mart\schema.yml
[0m12:22:19.918996 [debug] [MainThread]: Partial parsing: deleted file: bq_evo://models\mart\bing_ads\mrt_bing_ads_performancereporting.sql
[0m12:22:19.919992 [debug] [MainThread]: Partial parsing: deleted file: bq_evo://models\mart\google_ads\mrt_google_ads_performancereporting.sql
[0m12:22:20.011818 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bq_evo.int_google_analytics_NDG_conversionevents_GA4' (models\intermediate\google_analytics\int_google_analytics_NDG_conversionevents_GA4.sql) depends on a node named 'stg_ga4_events' which was not found
[0m12:22:20.012781 [debug] [MainThread]: Command `dbt run` failed at 12:22:20.012781 after 0.66 seconds
[0m12:22:20.013802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB9BE5E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB9B81ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB9CEF5D90>]}
[0m12:22:20.013802 [debug] [MainThread]: Flushing usage events
[0m12:23:05.065019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91DA11C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91D41C790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91DAAC2D0>]}


============================== 12:23:05.069043 | 74e0cf40-07d2-4aa4-bff0-e0c9de4ac064 ==============================
[0m12:23:05.069043 [info ] [MainThread]: Running with dbt=1.6.2
[0m12:23:05.070005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh -m intermediate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:23:05.463971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74e0cf40-07d2-4aa4-bff0-e0c9de4ac064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91ECDAA10>]}
[0m12:23:05.471943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74e0cf40-07d2-4aa4-bff0-e0c9de4ac064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91DA41910>]}
[0m12:23:05.472938 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m12:23:05.521404 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m12:23:05.607211 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 5 files added, 2 files changed.
[0m12:23:05.608209 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\google_analytics\int_google_analytics_NDG_conversionevents_GA4.sql
[0m12:23:05.608209 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\google_analytics\int_google_analytics_all_purchases_GA4.sql
[0m12:23:05.609753 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\google_analytics\mrt_google_analytics_campaign_webperformance.sql
[0m12:23:05.609753 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\google_ads\mrt_google_ads_basic_campaign_stats.sql
[0m12:23:05.610788 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\bing_ads\mrt_bing_ads_basic_campaign_stats.sql
[0m12:23:05.610788 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\schema.yml
[0m12:23:05.611790 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\mart\schema.yml
[0m12:23:05.612747 [debug] [MainThread]: Partial parsing: deleted file: bq_evo://models\mart\bing_ads\mrt_bing_ads_performancereporting.sql
[0m12:23:05.612747 [debug] [MainThread]: Partial parsing: deleted file: bq_evo://models\mart\google_ads\mrt_google_ads_performancereporting.sql
[0m12:23:05.719078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74e0cf40-07d2-4aa4-bff0-e0c9de4ac064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91DA1C390>]}
[0m12:23:05.738993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74e0cf40-07d2-4aa4-bff0-e0c9de4ac064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91F520BD0>]}
[0m12:23:05.739991 [info ] [MainThread]: Found 17 models, 17 tests, 10 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m12:23:05.740989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74e0cf40-07d2-4aa4-bff0-e0c9de4ac064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91F108B50>]}
[0m12:23:05.742983 [info ] [MainThread]: 
[0m12:23:05.743979 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:23:05.745973 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m12:23:05.745973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:08.006566 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m12:23:08.010601 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m12:23:08.011595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:08.015046 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m12:23:08.016049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:08.019040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:08.779534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74e0cf40-07d2-4aa4-bff0-e0c9de4ac064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91ECBC8D0>]}
[0m12:23:08.781529 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:23:08.782527 [info ] [MainThread]: 
[0m12:23:08.790504 [debug] [Thread-1 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:23:08.791506 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m12:23:08.793498 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m12:23:08.794532 [info ] [Thread-1 (]: 1 of 8 START sql view model intermediate.int_bing_ads_unique_campaigns ......... [RUN]
[0m12:23:08.796490 [info ] [Thread-2 (]: 2 of 8 START sql view model intermediate.int_google_ads_unique_campaigns ....... [RUN]
[0m12:23:08.798484 [info ] [Thread-3 (]: 3 of 8 START sql view model intermediate.int_google_analytics_all_events ....... [RUN]
[0m12:23:08.801480 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_bing_ads_unique_campaigns'
[0m12:23:08.803474 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_ads_unique_campaigns'
[0m12:23:08.805469 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_analytics_all_events'
[0m12:23:08.806466 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:23:08.807463 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m12:23:08.809460 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m12:23:08.820956 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m12:23:08.826011 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m12:23:08.829965 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m12:23:08.833921 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (compile): 12:23:08.810480 => 12:23:08.832928
[0m12:23:08.835916 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 12:23:08.820956 => 12:23:08.834940
[0m12:23:08.836913 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:23:08.837915 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 12:23:08.826954 => 12:23:08.836913
[0m12:23:08.838908 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m12:23:08.881072 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m12:23:08.882108 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m12:23:08.885275 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m12:23:08.894228 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m12:23:08.895244 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:23:08.897801 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:23:08.900166 [debug] [Thread-1 (]: On model.bq_evo.int_bing_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Bing Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        id,
        MAX(name) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        MAX(CampaignID) as CampaignID
    FROM _raw
    GROUP BY 1
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m12:23:08.901168 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:23:08.901168 [debug] [Thread-2 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        id,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        MAX(CampaignID) as CampaignID
    FROM _raw
    GROUP BY 1
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m12:23:08.908198 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_final AS(
    SELECT *
    FROM _rename_columns
)

SELECT * FROM _final;


[0m12:23:10.084255 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:480223e9-242d-4cc1-bc6f-85b9792d6949&page=queryresults
[0m12:23:10.223443 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:24ca2d7c-f16f-4d31-a9f3-67da92575973&page=queryresults
[0m12:23:10.673872 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 12:23:08.886696 => 12:23:10.672837
[0m12:23:10.675896 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e0cf40-07d2-4aa4-bff0-e0c9de4ac064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91F169ED0>]}
[0m12:23:10.677891 [info ] [Thread-3 (]: 3 of 8 OK created sql view model intermediate.int_google_analytics_all_events .. [[32mCREATE VIEW (0 processed)[0m in 1.87s]
[0m12:23:10.681256 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m12:23:10.684279 [debug] [Thread-4 (]: Began running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:23:10.685283 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_all_campaigns
[0m12:23:10.688452 [info ] [Thread-4 (]: 4 of 8 START sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [RUN]
[0m12:23:10.692442 [info ] [Thread-3 (]: 5 of 8 START sql view model intermediate.int_google_analytics_all_campaigns .... [RUN]
[0m12:23:10.696431 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_analytics_NDG_conversionevents_GA4'
[0m12:23:10.699422 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_events, now model.bq_evo.int_google_analytics_all_campaigns)
[0m12:23:10.701417 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:23:10.703549 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_all_campaigns
[0m12:23:10.713526 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m12:23:10.724021 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m12:23:10.729038 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (compile): 12:23:10.705548 => 12:23:10.728010
[0m12:23:10.733995 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:20ec1196-626d-485f-8b62-9874ced5e585&page=queryresults
[0m12:23:10.734992 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:23:10.738983 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (execute): 12:23:08.838908 => 12:23:10.737986
[0m12:23:10.741974 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (compile): 12:23:10.714523 => 12:23:10.739982
[0m12:23:10.759926 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_all_campaigns
[0m12:23:10.757931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e0cf40-07d2-4aa4-bff0-e0c9de4ac064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91F521490>]}
[0m12:23:10.754940 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m12:23:10.770192 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m12:23:10.772193 [info ] [Thread-1 (]: 1 of 8 OK created sql view model intermediate.int_bing_ads_unique_campaigns .... [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m12:23:10.780171 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:23:10.782167 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:23:10.784161 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:23:10.787152 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:23:10.793254 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_all_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagnen aus GA4 und GA3."""
    )
  as WITH _historic_ua_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
),

ga4_campaigns AS(
    SELECT 
        MAX(Campaign),
        MAX(Partner),
        MAX(Source),
        MAX(Medium),
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
    GROUP BY 5
),

_final AS(
    SELECT * FROM _historic_ua_campaigns
    UNION DISTINCT
    SELECT * FROM ga4_campaigns
)

SELECT * FROM _final;


[0m12:23:10.795132 [info ] [Thread-1 (]: 6 of 8 START sql view model intermediate.int_google_analytics_all_purchases_GA4  [RUN]
[0m12:23:10.797127 [debug] [Thread-4 (]: On model.bq_evo.int_google_analytics_NDG_conversionevents_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle relevanten Conversionevents aus Google Analytics 4 f\u00fcr NDG-Vermarktung. Inklusive aller E-Commerce-Events (ohne Metainformationen)."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
)

_conversions_NDG as(
  SELECT 
    event_date as Date,
    event_name as ZielvorhabenName, 
    CampaignID,
    Source,
    Medium,

    MAX(Partner) as Partner,

    count(event_date) as Conversions,

  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  WHERE (
    event_name = 'lead_form_evo_solar_lp' OR
    event_name = 'evo_solar_pva_check_sent_available' OR
    event_name = 'contact_form_button' OR
    event_name = 'click_online_application' OR
    event_name = 'oss_registration_doi' OR
    event_name = 'click_tarifrechnernutzung' OR
    event_name = 'conversion_solarrechner' OR
    event_name = 'purchase'
  )

  GROUP BY 1,2,3,4,5
),

_added_columns AS(
  SELECT 
      Date,
      ZielvorhabenName,
      LOWER(CONCAT(ZielvorhabenName, Partner)) as ZielvorhabenID,
      CampaignID,
      Source,
      Medium,
      Partner,
      '(not set)' as Keyword,
      '(not set)' as KeywordMatchType,
      Conversions
  FROM _conversions
),

_final AS(
  SELECT *
  FROM _added_columns
)

SELECT * FROM _final;


[0m12:23:10.805113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_unique_campaigns, now model.bq_evo.int_google_analytics_all_purchases_GA4)
[0m12:23:10.817079 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:23:10.830555 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m12:23:10.833548 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (compile): 12:23:10.820581 => 12:23:10.833548
[0m12:23:10.835541 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:23:10.845515 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m12:23:10.848508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:10.849504 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_all_purchases_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_purchases_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle <purchase-events> aus Google Analytics 4. Inkl. aller zugeh\u00f6rigen Metainformationen aus GA4."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_select_purchase_events AS(
  SELECT * FROM _raw
  WHERE event_name = "purchase"
),

_final AS(
    SELECT *
    FROM _select_purchase_events
)

SELECT * FROM _final;


[0m12:23:11.318988 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 12:23:08.883110 => 12:23:11.318988
[0m12:23:11.321985 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e0cf40-07d2-4aa4-bff0-e0c9de4ac064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91F58A8D0>]}
[0m12:23:11.323979 [info ] [Thread-2 (]: 2 of 8 OK created sql view model intermediate.int_google_ads_unique_campaigns .. [[32mCREATE VIEW (0 processed)[0m in 2.52s]
[0m12:23:11.325974 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m12:23:11.327968 [debug] [Thread-2 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:23:11.329964 [info ] [Thread-2 (]: 7 of 8 START sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [RUN]
[0m12:23:11.332955 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_unique_campaigns, now model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names)
[0m12:23:11.333952 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:23:11.342929 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m12:23:11.345921 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (compile): 12:23:11.334950 => 12:23:11.344923
[0m12:23:11.347917 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:23:11.356891 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m12:23:11.359884 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:23:11.361878 [debug] [Thread-2 (]: On model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne inkl. Klartext der Kampagne."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m12:23:12.165202 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ddd6cf56-1689-4358-8c2c-18cb96180741&page=queryresults
[0m12:23:12.275417 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:da735587-e0c8-44ce-a305-ca4d00f04e76&page=queryresults
[0m12:23:12.277412 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "_conversions_NDG" at [13:1]')
[0m12:23:12.362640 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:94281f9d-b3b4-40fd-92a9-ee1c6ced9f32&page=queryresults
[0m12:23:12.542271 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:1e957335-543e-4f33-91e2-faefb4fc603d&page=queryresults
[0m12:23:12.674782 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2e2f40f6-2246-46cc-87b4-11f2c1bec299&page=queryresults
[0m12:23:12.675778 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2e2f40f6-2246-46cc-87b4-11f2c1bec299&page=queryresults
[0m12:23:12.677746 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (execute): 12:23:10.745964 => 12:23:12.677746
[0m12:23:12.686741 [debug] [Thread-4 (]: Database Error in model int_google_analytics_NDG_conversionevents_GA4 (models\intermediate\google_analytics\int_google_analytics_NDG_conversionevents_GA4.sql)
  Syntax error: Unexpected identifier "_conversions_NDG" at [13:1]
  compiled Code at target\run\bq_evo\models\intermediate\google_analytics\int_google_analytics_NDG_conversionevents_GA4.sql
[0m12:23:12.688716 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e0cf40-07d2-4aa4-bff0-e0c9de4ac064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91F51C310>]}
[0m12:23:12.689712 [error] [Thread-4 (]: 4 of 8 ERROR creating sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [[31mERROR[0m in 1.99s]
[0m12:23:12.691707 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:23:12.692705 [debug] [Thread-4 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m12:23:12.693702 [info ] [Thread-4 (]: 8 of 8 START sql view model intermediate.int_google_ads_campaign_stats ......... [RUN]
[0m12:23:12.699689 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_NDG_conversionevents_GA4, now model.bq_evo.int_google_ads_campaign_stats)
[0m12:23:12.702678 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m12:23:12.713655 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m12:23:12.715650 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 12:23:12.704674 => 12:23:12.715650
[0m12:23:12.717651 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m12:23:12.726139 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m12:23:12.728134 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:23:12.730129 [debug] [Thread-4 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
),

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m12:23:12.926215 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (execute): 12:23:10.836538 => 12:23:12.926215
[0m12:23:12.927212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e0cf40-07d2-4aa4-bff0-e0c9de4ac064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91F426F10>]}
[0m12:23:12.928420 [info ] [Thread-1 (]: 6 of 8 OK created sql view model intermediate.int_google_analytics_all_purchases_GA4  [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m12:23:12.929422 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:23:13.095777 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (execute): 12:23:10.761922 => 12:23:13.094783
[0m12:23:13.096767 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e0cf40-07d2-4aa4-bff0-e0c9de4ac064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91F152010>]}
[0m12:23:13.098762 [info ] [Thread-3 (]: 5 of 8 OK created sql view model intermediate.int_google_analytics_all_campaigns  [[32mCREATE VIEW (0 processed)[0m in 2.40s]
[0m12:23:13.100757 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_all_campaigns
[0m12:23:13.233509 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (execute): 12:23:11.349909 => 12:23:13.233509
[0m12:23:13.234508 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e0cf40-07d2-4aa4-bff0-e0c9de4ac064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91F427D10>]}
[0m12:23:13.235489 [info ] [Thread-2 (]: 7 of 8 OK created sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.90s]
[0m12:23:13.236467 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:23:13.467019 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6dfdf57d-3513-4041-a1c7-7e799ab6026f&page=queryresults
[0m12:23:14.263667 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 12:23:12.718642 => 12:23:14.263667
[0m12:23:14.265665 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e0cf40-07d2-4aa4-bff0-e0c9de4ac064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91F14E090>]}
[0m12:23:14.266659 [info ] [Thread-4 (]: 8 of 8 OK created sql view model intermediate.int_google_ads_campaign_stats .... [[32mCREATE VIEW (0 processed)[0m in 1.57s]
[0m12:23:14.267654 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m12:23:14.270672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:14.270672 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m12:23:14.271677 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m12:23:14.271677 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m12:23:14.272663 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m12:23:14.272663 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_purchases_GA4' was properly closed.
[0m12:23:14.273672 [debug] [MainThread]: Connection 'model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names' was properly closed.
[0m12:23:14.274642 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_campaigns' was properly closed.
[0m12:23:14.274642 [debug] [MainThread]: Connection 'model.bq_evo.int_google_ads_campaign_stats' was properly closed.
[0m12:23:14.275652 [info ] [MainThread]: 
[0m12:23:14.276630 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 8.53 seconds (8.53s).
[0m12:23:14.282613 [debug] [MainThread]: Command end result
[0m12:23:14.300577 [info ] [MainThread]: 
[0m12:23:14.301563 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:23:14.303558 [info ] [MainThread]: 
[0m12:23:14.304555 [error] [MainThread]:   Database Error in model int_google_analytics_NDG_conversionevents_GA4 (models\intermediate\google_analytics\int_google_analytics_NDG_conversionevents_GA4.sql)
  Syntax error: Unexpected identifier "_conversions_NDG" at [13:1]
  compiled Code at target\run\bq_evo\models\intermediate\google_analytics\int_google_analytics_NDG_conversionevents_GA4.sql
[0m12:23:14.306558 [info ] [MainThread]: 
[0m12:23:14.307549 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m12:23:14.308544 [debug] [MainThread]: Command `dbt run` failed at 12:23:14.308544 after 9.26 seconds
[0m12:23:14.309541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91E05E7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91DB0D650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91DB0D590>]}
[0m12:23:14.310563 [debug] [MainThread]: Flushing usage events
[0m12:24:39.179463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C416EF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C46A8510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C46418D0>]}


============================== 12:24:39.184450 | 7c171e91-a194-40b4-98bd-a0fb0716ba1e ==============================
[0m12:24:39.184450 [info ] [MainThread]: Running with dbt=1.6.2
[0m12:24:39.185448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh -m intermediate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:24:39.530584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c171e91-a194-40b4-98bd-a0fb0716ba1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C5D31810>]}
[0m12:24:39.539560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c171e91-a194-40b4-98bd-a0fb0716ba1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C4169110>]}
[0m12:24:39.540557 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m12:24:39.591801 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m12:24:39.693060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:24:39.694060 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\google_analytics\int_google_analytics_NDG_conversionevents_GA4.sql
[0m12:24:39.768555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c171e91-a194-40b4-98bd-a0fb0716ba1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C6076DD0>]}
[0m12:24:39.791911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c171e91-a194-40b4-98bd-a0fb0716ba1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C6198110>]}
[0m12:24:39.792910 [info ] [MainThread]: Found 17 models, 17 tests, 10 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m12:24:39.794460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c171e91-a194-40b4-98bd-a0fb0716ba1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C5CF6990>]}
[0m12:24:39.796487 [info ] [MainThread]: 
[0m12:24:39.797452 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:24:39.799478 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m12:24:39.799478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:42.117676 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m12:24:42.121615 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m12:24:42.122613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:42.126219 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m12:24:42.128173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:42.132359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:42.832776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c171e91-a194-40b4-98bd-a0fb0716ba1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C59125D0>]}
[0m12:24:42.837815 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:24:42.840749 [info ] [MainThread]: 
[0m12:24:42.855081 [debug] [Thread-1 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:24:42.857076 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m12:24:42.859072 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m12:24:42.862061 [info ] [Thread-1 (]: 1 of 8 START sql view model intermediate.int_bing_ads_unique_campaigns ......... [RUN]
[0m12:24:42.865051 [info ] [Thread-2 (]: 2 of 8 START sql view model intermediate.int_google_ads_unique_campaigns ....... [RUN]
[0m12:24:42.868043 [info ] [Thread-3 (]: 3 of 8 START sql view model intermediate.int_google_analytics_all_events ....... [RUN]
[0m12:24:42.872035 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_bing_ads_unique_campaigns'
[0m12:24:42.875023 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_ads_unique_campaigns'
[0m12:24:42.877056 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_analytics_all_events'
[0m12:24:42.879012 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:24:42.880044 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m12:24:42.881007 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m12:24:42.892012 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m12:24:42.895998 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m12:24:42.898989 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m12:24:42.900956 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (compile): 12:24:42.882005 => 12:24:42.899984
[0m12:24:42.901949 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 12:24:42.893007 => 12:24:42.901949
[0m12:24:42.902944 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:24:42.903941 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 12:24:42.896998 => 12:24:42.902944
[0m12:24:42.904939 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m12:24:42.940427 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m12:24:42.940427 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m12:24:42.944416 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m12:24:42.948403 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m12:24:42.949401 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:24:42.950365 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:24:42.951365 [debug] [Thread-1 (]: On model.bq_evo.int_bing_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Bing Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        id,
        MAX(name) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        MAX(CampaignID) as CampaignID
    FROM _raw
    GROUP BY 1
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m12:24:42.952363 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:24:42.953360 [debug] [Thread-2 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        id,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        MAX(CampaignID) as CampaignID
    FROM _raw
    GROUP BY 1
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m12:24:42.956350 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_final AS(
    SELECT *
    FROM _rename_columns
)

SELECT * FROM _final;


[0m12:24:43.750611 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:0109e721-c492-4b55-91c7-e4dc4486e3e4&page=queryresults
[0m12:24:43.756457 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4b7b8cc4-88a1-4951-96c4-2c52b30934b6&page=queryresults
[0m12:24:43.785092 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6c09bcf9-1d63-43f6-9c56-22f2c58dad41&page=queryresults
[0m12:24:44.311115 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (execute): 12:24:42.905973 => 12:24:44.311115
[0m12:24:44.313073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c171e91-a194-40b4-98bd-a0fb0716ba1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C6162A10>]}
[0m12:24:44.314071 [info ] [Thread-1 (]: 1 of 8 OK created sql view model intermediate.int_bing_ads_unique_campaigns .... [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m12:24:44.316085 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:24:44.317066 [debug] [Thread-4 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:24:44.318063 [info ] [Thread-4 (]: 4 of 8 START sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [RUN]
[0m12:24:44.319061 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names'
[0m12:24:44.320059 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:24:44.321057 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 12:24:42.941424 => 12:24:44.321057
[0m12:24:44.324047 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m12:24:44.325068 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c171e91-a194-40b4-98bd-a0fb0716ba1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C5D3E810>]}
[0m12:24:44.327065 [info ] [Thread-2 (]: 2 of 8 OK created sql view model intermediate.int_google_ads_unique_campaigns .. [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m12:24:44.328065 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (compile): 12:24:44.322088 => 12:24:44.328065
[0m12:24:44.329564 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m12:24:44.330570 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:24:44.331316 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m12:24:44.335343 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m12:24:44.335343 [info ] [Thread-1 (]: 5 of 8 START sql view model intermediate.int_google_ads_campaign_stats ......... [RUN]
[0m12:24:44.337303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_unique_campaigns, now model.bq_evo.int_google_ads_campaign_stats)
[0m12:24:44.339299 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:24:44.340296 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m12:24:44.341293 [debug] [Thread-4 (]: On model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne inkl. Klartext der Kampagne."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m12:24:44.345316 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m12:24:44.349271 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 12:24:44.342290 => 12:24:44.348300
[0m12:24:44.350269 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m12:24:44.353295 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m12:24:44.355254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:44.356252 [debug] [Thread-1 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
),

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m12:24:44.435675 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 12:24:42.945380 => 12:24:44.435675
[0m12:24:44.436706 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c171e91-a194-40b4-98bd-a0fb0716ba1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C5872610>]}
[0m12:24:44.438678 [info ] [Thread-3 (]: 3 of 8 OK created sql view model intermediate.int_google_analytics_all_events .. [[32mCREATE VIEW (0 processed)[0m in 1.56s]
[0m12:24:44.439665 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m12:24:44.440701 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:24:44.441660 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_all_campaigns
[0m12:24:44.441660 [info ] [Thread-2 (]: 6 of 8 START sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [RUN]
[0m12:24:44.443655 [info ] [Thread-3 (]: 7 of 8 START sql view model intermediate.int_google_analytics_all_campaigns .... [RUN]
[0m12:24:44.444652 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_unique_campaigns, now model.bq_evo.int_google_analytics_NDG_conversionevents_GA4)
[0m12:24:44.445649 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_events, now model.bq_evo.int_google_analytics_all_campaigns)
[0m12:24:44.446647 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:24:44.446647 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_all_campaigns
[0m12:24:44.450636 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m12:24:44.454626 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m12:24:44.457619 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (compile): 12:24:44.447644 => 12:24:44.456621
[0m12:24:44.459612 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (compile): 12:24:44.450636 => 12:24:44.458615
[0m12:24:44.460610 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:24:44.462605 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_all_campaigns
[0m12:24:44.466607 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m12:24:44.482551 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m12:24:44.484546 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:24:44.486542 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_all_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagnen aus GA4 und GA3."""
    )
  as WITH _historic_ua_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
),

ga4_campaigns AS(
    SELECT 
        MAX(Campaign),
        MAX(Partner),
        MAX(Source),
        MAX(Medium),
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
    GROUP BY 5
),

_final AS(
    SELECT * FROM _historic_ua_campaigns
    UNION DISTINCT
    SELECT * FROM ga4_campaigns
)

SELECT * FROM _final;


[0m12:24:44.489533 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:24:44.491527 [debug] [Thread-2 (]: On model.bq_evo.int_google_analytics_NDG_conversionevents_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle relevanten Conversionevents aus Google Analytics 4 f\u00fcr NDG-Vermarktung. Inklusive aller E-Commerce-Events (ohne Metainformationen)."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_conversions_NDG as(
  SELECT 
    event_date as Date,
    event_name as ZielvorhabenName, 
    CampaignID,
    Source,
    Medium,

    MAX(Partner) as Partner,

    count(event_date) as Conversions,

  FROM _raw
  WHERE (
    event_name = 'lead_form_evo_solar_lp' OR
    event_name = 'evo_solar_pva_check_sent_available' OR
    event_name = 'contact_form_button' OR
    event_name = 'click_online_application' OR
    event_name = 'oss_registration_doi' OR
    event_name = 'click_tarifrechnernutzung' OR
    event_name = 'conversion_solarrechner' OR
    event_name = 'purchase'
  )

  GROUP BY 1,2,3,4,5
),

_added_columns AS(
  SELECT 
      Date,
      ZielvorhabenName,
      LOWER(CONCAT(ZielvorhabenName, Partner)) as ZielvorhabenID,
      CampaignID,
      Source,
      Medium,
      Partner,
      '(not set)' as Keyword,
      '(not set)' as KeywordMatchType,
      Conversions
  FROM _conversions_NDG
),

_final AS(
  SELECT *
  FROM _added_columns
)

SELECT * FROM _final;


[0m12:24:45.179871 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:eb6a3a73-17e0-4e3a-b7d3-39fe5a470723&page=queryresults
[0m12:24:45.297711 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:af6b94a1-b11e-4139-bd93-0c19148e2de6&page=queryresults
[0m12:24:45.315594 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:850b73fe-6af9-433e-844a-08eca1f74536&page=queryresults
[0m12:24:45.850727 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:78a2eed4-cde7-4701-89c7-2b4c84bd5e83&page=queryresults
[0m12:24:45.879750 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (execute): 12:24:44.462605 => 12:24:45.879750
[0m12:24:45.880747 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c171e91-a194-40b4-98bd-a0fb0716ba1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C6199890>]}
[0m12:24:45.881741 [info ] [Thread-2 (]: 6 of 8 OK created sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m12:24:45.883739 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:24:45.884698 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:24:45.885697 [info ] [Thread-2 (]: 8 of 8 START sql view model intermediate.int_google_analytics_all_purchases_GA4  [RUN]
[0m12:24:45.886693 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_NDG_conversionevents_GA4, now model.bq_evo.int_google_analytics_all_purchases_GA4)
[0m12:24:45.887725 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:24:45.891717 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m12:24:45.892712 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (compile): 12:24:45.888725 => 12:24:45.892712
[0m12:24:45.894675 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:24:45.898661 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m12:24:45.899695 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (execute): 12:24:44.332316 => 12:24:45.899695
[0m12:24:45.901656 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c171e91-a194-40b4-98bd-a0fb0716ba1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C6201810>]}
[0m12:24:45.904647 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:24:45.902652 [info ] [Thread-4 (]: 4 of 8 OK created sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.58s]
[0m12:24:45.905646 [debug] [Thread-2 (]: On model.bq_evo.int_google_analytics_all_purchases_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_purchases_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle <purchase-events> aus Google Analytics 4. Inkl. aller zugeh\u00f6rigen Metainformationen aus GA4."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_select_purchase_events AS(
  SELECT * FROM _raw
  WHERE event_name = "purchase"
),

_final AS(
    SELECT *
    FROM _select_purchase_events
)

SELECT * FROM _final;


[0m12:24:45.906641 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:24:46.005246 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (execute): 12:24:44.467591 => 12:24:46.004216
[0m12:24:46.006211 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c171e91-a194-40b4-98bd-a0fb0716ba1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C6296010>]}
[0m12:24:46.006211 [info ] [Thread-3 (]: 7 of 8 OK created sql view model intermediate.int_google_analytics_all_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.56s]
[0m12:24:46.008207 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_all_campaigns
[0m12:24:46.323195 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 12:24:44.350269 => 12:24:46.322198
[0m12:24:46.324192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c171e91-a194-40b4-98bd-a0fb0716ba1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C605ED90>]}
[0m12:24:46.325197 [info ] [Thread-1 (]: 5 of 8 OK created sql view model intermediate.int_google_ads_campaign_stats .... [[32mCREATE VIEW (0 processed)[0m in 1.99s]
[0m12:24:46.326186 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m12:24:46.714505 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a93c72ee-7b78-4657-951e-c0300812020f&page=queryresults
[0m12:24:47.511049 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (execute): 12:24:45.894675 => 12:24:47.510073
[0m12:24:47.512067 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c171e91-a194-40b4-98bd-a0fb0716ba1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C618C5D0>]}
[0m12:24:47.513038 [info ] [Thread-2 (]: 8 of 8 OK created sql view model intermediate.int_google_analytics_all_purchases_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m12:24:47.515030 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:24:47.516991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:47.516991 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m12:24:47.517988 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m12:24:47.517988 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m12:24:47.518985 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m12:24:47.518985 [debug] [MainThread]: Connection 'model.bq_evo.int_google_ads_campaign_stats' was properly closed.
[0m12:24:47.520023 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_purchases_GA4' was properly closed.
[0m12:24:47.520980 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_campaigns' was properly closed.
[0m12:24:47.520980 [debug] [MainThread]: Connection 'model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names' was properly closed.
[0m12:24:47.521980 [info ] [MainThread]: 
[0m12:24:47.522980 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 7.72 seconds (7.72s).
[0m12:24:47.524975 [debug] [MainThread]: Command end result
[0m12:24:47.537450 [info ] [MainThread]: 
[0m12:24:47.538451 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:24:47.539450 [info ] [MainThread]: 
[0m12:24:47.540446 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:24:47.541443 [debug] [MainThread]: Command `dbt run` succeeded at 12:24:47.541443 after 8.38 seconds
[0m12:24:47.542440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C416C150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C40167D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BEA273D0>]}
[0m12:24:47.542440 [debug] [MainThread]: Flushing usage events
[0m12:25:06.879802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001122CA71190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001122C50D810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001122CA5FC10>]}


============================== 12:25:06.883828 | 530d6fcd-6174-421d-b1e5-e7ff5899348b ==============================
[0m12:25:06.883828 [info ] [MainThread]: Running with dbt=1.6.2
[0m12:25:06.884860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test -m intermediate', 'send_anonymous_usage_stats': 'True'}
[0m12:25:07.222871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '530d6fcd-6174-421d-b1e5-e7ff5899348b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001122D6A1110>]}
[0m12:25:07.230850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '530d6fcd-6174-421d-b1e5-e7ff5899348b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001122D654E90>]}
[0m12:25:07.232811 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m12:25:07.282748 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m12:25:07.367077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:07.368074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:07.375055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '530d6fcd-6174-421d-b1e5-e7ff5899348b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001122CA72A90>]}
[0m12:25:07.393014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '530d6fcd-6174-421d-b1e5-e7ff5899348b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001122DE442D0>]}
[0m12:25:07.394021 [info ] [MainThread]: Found 17 models, 17 tests, 10 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m12:25:07.395007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '530d6fcd-6174-421d-b1e5-e7ff5899348b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001122D2F0450>]}
[0m12:25:07.396515 [info ] [MainThread]: 
[0m12:25:07.397515 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:25:07.400520 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m12:25:07.400520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:07.401538 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m12:25:07.402502 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m12:25:07.403499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:07.403499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:10.038648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '530d6fcd-6174-421d-b1e5-e7ff5899348b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001122DF0B690>]}
[0m12:25:10.041641 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:25:10.042697 [info ] [MainThread]: 
[0m12:25:10.047729 [debug] [Thread-1 (]: Began running node test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422
[0m12:25:10.047729 [debug] [Thread-2 (]: Began running node test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227
[0m12:25:10.048728 [debug] [Thread-3 (]: Began running node test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd
[0m12:25:10.049684 [debug] [Thread-4 (]: Began running node test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f
[0m12:25:10.048728 [info ] [Thread-1 (]: 1 of 11 START test not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID  [RUN]
[0m12:25:10.051680 [info ] [Thread-2 (]: 2 of 11 START test not_null_int_bing_ads_unique_campaigns_CampaignID ........... [RUN]
[0m12:25:10.052677 [info ] [Thread-3 (]: 3 of 11 START test not_null_int_google_ads_campaign_stats_CampaignID ........... [RUN]
[0m12:25:10.054672 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422'
[0m12:25:10.053674 [info ] [Thread-4 (]: 4 of 11 START test not_null_int_google_ads_unique_campaigns_CampaignID ......... [RUN]
[0m12:25:10.056699 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227'
[0m12:25:10.057664 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd'
[0m12:25:10.058695 [debug] [Thread-1 (]: Began compiling node test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422
[0m12:25:10.059659 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f'
[0m12:25:10.060658 [debug] [Thread-2 (]: Began compiling node test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227
[0m12:25:10.061653 [debug] [Thread-3 (]: Began compiling node test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd
[0m12:25:10.080635 [debug] [Thread-1 (]: Writing injected SQL for node "test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422"
[0m12:25:10.080635 [debug] [Thread-4 (]: Began compiling node test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f
[0m12:25:10.085621 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227"
[0m12:25:10.089614 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd"
[0m12:25:10.095599 [debug] [Thread-4 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f"
[0m12:25:10.096596 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422 (compile): 12:25:10.062651 => 12:25:10.096596
[0m12:25:10.098590 [debug] [Thread-1 (]: Began executing node test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422
[0m12:25:10.099594 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227 (compile): 12:25:10.081634 => 12:25:10.099594
[0m12:25:10.118853 [debug] [Thread-1 (]: Writing runtime sql for node "test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422"
[0m12:25:10.119819 [debug] [Thread-4 (]: Timing info for test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f (compile): 12:25:10.091617 => 12:25:10.118853
[0m12:25:10.119819 [debug] [Thread-2 (]: Began executing node test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227
[0m12:25:10.120815 [debug] [Thread-3 (]: Timing info for test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd (compile): 12:25:10.085621 => 12:25:10.120815
[0m12:25:10.122811 [debug] [Thread-4 (]: Began executing node test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f
[0m12:25:10.126799 [debug] [Thread-2 (]: Writing runtime sql for node "test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227"
[0m12:25:10.127830 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:25:10.128793 [debug] [Thread-3 (]: Began executing node test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd
[0m12:25:10.131819 [debug] [Thread-4 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f"
[0m12:25:10.132785 [debug] [Thread-1 (]: On test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:25:10.136807 [debug] [Thread-3 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd"
[0m12:25:10.136807 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:25:10.142773 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:25:10.143759 [debug] [Thread-2 (]: On test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:25:10.144761 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:25:10.145750 [debug] [Thread-4 (]: On test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:25:10.147776 [debug] [Thread-3 (]: On test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:25:11.144126 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:f557642b-d45d-4515-b9b3-033c7efb7710&page=queryresults
[0m12:25:11.278101 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3039ad4b-6d98-452d-bfc6-9242bc627f43&page=queryresults
[0m12:25:11.304451 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:21f2dad1-9007-42e2-8a1f-36e40c41fe95&page=queryresults
[0m12:25:11.387879 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6e133e44-f3f7-4b34-ad27-f1ba63c1de36&page=queryresults
[0m12:25:11.485429 [debug] [Thread-4 (]: Timing info for test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f (execute): 12:25:10.128793 => 12:25:11.485429
[0m12:25:11.489385 [info ] [Thread-4 (]: 4 of 11 PASS not_null_int_google_ads_unique_campaigns_CampaignID ............... [[32mPASS[0m in 1.43s]
[0m12:25:11.492383 [debug] [Thread-4 (]: Finished running node test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f
[0m12:25:11.495382 [debug] [Thread-4 (]: Began running node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4
[0m12:25:11.503367 [info ] [Thread-4 (]: 5 of 11 START test not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID  [RUN]
[0m12:25:11.509065 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f, now test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4)
[0m12:25:11.510029 [debug] [Thread-4 (]: Began compiling node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4
[0m12:25:11.514052 [debug] [Thread-4 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4"
[0m12:25:11.516014 [debug] [Thread-4 (]: Timing info for test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4 (compile): 12:25:11.510029 => 12:25:11.516014
[0m12:25:11.517010 [debug] [Thread-4 (]: Began executing node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4
[0m12:25:11.520035 [debug] [Thread-4 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4"
[0m12:25:11.521996 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:25:11.522995 [debug] [Thread-4 (]: On test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:25:11.582866 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227 (execute): 12:25:10.123812 => 12:25:11.581834
[0m12:25:11.583832 [info ] [Thread-2 (]: 2 of 11 PASS not_null_int_bing_ads_unique_campaigns_CampaignID ................. [[32mPASS[0m in 1.53s]
[0m12:25:11.587852 [debug] [Thread-2 (]: Finished running node test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227
[0m12:25:11.588816 [debug] [Thread-2 (]: Began running node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c
[0m12:25:11.589815 [info ] [Thread-2 (]: 6 of 11 START test not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID  [RUN]
[0m12:25:11.590816 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227, now test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c)
[0m12:25:11.592808 [debug] [Thread-2 (]: Began compiling node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c
[0m12:25:11.597829 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c"
[0m12:25:11.599789 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c (compile): 12:25:11.592808 => 12:25:11.598824
[0m12:25:11.600787 [debug] [Thread-2 (]: Began executing node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c
[0m12:25:11.606315 [debug] [Thread-2 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c"
[0m12:25:11.608342 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422 (execute): 12:25:10.099594 => 12:25:11.608342
[0m12:25:11.609306 [info ] [Thread-1 (]: 1 of 11 PASS not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID  [[32mPASS[0m in 1.55s]
[0m12:25:11.611306 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:25:11.612320 [debug] [Thread-1 (]: Finished running node test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422
[0m12:25:11.613304 [debug] [Thread-2 (]: On test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ZielvorhabenID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
where ZielvorhabenID is null



      
    ) dbt_internal_test
[0m12:25:11.614294 [debug] [Thread-1 (]: Began running node test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c
[0m12:25:11.617287 [info ] [Thread-1 (]: 7 of 11 START test not_null_int_google_analytics_all_campaigns_CampaignID ...... [RUN]
[0m12:25:11.619294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422, now test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c)
[0m12:25:11.619294 [debug] [Thread-1 (]: Began compiling node test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c
[0m12:25:11.625314 [debug] [Thread-1 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c"
[0m12:25:11.626295 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c (compile): 12:25:11.620323 => 12:25:11.626295
[0m12:25:11.627258 [debug] [Thread-1 (]: Began executing node test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c
[0m12:25:11.631284 [debug] [Thread-1 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c"
[0m12:25:11.633243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:11.634241 [debug] [Thread-1 (]: On test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:25:11.688095 [debug] [Thread-3 (]: Timing info for test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd (execute): 12:25:10.133787 => 12:25:11.688095
[0m12:25:11.689092 [info ] [Thread-3 (]: 3 of 11 PASS not_null_int_google_ads_campaign_stats_CampaignID ................. [[32mPASS[0m in 1.63s]
[0m12:25:11.691101 [debug] [Thread-3 (]: Finished running node test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd
[0m12:25:11.691101 [debug] [Thread-3 (]: Began running node test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2
[0m12:25:11.692087 [info ] [Thread-3 (]: 8 of 11 START test not_null_int_google_analytics_all_events_CampaignID ......... [RUN]
[0m12:25:11.694115 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd, now test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2)
[0m12:25:11.695113 [debug] [Thread-3 (]: Began compiling node test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2
[0m12:25:11.705563 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2"
[0m12:25:11.707559 [debug] [Thread-3 (]: Timing info for test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2 (compile): 12:25:11.696076 => 12:25:11.707559
[0m12:25:11.708556 [debug] [Thread-3 (]: Began executing node test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2
[0m12:25:11.713542 [debug] [Thread-3 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2"
[0m12:25:11.715538 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:25:11.716535 [debug] [Thread-3 (]: On test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:25:12.469731 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:d49453cb-1850-45e6-be7c-80c179cd55ea&page=queryresults
[0m12:25:12.993497 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5dcd836f-bec9-4d5f-b150-8010b90c19ab&page=queryresults
[0m12:25:12.997525 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:688fdda7-7740-4cf8-9aaa-8d6fca3f3c11&page=queryresults
[0m12:25:13.118519 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2ec91450-be29-493c-b4ec-6ccf1c2863e0&page=queryresults
[0m12:25:18.582382 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c (execute): 12:25:11.628255 => 12:25:18.581427
[0m12:25:18.584412 [info ] [Thread-1 (]: 7 of 11 PASS not_null_int_google_analytics_all_campaigns_CampaignID ............ [[32mPASS[0m in 6.97s]
[0m12:25:18.586372 [debug] [Thread-1 (]: Finished running node test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c
[0m12:25:18.587406 [debug] [Thread-1 (]: Began running node test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e
[0m12:25:18.588402 [info ] [Thread-1 (]: 9 of 11 START test not_null_int_google_analytics_all_purchases_GA4_CampaignID .. [RUN]
[0m12:25:18.590361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c, now test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e)
[0m12:25:18.591357 [debug] [Thread-1 (]: Began compiling node test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e
[0m12:25:18.598372 [debug] [Thread-1 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e"
[0m12:25:18.601371 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e (compile): 12:25:18.592356 => 12:25:18.600369
[0m12:25:18.602327 [debug] [Thread-1 (]: Began executing node test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e
[0m12:25:18.613351 [debug] [Thread-1 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e"
[0m12:25:18.615347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:18.616344 [debug] [Thread-1 (]: On test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:25:18.725191 [debug] [Thread-4 (]: Timing info for test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4 (execute): 12:25:11.518008 => 12:25:18.725191
[0m12:25:18.726221 [info ] [Thread-4 (]: 5 of 11 PASS not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID . [[32mPASS[0m in 7.22s]
[0m12:25:18.728195 [debug] [Thread-4 (]: Finished running node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4
[0m12:25:18.729229 [debug] [Thread-4 (]: Began running node test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906
[0m12:25:18.730183 [info ] [Thread-4 (]: 10 of 11 START test unique_int_bing_ads_unique_campaigns_CampaignID ............ [RUN]
[0m12:25:18.731175 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4, now test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906)
[0m12:25:18.732205 [debug] [Thread-4 (]: Began compiling node test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906
[0m12:25:18.738190 [debug] [Thread-4 (]: Writing injected SQL for node "test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906"
[0m12:25:18.740155 [debug] [Thread-4 (]: Timing info for test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906 (compile): 12:25:18.732205 => 12:25:18.739186
[0m12:25:18.740155 [debug] [Thread-4 (]: Began executing node test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906
[0m12:25:18.743179 [debug] [Thread-4 (]: Writing runtime sql for node "test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906"
[0m12:25:18.745139 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:25:18.746167 [debug] [Thread-4 (]: On test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select CampaignID as unique_field
  from `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  where CampaignID is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:25:18.768075 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c (execute): 12:25:11.602808 => 12:25:18.768075
[0m12:25:18.769106 [info ] [Thread-2 (]: 6 of 11 PASS not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID  [[32mPASS[0m in 7.18s]
[0m12:25:18.771080 [debug] [Thread-2 (]: Finished running node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c
[0m12:25:18.771080 [debug] [Thread-2 (]: Began running node test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee
[0m12:25:18.772066 [info ] [Thread-2 (]: 11 of 11 START test unique_int_google_ads_unique_campaigns_CampaignID .......... [RUN]
[0m12:25:18.774093 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c, now test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee)
[0m12:25:18.774093 [debug] [Thread-2 (]: Began compiling node test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee
[0m12:25:18.779047 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee"
[0m12:25:18.781042 [debug] [Thread-2 (]: Timing info for test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee (compile): 12:25:18.775058 => 12:25:18.781042
[0m12:25:18.782039 [debug] [Thread-2 (]: Began executing node test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee
[0m12:25:18.785034 [debug] [Thread-2 (]: Writing runtime sql for node "test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee"
[0m12:25:18.788029 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:25:18.788029 [debug] [Thread-2 (]: On test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select CampaignID as unique_field
  from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  where CampaignID is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:25:19.235838 [debug] [Thread-3 (]: Timing info for test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2 (execute): 12:25:11.709554 => 12:25:19.234841
[0m12:25:19.236836 [info ] [Thread-3 (]: 8 of 11 PASS not_null_int_google_analytics_all_events_CampaignID ............... [[32mPASS[0m in 7.54s]
[0m12:25:19.237799 [debug] [Thread-3 (]: Finished running node test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2
[0m12:25:19.364117 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:abd13143-38ba-44bf-b933-01ca568858c2&page=queryresults
[0m12:25:19.684463 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:13bbef04-02ed-428e-8b08-5fd0f56809ad&page=queryresults
[0m12:25:19.715092 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:58cc837f-a024-4411-a953-f4d71285c64f&page=queryresults
[0m12:25:19.950914 [debug] [Thread-2 (]: Timing info for test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee (execute): 12:25:18.782039 => 12:25:19.949912
[0m12:25:19.953861 [error] [Thread-2 (]: 11 of 11 FAIL 1 unique_int_google_ads_unique_campaigns_CampaignID .............. [[31mFAIL 1[0m in 1.18s]
[0m12:25:19.954855 [debug] [Thread-2 (]: Finished running node test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee
[0m12:25:19.984322 [debug] [Thread-4 (]: Timing info for test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906 (execute): 12:25:18.741181 => 12:25:19.984322
[0m12:25:19.985314 [info ] [Thread-4 (]: 10 of 11 PASS unique_int_bing_ads_unique_campaigns_CampaignID .................. [[32mPASS[0m in 1.25s]
[0m12:25:19.987291 [debug] [Thread-4 (]: Finished running node test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906
[0m12:25:26.320036 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e (execute): 12:25:18.602327 => 12:25:26.319040
[0m12:25:26.322011 [info ] [Thread-1 (]: 9 of 11 PASS not_null_int_google_analytics_all_purchases_GA4_CampaignID ........ [[32mPASS[0m in 7.73s]
[0m12:25:26.322987 [debug] [Thread-1 (]: Finished running node test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e
[0m12:25:26.326001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:26.326001 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m12:25:26.326965 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m12:25:26.326965 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m12:25:26.327962 [debug] [MainThread]: Connection 'test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e' was properly closed.
[0m12:25:26.328962 [debug] [MainThread]: Connection 'test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee' was properly closed.
[0m12:25:26.329979 [debug] [MainThread]: Connection 'test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2' was properly closed.
[0m12:25:26.330967 [debug] [MainThread]: Connection 'test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906' was properly closed.
[0m12:25:26.331954 [info ] [MainThread]: 
[0m12:25:26.332949 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 18.93 seconds (18.93s).
[0m12:25:26.336939 [debug] [MainThread]: Command end result
[0m12:25:26.351936 [info ] [MainThread]: 
[0m12:25:26.352901 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:25:26.354898 [info ] [MainThread]: 
[0m12:25:26.355893 [error] [MainThread]: [31mFailure in test unique_int_google_ads_unique_campaigns_CampaignID (models\intermediate\schema.yml)[0m
[0m12:25:26.356889 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:25:26.356889 [info ] [MainThread]: 
[0m12:25:26.358365 [info ] [MainThread]:   compiled Code at target\compiled\bq_evo\models\intermediate\schema.yml\unique_int_google_ads_unique_campaigns_CampaignID.sql
[0m12:25:26.359364 [info ] [MainThread]: 
[0m12:25:26.360393 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m12:25:26.362354 [debug] [MainThread]: Command `dbt test` failed at 12:25:26.361362 after 19.50 seconds
[0m12:25:26.362354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001122C1E30D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001122CA5E650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001122C43C150>]}
[0m12:25:26.363350 [debug] [MainThread]: Flushing usage events
[0m12:30:27.700998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541B271910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541AC13190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541A743A10>]}


============================== 12:30:27.703985 | 7e97202c-06cc-455c-a947-4d5f79690a0f ==============================
[0m12:30:27.703985 [info ] [MainThread]: Running with dbt=1.6.2
[0m12:30:27.705821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh -m intermediate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:30:28.053781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e97202c-06cc-455c-a947-4d5f79690a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541BECAA10>]}
[0m12:30:28.061759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e97202c-06cc-455c-a947-4d5f79690a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541AC40510>]}
[0m12:30:28.063725 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m12:30:28.115162 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m12:30:28.203967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:30:28.204965 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\google_ads\int_google_ads_unique_campaigns.sql
[0m12:30:28.263807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e97202c-06cc-455c-a947-4d5f79690a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541C34D6D0>]}
[0m12:30:28.280764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e97202c-06cc-455c-a947-4d5f79690a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541C7DEB50>]}
[0m12:30:28.281762 [info ] [MainThread]: Found 17 models, 17 tests, 10 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m12:30:28.282759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e97202c-06cc-455c-a947-4d5f79690a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541BFE2A10>]}
[0m12:30:28.284753 [info ] [MainThread]: 
[0m12:30:28.286748 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:30:28.287745 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m12:30:28.288777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:30.727046 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m12:30:30.728005 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m12:30:30.729002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:30.730000 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m12:30:30.730000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:30.733027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:31.402658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e97202c-06cc-455c-a947-4d5f79690a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541BFE2A10>]}
[0m12:30:31.406637 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:30:31.409631 [info ] [MainThread]: 
[0m12:30:31.420508 [debug] [Thread-1 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:30:31.421512 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m12:30:31.422548 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m12:30:31.423505 [info ] [Thread-1 (]: 1 of 8 START sql view model intermediate.int_bing_ads_unique_campaigns ......... [RUN]
[0m12:30:31.424506 [info ] [Thread-2 (]: 2 of 8 START sql view model intermediate.int_google_ads_unique_campaigns ....... [RUN]
[0m12:30:31.426503 [info ] [Thread-3 (]: 3 of 8 START sql view model intermediate.int_google_analytics_all_events ....... [RUN]
[0m12:30:31.428529 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_bing_ads_unique_campaigns'
[0m12:30:31.429492 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_ads_unique_campaigns'
[0m12:30:31.430522 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_analytics_all_events'
[0m12:30:31.431519 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:30:31.432481 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m12:30:31.433478 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m12:30:31.442457 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m12:30:31.445481 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m12:30:31.448472 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m12:30:31.450432 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (compile): 12:30:31.434476 => 12:30:31.449435
[0m12:30:31.451429 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 12:30:31.443490 => 12:30:31.451429
[0m12:30:31.452429 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:30:31.453429 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 12:30:31.446489 => 12:30:31.452429
[0m12:30:31.453429 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m12:30:31.486336 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m12:30:31.487336 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m12:30:31.491360 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m12:30:31.496345 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m12:30:31.496345 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:30:31.498306 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:30:31.499304 [debug] [Thread-1 (]: On model.bq_evo.int_bing_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Bing Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        id,
        MAX(name) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        MAX(CampaignID) as CampaignID
    FROM _raw
    GROUP BY 1
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m12:30:31.500304 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:30:31.500304 [debug] [Thread-2 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id),
        MAX(campaign),
        MAX(Source),
        MAX(Medium),
        MAX(Partner),
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m12:30:31.502802 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_final AS(
    SELECT *
    FROM _rename_columns
)

SELECT * FROM _final;


[0m12:30:32.444997 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:08ff62ae-0008-4980-bd48-eadc4bc64ff2&page=queryresults
[0m12:30:32.449027 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7b7350e0-78bc-4669-93b8-b8178e695921&page=queryresults
[0m12:30:32.463848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:71175df9-1777-4822-a48f-d8ad966abd15&page=queryresults
[0m12:30:32.680645 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW columns must be named, but column 1 has no name at [8:6]')
[0m12:30:33.011025 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (execute): 12:30:31.454422 => 12:30:33.011025
[0m12:30:33.012983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e97202c-06cc-455c-a947-4d5f79690a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541C2D62D0>]}
[0m12:30:33.014004 [info ] [Thread-1 (]: 1 of 8 OK created sql view model intermediate.int_bing_ads_unique_campaigns .... [[32mCREATE VIEW (0 processed)[0m in 1.59s]
[0m12:30:33.015976 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:30:33.016975 [debug] [Thread-4 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:30:33.017969 [info ] [Thread-4 (]: 4 of 8 START sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [RUN]
[0m12:30:33.019977 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names'
[0m12:30:33.019977 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:30:33.022993 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m12:30:33.024952 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (compile): 12:30:33.020973 => 12:30:33.023987
[0m12:30:33.025958 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:30:33.028971 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m12:30:33.029976 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:30:33.030936 [debug] [Thread-4 (]: On model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne inkl. Klartext der Kampagne."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m12:30:33.048368 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 12:30:31.492324 => 12:30:33.048368
[0m12:30:33.049362 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e97202c-06cc-455c-a947-4d5f79690a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541C734710>]}
[0m12:30:33.050393 [info ] [Thread-3 (]: 3 of 8 OK created sql view model intermediate.int_google_analytics_all_events .. [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m12:30:33.051391 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m12:30:33.053354 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:30:33.053354 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_all_campaigns
[0m12:30:33.054385 [info ] [Thread-1 (]: 5 of 8 START sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [RUN]
[0m12:30:33.056345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_unique_campaigns, now model.bq_evo.int_google_analytics_NDG_conversionevents_GA4)
[0m12:30:33.055349 [info ] [Thread-3 (]: 6 of 8 START sql view model intermediate.int_google_analytics_all_campaigns .... [RUN]
[0m12:30:33.056345 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:30:33.057376 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_events, now model.bq_evo.int_google_analytics_all_campaigns)
[0m12:30:33.061330 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m12:30:33.062328 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_all_campaigns
[0m12:30:33.066332 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m12:30:33.067316 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (compile): 12:30:33.058341 => 12:30:33.067316
[0m12:30:33.069310 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:30:33.070306 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (compile): 12:30:33.063325 => 12:30:33.070306
[0m12:30:33.073334 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m12:30:33.074330 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_all_campaigns
[0m12:30:33.079316 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m12:30:33.080282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:33.081278 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_NDG_conversionevents_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle relevanten Conversionevents aus Google Analytics 4 f\u00fcr NDG-Vermarktung. Inklusive aller E-Commerce-Events (ohne Metainformationen)."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_conversions_NDG as(
  SELECT 
    event_date as Date,
    event_name as ZielvorhabenName, 
    CampaignID,
    Source,
    Medium,

    MAX(Partner) as Partner,

    count(event_date) as Conversions,

  FROM _raw
  WHERE (
    event_name = 'lead_form_evo_solar_lp' OR
    event_name = 'evo_solar_pva_check_sent_available' OR
    event_name = 'contact_form_button' OR
    event_name = 'click_online_application' OR
    event_name = 'oss_registration_doi' OR
    event_name = 'click_tarifrechnernutzung' OR
    event_name = 'conversion_solarrechner' OR
    event_name = 'purchase'
  )

  GROUP BY 1,2,3,4,5
),

_added_columns AS(
  SELECT 
      Date,
      ZielvorhabenName,
      LOWER(CONCAT(ZielvorhabenName, Partner)) as ZielvorhabenID,
      CampaignID,
      Source,
      Medium,
      Partner,
      '(not set)' as Keyword,
      '(not set)' as KeywordMatchType,
      Conversions
  FROM _conversions_NDG
),

_final AS(
  SELECT *
  FROM _added_columns
)

SELECT * FROM _final;


[0m12:30:33.082276 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:30:33.085267 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_all_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagnen aus GA4 und GA3."""
    )
  as WITH _historic_ua_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
),

ga4_campaigns AS(
    SELECT 
        MAX(Campaign),
        MAX(Partner),
        MAX(Source),
        MAX(Medium),
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
    GROUP BY 5
),

_final AS(
    SELECT * FROM _historic_ua_campaigns
    UNION DISTINCT
    SELECT * FROM ga4_campaigns
)

SELECT * FROM _final;


[0m12:30:33.557555 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:bbe42f42-e400-4806-9a71-624b1d7ad0bb&page=queryresults
[0m12:30:33.753470 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:bbe42f42-e400-4806-9a71-624b1d7ad0bb&page=queryresults
[0m12:30:33.757441 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 12:30:31.488335 => 12:30:33.756442
[0m12:30:33.767411 [debug] [Thread-2 (]: Database Error in model int_google_ads_unique_campaigns (models\intermediate\google_ads\int_google_ads_unique_campaigns.sql)
  CREATE VIEW columns must be named, but column 1 has no name at [8:6]
  compiled Code at target\run\bq_evo\models\intermediate\google_ads\int_google_ads_unique_campaigns.sql
[0m12:30:33.768421 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e97202c-06cc-455c-a947-4d5f79690a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541C879610>]}
[0m12:30:33.769406 [error] [Thread-2 (]: 2 of 8 ERROR creating sql view model intermediate.int_google_ads_unique_campaigns  [[31mERROR[0m in 2.34s]
[0m12:30:33.771402 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m12:30:33.773399 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:30:33.775392 [info ] [Thread-2 (]: 7 of 8 START sql view model intermediate.int_google_analytics_all_purchases_GA4  [RUN]
[0m12:30:33.777385 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_unique_campaigns, now model.bq_evo.int_google_analytics_all_purchases_GA4)
[0m12:30:33.777385 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:30:33.781408 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m12:30:33.783371 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (compile): 12:30:33.778408 => 12:30:33.783371
[0m12:30:33.784370 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:30:33.796337 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m12:30:33.798333 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:30:33.799329 [debug] [Thread-2 (]: On model.bq_evo.int_google_analytics_all_purchases_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_purchases_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle <purchase-events> aus Google Analytics 4. Inkl. aller zugeh\u00f6rigen Metainformationen aus GA4."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_select_purchase_events AS(
  SELECT * FROM _raw
  WHERE event_name = "purchase"
),

_final AS(
    SELECT *
    FROM _select_purchase_events
)

SELECT * FROM _final;


[0m12:30:33.855695 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:fdb18e99-19ac-4a93-ba73-e89566f38c84&page=queryresults
[0m12:30:33.902606 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:024c9953-d809-40ff-8ecd-fc45b9ef774e&page=queryresults
[0m12:30:33.950990 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:9639009d-851c-4bde-8a46-9927dadf789e&page=queryresults
[0m12:30:34.459654 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2742d6b4-71a2-48f9-9f01-da1c9830dafb&page=queryresults
[0m12:30:34.479489 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (execute): 12:30:33.075295 => 12:30:34.479489
[0m12:30:34.482475 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e97202c-06cc-455c-a947-4d5f79690a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541C88E490>]}
[0m12:30:34.483417 [info ] [Thread-3 (]: 6 of 8 OK created sql view model intermediate.int_google_analytics_all_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m12:30:34.484413 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_all_campaigns
[0m12:30:34.485427 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m12:30:34.485427 [info ] [Thread-3 (]: 8 of 8 SKIP relation intermediate.int_google_ads_campaign_stats ................ [[33mSKIP[0m]
[0m12:30:34.486415 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m12:30:34.566372 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (execute): 12:30:33.025958 => 12:30:34.566372
[0m12:30:34.567332 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e97202c-06cc-455c-a947-4d5f79690a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541C73AFD0>]}
[0m12:30:34.568333 [info ] [Thread-4 (]: 4 of 8 OK created sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.55s]
[0m12:30:34.569328 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:30:34.632292 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (execute): 12:30:33.070306 => 12:30:34.632292
[0m12:30:34.633330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e97202c-06cc-455c-a947-4d5f79690a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541C756610>]}
[0m12:30:34.635287 [info ] [Thread-1 (]: 5 of 8 OK created sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.58s]
[0m12:30:34.637299 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:30:35.183130 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (execute): 12:30:33.785371 => 12:30:35.182134
[0m12:30:35.184160 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e97202c-06cc-455c-a947-4d5f79690a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541C7D4110>]}
[0m12:30:35.185119 [info ] [Thread-2 (]: 7 of 8 OK created sql view model intermediate.int_google_analytics_all_purchases_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m12:30:35.186115 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:30:35.188144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:35.189109 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m12:30:35.189109 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m12:30:35.190137 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m12:30:35.190137 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m12:30:35.191101 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_NDG_conversionevents_GA4' was properly closed.
[0m12:30:35.191101 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_purchases_GA4' was properly closed.
[0m12:30:35.192099 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_campaigns' was properly closed.
[0m12:30:35.192099 [debug] [MainThread]: Connection 'model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names' was properly closed.
[0m12:30:35.193130 [info ] [MainThread]: 
[0m12:30:35.194140 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 6.91 seconds (6.91s).
[0m12:30:35.198119 [debug] [MainThread]: Command end result
[0m12:30:35.209351 [info ] [MainThread]: 
[0m12:30:35.211343 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:30:35.211343 [info ] [MainThread]: 
[0m12:30:35.212338 [error] [MainThread]:   Database Error in model int_google_ads_unique_campaigns (models\intermediate\google_ads\int_google_ads_unique_campaigns.sql)
  CREATE VIEW columns must be named, but column 1 has no name at [8:6]
  compiled Code at target\run\bq_evo\models\intermediate\google_ads\int_google_ads_unique_campaigns.sql
[0m12:30:35.214341 [info ] [MainThread]: 
[0m12:30:35.215331 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
[0m12:30:35.217338 [debug] [MainThread]: Command `dbt run` failed at 12:30:35.217338 after 7.53 seconds
[0m12:30:35.217338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541A78C150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541A75E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001541A76E710>]}
[0m12:30:35.218322 [debug] [MainThread]: Flushing usage events
[0m12:32:22.993843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EA7461D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EA61C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EA77DD50>]}


============================== 12:32:22.997832 | 47900371-2daa-418c-8377-059b4cec680f ==============================
[0m12:32:22.997832 [info ] [MainThread]: Running with dbt=1.6.2
[0m12:32:22.998887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh -m intermediate', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:32:23.345506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47900371-2daa-418c-8377-059b4cec680f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EC34DC50>]}
[0m12:32:23.353486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47900371-2daa-418c-8377-059b4cec680f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EA769E90>]}
[0m12:32:23.355446 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m12:32:23.408337 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m12:32:23.493749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:23.494746 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\google_ads\int_google_ads_unique_campaigns.sql
[0m12:32:23.552619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47900371-2daa-418c-8377-059b4cec680f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EC6A1910>]}
[0m12:32:23.572099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47900371-2daa-418c-8377-059b4cec680f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EC70A990>]}
[0m12:32:23.572099 [info ] [MainThread]: Found 17 models, 17 tests, 10 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m12:32:23.573108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47900371-2daa-418c-8377-059b4cec680f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EC7408D0>]}
[0m12:32:23.575106 [info ] [MainThread]: 
[0m12:32:23.576068 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:32:23.578559 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m12:32:23.579229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:25.957202 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m12:32:25.959203 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m12:32:25.960240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:25.962218 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m12:32:25.963196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:25.967179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:26.658161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47900371-2daa-418c-8377-059b4cec680f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EC370190>]}
[0m12:32:26.662159 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:32:26.665146 [info ] [MainThread]: 
[0m12:32:26.678459 [debug] [Thread-1 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:32:26.679457 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m12:32:26.680457 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m12:32:26.681453 [info ] [Thread-1 (]: 1 of 8 START sql view model intermediate.int_bing_ads_unique_campaigns ......... [RUN]
[0m12:32:26.683447 [info ] [Thread-2 (]: 2 of 8 START sql view model intermediate.int_google_ads_unique_campaigns ....... [RUN]
[0m12:32:26.685442 [info ] [Thread-3 (]: 3 of 8 START sql view model intermediate.int_google_analytics_all_events ....... [RUN]
[0m12:32:26.687436 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_bing_ads_unique_campaigns'
[0m12:32:26.688432 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_ads_unique_campaigns'
[0m12:32:26.690427 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_analytics_all_events'
[0m12:32:26.691428 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:32:26.692423 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m12:32:26.693421 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m12:32:26.702394 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m12:32:26.706383 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m12:32:26.710408 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m12:32:26.712365 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (compile): 12:32:26.694416 => 12:32:26.711397
[0m12:32:26.713366 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 12:32:26.703391 => 12:32:26.713366
[0m12:32:26.714363 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:32:26.715373 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 12:32:26.707379 => 12:32:26.715373
[0m12:32:26.716355 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m12:32:26.750851 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m12:32:26.751826 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m12:32:26.755806 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m12:32:26.760793 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m12:32:26.761815 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:32:26.763793 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:32:26.764804 [debug] [Thread-1 (]: On model.bq_evo.int_bing_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Bing Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        id,
        MAX(name) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        MAX(CampaignID) as CampaignID
    FROM _raw
    GROUP BY 1
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m12:32:26.764804 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:32:26.765778 [debug] [Thread-2 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id ,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m12:32:26.768773 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_final AS(
    SELECT *
    FROM _rename_columns
)

SELECT * FROM _final;


[0m12:32:27.562834 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2cbe01f7-1704-4ad8-8d2a-188b750e4937&page=queryresults
[0m12:32:27.563832 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:bc821c6b-26f3-4510-94b1-6cf78c00eff9&page=queryresults
[0m12:32:27.630994 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:b4c9a6c2-1b64-4842-96ae-5cd15b00b3e4&page=queryresults
[0m12:32:28.159941 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 12:32:26.751826 => 12:32:28.159941
[0m12:32:28.160900 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47900371-2daa-418c-8377-059b4cec680f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EC34DB50>]}
[0m12:32:28.161933 [info ] [Thread-2 (]: 2 of 8 OK created sql view model intermediate.int_google_ads_unique_campaigns .. [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m12:32:28.162898 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m12:32:28.163927 [debug] [Thread-4 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m12:32:28.164893 [info ] [Thread-4 (]: 4 of 8 START sql view model intermediate.int_google_ads_campaign_stats ......... [RUN]
[0m12:32:28.166888 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_ads_campaign_stats'
[0m12:32:28.167707 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m12:32:28.170702 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m12:32:28.172696 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 12:32:28.167707 => 12:32:28.171699
[0m12:32:28.172696 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m12:32:28.179680 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m12:32:28.181673 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:32:28.182670 [debug] [Thread-4 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
),

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m12:32:28.317452 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 12:32:26.756841 => 12:32:28.317452
[0m12:32:28.318427 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47900371-2daa-418c-8377-059b4cec680f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EC2F5E50>]}
[0m12:32:28.320411 [info ] [Thread-3 (]: 3 of 8 OK created sql view model intermediate.int_google_analytics_all_events .. [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m12:32:28.321409 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m12:32:28.322407 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:32:28.323404 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_all_campaigns
[0m12:32:28.323404 [info ] [Thread-2 (]: 5 of 8 START sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [RUN]
[0m12:32:28.324400 [info ] [Thread-3 (]: 6 of 8 START sql view model intermediate.int_google_analytics_all_campaigns .... [RUN]
[0m12:32:28.326396 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_unique_campaigns, now model.bq_evo.int_google_analytics_NDG_conversionevents_GA4)
[0m12:32:28.328427 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (execute): 12:32:26.716355 => 12:32:28.327392
[0m12:32:28.328427 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_events, now model.bq_evo.int_google_analytics_all_campaigns)
[0m12:32:28.329421 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:32:28.331383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47900371-2daa-418c-8377-059b4cec680f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EC3BBCD0>]}
[0m12:32:28.331383 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_all_campaigns
[0m12:32:28.337375 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m12:32:28.338402 [info ] [Thread-1 (]: 1 of 8 OK created sql view model intermediate.int_bing_ads_unique_campaigns .... [[32mCREATE VIEW (0 processed)[0m in 1.64s]
[0m12:32:28.342391 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m12:32:28.344355 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m12:32:28.346347 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (compile): 12:32:28.332382 => 12:32:28.345352
[0m12:32:28.347351 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:32:28.349843 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:32:28.350845 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (compile): 12:32:28.339365 => 12:32:28.349843
[0m12:32:28.351843 [info ] [Thread-1 (]: 7 of 8 START sql view model intermediate.int_google_analytics_all_purchases_GA4  [RUN]
[0m12:32:28.357826 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m12:32:28.358823 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_all_campaigns
[0m12:32:28.359825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_unique_campaigns, now model.bq_evo.int_google_analytics_all_purchases_GA4)
[0m12:32:28.366807 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m12:32:28.367811 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:32:28.367811 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:32:28.371824 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m12:32:28.372786 [debug] [Thread-2 (]: On model.bq_evo.int_google_analytics_NDG_conversionevents_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle relevanten Conversionevents aus Google Analytics 4 f\u00fcr NDG-Vermarktung. Inklusive aller E-Commerce-Events (ohne Metainformationen)."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_conversions_NDG as(
  SELECT 
    event_date as Date,
    event_name as ZielvorhabenName, 
    CampaignID,
    Source,
    Medium,

    MAX(Partner) as Partner,

    count(event_date) as Conversions,

  FROM _raw
  WHERE (
    event_name = 'lead_form_evo_solar_lp' OR
    event_name = 'evo_solar_pva_check_sent_available' OR
    event_name = 'contact_form_button' OR
    event_name = 'click_online_application' OR
    event_name = 'oss_registration_doi' OR
    event_name = 'click_tarifrechnernutzung' OR
    event_name = 'conversion_solarrechner' OR
    event_name = 'purchase'
  )

  GROUP BY 1,2,3,4,5
),

_added_columns AS(
  SELECT 
      Date,
      ZielvorhabenName,
      LOWER(CONCAT(ZielvorhabenName, Partner)) as ZielvorhabenID,
      CampaignID,
      Source,
      Medium,
      Partner,
      '(not set)' as Keyword,
      '(not set)' as KeywordMatchType,
      Conversions
  FROM _conversions_NDG
),

_final AS(
  SELECT *
  FROM _added_columns
)

SELECT * FROM _final;


[0m12:32:28.373783 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:32:28.376775 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_all_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagnen aus GA4 und GA3."""
    )
  as WITH _historic_ua_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
),

ga4_campaigns AS(
    SELECT 
        MAX(Campaign),
        MAX(Partner),
        MAX(Source),
        MAX(Medium),
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
    GROUP BY 5
),

_final AS(
    SELECT * FROM _historic_ua_campaigns
    UNION DISTINCT
    SELECT * FROM ga4_campaigns
)

SELECT * FROM _final;


[0m12:32:28.377781 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (compile): 12:32:28.368805 => 12:32:28.377781
[0m12:32:28.383766 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:32:28.391735 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m12:32:28.392732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:28.393731 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_all_purchases_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_purchases_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle <purchase-events> aus Google Analytics 4. Inkl. aller zugeh\u00f6rigen Metainformationen aus GA4."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_select_purchase_events AS(
  SELECT * FROM _raw
  WHERE event_name = "purchase"
),

_final AS(
    SELECT *
    FROM _select_purchase_events
)

SELECT * FROM _final;


[0m12:32:29.069678 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:f4f76b5b-5713-450d-ace2-f95e8206bbc0&page=queryresults
[0m12:32:29.183735 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2ae40966-63ab-4622-a511-300a2eb25595&page=queryresults
[0m12:32:29.239452 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:50f4257d-6695-4d26-9c32-64870d441c6d&page=queryresults
[0m12:32:29.263291 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:19809630-5ba7-43e7-8470-344a6872370a&page=queryresults
[0m12:32:29.539862 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 12:32:28.173694 => 12:32:29.538848
[0m12:32:29.542841 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47900371-2daa-418c-8377-059b4cec680f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EC65FB10>]}
[0m12:32:29.542841 [info ] [Thread-4 (]: 4 of 8 OK created sql view model intermediate.int_google_ads_campaign_stats .... [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m12:32:29.544794 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m12:32:29.544794 [debug] [Thread-4 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:32:29.545827 [info ] [Thread-4 (]: 8 of 8 START sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [RUN]
[0m12:32:29.546788 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_campaign_stats, now model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names)
[0m12:32:29.547787 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:32:29.550814 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m12:32:29.551776 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (compile): 12:32:29.547787 => 12:32:29.551776
[0m12:32:29.553304 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:32:29.557330 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m12:32:29.559299 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:32:29.560296 [debug] [Thread-4 (]: On model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne inkl. Klartext der Kampagne."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m12:32:29.696042 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (execute): 12:32:28.384754 => 12:32:29.696042
[0m12:32:29.697005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47900371-2daa-418c-8377-059b4cec680f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EC636050>]}
[0m12:32:29.698003 [info ] [Thread-1 (]: 7 of 8 OK created sql view model intermediate.int_google_analytics_all_purchases_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m12:32:29.699000 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m12:32:29.946614 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (execute): 12:32:28.360818 => 12:32:29.946614
[0m12:32:29.947649 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47900371-2daa-418c-8377-059b4cec680f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EC7ECE50>]}
[0m12:32:29.948608 [info ] [Thread-3 (]: 6 of 8 OK created sql view model intermediate.int_google_analytics_all_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m12:32:29.949604 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_all_campaigns
[0m12:32:29.968140 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (execute): 12:32:28.352840 => 12:32:29.967142
[0m12:32:29.969137 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47900371-2daa-418c-8377-059b4cec680f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EC80AED0>]}
[0m12:32:29.970134 [info ] [Thread-2 (]: 5 of 8 OK created sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.64s]
[0m12:32:29.971131 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m12:32:30.210803 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e34a9954-3c53-4202-92d7-7b51b393a04a&page=queryresults
[0m12:32:30.686491 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (execute): 12:32:29.554310 => 12:32:30.685494
[0m12:32:30.688482 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47900371-2daa-418c-8377-059b4cec680f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EC7EFFD0>]}
[0m12:32:30.689221 [info ] [Thread-4 (]: 8 of 8 OK created sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m12:32:30.689862 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m12:32:30.692893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:30.692893 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m12:32:30.693890 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m12:32:30.693890 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m12:32:30.694852 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m12:32:30.694852 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_purchases_GA4' was properly closed.
[0m12:32:30.695851 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_NDG_conversionevents_GA4' was properly closed.
[0m12:32:30.696849 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_campaigns' was properly closed.
[0m12:32:30.697844 [debug] [MainThread]: Connection 'model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names' was properly closed.
[0m12:32:30.698844 [info ] [MainThread]: 
[0m12:32:30.699839 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 7.12 seconds (7.12s).
[0m12:32:30.702864 [debug] [MainThread]: Command end result
[0m12:32:30.716803 [info ] [MainThread]: 
[0m12:32:30.717791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:30.718789 [info ] [MainThread]: 
[0m12:32:30.719807 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:32:30.721785 [debug] [MainThread]: Command `dbt run` succeeded at 12:32:30.721785 after 7.74 seconds
[0m12:32:30.721785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EA7FE810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EACAC150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7EA80BED0>]}
[0m12:32:30.722780 [debug] [MainThread]: Flushing usage events
[0m12:32:44.129224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EC173D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EB9A8090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EC1713D0>]}


============================== 12:32:44.132215 | ecd905b3-44a2-4144-b8bc-bb897329e6dc ==============================
[0m12:32:44.132215 [info ] [MainThread]: Running with dbt=1.6.2
[0m12:32:44.133668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test -m intermediate', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:32:44.470662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecd905b3-44a2-4144-b8bc-bb897329e6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3ECF1DB10>]}
[0m12:32:44.479637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecd905b3-44a2-4144-b8bc-bb897329e6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3ED352810>]}
[0m12:32:44.480602 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m12:32:44.534017 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m12:32:44.625426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:32:44.625426 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:32:44.632407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecd905b3-44a2-4144-b8bc-bb897329e6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3ED61CA50>]}
[0m12:32:44.649355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecd905b3-44a2-4144-b8bc-bb897329e6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3ED680550>]}
[0m12:32:44.650348 [info ] [MainThread]: Found 17 models, 17 tests, 10 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m12:32:44.652321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecd905b3-44a2-4144-b8bc-bb897329e6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EADA56D0>]}
[0m12:32:44.654350 [info ] [MainThread]: 
[0m12:32:44.655312 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:32:44.657670 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m12:32:44.658670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:44.659670 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m12:32:44.660685 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m12:32:44.661665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:44.662660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:47.207429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecd905b3-44a2-4144-b8bc-bb897329e6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3ED232150>]}
[0m12:32:47.210464 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:32:47.213987 [info ] [MainThread]: 
[0m12:32:47.227958 [debug] [Thread-1 (]: Began running node test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422
[0m12:32:47.228953 [debug] [Thread-2 (]: Began running node test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227
[0m12:32:47.229950 [debug] [Thread-3 (]: Began running node test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd
[0m12:32:47.231946 [debug] [Thread-4 (]: Began running node test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f
[0m12:32:47.232942 [info ] [Thread-1 (]: 1 of 11 START test not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID  [RUN]
[0m12:32:47.234938 [info ] [Thread-2 (]: 2 of 11 START test not_null_int_bing_ads_unique_campaigns_CampaignID ........... [RUN]
[0m12:32:47.235934 [info ] [Thread-3 (]: 3 of 11 START test not_null_int_google_ads_campaign_stats_CampaignID ........... [RUN]
[0m12:32:47.238930 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422'
[0m12:32:47.236931 [info ] [Thread-4 (]: 4 of 11 START test not_null_int_google_ads_unique_campaigns_CampaignID ......... [RUN]
[0m12:32:47.240922 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227'
[0m12:32:47.242950 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd'
[0m12:32:47.243913 [debug] [Thread-1 (]: Began compiling node test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422
[0m12:32:47.244943 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f'
[0m12:32:47.246905 [debug] [Thread-2 (]: Began compiling node test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227
[0m12:32:47.247901 [debug] [Thread-3 (]: Began compiling node test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd
[0m12:32:47.265887 [debug] [Thread-1 (]: Writing injected SQL for node "test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422"
[0m12:32:47.266851 [debug] [Thread-4 (]: Began compiling node test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f
[0m12:32:47.270873 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227"
[0m12:32:47.274870 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd"
[0m12:32:47.280869 [debug] [Thread-4 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f"
[0m12:32:47.281866 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422 (compile): 12:32:47.248937 => 12:32:47.281866
[0m12:32:47.283861 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227 (compile): 12:32:47.266851 => 12:32:47.283861
[0m12:32:47.284877 [debug] [Thread-1 (]: Began executing node test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422
[0m12:32:47.285856 [debug] [Thread-3 (]: Timing info for test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd (compile): 12:32:47.271871 => 12:32:47.285856
[0m12:32:47.287850 [debug] [Thread-2 (]: Began executing node test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227
[0m12:32:47.288848 [debug] [Thread-4 (]: Timing info for test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f (compile): 12:32:47.275879 => 12:32:47.287850
[0m12:32:47.306838 [debug] [Thread-1 (]: Writing runtime sql for node "test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422"
[0m12:32:47.307908 [debug] [Thread-3 (]: Began executing node test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd
[0m12:32:47.310474 [debug] [Thread-2 (]: Writing runtime sql for node "test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227"
[0m12:32:47.311473 [debug] [Thread-4 (]: Began executing node test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f
[0m12:32:47.314971 [debug] [Thread-3 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd"
[0m12:32:47.315969 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:32:47.319993 [debug] [Thread-4 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f"
[0m12:32:47.320991 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:32:47.322952 [debug] [Thread-1 (]: On test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:32:47.323950 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:32:47.324945 [debug] [Thread-2 (]: On test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:32:47.325943 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:32:47.328971 [debug] [Thread-3 (]: On test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:32:47.331927 [debug] [Thread-4 (]: On test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:32:48.296771 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:075de55b-fc8b-4eda-97e0-cc0f170e76f4&page=queryresults
[0m12:32:48.360886 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a5df64c1-b04d-44ea-8be8-2a33da362709&page=queryresults
[0m12:32:48.451955 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:41c9543c-75da-4d76-8bed-bd45e1c6b281&page=queryresults
[0m12:32:48.585480 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:22a5bcb6-49c6-47cc-a2e4-b0a7525f42c6&page=queryresults
[0m12:32:48.630521 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227 (execute): 12:32:47.308477 => 12:32:48.630521
[0m12:32:48.632481 [info ] [Thread-2 (]: 2 of 11 PASS not_null_int_bing_ads_unique_campaigns_CampaignID ................. [[32mPASS[0m in 1.39s]
[0m12:32:48.633477 [debug] [Thread-2 (]: Finished running node test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227
[0m12:32:48.635266 [debug] [Thread-2 (]: Began running node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4
[0m12:32:48.636267 [info ] [Thread-2 (]: 5 of 11 START test not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID  [RUN]
[0m12:32:48.637306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bq_evo.not_null_int_bing_ads_unique_campaigns_CampaignID.5214e7b227, now test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4)
[0m12:32:48.638316 [debug] [Thread-2 (]: Began compiling node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4
[0m12:32:48.644280 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4"
[0m12:32:48.647238 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4 (compile): 12:32:48.639259 => 12:32:48.646303
[0m12:32:48.648236 [debug] [Thread-2 (]: Began executing node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4
[0m12:32:48.651227 [debug] [Thread-2 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4"
[0m12:32:48.653222 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:32:48.654219 [debug] [Thread-2 (]: On test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:32:48.677208 [debug] [Thread-4 (]: Timing info for test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f (execute): 12:32:47.316973 => 12:32:48.677208
[0m12:32:48.679202 [info ] [Thread-4 (]: 4 of 11 PASS not_null_int_google_ads_unique_campaigns_CampaignID ............... [[32mPASS[0m in 1.43s]
[0m12:32:48.681213 [debug] [Thread-4 (]: Finished running node test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f
[0m12:32:48.682230 [debug] [Thread-4 (]: Began running node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c
[0m12:32:48.682230 [info ] [Thread-4 (]: 6 of 11 START test not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID  [RUN]
[0m12:32:48.684187 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bq_evo.not_null_int_google_ads_unique_campaigns_CampaignID.b78d28588f, now test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c)
[0m12:32:48.685185 [debug] [Thread-4 (]: Began compiling node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c
[0m12:32:48.690335 [debug] [Thread-4 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c"
[0m12:32:48.691333 [debug] [Thread-4 (]: Timing info for test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c (compile): 12:32:48.686343 => 12:32:48.691333
[0m12:32:48.692331 [debug] [Thread-4 (]: Began executing node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c
[0m12:32:48.696319 [debug] [Thread-4 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c"
[0m12:32:48.700309 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:32:48.704353 [debug] [Thread-4 (]: On test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ZielvorhabenID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
where ZielvorhabenID is null



      
    ) dbt_internal_test
[0m12:32:48.813654 [debug] [Thread-3 (]: Timing info for test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd (execute): 12:32:47.312479 => 12:32:48.813654
[0m12:32:48.815644 [info ] [Thread-3 (]: 3 of 11 PASS not_null_int_google_ads_campaign_stats_CampaignID ................. [[32mPASS[0m in 1.57s]
[0m12:32:48.819173 [debug] [Thread-3 (]: Finished running node test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd
[0m12:32:48.820249 [debug] [Thread-3 (]: Began running node test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c
[0m12:32:48.821172 [info ] [Thread-3 (]: 7 of 11 START test not_null_int_google_analytics_all_campaigns_CampaignID ...... [RUN]
[0m12:32:48.823165 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bq_evo.not_null_int_google_ads_campaign_stats_CampaignID.2475301ffd, now test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c)
[0m12:32:48.823165 [debug] [Thread-3 (]: Began compiling node test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c
[0m12:32:48.828174 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c"
[0m12:32:48.830146 [debug] [Thread-3 (]: Timing info for test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c (compile): 12:32:48.824162 => 12:32:48.830146
[0m12:32:48.831144 [debug] [Thread-3 (]: Began executing node test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c
[0m12:32:48.834136 [debug] [Thread-3 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c"
[0m12:32:48.836138 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:32:48.837127 [debug] [Thread-3 (]: On test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:32:48.903983 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422 (execute): 12:32:47.288848 => 12:32:48.903983
[0m12:32:48.906016 [info ] [Thread-1 (]: 1 of 11 PASS not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID  [[32mPASS[0m in 1.67s]
[0m12:32:48.907975 [debug] [Thread-1 (]: Finished running node test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422
[0m12:32:48.909007 [debug] [Thread-1 (]: Began running node test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2
[0m12:32:48.909969 [info ] [Thread-1 (]: 8 of 11 START test not_null_int_google_analytics_all_events_CampaignID ......... [RUN]
[0m12:32:48.911965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.bq_evo.not_null_int_bing_ads_campaign_performance_joined_campaign_names_CampaignID.5c326b9422, now test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2)
[0m12:32:48.911965 [debug] [Thread-1 (]: Began compiling node test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2
[0m12:32:48.916951 [debug] [Thread-1 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2"
[0m12:32:48.917948 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2 (compile): 12:32:48.912961 => 12:32:48.917948
[0m12:32:48.919456 [debug] [Thread-1 (]: Began executing node test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2
[0m12:32:48.922451 [debug] [Thread-1 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2"
[0m12:32:48.923448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:48.924448 [debug] [Thread-1 (]: On test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:32:49.482509 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:645977fe-a3d4-4ef3-a1ed-1ad2d13fb84b&page=queryresults
[0m12:32:49.484485 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8c3d54a8-d341-4a43-a2f1-54404fc2ce36&page=queryresults
[0m12:32:49.584254 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:0aa17897-0d41-4c7b-9b3f-c4b35696690d&page=queryresults
[0m12:32:49.646221 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:bc3aff97-dfb3-43ee-9204-519f69127688&page=queryresults
[0m12:32:55.672877 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4 (execute): 12:32:48.648236 => 12:32:55.672877
[0m12:32:55.673838 [info ] [Thread-2 (]: 5 of 11 PASS not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID . [[32mPASS[0m in 7.04s]
[0m12:32:55.675833 [debug] [Thread-2 (]: Finished running node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4
[0m12:32:55.676830 [debug] [Thread-2 (]: Began running node test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e
[0m12:32:55.676830 [info ] [Thread-2 (]: 9 of 11 START test not_null_int_google_analytics_all_purchases_GA4_CampaignID .. [RUN]
[0m12:32:55.678858 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_CampaignID.a44c364cf4, now test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e)
[0m12:32:55.678858 [debug] [Thread-2 (]: Began compiling node test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e
[0m12:32:55.683845 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e"
[0m12:32:55.685810 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e (compile): 12:32:55.679823 => 12:32:55.684842
[0m12:32:55.686802 [debug] [Thread-2 (]: Began executing node test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e
[0m12:32:55.695812 [debug] [Thread-2 (]: Writing runtime sql for node "test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e"
[0m12:32:55.697780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:32:55.698781 [debug] [Thread-2 (]: On test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:32:56.098935 [debug] [Thread-3 (]: Timing info for test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c (execute): 12:32:48.832141 => 12:32:56.098935
[0m12:32:56.099932 [info ] [Thread-3 (]: 7 of 11 PASS not_null_int_google_analytics_all_campaigns_CampaignID ............ [[32mPASS[0m in 7.28s]
[0m12:32:56.101926 [debug] [Thread-3 (]: Finished running node test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c
[0m12:32:56.101926 [debug] [Thread-3 (]: Began running node test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906
[0m12:32:56.102922 [info ] [Thread-3 (]: 10 of 11 START test unique_int_bing_ads_unique_campaigns_CampaignID ............ [RUN]
[0m12:32:56.104918 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bq_evo.not_null_int_google_analytics_all_campaigns_CampaignID.1e0bcee97c, now test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906)
[0m12:32:56.105916 [debug] [Thread-3 (]: Began compiling node test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906
[0m12:32:56.111933 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906"
[0m12:32:56.113893 [debug] [Thread-3 (]: Timing info for test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906 (compile): 12:32:56.105916 => 12:32:56.112931
[0m12:32:56.114898 [debug] [Thread-3 (]: Began executing node test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906
[0m12:32:56.116918 [debug] [Thread-3 (]: Writing runtime sql for node "test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906"
[0m12:32:56.118442 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:32:56.119441 [debug] [Thread-3 (]: On test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select CampaignID as unique_field
  from `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  where CampaignID is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:32:56.303969 [debug] [Thread-4 (]: Timing info for test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c (execute): 12:32:48.693329 => 12:32:56.303969
[0m12:32:56.304966 [info ] [Thread-4 (]: 6 of 11 PASS not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID  [[32mPASS[0m in 7.62s]
[0m12:32:56.306928 [debug] [Thread-4 (]: Finished running node test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c
[0m12:32:56.307925 [debug] [Thread-4 (]: Began running node test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee
[0m12:32:56.308922 [info ] [Thread-4 (]: 11 of 11 START test unique_int_google_ads_unique_campaigns_CampaignID .......... [RUN]
[0m12:32:56.310918 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bq_evo.not_null_int_google_analytics_NDG_conversionevents_GA4_ZielvorhabenID.4bb5cb583c, now test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee)
[0m12:32:56.311914 [debug] [Thread-4 (]: Began compiling node test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee
[0m12:32:56.318895 [debug] [Thread-4 (]: Writing injected SQL for node "test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee"
[0m12:32:56.321894 [debug] [Thread-4 (]: Timing info for test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee (compile): 12:32:56.312911 => 12:32:56.320891
[0m12:32:56.323919 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a42aac1d-b1dd-43ff-bb66-5ccd3421447a&page=queryresults
[0m12:32:56.324911 [debug] [Thread-4 (]: Began executing node test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee
[0m12:32:56.329866 [debug] [Thread-4 (]: Writing runtime sql for node "test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee"
[0m12:32:56.331865 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:32:56.332861 [debug] [Thread-4 (]: On test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select CampaignID as unique_field
  from `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  where CampaignID is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:32:56.478631 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2 (execute): 12:32:48.920461 => 12:32:56.477620
[0m12:32:56.479628 [info ] [Thread-1 (]: 8 of 11 PASS not_null_int_google_analytics_all_events_CampaignID ............... [[32mPASS[0m in 7.57s]
[0m12:32:56.480591 [debug] [Thread-1 (]: Finished running node test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2
[0m12:32:57.013947 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:77778000-31b2-4d29-888e-3bd98a6a6553&page=queryresults
[0m12:32:57.276569 [debug] [Thread-3 (]: Timing info for test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906 (execute): 12:32:56.114898 => 12:32:57.275620
[0m12:32:57.279560 [info ] [Thread-3 (]: 10 of 11 PASS unique_int_bing_ads_unique_campaigns_CampaignID .................. [[32mPASS[0m in 1.18s]
[0m12:32:57.280549 [debug] [Thread-3 (]: Finished running node test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906
[0m12:32:57.317878 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6d2aebe3-1923-40e3-a782-d0ca6fa72542&page=queryresults
[0m12:32:57.611116 [debug] [Thread-4 (]: Timing info for test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee (execute): 12:32:56.326875 => 12:32:57.610082
[0m12:32:57.612090 [info ] [Thread-4 (]: 11 of 11 PASS unique_int_google_ads_unique_campaigns_CampaignID ................ [[32mPASS[0m in 1.30s]
[0m12:32:57.613079 [debug] [Thread-4 (]: Finished running node test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee
[0m12:33:02.441438 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e (execute): 12:32:55.687805 => 12:33:02.440447
[0m12:33:02.442432 [info ] [Thread-2 (]: 9 of 11 PASS not_null_int_google_analytics_all_purchases_GA4_CampaignID ........ [[32mPASS[0m in 6.76s]
[0m12:33:02.443396 [debug] [Thread-2 (]: Finished running node test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e
[0m12:33:02.445392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:02.446423 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m12:33:02.446423 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m12:33:02.447386 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m12:33:02.447386 [debug] [MainThread]: Connection 'test.bq_evo.not_null_int_google_analytics_all_events_CampaignID.3357413cd2' was properly closed.
[0m12:33:02.448383 [debug] [MainThread]: Connection 'test.bq_evo.not_null_int_google_analytics_all_purchases_GA4_CampaignID.2cf6a5e64e' was properly closed.
[0m12:33:02.449381 [debug] [MainThread]: Connection 'test.bq_evo.unique_int_bing_ads_unique_campaigns_CampaignID.32ece24906' was properly closed.
[0m12:33:02.449381 [debug] [MainThread]: Connection 'test.bq_evo.unique_int_google_ads_unique_campaigns_CampaignID.0c01e64aee' was properly closed.
[0m12:33:02.450386 [info ] [MainThread]: 
[0m12:33:02.451375 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 17.80 seconds (17.80s).
[0m12:33:02.455365 [debug] [MainThread]: Command end result
[0m12:33:02.469365 [info ] [MainThread]: 
[0m12:33:02.470361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:33:02.472355 [info ] [MainThread]: 
[0m12:33:02.473863 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m12:33:02.474865 [debug] [MainThread]: Command `dbt test` succeeded at 12:33:02.474865 after 18.36 seconds
[0m12:33:02.475895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EB91F010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EC15F990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EC15E410>]}
[0m12:33:02.476859 [debug] [MainThread]: Flushing usage events
[0m12:33:17.022438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023024C43710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023024CFB090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230250DF390>]}


============================== 12:33:17.024939 | 4575d955-bb85-4a32-9c3c-2ad531a4aeb2 ==============================
[0m12:33:17.024939 [info ] [MainThread]: Running with dbt=1.6.2
[0m12:33:17.026934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh -m mart', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:33:17.373886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4575d955-bb85-4a32-9c3c-2ad531a4aeb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002302616AB50>]}
[0m12:33:17.382896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4575d955-bb85-4a32-9c3c-2ad531a4aeb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023024C59E50>]}
[0m12:33:17.384856 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m12:33:17.437360 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m12:33:17.521101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:33:17.522098 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:33:17.529608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4575d955-bb85-4a32-9c3c-2ad531a4aeb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023026B159D0>]}
[0m12:33:17.548158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4575d955-bb85-4a32-9c3c-2ad531a4aeb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023026B66AD0>]}
[0m12:33:17.549155 [info ] [MainThread]: Found 17 models, 17 tests, 10 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m12:33:17.549155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4575d955-bb85-4a32-9c3c-2ad531a4aeb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230261F4450>]}
[0m12:33:17.551184 [info ] [MainThread]: 
[0m12:33:17.552880 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:33:17.553896 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m12:33:17.554912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:19.688075 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m12:33:19.689072 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m12:33:19.689072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:19.690035 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m12:33:19.691012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:19.692411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:20.359358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4575d955-bb85-4a32-9c3c-2ad531a4aeb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002302616B350>]}
[0m12:33:20.360384 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:33:20.361362 [info ] [MainThread]: 
[0m12:33:20.365816 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m12:33:20.365816 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m12:33:20.366850 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m12:33:20.366850 [info ] [Thread-1 (]: 1 of 3 START sql incremental model mart.mrt_bing_ads_basic_campaign_stats ...... [RUN]
[0m12:33:20.367863 [info ] [Thread-2 (]: 2 of 3 START sql incremental model mart.mrt_google_ads_basic_campaign_stats .... [RUN]
[0m12:33:20.369808 [info ] [Thread-3 (]: 3 of 3 START sql incremental model mart.mrt_google_analytics_campaign_webperformance  [RUN]
[0m12:33:20.371838 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_bing_ads_basic_campaign_stats'
[0m12:33:20.372848 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_ads_basic_campaign_stats'
[0m12:33:20.373799 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance'
[0m12:33:20.374824 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m12:33:20.375792 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m12:33:20.375792 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m12:33:20.388758 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m12:33:20.392746 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m12:33:20.397768 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m12:33:20.400725 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (compile): 12:33:20.376792 => 12:33:20.400725
[0m12:33:20.401723 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (compile): 12:33:20.388758 => 12:33:20.400725
[0m12:33:20.402720 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (compile): 12:33:20.393745 => 12:33:20.401723
[0m12:33:20.402720 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m12:33:20.403718 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m12:33:20.404714 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m12:33:20.479141 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m12:33:20.480135 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m12:33:20.484123 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m12:33:20.486085 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:33:20.487092 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:33:20.488094 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

    
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m12:33:20.489078 [debug] [Thread-1 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
 
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m12:33:20.490090 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:33:20.495060 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt grundlegende Web-Performancewerte aller \u00fcber GA4 erfassten Kampagnen."""
    )
    as (
      

WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`

    
),

sessions_by_campaign AS(
  SELECT
    event_date as Date,
    CampaignID,

    COUNT(DISTINCT(CONCAT(user_pseudo_id,session_id))) as Sessions,
    COUNT(DISTINCT 
      CASE 
        WHEN session_engaged = '1' THEN CONCAT(user_pseudo_id,session_id) 
      END) as Sessions_Engaged,
    MAX(Medium),
    MAX(Source),
    MAX(Partner),

  FROM _raw
  GROUP BY 1,2
),

_add_engagement_rate AS(
    SELECT 
        Date,
        CampaignID,
        Sessions,
        Sessions_Engaged,
        (CASE
            WHEN Sessions > 0 THEN (Sessions_Engaged / Sessions) 
            ELSE 0
        END) as Engagement_Rate,
        Medium,
        Source,
        Partner
    FROM sessions_by_campaign
),

_added_columns AS(
    SELECT
        *,
        '(not set)' as Keyword,
        '(not set)' as KeywordMatchType
    FROM _add_engagement_rate
),

_final AS(
    SELECT *
    FROM _added_columns
)

SELECT * FROM _final
    );
  
[0m12:33:21.331299 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:044947ba-40a1-4d6e-8d63-3c4efc7c5c78&page=queryresults
[0m12:33:21.333302 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c661d758-41af-49c8-9884-6e38dd38ed68&page=queryresults
[0m12:33:21.352243 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7949bf70-b712-4df0-a63a-e794f8bd4ec4&page=queryresults
[0m12:33:21.482079 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: Medium at [52:9]')
[0m12:33:21.721738 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:af1652cf-5012-4147-ad70-294070531789&page=queryresults
[0m12:33:21.865870 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:af1652cf-5012-4147-ad70-294070531789&page=queryresults
[0m12:33:21.870849 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (execute): 12:33:20.480135 => 12:33:21.869852
[0m12:33:21.888793 [debug] [Thread-3 (]: Database Error in model mrt_google_analytics_campaign_webperformance (models\mart\google_analytics\mrt_google_analytics_campaign_webperformance.sql)
  Unrecognized name: Medium at [52:9]
  compiled Code at target\run\bq_evo\models\mart\google_analytics\mrt_google_analytics_campaign_webperformance.sql
[0m12:33:21.889791 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4575d955-bb85-4a32-9c3c-2ad531a4aeb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023026C91750>]}
[0m12:33:21.890787 [error] [Thread-3 (]: 3 of 3 ERROR creating sql incremental model mart.mrt_google_analytics_campaign_webperformance  [[31mERROR[0m in 1.51s]
[0m12:33:21.892781 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m12:33:23.413342 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (execute): 12:33:20.405714 => 12:33:23.413342
[0m12:33:23.414336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4575d955-bb85-4a32-9c3c-2ad531a4aeb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023026B0BDD0>]}
[0m12:33:23.415312 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model mart.mrt_bing_ads_basic_campaign_stats . [[32mCREATE TABLE (3.2k rows, 957.9 KiB processed)[0m in 3.04s]
[0m12:33:23.416296 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m12:33:24.113815 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (execute): 12:33:20.470128 => 12:33:24.112814
[0m12:33:24.114808 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4575d955-bb85-4a32-9c3c-2ad531a4aeb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023026C87D90>]}
[0m12:33:24.115797 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model mart.mrt_google_ads_basic_campaign_stats  [[32mCREATE TABLE (87.8k rows, 10.2 MiB processed)[0m in 3.74s]
[0m12:33:24.116761 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m12:33:24.119752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:24.119752 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m12:33:24.120750 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m12:33:24.121788 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m12:33:24.121788 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m12:33:24.123030 [debug] [MainThread]: Connection 'model.bq_evo.mrt_bing_ads_basic_campaign_stats' was properly closed.
[0m12:33:24.123030 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_ads_basic_campaign_stats' was properly closed.
[0m12:33:24.124030 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance' was properly closed.
[0m12:33:24.124030 [info ] [MainThread]: 
[0m12:33:24.125028 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 6.57 seconds (6.57s).
[0m12:33:24.128046 [debug] [MainThread]: Command end result
[0m12:33:24.139554 [info ] [MainThread]: 
[0m12:33:24.140537 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:33:24.141535 [info ] [MainThread]: 
[0m12:33:24.142529 [error] [MainThread]:   Database Error in model mrt_google_analytics_campaign_webperformance (models\mart\google_analytics\mrt_google_analytics_campaign_webperformance.sql)
  Unrecognized name: Medium at [52:9]
  compiled Code at target\run\bq_evo\models\mart\google_analytics\mrt_google_analytics_campaign_webperformance.sql
[0m12:33:24.143526 [info ] [MainThread]: 
[0m12:33:24.144526 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m12:33:24.146525 [debug] [MainThread]: Command `dbt run` failed at 12:33:24.145533 after 7.14 seconds
[0m12:33:24.147516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002302576B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023025124150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023024D23ED0>]}
[0m12:33:24.148515 [debug] [MainThread]: Flushing usage events
[0m12:34:13.019668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C15E12E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C15E205D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C15944810>]}


============================== 12:34:13.023692 | 90b909ee-d6b1-490d-bbc5-338aade4ecc4 ==============================
[0m12:34:13.023692 [info ] [MainThread]: Running with dbt=1.6.2
[0m12:34:13.024655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh -m mart', 'send_anonymous_usage_stats': 'True'}
[0m12:34:13.367463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90b909ee-d6b1-490d-bbc5-338aade4ecc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C170DAB50>]}
[0m12:34:13.375017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90b909ee-d6b1-490d-bbc5-338aade4ecc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C16493B90>]}
[0m12:34:13.376015 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m12:34:13.425848 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m12:34:13.515260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:34:13.516258 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\mart\google_analytics\mrt_google_analytics_campaign_webperformance.sql
[0m12:34:13.577678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90b909ee-d6b1-490d-bbc5-338aade4ecc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C1754D5D0>]}
[0m12:34:13.596107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90b909ee-d6b1-490d-bbc5-338aade4ecc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C175D74D0>]}
[0m12:34:13.597105 [info ] [MainThread]: Found 17 models, 17 tests, 10 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m12:34:13.598101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90b909ee-d6b1-490d-bbc5-338aade4ecc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C17881690>]}
[0m12:34:13.599099 [info ] [MainThread]: 
[0m12:34:13.601131 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:34:13.602091 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m12:34:13.603087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:15.948299 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m12:34:15.949300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:15.949300 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m12:34:15.952326 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m12:34:15.953289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:15.954288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:16.713958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90b909ee-d6b1-490d-bbc5-338aade4ecc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C171DCAD0>]}
[0m12:34:16.715954 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:34:16.717947 [info ] [MainThread]: 
[0m12:34:16.725841 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m12:34:16.726845 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m12:34:16.726845 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m12:34:16.727876 [info ] [Thread-1 (]: 1 of 3 START sql incremental model mart.mrt_bing_ads_basic_campaign_stats ...... [RUN]
[0m12:34:16.729836 [info ] [Thread-2 (]: 2 of 3 START sql incremental model mart.mrt_google_ads_basic_campaign_stats .... [RUN]
[0m12:34:16.730837 [info ] [Thread-3 (]: 3 of 3 START sql incremental model mart.mrt_google_analytics_campaign_webperformance  [RUN]
[0m12:34:16.732863 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_bing_ads_basic_campaign_stats'
[0m12:34:16.734857 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_ads_basic_campaign_stats'
[0m12:34:16.737814 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance'
[0m12:34:16.738811 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m12:34:16.739848 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m12:34:16.739848 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m12:34:16.753770 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m12:34:16.757795 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m12:34:16.761753 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m12:34:16.763747 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (compile): 12:34:16.740806 => 12:34:16.763747
[0m12:34:16.765741 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m12:34:16.765741 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (compile): 12:34:16.753770 => 12:34:16.765741
[0m12:34:16.766773 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (compile): 12:34:16.757795 => 12:34:16.766773
[0m12:34:16.808135 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:34:16.808978 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m12:34:16.809487 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m12:34:16.815508 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:34:16.853374 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m12:34:16.857362 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:34:16.858379 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt grundlegende Web-Performancewerte aller \u00fcber GA4 erfassten Kampagnen."""
    )
    as (
      

WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`

    
),

sessions_by_campaign AS(
  SELECT
    event_date as Date,
    CampaignID,

    COUNT(DISTINCT(CONCAT(user_pseudo_id,session_id))) as Sessions,
    COUNT(DISTINCT 
      CASE 
        WHEN session_engaged = '1' THEN CONCAT(user_pseudo_id,session_id) 
      END) as Sessions_Engaged,
    MAX(Medium) as Medium,
    MAX(Source) as Source,
    MAX(Partner) as Partner,

  FROM _raw
  GROUP BY 1,2
),

_add_engagement_rate AS(
    SELECT 
        Date,
        CampaignID,
        Sessions,
        Sessions_Engaged,
        (CASE
            WHEN Sessions > 0 THEN (Sessions_Engaged / Sessions) 
            ELSE 0
        END) as Engagement_Rate,
        Medium,
        Source,
        Partner
    FROM sessions_by_campaign
),

_added_columns AS(
    SELECT
        *,
        '(not set)' as Keyword,
        '(not set)' as KeywordMatchType
    FROM _add_engagement_rate
),

_final AS(
    SELECT *
    FROM _added_columns
)

SELECT * FROM _final
    );
  
[0m12:34:17.486429 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m12:34:17.488434 [debug] [Thread-1 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
 
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m12:34:17.546518 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m12:34:17.548516 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

    
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m12:34:17.752143 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:fa9f9407-6131-4771-bd6f-8cfb358250f5&page=queryresults
[0m12:34:17.762779 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:fe1b4fc6-17ad-4b10-8c28-c941b3b3e5f7&page=queryresults
[0m12:34:17.833765 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6337f734-6e02-47d9-8754-625d8c9fd179&page=queryresults
[0m12:34:20.067367 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (execute): 12:34:16.767737 => 12:34:20.067367
[0m12:34:20.068398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90b909ee-d6b1-490d-bbc5-338aade4ecc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C179C9490>]}
[0m12:34:20.069398 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model mart.mrt_bing_ads_basic_campaign_stats . [[32mCREATE TABLE (3.2k rows, 957.9 KiB processed)[0m in 3.34s]
[0m12:34:20.070395 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m12:34:20.622070 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (execute): 12:34:16.811520 => 12:34:20.621073
[0m12:34:20.624066 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90b909ee-d6b1-490d-bbc5-338aade4ecc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C17937BD0>]}
[0m12:34:20.626065 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model mart.mrt_google_ads_basic_campaign_stats  [[32mCREATE TABLE (87.8k rows, 10.2 MiB processed)[0m in 3.89s]
[0m12:34:20.629052 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m12:34:28.080648 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (execute): 12:34:16.816472 => 12:34:28.080648
[0m12:34:28.082639 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90b909ee-d6b1-490d-bbc5-338aade4ecc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C17533650>]}
[0m12:34:28.083604 [info ] [Thread-3 (]: 3 of 3 OK created sql incremental model mart.mrt_google_analytics_campaign_webperformance  [[32mCREATE TABLE (11.2k rows, 1.2 GiB processed)[0m in 11.35s]
[0m12:34:28.085606 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m12:34:28.087588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:28.088585 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m12:34:28.088585 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m12:34:28.089583 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m12:34:28.089583 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m12:34:28.090586 [debug] [MainThread]: Connection 'model.bq_evo.mrt_bing_ads_basic_campaign_stats' was properly closed.
[0m12:34:28.090586 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_ads_basic_campaign_stats' was properly closed.
[0m12:34:28.091578 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance' was properly closed.
[0m12:34:28.092575 [info ] [MainThread]: 
[0m12:34:28.094587 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 14.49 seconds (14.49s).
[0m12:34:28.096565 [debug] [MainThread]: Command end result
[0m12:34:28.110569 [info ] [MainThread]: 
[0m12:34:28.111563 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:34:28.112562 [info ] [MainThread]: 
[0m12:34:28.114554 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:34:28.115569 [debug] [MainThread]: Command `dbt run` succeeded at 12:34:28.115569 after 15.11 seconds
[0m12:34:28.116548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C15E24790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C15E24350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C1026FE10>]}
[0m12:34:28.116548 [debug] [MainThread]: Flushing usage events
[0m12:34:58.747273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018617F42D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018617F40350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018617F401D0>]}


============================== 12:34:58.750442 | a14e6b97-47cf-4c5b-9275-1cffd900a394 ==============================
[0m12:34:58.750442 [info ] [MainThread]: Running with dbt=1.6.2
[0m12:34:58.752901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test -m mart', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:34:59.130212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a14e6b97-47cf-4c5b-9275-1cffd900a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186192A1110>]}
[0m12:34:59.140422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a14e6b97-47cf-4c5b-9275-1cffd900a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018618593C10>]}
[0m12:34:59.141419 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m12:34:59.193300 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m12:34:59.281832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:34:59.282851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:34:59.289840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a14e6b97-47cf-4c5b-9275-1cffd900a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861931C290>]}
[0m12:34:59.305861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a14e6b97-47cf-4c5b-9275-1cffd900a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018619A6A890>]}
[0m12:34:59.306871 [info ] [MainThread]: Found 17 models, 17 tests, 10 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m12:34:59.307831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14e6b97-47cf-4c5b-9275-1cffd900a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018618C251D0>]}
[0m12:34:59.310856 [info ] [MainThread]: 
[0m12:34:59.311734 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:34:59.313768 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m12:34:59.314764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:59.315727 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m12:34:59.316780 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m12:34:59.317755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:59.318722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:01.895192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14e6b97-47cf-4c5b-9275-1cffd900a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861970A9D0>]}
[0m12:35:01.896189 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:35:01.897188 [info ] [MainThread]: 
[0m12:35:01.903369 [debug] [Thread-1 (]: Began running node test.bq_evo.not_null_mrt_bing_ads_basic_campaign_stats_CampaignID.e363f600db
[0m12:35:01.903369 [debug] [Thread-2 (]: Began running node test.bq_evo.not_null_mrt_google_ads_basic_campaign_stats_CampaignID.8f7cf788ca
[0m12:35:01.904403 [debug] [Thread-3 (]: Began running node test.bq_evo.not_null_mrt_google_analytics_campaign_webperformance_CampaignID.6c662f597a
[0m12:35:01.905365 [info ] [Thread-1 (]: 1 of 3 START test not_null_mrt_bing_ads_basic_campaign_stats_CampaignID ........ [RUN]
[0m12:35:01.906360 [info ] [Thread-2 (]: 2 of 3 START test not_null_mrt_google_ads_basic_campaign_stats_CampaignID ...... [RUN]
[0m12:35:01.907358 [info ] [Thread-3 (]: 3 of 3 START test not_null_mrt_google_analytics_campaign_webperformance_CampaignID  [RUN]
[0m12:35:01.909388 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_mrt_bing_ads_basic_campaign_stats_CampaignID.e363f600db'
[0m12:35:01.910350 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_mrt_google_ads_basic_campaign_stats_CampaignID.8f7cf788ca'
[0m12:35:01.912381 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.bq_evo.not_null_mrt_google_analytics_campaign_webperformance_CampaignID.6c662f597a'
[0m12:35:01.913343 [debug] [Thread-1 (]: Began compiling node test.bq_evo.not_null_mrt_bing_ads_basic_campaign_stats_CampaignID.e363f600db
[0m12:35:01.914340 [debug] [Thread-2 (]: Began compiling node test.bq_evo.not_null_mrt_google_ads_basic_campaign_stats_CampaignID.8f7cf788ca
[0m12:35:01.916335 [debug] [Thread-3 (]: Began compiling node test.bq_evo.not_null_mrt_google_analytics_campaign_webperformance_CampaignID.6c662f597a
[0m12:35:01.936320 [debug] [Thread-1 (]: Writing injected SQL for node "test.bq_evo.not_null_mrt_bing_ads_basic_campaign_stats_CampaignID.e363f600db"
[0m12:35:01.940307 [debug] [Thread-2 (]: Writing injected SQL for node "test.bq_evo.not_null_mrt_google_ads_basic_campaign_stats_CampaignID.8f7cf788ca"
[0m12:35:01.946812 [debug] [Thread-3 (]: Writing injected SQL for node "test.bq_evo.not_null_mrt_google_analytics_campaign_webperformance_CampaignID.6c662f597a"
[0m12:35:01.949804 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_mrt_bing_ads_basic_campaign_stats_CampaignID.e363f600db (compile): 12:35:01.917335 => 12:35:01.948809
[0m12:35:01.950820 [debug] [Thread-1 (]: Began executing node test.bq_evo.not_null_mrt_bing_ads_basic_campaign_stats_CampaignID.e363f600db
[0m12:35:01.960773 [debug] [Thread-3 (]: Timing info for test.bq_evo.not_null_mrt_google_analytics_campaign_webperformance_CampaignID.6c662f597a (compile): 12:35:01.941272 => 12:35:01.960773
[0m12:35:01.961771 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_mrt_google_ads_basic_campaign_stats_CampaignID.8f7cf788ca (compile): 12:35:01.936320 => 12:35:01.961771
[0m12:35:01.971780 [debug] [Thread-1 (]: Writing runtime sql for node "test.bq_evo.not_null_mrt_bing_ads_basic_campaign_stats_CampaignID.e363f600db"
[0m12:35:01.972775 [debug] [Thread-3 (]: Began executing node test.bq_evo.not_null_mrt_google_analytics_campaign_webperformance_CampaignID.6c662f597a
[0m12:35:01.973738 [debug] [Thread-2 (]: Began executing node test.bq_evo.not_null_mrt_google_ads_basic_campaign_stats_CampaignID.8f7cf788ca
[0m12:35:01.979722 [debug] [Thread-3 (]: Writing runtime sql for node "test.bq_evo.not_null_mrt_google_analytics_campaign_webperformance_CampaignID.6c662f597a"
[0m12:35:01.981718 [debug] [Thread-2 (]: Writing runtime sql for node "test.bq_evo.not_null_mrt_google_ads_basic_campaign_stats_CampaignID.8f7cf788ca"
[0m12:35:01.982750 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:35:01.984709 [debug] [Thread-1 (]: On test.bq_evo.not_null_mrt_bing_ads_basic_campaign_stats_CampaignID.e363f600db: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_mrt_bing_ads_basic_campaign_stats_CampaignID.e363f600db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:35:01.984709 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:35:01.985706 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:35:01.988698 [debug] [Thread-3 (]: On test.bq_evo.not_null_mrt_google_analytics_campaign_webperformance_CampaignID.6c662f597a: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_mrt_google_analytics_campaign_webperformance_CampaignID.6c662f597a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:35:01.989695 [debug] [Thread-2 (]: On test.bq_evo.not_null_mrt_google_ads_basic_campaign_stats_CampaignID.8f7cf788ca: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "test.bq_evo.not_null_mrt_google_ads_basic_campaign_stats_CampaignID.8f7cf788ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CampaignID
from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats`
where CampaignID is null



      
    ) dbt_internal_test
[0m12:35:02.850931 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:cdd30aaf-0c57-44a4-8e1a-5d59518a002f&page=queryresults
[0m12:35:02.853919 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:86f00c5b-f77b-4574-9d73-6fa01297c12e&page=queryresults
[0m12:35:02.856912 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ef5b2fcc-127c-4a9f-a1d6-5b6d8a32d3f1&page=queryresults
[0m12:35:03.153967 [debug] [Thread-3 (]: Timing info for test.bq_evo.not_null_mrt_google_analytics_campaign_webperformance_CampaignID.6c662f597a (execute): 12:35:01.974735 => 12:35:03.153967
[0m12:35:03.155955 [info ] [Thread-3 (]: 3 of 3 PASS not_null_mrt_google_analytics_campaign_webperformance_CampaignID ... [[32mPASS[0m in 1.24s]
[0m12:35:03.156953 [debug] [Thread-3 (]: Finished running node test.bq_evo.not_null_mrt_google_analytics_campaign_webperformance_CampaignID.6c662f597a
[0m12:35:03.174369 [debug] [Thread-2 (]: Timing info for test.bq_evo.not_null_mrt_google_ads_basic_campaign_stats_CampaignID.8f7cf788ca (execute): 12:35:01.979722 => 12:35:03.174369
[0m12:35:03.175366 [info ] [Thread-2 (]: 2 of 3 PASS not_null_mrt_google_ads_basic_campaign_stats_CampaignID ............ [[32mPASS[0m in 1.27s]
[0m12:35:03.177362 [debug] [Thread-2 (]: Finished running node test.bq_evo.not_null_mrt_google_ads_basic_campaign_stats_CampaignID.8f7cf788ca
[0m12:35:03.251682 [debug] [Thread-1 (]: Timing info for test.bq_evo.not_null_mrt_bing_ads_basic_campaign_stats_CampaignID.e363f600db (execute): 12:35:01.951798 => 12:35:03.250697
[0m12:35:03.253677 [info ] [Thread-1 (]: 1 of 3 PASS not_null_mrt_bing_ads_basic_campaign_stats_CampaignID .............. [[32mPASS[0m in 1.34s]
[0m12:35:03.255672 [debug] [Thread-1 (]: Finished running node test.bq_evo.not_null_mrt_bing_ads_basic_campaign_stats_CampaignID.e363f600db
[0m12:35:03.259660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:03.260657 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m12:35:03.263649 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m12:35:03.264646 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m12:35:03.265644 [debug] [MainThread]: Connection 'test.bq_evo.not_null_mrt_bing_ads_basic_campaign_stats_CampaignID.e363f600db' was properly closed.
[0m12:35:03.266641 [debug] [MainThread]: Connection 'test.bq_evo.not_null_mrt_google_ads_basic_campaign_stats_CampaignID.8f7cf788ca' was properly closed.
[0m12:35:03.267639 [debug] [MainThread]: Connection 'test.bq_evo.not_null_mrt_google_analytics_campaign_webperformance_CampaignID.6c662f597a' was properly closed.
[0m12:35:03.268636 [info ] [MainThread]: 
[0m12:35:03.269647 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m12:35:03.272625 [debug] [MainThread]: Command end result
[0m12:35:03.306537 [info ] [MainThread]: 
[0m12:35:03.307534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:03.308532 [info ] [MainThread]: 
[0m12:35:03.310527 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:35:03.312518 [debug] [MainThread]: Command `dbt test` succeeded at 12:35:03.312518 after 4.58 seconds
[0m12:35:03.313519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186179A2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018618006F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861791C150>]}
[0m12:35:03.314514 [debug] [MainThread]: Flushing usage events
[0m12:35:34.898170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C5877510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C5877710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C5874DD0>]}


============================== 12:35:34.902159 | 57985ac6-e1e7-43c3-8936-ee5096c63815 ==============================
[0m12:35:34.902159 [info ] [MainThread]: Running with dbt=1.6.2
[0m12:35:34.903199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:35:35.248132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57985ac6-e1e7-43c3-8936-ee5096c63815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C646E910>]}
[0m12:35:35.256111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57985ac6-e1e7-43c3-8936-ee5096c63815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C521DE90>]}
[0m12:35:35.258107 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m12:35:35.308448 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m12:35:35.392737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:35.392737 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:35.400715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57985ac6-e1e7-43c3-8936-ee5096c63815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C6C79E10>]}
[0m12:35:35.417078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57985ac6-e1e7-43c3-8936-ee5096c63815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C68D5C10>]}
[0m12:35:35.418076 [info ] [MainThread]: Found 17 models, 17 tests, 10 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m12:35:35.419074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57985ac6-e1e7-43c3-8936-ee5096c63815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C64CFE10>]}
[0m12:35:35.421103 [info ] [MainThread]: 
[0m12:35:35.421571 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:35:35.423697 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m12:35:35.424181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:37.681583 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m12:35:37.682583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:37.682583 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m12:35:37.685609 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m12:35:37.686574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:37.686574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:38.383280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57985ac6-e1e7-43c3-8936-ee5096c63815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C5875790>]}
[0m12:35:38.387288 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:35:38.390324 [info ] [MainThread]: 
[0m12:35:38.399187 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m12:35:38.400191 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m12:35:38.400191 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m12:35:38.402184 [info ] [Thread-1 (]: 1 of 3 START sql incremental model mart.mrt_bing_ads_basic_campaign_stats ...... [RUN]
[0m12:35:38.403186 [info ] [Thread-2 (]: 2 of 3 START sql incremental model mart.mrt_google_ads_basic_campaign_stats .... [RUN]
[0m12:35:38.405175 [info ] [Thread-3 (]: 3 of 3 START sql incremental model mart.mrt_google_analytics_campaign_webperformance  [RUN]
[0m12:35:38.407170 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_bing_ads_basic_campaign_stats'
[0m12:35:38.408169 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_ads_basic_campaign_stats'
[0m12:35:38.410163 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance'
[0m12:35:38.411161 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m12:35:38.413156 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m12:35:38.414154 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m12:35:38.430184 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m12:35:38.434206 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m12:35:38.438194 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m12:35:38.440162 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (compile): 12:35:38.415218 => 12:35:38.439158
[0m12:35:38.441152 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (compile): 12:35:38.431180 => 12:35:38.441152
[0m12:35:38.442150 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m12:35:38.443149 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (compile): 12:35:38.435169 => 12:35:38.443149
[0m12:35:38.444145 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m12:35:38.498653 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m12:35:38.512615 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:35:38.516607 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:35:38.520561 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:35:38.521539 [debug] [Thread-1 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
 
    

      WHERE
      --Update table for the past seven days + today
      Date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m12:35:38.522580 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

    

      WHERE
      --Update table for the past seven days + today
      date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m12:35:38.522580 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt grundlegende Web-Performancewerte aller \u00fcber GA4 erfassten Kampagnen.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`

    

      WHERE
      --Update table for the past seven days + today
      event_date >= current_date()-7
        
    
),

sessions_by_campaign AS(
  SELECT
    event_date as Date,
    CampaignID,

    COUNT(DISTINCT(CONCAT(user_pseudo_id,session_id))) as Sessions,
    COUNT(DISTINCT 
      CASE 
        WHEN session_engaged = '1' THEN CONCAT(user_pseudo_id,session_id) 
      END) as Sessions_Engaged,
    MAX(Medium) as Medium,
    MAX(Source) as Source,
    MAX(Partner) as Partner,

  FROM _raw
  GROUP BY 1,2
),

_add_engagement_rate AS(
    SELECT 
        Date,
        CampaignID,
        Sessions,
        Sessions_Engaged,
        (CASE
            WHEN Sessions > 0 THEN (Sessions_Engaged / Sessions) 
            ELSE 0
        END) as Engagement_Rate,
        Medium,
        Source,
        Partner
    FROM sessions_by_campaign
),

_added_columns AS(
    SELECT
        *,
        '(not set)' as Keyword,
        '(not set)' as KeywordMatchType
    FROM _add_engagement_rate
),

_final AS(
    SELECT *
    FROM _added_columns
)

SELECT * FROM _final
    );
  
[0m12:35:39.357309 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7be68135-33d0-4ff1-866b-7bb3ecffc0f3&page=queryresults
[0m12:35:39.412247 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:429b7e8e-1f31-4f9a-b6c1-b4c97eb23351&page=queryresults
[0m12:35:39.427080 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:f277bab8-33e8-40bd-b53c-49ab211a0c06&page=queryresults
[0m12:35:41.293435 [debug] [Thread-1 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:35:41.318408 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m12:35:41.319367 [debug] [Thread-1 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.Date = DBT_INTERNAL_DEST.Date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m12:35:41.569959 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:f4907d94-4c15-4d1f-ad3b-ad8ce7ac33de&page=queryresults
[0m12:35:41.606334 [debug] [Thread-2 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:35:41.608328 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m12:35:41.609326 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.date = DBT_INTERNAL_DEST.date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m12:35:41.849318 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:80e951f1-9f44-489e-a70e-fd599d0a97b5&page=queryresults
[0m12:35:43.660175 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (execute): 12:35:38.445143 => 12:35:43.660175
[0m12:35:43.662173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57985ac6-e1e7-43c3-8936-ee5096c63815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C337A9D0>]}
[0m12:35:43.664152 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model mart.mrt_bing_ads_basic_campaign_stats . [[32mMERGE (0.0 rows, 387.5 KiB processed)[0m in 5.26s]
[0m12:35:43.667157 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m12:35:44.489492 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (execute): 12:35:38.513581 => 12:35:44.489492
[0m12:35:44.490488 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57985ac6-e1e7-43c3-8936-ee5096c63815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C6D73B50>]}
[0m12:35:44.491451 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model mart.mrt_google_ads_basic_campaign_stats  [[32mMERGE (171.0 rows, 11.3 MiB processed)[0m in 6.08s]
[0m12:35:44.492462 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m12:35:47.506173 [debug] [Thread-3 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:35:47.508156 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m12:35:47.509698 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.Date = DBT_INTERNAL_DEST.Date
                ) and (
                    DBT_INTERNAL_SOURCE.CampaignID = DBT_INTERNAL_DEST.CampaignID
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Sessions` = DBT_INTERNAL_SOURCE.`Sessions`,`Sessions_Engaged` = DBT_INTERNAL_SOURCE.`Sessions_Engaged`,`Engagement_Rate` = DBT_INTERNAL_SOURCE.`Engagement_Rate`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`
    

    when not matched then insert
        (`Date`, `CampaignID`, `Sessions`, `Sessions_Engaged`, `Engagement_Rate`, `Medium`, `Source`, `Partner`, `Keyword`, `KeywordMatchType`)
    values
        (`Date`, `CampaignID`, `Sessions`, `Sessions_Engaged`, `Engagement_Rate`, `Medium`, `Source`, `Partner`, `Keyword`, `KeywordMatchType`)


    
[0m12:35:47.847179 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:47c5f3ce-fe9e-48cc-aa57-588f9b08fef7&page=queryresults
[0m12:35:49.903529 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (execute): 12:35:38.517606 => 12:35:49.902534
[0m12:35:49.906510 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57985ac6-e1e7-43c3-8936-ee5096c63815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C6832850>]}
[0m12:35:49.909464 [info ] [Thread-3 (]: 3 of 3 OK created sql incremental model mart.mrt_google_analytics_campaign_webperformance  [[32mMERGE (407.0 rows, 1.3 MiB processed)[0m in 11.50s]
[0m12:35:49.913974 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m12:35:49.916999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:49.916999 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m12:35:49.917965 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m12:35:49.917965 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m12:35:49.918957 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m12:35:49.918957 [debug] [MainThread]: Connection 'model.bq_evo.mrt_bing_ads_basic_campaign_stats' was properly closed.
[0m12:35:49.919955 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_ads_basic_campaign_stats' was properly closed.
[0m12:35:49.920954 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance' was properly closed.
[0m12:35:49.921962 [info ] [MainThread]: 
[0m12:35:49.922948 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 14.50 seconds (14.50s).
[0m12:35:49.925942 [debug] [MainThread]: Command end result
[0m12:35:49.936911 [info ] [MainThread]: 
[0m12:35:49.937907 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:49.938906 [info ] [MainThread]: 
[0m12:35:49.939912 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:35:49.941899 [debug] [MainThread]: Command `dbt run` succeeded at 12:35:49.941899 after 15.06 seconds
[0m12:35:49.942897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C4D6C2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C585E190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127C4C15ED0>]}
[0m12:35:49.943892 [debug] [MainThread]: Flushing usage events
[0m15:33:56.713156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229D71154D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229D6C45010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229D7209990>]}


============================== 15:33:56.717144 | 29fda440-2b22-4a8b-b679-882f29d3bd88 ==============================
[0m15:33:56.717144 [info ] [MainThread]: Running with dbt=1.6.2
[0m15:33:56.718417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m15:33:57.094783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29fda440-2b22-4a8b-b679-882f29d3bd88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229D8939750>]}
[0m15:33:57.103759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29fda440-2b22-4a8b-b679-882f29d3bd88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229D84D87D0>]}
[0m15:33:57.105754 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m15:33:57.159136 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m15:33:57.254484 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 8 files added, 3 files changed.
[0m15:33:57.255448 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\single_source_data\bing_ads\mrt_bing_ads_basic_campaign_stats.sql
[0m15:33:57.255448 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\google_analytics\stg_google_analytics_historic_transactions.sql
[0m15:33:57.256446 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\google_analytics\stg_google_analytics_historic_goal_conversions.sql
[0m15:33:57.256446 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\multi_source_data\mrt_metainformation_campaigns.sql
[0m15:33:57.257443 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\single_source_data\google_analytics\mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized.sql
[0m15:33:57.257443 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\single_source_data\google_ads\mrt_google_ads_basic_campaign_stats.sql
[0m15:33:57.258441 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\single_source_data\google_analytics\mrt_google_analytics_merged_ua_ga4_transactions_summarized.sql
[0m15:33:57.258441 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\single_source_data\google_analytics\mrt_google_analytics_campaign_webperformance.sql
[0m15:33:57.259437 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\mart\schema.yml
[0m15:33:57.260436 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\sources.yml
[0m15:33:57.260436 [debug] [MainThread]: Partial parsing: deleted file: bq_evo://models\mart\google_analytics\mrt_google_analytics_campaign_webperformance.sql
[0m15:33:57.261433 [debug] [MainThread]: Partial parsing: deleted file: bq_evo://models\mart\google_ads\mrt_google_ads_basic_campaign_stats.sql
[0m15:33:57.261433 [debug] [MainThread]: Partial parsing: deleted file: bq_evo://models\mart\bing_ads\mrt_bing_ads_basic_campaign_stats.sql
[0m15:33:57.262429 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\bing_ads\int_bing_ads_unique_campaigns.sql
[0m15:33:57.366797 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized' (models\mart\single_source_data\google_analytics\mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized.sql) depends on a node named 'universal_analytics_historic_goal_conversions' which was not found
[0m15:33:57.367763 [debug] [MainThread]: Command `dbt run` failed at 15:33:57.367763 after 0.67 seconds
[0m15:33:57.368799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229D6C5E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229D6C45290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229D6C6CFD0>]}
[0m15:33:57.368799 [debug] [MainThread]: Flushing usage events
[0m15:35:01.259269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96AA846D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96AD44E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96AAF7290>]}


============================== 15:35:01.263238 | 9e3ba4ca-23aa-4432-90a1-5d8faaf9228f ==============================
[0m15:35:01.263238 [info ] [MainThread]: Running with dbt=1.6.2
[0m15:35:01.265233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:35:01.602962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96C830ED0>]}
[0m15:35:01.612901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B968CD4D10>]}
[0m15:35:01.613899 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m15:35:01.662869 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m15:35:01.750149 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 8 files added, 3 files changed.
[0m15:35:01.750149 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\single_source_data\bing_ads\mrt_bing_ads_basic_campaign_stats.sql
[0m15:35:01.751147 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\google_analytics\stg_google_analytics_historic_goal_conversions.sql
[0m15:35:01.752178 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\google_analytics\stg_google_analytics_historic_transactions.sql
[0m15:35:01.752178 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\single_source_data\google_ads\mrt_google_ads_basic_campaign_stats.sql
[0m15:35:01.753141 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\single_source_data\google_analytics\mrt_google_analytics_merged_ua_ga4_transactions_summarized.sql
[0m15:35:01.754151 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\single_source_data\google_analytics\mrt_google_analytics_campaign_webperformance.sql
[0m15:35:01.754151 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\multi_source_data\mrt_metainformation_campaigns.sql
[0m15:35:01.755185 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\single_source_data\google_analytics\mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized.sql
[0m15:35:01.756149 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\sources.yml
[0m15:35:01.757180 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\mart\schema.yml
[0m15:35:01.757180 [debug] [MainThread]: Partial parsing: deleted file: bq_evo://models\mart\bing_ads\mrt_bing_ads_basic_campaign_stats.sql
[0m15:35:01.758178 [debug] [MainThread]: Partial parsing: deleted file: bq_evo://models\mart\google_ads\mrt_google_ads_basic_campaign_stats.sql
[0m15:35:01.758178 [debug] [MainThread]: Partial parsing: deleted file: bq_evo://models\mart\google_analytics\mrt_google_analytics_campaign_webperformance.sql
[0m15:35:01.759141 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\bing_ads\int_bing_ads_unique_campaigns.sql
[0m15:35:01.874479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96BFEF210>]}
[0m15:35:01.892429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96C9816D0>]}
[0m15:35:01.892429 [info ] [MainThread]: Found 22 models, 18 tests, 11 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:35:01.893457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CB0B110>]}
[0m15:35:01.896446 [info ] [MainThread]: 
[0m15:35:01.897610 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:35:01.899802 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:35:01.900802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:01.900802 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:35:01.902311 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:35:01.903311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:01.903311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:04.648154 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m15:35:04.650205 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m15:35:04.651200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:04.654140 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m15:35:04.655426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:04.660827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:05.317415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CA84250>]}
[0m15:35:05.318410 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:35:05.318915 [info ] [MainThread]: 
[0m15:35:05.323905 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_bing_ads_campaign_history
[0m15:35:05.324929 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:35:05.324929 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_google_ads_campaign_history
[0m15:35:05.324929 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m15:35:05.325924 [info ] [Thread-1 (]: 1 of 22 START sql view model staging.stg_bing_ads_campaign_history ............. [RUN]
[0m15:35:05.326902 [info ] [Thread-2 (]: 2 of 22 START sql view model staging.stg_bing_ads_campaign_performance_daily_report  [RUN]
[0m15:35:05.327895 [info ] [Thread-3 (]: 3 of 22 START sql view model staging.stg_google_ads_campaign_history ........... [RUN]
[0m15:35:05.328892 [info ] [Thread-4 (]: 4 of 22 START sql view model staging.stg_google_ads_campaign_stats ............. [RUN]
[0m15:35:05.329889 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_history'
[0m15:35:05.330887 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_performance_daily_report'
[0m15:35:05.332881 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_history'
[0m15:35:05.334911 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m15:35:05.336874 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_history
[0m15:35:05.337868 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:35:05.337868 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_history
[0m15:35:05.338866 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m15:35:05.346845 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m15:35:05.349874 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m15:35:05.353859 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_history"
[0m15:35:05.356852 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m15:35:05.357816 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (compile): 15:35:05.339863 => 15:35:05.357816
[0m15:35:05.358817 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (compile): 15:35:05.346845 => 15:35:05.358817
[0m15:35:05.360808 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (compile): 15:35:05.350868 => 15:35:05.359810
[0m15:35:05.360808 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_history
[0m15:35:05.361806 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 15:35:05.353859 => 15:35:05.361806
[0m15:35:05.362804 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:35:05.362804 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_google_ads_campaign_history
[0m15:35:05.393789 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m15:35:05.394784 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m15:35:05.399739 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m15:35:05.402731 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_history"
[0m15:35:05.407296 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m15:35:05.407296 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:35:05.408301 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:35:05.409301 [debug] [Thread-1 (]: On model.bq_evo.stg_bing_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_history`
),


_added_columns AS (
    SELECT
        *,
        'cpc' as Medium,
        'bing' as Source,
        (CASE 
            WHEN account_id = 156001989 THEN 'EVO'
        END) as Partner,
    FROM _raw
),

_added_campaignid AS (
    SELECT 
        *,
        LOWER (CONCAT(name, Source, Medium, Partner)) as CampaignID
    FROM _added_columns
),

_final AS(
    SELECT *
    FROM _added_campaignid
)

SELECT * FROM _final;


[0m15:35:05.410292 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:35:05.411289 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:35:05.411289 [debug] [Thread-2 (]: On model.bq_evo.stg_bing_ads_campaign_performance_daily_report: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_performance_daily_report`
),

_renamed_columns AS(
    SELECT 
        _fivetran_id,
        _fivetran_synced,
        account_id,
        ad_distribution,
        ad_relevance,
        all_conversions,
        all_conversions_qualified,
        all_return_on_ad_spend,
        all_revenue,
        assists,
        average_cpc,
        average_position,
        bid_match_type,
        budget_association_status,
        campaign_id,
        campaign_name,
        campaign_status,
        clicks as Clicks,
        conversions,
        conversions_qualified,
        ctr,
        currency_code,
        date as Date,
        delivered_match_type,
        device_os,
        device_type,
        expected_ctr,
        historical_ad_relevance,
        historical_expected_ctr,
        historical_landing_page_experience,
        historical_quality_score,
        impressions as Impressions,
        landing_page_experience,
        low_quality_clicks,
        low_quality_clicks_percent,
        low_quality_conversion_rate,
        low_quality_conversions,
        low_quality_conversions_qualified,
        low_quality_general_clicks,
        low_quality_impressions,
        low_quality_impressions_percent,
        low_quality_sophisticated_clicks,
        network,
        phone_calls,
        phone_impressions,
        quality_score,
        return_on_ad_spend,
        revenue,
        spend as Cost,
        top_vs_other,
        view_through_conversions
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m15:35:05.414280 [debug] [Thread-3 (]: On model.bq_evo.stg_google_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_history`
),

_renamed_columns AS(
  SELECT
    _fivetran_start,
    id,
    _fivetran_active,
    _fivetran_end,
    _fivetran_synced,
    ad_serving_optimization_status,
    advertising_channel_subtype,
    advertising_channel_type,
    base_campaign_id,
    customer_id,
    end_date,
    experiment_type,
    final_url_suffix,
    frequency_caps,
    name as campaign,
    optimization_score,
    payment_mode,
    serving_status,
    start_date,
    status,
    tracking_url_template,
    updated_at,
    vanity_pharma_display_url_mode,
    vanity_pharma_text,
    video_brand_safety_suitability
  FROM _raw
),

_add_new_columns AS(
  SELECT 
    *,
    'google' as Source,
    'cpc' as Medium,
    (CASE
      WHEN customer_id = 6607387807 THEN 'EVO'  
      ELSE '(null)'
    END) as Partner
  FROM _renamed_columns
),

_final AS(
  SELECT
    *,
    LOWER(CONCAT(campaign, Source, Medium, Partner)) as CampaignID
  FROM _add_new_columns
)

SELECT * FROM _final;


[0m15:35:05.415294 [debug] [Thread-4 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Google Ads Kampagnen"""
    )
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_transformed_cost AS(
    SELECT
        _fivetran_id,
        customer_id,
        date,
        _fivetran_synced,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability,
        ad_network_type,
        base_campaign,
        clicks,
        conversions,
        conversions_value,
        cost_micros/1000000 as cost,
        device,
        id,
        impressions,
        interaction_event_types,
        interactions,
        view_through_conversions,
    FROM _raw
),

_final AS(
    SELECT * FROM _transformed_cost
)

SELECT * FROM _final;


[0m15:35:06.257783 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:b87f1bf7-c672-4ff2-bf60-882e8a46bdf8&page=queryresults
[0m15:35:06.272745 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:acc5d79b-45d9-4518-9652-263d25919c37&page=queryresults
[0m15:35:06.277732 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ab4dcf5a-91f7-49bc-add3-aa15b0455875&page=queryresults
[0m15:35:06.314871 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:781dc647-c90c-46d7-8873-ab05202cfa12&page=queryresults
[0m15:35:06.523775 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (execute): 15:35:05.395749 => 15:35:06.523775
[0m15:35:06.524738 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CB19790>]}
[0m15:35:06.525734 [info ] [Thread-2 (]: 2 of 22 OK created sql view model staging.stg_bing_ads_campaign_performance_daily_report  [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m15:35:06.526732 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:35:06.528054 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_google_analytics_352128287
[0m15:35:06.528054 [info ] [Thread-2 (]: 5 of 22 START sql view model staging.stg_google_analytics_352128287 ............ [RUN]
[0m15:35:06.530364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_performance_daily_report, now model.bq_evo.stg_google_analytics_352128287)
[0m15:35:06.530364 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_google_analytics_352128287
[0m15:35:06.534386 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_352128287"
[0m15:35:06.536376 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (compile): 15:35:06.531427 => 15:35:06.536376
[0m15:35:06.537402 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_google_analytics_352128287
[0m15:35:06.541335 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_352128287"
[0m15:35:06.543331 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:35:06.547321 [debug] [Thread-2 (]: On model.bq_evo.stg_google_analytics_352128287: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_352128287"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
  OPTIONS(
      description="""Enth\u00e4lt alle GA4-Events in Tabellenform ohne Schachtelung. Bereinigt fehlerhafte Events ohne Session-ID. Offzielle Doku Google > https://support.google.com/analytics/answer/7029846?hl=en#zippy="""
    )
  as WITH _source AS(
  SELECT
    PARSE_DATE('%Y%m%d', event_date) as event_date,
    TIMESTAMP_MICROS(event_timestamp) as event_ts,
    
    MAX(CASE WHEN params.key = 'ga_session_id' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_id,
    user_pseudo_id,
    TIMESTAMP_MICROS(user_first_touch_timestamp) as user_first_touch_ts,

    event_name,

    params.key as params_key,
    params.value.string_value as params_string_value,
    params.value.int_value as params_int_value,
    params.value.float_value as params_float_value,
    params.value.double_value as params_double_value,

    (CASE WHEN traffic_source.name IS NULL THEN '(not set)' ELSE traffic_source.name END) as utm_campaign,
    (CASE WHEN traffic_source.medium IS NULL THEN '(not set)' ELSE traffic_source.medium END) as utm_medium,
    (CASE WHEN traffic_source.source IS NULL THEN '(not set)' ELSE traffic_source.source END) as utm_source,
    'EVO' as Partner,

    MAX(CASE WHEN params.key = 'page_title' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_title,
    MAX(CASE WHEN params.key = 'page_location' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_location,
    MAX(CASE WHEN params.key = 'page_referrer' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_referrer,
    MAX(CASE WHEN params.key = 'page_path' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_path,
    MAX(CASE WHEN params.key = 'percent_scrolled' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as percent_scrolled,
    MAX(CASE WHEN params.key = 'session_engaged' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_engaged,

    privacy_info.analytics_storage as analytics_storage,
    privacy_info.ads_storage as ads_storage,
    privacy_info.uses_transient_token as uses_transient_token,

    user_ltv.revenue as ltv_revenue,
    user_ltv.currency as ltv_currency,

    device.category as device_category,
    device.mobile_brand_name as device_brand,
    device.mobile_model_name as device_model_name,
    device.mobile_marketing_name as device_marketing_name,
    device.mobile_os_hardware_model as device_mobile_os_hardware_model,
    device.operating_system as device_os,
    device.operating_system_version as device_os_version,
    device.vendor_id as device_vendor_id,
    device.advertising_id as device_advertising_id,
    device.language as device_language,
    device.is_limited_ad_tracking as device_is_limited_ad_tracking,
    device.time_zone_offset_seconds as device_time_zone_offset_seconds,
    device.browser as device_browser,
    device.browser_version as device_browser_version,
    device.web_info.browser as device_web_info_browser,
    device.web_info.browser_version as device_web_info_browser_version,
    device.web_info.hostname as browser_web_info_hostname,

    geo.continent as continent,
    geo.country as country,
    geo.region as region,
    geo.city as city,
    geo.sub_continent as sub_continent,
    geo.metro as metropolitan_area,

    app_info.id as app_id,
    app_info.version as app_version,
    app_info.install_store as app_install_store,
    app_info.firebase_app_id as app_firebase_app_id,
    app_info.install_source as app_install_source,

    event_dimensions.hostname as event_hostname,

    ecommerce.total_item_quantity as total_item_quantity,
    ecommerce.purchase_revenue_in_usd as purchase_revenue_in_usd,
    ecommerce.purchase_revenue as purchase_revenue,
    ecommerce.refund_value_in_usd as refund_value_in_usd,
    ecommerce.refund_value as refund_value,
    ecommerce.shipping_value_in_usd as shipping_value_in_usd,
    ecommerce.shipping_value as shipping_value,
    ecommerce.tax_value_in_usd as tax_value_in_usd,
    ecommerce.tax_value as tax_value,
    ecommerce.unique_items as unique_items,
    ecommerce.transaction_id as transaction_id,
    
    items.item_id as item_id,
    items.item_name as item_name,
    items.item_brand as item_brand,
    items.item_variant as item_variant,
    items.item_category as item_category,
    items.item_category2 as item_category2,
    items.item_category3 as item_category3,
    items.item_category4 as item_category4,
    items.item_category5 as item_category5,
    items.price_in_usd as price_in_usd,
    items.price as price,
    items.quantity as quantity,
    items.item_revenue_in_usd as item_revenue_in_usd,
    items.item_revenue as item_revenue,
    items.item_refund_in_usd as item_refund_in_usd,
    items.item_refund as item_refund,
    items.coupon as coupon,
    items.affiliation as affiliation,
    items.location_id as location_id,
    items.item_list_id as item_list_id,
    items.item_list_name as item_list_name,
    items.item_list_index as item_list_index,
    items.promotion_id as promotion_id,
    items.promotion_name as promotion_name,
    items.creative_name as creative_name,
    items.creative_slot as creative_slot,

    collected_traffic_source.manual_campaign_id as manual_campaign_id,
    collected_traffic_source.manual_campaign_name as manual_campaign_name,
    collected_traffic_source.manual_source as manual_source,
    collected_traffic_source.manual_medium as manual_medium,
    collected_traffic_source.manual_term as manual_term,
    collected_traffic_source.manual_content as manual_content,
    collected_traffic_source.gclid as gclid,
    collected_traffic_source.dclid as dclid,
    collected_traffic_source.srsltid as srsltid

  FROM `oss-big-query-dashboard-prod`.`analytics_352128287`.`events_*` as events
  LEFT JOIN UNNEST (event_params) as params
  /*LEFT JOIN UNNEST (privacy_info) as privacy_info
  LEFT JOIN UNNEST (user_ltv) as user_ltv*/
  LEFT JOIN UNNEST(items) as items 
),

events_aggregated as (
  SELECT
    event_date,
    event_ts,
    session_id,
    user_pseudo_id,
    user_first_touch_ts,
    event_name,

--Kampagneninformationen
    MAX(utm_campaign) as utm_campaign,
    MAX(utm_medium) as utm_medium,
    (CASE WHEN MAX(utm_source) = 'ig' THEN 'instagram' ELSE MAX(utm_source) END) as utm_source,
  --  (CASE WHEN MAX(utm_campaign) IS NULL THEN '(not set)' ELSE MAX(utm_campaign) END) as utm_campaign,
  --  (CASE WHEN MAX(utm_medium) IS NULL THEN '(not set)' ELSE MAX(utm_medium) END) as utm_medium,
  --  (CASE WHEN MAX(utm_source) IS NULL THEN '(not set)' ELSE MAX(utm_source) END) as utm_source,

--Seiteninformationen
    MAX(page_title) as page_title,
    MAX(page_location) as page_location,
    MAX(page_referrer) as page_referrer,
    MAX(page_path) as page_path,
    MAX(percent_scrolled) as percent_scrolled,
    MAX(session_engaged) as session_engaged,

--Privacy-Infos
    MAX(analytics_storage) as analytics_storage,
    MAX(ads_storage) as ads_storage,
    MAX(uses_transient_token) as uses_transient_token,

--Kundenwertinformationen
    MAX(ltv_revenue) as ltv_revenue,
    MAX(ltv_currency) as ltv_currency,

--Geräteinformationen
    MAX(device_category) as device_category,
    MAX(device_brand) as device_brand,
    MAX(device_model_name) as device_model_name,
    MAX(device_marketing_name) as device_marketing_name,
    MAX(device_mobile_os_hardware_model) as device_mobile_os_hardware_model,
    MAX(device_os) as device_os,
    MAX(device_os_version) as device_os_version,
    MAX(device_vendor_id) as device_vendor_id,
    MAX(device_advertising_id) as device_advertising_id,
    MAX(device_language) as device_language,
    MAX(device_is_limited_ad_tracking) as device_is_limited_ad_tracking,
    MAX(device_time_zone_offset_seconds) as device_time_zone_offset_seconds,
    MAX(device_browser) as device_browser,
    MAX(device_browser_version) as device_browser_version,
    MAX(device_web_info_browser) as device_web_info_browser,
    MAX(device_web_info_browser_version) as device_web_info_browser_version,
    MAX(browser_web_info_hostname) as browser_web_info_hostname,

--Gebietsinformationen
    MAX(continent) as continent,
    MAX(country) as country,
    MAX(region) as region,
    MAX(city) as city,
    MAX(sub_continent) as sub_continent,
    MAX(metropolitan_area) as metropolitan_area,

--App-Informationen
    MAX(app_id) as app_id,
    MAX(app_version) as app_version,
    MAX(app_install_store) as app_install_store,
    MAX(app_firebase_app_id) as app_firebase_app_id,
    MAX(app_install_source) as app_install_source,

    MAX(event_hostname) as event_hostname,

--E-Commerceinformationen
    MAX(total_item_quantity) as total_item_quantity,
    MAX(purchase_revenue_in_usd) as purchase_revenue_in_usd,
    MAX(purchase_revenue) as purchase_revenue,
    MAX(refund_value_in_usd) as refund_value_in_usd,
    MAX(refund_value) as refund_value,
    MAX(shipping_value_in_usd) as shipping_value_in_usd,
    MAX(shipping_value) as shipping_value,
    MAX(tax_value_in_usd) as tax_value_in_usd,
    MAX(tax_value) as tax_value,
    MAX(unique_items) as unique_items,
    MAX(transaction_id) as transaction_id,

--Warenkorbinformationen
    MAX(item_id) as item_id,
    MAX(item_name) as item_name,
    MAX(item_brand) as item_brand,
    MAX(item_variant) as item_variant,
    MAX(item_category) as item_category,
    MAX(item_category2) as item_category2,
    MAX(item_category3) as item_category3,
    MAX(item_category4) as item_category4,
    MAX(item_category5) as item_category5,
    MAX(price_in_usd) as price_in_usd,
    MAX(price) as price,
    MAX(quantity) as quantity,
    MAX(item_revenue_in_usd) as item_revenue_in_usd,
    MAX(item_revenue) as item_revenue,
    MAX(item_refund_in_usd) as item_refund_in_usd,
    MAX(item_refund) as item_refund,
    MAX(coupon) as coupon,
    MAX(affiliation) as affiliation,
    MAX(location_id) as location_id,
    MAX(item_list_id) as item_list_id,
    MAX(item_list_name) as item_list_name,
    MAX(item_list_index) as item_list_index,
    MAX(promotion_id) as promotion_id,
    MAX(promotion_name) as promotion_name,
    MAX(creative_name) as creative_name,
    MAX(creative_slot) as creative_slot,

--Manuelle Trackingparameter
    MAX(manual_campaign_id) as manual_campaign_id,
    MAX(manual_campaign_name) as manual_campaign_name,
    MAX(manual_source) as manual_source,
    MAX(manual_medium) as manual_medium,
    MAX(manual_term) as manual_term,
    MAX(manual_content) as manual_content,
    MAX(gclid) as gclid,
    MAX(dclid) as dclid,
    MAX(srsltid) as srsltid

  FROM _source
  WHERE session_id <> 0
  GROUP BY 1,2,3,4,5,6
)

SELECT *
  --DISTINCT event_date
FROM events_aggregated;


[0m15:35:06.831432 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 15:35:05.403727 => 15:35:06.831432
[0m15:35:06.832427 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CB916D0>]}
[0m15:35:06.833419 [info ] [Thread-4 (]: 4 of 22 OK created sql view model staging.stg_google_ads_campaign_stats ........ [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m15:35:06.834390 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m15:35:06.835390 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_google_analytics_historic_campaigns
[0m15:35:06.835390 [info ] [Thread-4 (]: 6 of 22 START sql view model staging.stg_google_analytics_historic_campaigns ... [RUN]
[0m15:35:06.837417 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (execute): 15:35:05.363812 => 15:35:06.837417
[0m15:35:06.838412 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_ads_campaign_stats, now model.bq_evo.stg_google_analytics_historic_campaigns)
[0m15:35:06.839377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CA96ED0>]}
[0m15:35:06.839377 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_campaigns
[0m15:35:06.840374 [info ] [Thread-1 (]: 1 of 22 OK created sql view model staging.stg_bing_ads_campaign_history ........ [[32mCREATE VIEW (0 processed)[0m in 1.51s]
[0m15:35:06.844397 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_campaigns"
[0m15:35:06.845360 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_history
[0m15:35:06.846357 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m15:35:06.847358 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_analytics_historic_campaigns (compile): 15:35:06.841374 => 15:35:06.847358
[0m15:35:06.847358 [info ] [Thread-1 (]: 7 of 22 START sql view model staging.stg_google_analytics_historic_goal_conversions  [RUN]
[0m15:35:06.848354 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_google_analytics_historic_campaigns
[0m15:35:06.849350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_history, now model.bq_evo.stg_google_analytics_historic_goal_conversions)
[0m15:35:06.853377 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_campaigns"
[0m15:35:06.854372 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m15:35:06.858360 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_goal_conversions"
[0m15:35:06.859323 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:35:06.859323 [debug] [Thread-4 (]: On model.bq_evo.stg_google_analytics_historic_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle historischen Kampagnen aus Universal Analytics / GA3"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_campaigns`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m15:35:06.862317 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_historic_goal_conversions (compile): 15:35:06.855335 => 15:35:06.861319
[0m15:35:06.862317 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m15:35:06.872313 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_goal_conversions"
[0m15:35:06.873285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:06.874285 [debug] [Thread-1 (]: On model.bq_evo.stg_google_analytics_historic_goal_conversions: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_goal_conversions"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_goal_conversions`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_campaigns`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m15:35:06.910772 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (execute): 15:35:05.400736 => 15:35:06.909266
[0m15:35:06.911771 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96C806790>]}
[0m15:35:06.911771 [info ] [Thread-3 (]: 3 of 22 OK created sql view model staging.stg_google_ads_campaign_history ...... [[32mCREATE VIEW (0 processed)[0m in 1.58s]
[0m15:35:06.912769 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_google_ads_campaign_history
[0m15:35:06.913767 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_google_analytics_historic_transactions
[0m15:35:06.914764 [info ] [Thread-3 (]: 8 of 22 START sql view model staging.stg_google_analytics_historic_transactions  [RUN]
[0m15:35:06.916759 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_ads_campaign_history, now model.bq_evo.stg_google_analytics_historic_transactions)
[0m15:35:06.917757 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_transactions
[0m15:35:06.920748 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_transactions"
[0m15:35:06.921745 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_analytics_historic_transactions (compile): 15:35:06.917757 => 15:35:06.921745
[0m15:35:06.922742 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_google_analytics_historic_transactions
[0m15:35:06.926732 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_transactions"
[0m15:35:06.928727 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:35:06.929723 [debug] [Thread-3 (]: On model.bq_evo.stg_google_analytics_historic_transactions: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_transactions"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_transactions`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_campaigns`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m15:35:07.218804 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:96d717d4-83a6-4c26-93d2-d25adffe3499&page=queryresults
[0m15:35:07.589078 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4bde171b-5a43-42ab-909f-a8b3a23bf78e&page=queryresults
[0m15:35:07.658257 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ed6a161a-ba56-431a-ab58-6763d9508f9e&page=queryresults
[0m15:35:07.716738 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6258c566-649b-42c8-ae19-d4331b0373ec&page=queryresults
[0m15:35:07.968152 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_historic_goal_conversions (execute): 15:35:06.863312 => 15:35:07.967155
[0m15:35:07.969114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CB134D0>]}
[0m15:35:07.970540 [info ] [Thread-1 (]: 7 of 22 OK created sql view model staging.stg_google_analytics_historic_goal_conversions  [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m15:35:07.971284 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m15:35:07.972284 [debug] [Thread-1 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:35:07.973314 [info ] [Thread-1 (]: 9 of 22 START sql view model intermediate.int_bing_ads_unique_campaigns ........ [RUN]
[0m15:35:07.975311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_historic_goal_conversions, now model.bq_evo.int_bing_ads_unique_campaigns)
[0m15:35:07.976308 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:35:07.979305 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m15:35:07.981272 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (compile): 15:35:07.977271 => 15:35:07.981272
[0m15:35:07.982265 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:35:07.986247 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m15:35:07.987246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:07.988242 [debug] [Thread-1 (]: On model.bq_evo.int_bing_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Bing Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id,
        MAX(name) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m15:35:08.014831 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (execute): 15:35:06.537402 => 15:35:08.013802
[0m15:35:08.014831 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96BFAEA50>]}
[0m15:35:08.016792 [info ] [Thread-2 (]: 5 of 22 OK created sql view model staging.stg_google_analytics_352128287 ....... [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m15:35:08.017790 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_google_analytics_352128287
[0m15:35:08.018796 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m15:35:08.020822 [info ] [Thread-2 (]: 10 of 22 START sql view model intermediate.int_google_ads_unique_campaigns ..... [RUN]
[0m15:35:08.022810 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_352128287, now model.bq_evo.int_google_ads_unique_campaigns)
[0m15:35:08.023774 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m15:35:08.026804 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m15:35:08.027767 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 15:35:08.023774 => 15:35:08.027767
[0m15:35:08.028761 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m15:35:08.032750 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m15:35:08.033776 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:35:08.035742 [debug] [Thread-2 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id ,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m15:35:08.041763 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_analytics_historic_transactions (execute): 15:35:06.923741 => 15:35:08.041763
[0m15:35:08.042764 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CA50AD0>]}
[0m15:35:08.046744 [info ] [Thread-3 (]: 8 of 22 OK created sql view model staging.stg_google_analytics_historic_transactions  [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m15:35:08.047710 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_google_analytics_historic_transactions
[0m15:35:08.048706 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m15:35:08.049704 [info ] [Thread-3 (]: 11 of 22 START sql view model intermediate.int_google_analytics_all_events ..... [RUN]
[0m15:35:08.051738 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_historic_transactions, now model.bq_evo.int_google_analytics_all_events)
[0m15:35:08.051738 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m15:35:08.055722 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m15:35:08.057684 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 15:35:08.052738 => 15:35:08.056686
[0m15:35:08.058688 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m15:35:08.061671 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m15:35:08.063671 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:35:08.064664 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_final AS(
    SELECT *
    FROM _rename_columns
)

SELECT * FROM _final;


[0m15:35:08.388600 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_analytics_historic_campaigns (execute): 15:35:06.850349 => 15:35:08.388600
[0m15:35:08.389624 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CA366D0>]}
[0m15:35:08.390598 [info ] [Thread-4 (]: 6 of 22 OK created sql view model staging.stg_google_analytics_historic_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.55s]
[0m15:35:08.391591 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_google_analytics_historic_campaigns
[0m15:35:08.688432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ecfbeca2-cf6c-480b-84a4-462adacd4fce&page=queryresults
[0m15:35:08.795431 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:434abfbc-48c5-4738-98c4-e089fa5d9787&page=queryresults
[0m15:35:08.805439 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:510bbe7d-efa5-4d70-b2b7-85b555613e78&page=queryresults
[0m15:35:09.397268 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (execute): 15:35:07.982265 => 15:35:09.397268
[0m15:35:09.398265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CB23650>]}
[0m15:35:09.399506 [info ] [Thread-1 (]: 9 of 22 OK created sql view model intermediate.int_bing_ads_unique_campaigns ... [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m15:35:09.401171 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:35:09.401171 [debug] [Thread-4 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:35:09.402201 [info ] [Thread-4 (]: 12 of 22 START sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [RUN]
[0m15:35:09.403165 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_historic_campaigns, now model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names)
[0m15:35:09.404699 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:35:09.407695 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m15:35:09.409688 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (compile): 15:35:09.404699 => 15:35:09.408725
[0m15:35:09.410686 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:35:09.413678 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m15:35:09.415220 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:35:09.416220 [debug] [Thread-4 (]: On model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne inkl. Klartext der Kampagne."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m15:35:09.523784 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 15:35:08.058688 => 15:35:09.523784
[0m15:35:09.524781 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96C968710>]}
[0m15:35:09.525779 [info ] [Thread-3 (]: 11 of 22 OK created sql view model intermediate.int_google_analytics_all_events  [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m15:35:09.527773 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m15:35:09.528771 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m15:35:09.528771 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_all_campaigns
[0m15:35:09.529803 [info ] [Thread-1 (]: 13 of 22 START sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [RUN]
[0m15:35:09.530766 [info ] [Thread-3 (]: 14 of 22 START sql view model intermediate.int_google_analytics_all_campaigns .. [RUN]
[0m15:35:09.531762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_unique_campaigns, now model.bq_evo.int_google_analytics_NDG_conversionevents_GA4)
[0m15:35:09.533760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_events, now model.bq_evo.int_google_analytics_all_campaigns)
[0m15:35:09.533760 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m15:35:09.534755 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_all_campaigns
[0m15:35:09.539742 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m15:35:09.544728 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m15:35:09.547721 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (compile): 15:35:09.535752 => 15:35:09.546723
[0m15:35:09.548718 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m15:35:09.549715 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (compile): 15:35:09.540739 => 15:35:09.548718
[0m15:35:09.553704 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m15:35:09.554702 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_all_campaigns
[0m15:35:09.559696 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m15:35:09.560688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:09.562681 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 15:35:08.029768 => 15:35:09.562681
[0m15:35:09.563679 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_NDG_conversionevents_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle relevanten Conversionevents aus Google Analytics 4 f\u00fcr NDG-Vermarktung. Inklusive aller E-Commerce-Events (ohne Metainformationen)."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_conversions_NDG as(
  SELECT 
    event_date as Date,
    event_name as ZielvorhabenName, 
    CampaignID,
    Source,
    Medium,

    MAX(Partner) as Partner,

    count(event_date) as Conversions,

  FROM _raw
  WHERE (
    event_name = 'lead_form_evo_solar_lp' OR
    event_name = 'evo_solar_pva_check_sent_available' OR
    event_name = 'contact_form_button' OR
    event_name = 'click_online_application' OR
    event_name = 'oss_registration_doi' OR
    event_name = 'click_tarifrechnernutzung' OR
    event_name = 'conversion_solarrechner' OR
    event_name = 'purchase'
  )

  GROUP BY 1,2,3,4,5
),

_added_columns AS(
  SELECT 
      Date,
      ZielvorhabenName,
      LOWER(CONCAT(ZielvorhabenName, Partner)) as ZielvorhabenID,
      CampaignID,
      Source,
      Medium,
      Partner,
      '(not set)' as Keyword,
      '(not set)' as KeywordMatchType,
      Conversions
  FROM _conversions_NDG
),

_final AS(
  SELECT *
  FROM _added_columns
)

SELECT * FROM _final;


[0m15:35:09.565673 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:35:09.566669 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CBF23D0>]}
[0m15:35:09.569663 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_all_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagnen aus GA4 und GA3."""
    )
  as WITH _historic_ua_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
),

ga4_campaigns AS(
    SELECT 
        MAX(Campaign),
        MAX(Partner),
        MAX(Source),
        MAX(Medium),
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
    GROUP BY 5
),

_final AS(
    SELECT * FROM _historic_ua_campaigns
    UNION DISTINCT
    SELECT * FROM ga4_campaigns
)

SELECT * FROM _final;


[0m15:35:09.570658 [info ] [Thread-2 (]: 10 of 22 OK created sql view model intermediate.int_google_ads_unique_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.54s]
[0m15:35:09.573653 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m15:35:09.574648 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:35:09.576709 [info ] [Thread-2 (]: 15 of 22 START sql view model intermediate.int_google_analytics_all_purchases_GA4  [RUN]
[0m15:35:09.578638 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_unique_campaigns, now model.bq_evo.int_google_analytics_all_purchases_GA4)
[0m15:35:09.579635 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:35:09.582660 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m15:35:09.584621 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (compile): 15:35:09.579635 => 15:35:09.583661
[0m15:35:09.585620 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:35:09.588639 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m15:35:09.590610 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:35:09.591602 [debug] [Thread-2 (]: On model.bq_evo.int_google_analytics_all_purchases_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_purchases_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle <purchase-events> aus Google Analytics 4. Inkl. aller zugeh\u00f6rigen Metainformationen aus GA4."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_select_purchase_events AS(
  SELECT * FROM _raw
  WHERE event_name = "purchase"
),

_final AS(
    SELECT *
    FROM _select_purchase_events
)

SELECT * FROM _final;


[0m15:35:10.244589 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:f9bd8d95-25fa-4be6-82f6-67b1c257953d&page=queryresults
[0m15:35:10.346379 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7e66e4fb-0da1-4e69-a64a-a93ff58f07e0&page=queryresults
[0m15:35:10.357379 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e2bf32a5-23d3-4442-bbba-f50f473eaf55&page=queryresults
[0m15:35:10.419205 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:116ca179-a7ac-41fe-a707-41c566b2ca91&page=queryresults
[0m15:35:10.827605 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (execute): 15:35:09.550711 => 15:35:10.827605
[0m15:35:10.828598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CC26E50>]}
[0m15:35:10.829563 [info ] [Thread-1 (]: 13 of 22 OK created sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m15:35:10.832588 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m15:35:10.833556 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m15:35:10.834548 [info ] [Thread-1 (]: 16 of 22 START sql incremental model mart.mrt_google_analytics_campaign_webperformance  [RUN]
[0m15:35:10.835558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_NDG_conversionevents_GA4, now model.bq_evo.mrt_google_analytics_campaign_webperformance)
[0m15:35:10.836575 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m15:35:10.845551 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m15:35:10.847520 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (compile): 15:35:10.837541 => 15:35:10.847520
[0m15:35:10.848515 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m15:35:10.879462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:10.949644 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (execute): 15:35:09.410686 => 15:35:10.949644
[0m15:35:10.950646 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CB0E610>]}
[0m15:35:10.951641 [info ] [Thread-4 (]: 12 of 22 OK created sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.55s]
[0m15:35:10.953636 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:35:10.953636 [debug] [Thread-4 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m15:35:10.954633 [info ] [Thread-4 (]: 17 of 22 START sql view model intermediate.int_google_ads_campaign_stats ....... [RUN]
[0m15:35:10.955596 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names, now model.bq_evo.int_google_ads_campaign_stats)
[0m15:35:10.956631 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m15:35:10.959611 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m15:35:10.960607 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 15:35:10.956631 => 15:35:10.960607
[0m15:35:10.961580 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m15:35:10.966566 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m15:35:10.968562 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:35:10.969559 [debug] [Thread-4 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
),

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m15:35:11.013446 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (execute): 15:35:09.586616 => 15:35:11.013446
[0m15:35:11.014443 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CB17290>]}
[0m15:35:11.015441 [info ] [Thread-2 (]: 15 of 22 OK created sql view model intermediate.int_google_analytics_all_purchases_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m15:35:11.016438 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:35:11.017433 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m15:35:11.018431 [info ] [Thread-2 (]: 18 of 22 START sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [RUN]
[0m15:35:11.019451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_purchases_GA4, now model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized)
[0m15:35:11.020448 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m15:35:11.025434 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m15:35:11.027431 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (compile): 15:35:11.021446 => 15:35:11.026431
[0m15:35:11.027431 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m15:35:11.063332 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m15:35:11.065327 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:35:11.066326 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Conversiondaten bis einschl. 04.06.2023 aus Unisversal Analytics, alle Conversions ab 05.06.2023 aus Google Analytics 4."""
    )
    as (
      WITH ga4_conversions AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
    WHERE 
        Date > '2023-06-04'
),

ua_conversions AS(
    SELECT
        Date,
        NameZielvorhaben as ZielvorhabenName,
        LOWER(CONCAT(NameZielvorhaben, Partner)) as ZielvorhabenID,
        CampaignID,
        Source,
        Medium,
        Partner,
        Keyword,
        KeywordMatchType,
        Conversions
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_goal_conversions`
    WHERE Date <= '2023-06-04'
),

_merged_step1 AS(
    SELECT * FROM ga4_conversions
    UNION ALL
    SELECT * FROM ua_conversions
),

_final AS(
    SELECT *
    FROM _merged_step1
)

SELECT * FROM _final
    );
  
[0m15:35:11.116196 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (execute): 15:35:09.555698 => 15:35:11.116196
[0m15:35:11.117194 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CC3E350>]}
[0m15:35:11.117194 [info ] [Thread-3 (]: 14 of 22 OK created sql view model intermediate.int_google_analytics_all_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.58s]
[0m15:35:11.118701 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_all_campaigns
[0m15:35:11.119705 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m15:35:11.120701 [info ] [Thread-3 (]: 19 of 22 START sql incremental model mart.mrt_bing_ads_basic_campaign_stats .... [RUN]
[0m15:35:11.122693 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_campaigns, now model.bq_evo.mrt_bing_ads_basic_campaign_stats)
[0m15:35:11.122693 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m15:35:11.126683 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m15:35:11.128678 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (compile): 15:35:11.123691 => 15:35:11.128678
[0m15:35:11.129675 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m15:35:11.132667 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:35:11.491969 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m15:35:11.493931 [debug] [Thread-1 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt grundlegende Web-Performancewerte aller \u00fcber GA4 erfassten Kampagnen."""
    )
    as (
      

WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`

    
),

sessions_by_campaign AS(
  SELECT
    event_date as Date,
    CampaignID,

    COUNT(DISTINCT(CONCAT(user_pseudo_id,session_id))) as Sessions,
    COUNT(DISTINCT 
      CASE 
        WHEN session_engaged = '1' THEN CONCAT(user_pseudo_id,session_id) 
      END) as Sessions_Engaged,
    MAX(Medium) as Medium,
    MAX(Source) as Source,
    MAX(Partner) as Partner,

  FROM _raw
  GROUP BY 1,2
),

_add_engagement_rate AS(
    SELECT 
        Date,
        CampaignID,
        Sessions,
        Sessions_Engaged,
        (CASE
            WHEN Sessions > 0 THEN (Sessions_Engaged / Sessions) 
            ELSE 0
        END) as Engagement_Rate,
        Medium,
        Source,
        Partner
    FROM sessions_by_campaign
),

_added_columns AS(
    SELECT
        *,
        '(not set)' as Keyword,
        '(not set)' as KeywordMatchType
    FROM _add_engagement_rate
),

_final AS(
    SELECT *
    FROM _added_columns
)

SELECT * FROM _final
    );
  
[0m15:35:11.751007 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m15:35:11.752029 [debug] [Thread-3 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
 
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m15:35:11.768942 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:033c7f60-89ef-433d-af26-40f8d22a766d&page=queryresults
[0m15:35:11.779302 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:25e884e3-1a6b-4d2e-a317-5d4276aced23&page=queryresults
[0m15:35:11.872331 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e7242708-641d-4772-9ea8-e4e3e7269235&page=queryresults
[0m15:35:11.979482 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:58296bd3-b722-4fe3-97b4-355a34929431&page=queryresults
[0m15:35:12.011943 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: Date at [35:11]')
[0m15:35:12.283471 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 15:35:10.961580 => 15:35:12.282476
[0m15:35:12.284407 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CB93250>]}
[0m15:35:12.285437 [info ] [Thread-4 (]: 17 of 22 OK created sql view model intermediate.int_google_ads_campaign_stats .. [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m15:35:12.286400 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m15:35:12.287404 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m15:35:12.287404 [info ] [Thread-4 (]: 20 of 22 START sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [RUN]
[0m15:35:12.289392 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_campaign_stats, now model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized)
[0m15:35:12.289392 [debug] [Thread-4 (]: Began compiling node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m15:35:12.293381 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m15:35:12.295378 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (compile): 15:35:12.290423 => 15:35:12.294384
[0m15:35:12.295378 [debug] [Thread-4 (]: Began executing node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m15:35:12.302391 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m15:35:12.305351 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:35:12.306355 [debug] [Thread-4 (]: On model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_merged_ua_ga4_transactions_summarized`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle aggregierten Transaktionen bis einschl. 04.06.2023 aus Unisversal Analytics, alle Conversions ab 05.06.2023 aus Google Analytics 4. Enth\u00e4lt keine Detailinformationen je Transaktion."""
    )
    as (
      WITH _raw AS(
  SELECT 
    event_date as Date,
    Campaign,
    Medium,
    Source,
    item_category as ProductCategory,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  WHERE 
    transaction_id NOT LIKE 'TEST%'
),

_aggregation_on_day AS(
  SELECT
    Date,
    Campaign,
    Medium,
    Source,
    ProductCategory,
    count(Date) as Transactions,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    MAX(Partner) as Partner,
    CampaignID
  FROM _raw
  WHERE Date >= '2023-06-05'
  GROUP BY 1,2,3,4,5,10
),

evo_ecommerce_ua AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_transactions`
  WHERE Date < '2023-06-05'
),

_merged_step1 AS(
  SELECT * FROM _aggregation_on_day
  UNION ALL
  SELECT * FROM evo_ecommerce_ua
),

_final AS(
  SELECT * FROM _merged_step1
)

SELECT * FROM _final
    );
  
[0m15:35:13.038514 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:977df7ca-cb5a-4f0a-9a01-17b7d998af62&page=queryresults
[0m15:35:13.064445 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:dd5f4a8d-f993-4177-9b4a-2c01fde4b1d7&page=queryresults
[0m15:35:13.172670 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: Date at [51:9]')
[0m15:35:13.185636 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:dd5f4a8d-f993-4177-9b4a-2c01fde4b1d7&page=queryresults
[0m15:35:13.186650 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (execute): 15:35:11.028426 => 15:35:13.186650
[0m15:35:13.192617 [debug] [Thread-2 (]: Database Error in model mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (models\mart\single_source_data\google_analytics\mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized.sql)
  Unrecognized name: Date at [35:11]
  compiled Code at target\run\bq_evo\models\mart\single_source_data\google_analytics\mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized.sql
[0m15:35:13.193615 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CCC1FD0>]}
[0m15:35:13.194621 [error] [Thread-2 (]: 18 of 22 ERROR creating sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [[31mERROR[0m in 2.17s]
[0m15:35:13.196621 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m15:35:13.198605 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_metainformation_campaigns
[0m15:35:13.199599 [info ] [Thread-2 (]: 21 of 22 START sql table model mart.mrt_metainformation_campaigns .............. [RUN]
[0m15:35:13.200597 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized, now model.bq_evo.mrt_metainformation_campaigns)
[0m15:35:13.201593 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_metainformation_campaigns
[0m15:35:13.205583 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_metainformation_campaigns"
[0m15:35:13.207583 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (compile): 15:35:13.201593 => 15:35:13.207583
[0m15:35:13.208580 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_metainformation_campaigns
[0m15:35:13.219549 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_metainformation_campaigns"
[0m15:35:13.222054 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:35:13.223055 [debug] [Thread-2 (]: On model.bq_evo.mrt_metainformation_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_metainformation_campaigns"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_metainformation_campaigns`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt Kampagnen aus allen Quelldatensystemen mit Metainformationen."""
    )
    as (
      

WITH _googleads_campaigns AS(
    SELECT
        campaign as Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_google_analytics_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        CASE
            WHEN Medium IN ('cpc', 'ppc','cpa', 'cpm', 'cpv', 'cpp') THEN 'true' 
            ELSE 'false'
        END as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
),

_bingads_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_merged_googleads_and_analytics AS(
    SELECT * FROM _googleads_campaigns
    UNION ALL
    SELECT * FROM _google_analytics_campaigns
),

_merged_bingads AS(
    SELECT * FROM _merged_googleads_and_analytics
    UNION ALL
    SELECT * FROM _bingads_campaigns    
)

_final AS(
    SELECT 
        DISTINCT *
    FROM _merged_bingads
)

SELECT * FROM _final
    );
  
[0m15:35:13.537936 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c39e9330-4419-487f-be14-8315f68f111f&page=queryresults
[0m15:35:13.750386 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c30c6878-ef0b-4544-87db-4b355e28e76e&page=queryresults
[0m15:35:13.751383 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "_final" at [65:1]')
[0m15:35:13.911702 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c39e9330-4419-487f-be14-8315f68f111f&page=queryresults
[0m15:35:13.914690 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (execute): 15:35:12.296375 => 15:35:13.914690
[0m15:35:13.920668 [debug] [Thread-4 (]: Database Error in model mrt_google_analytics_merged_ua_ga4_transactions_summarized (models\mart\single_source_data\google_analytics\mrt_google_analytics_merged_ua_ga4_transactions_summarized.sql)
  Unrecognized name: Date at [51:9]
  compiled Code at target\run\bq_evo\models\mart\single_source_data\google_analytics\mrt_google_analytics_merged_ua_ga4_transactions_summarized.sql
[0m15:35:13.921630 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CD14C90>]}
[0m15:35:13.921630 [error] [Thread-4 (]: 20 of 22 ERROR creating sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [[31mERROR[0m in 1.63s]
[0m15:35:13.923137 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m15:35:13.924138 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m15:35:13.925135 [info ] [Thread-4 (]: 22 of 22 START sql incremental model mart.mrt_google_ads_basic_campaign_stats .. [RUN]
[0m15:35:13.926132 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized, now model.bq_evo.mrt_google_ads_basic_campaign_stats)
[0m15:35:13.927131 [debug] [Thread-4 (]: Began compiling node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m15:35:13.931152 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m15:35:13.990962 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (compile): 15:35:13.927131 => 15:35:13.989962
[0m15:35:13.991962 [debug] [Thread-4 (]: Began executing node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m15:35:13.994982 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:35:14.030406 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (execute): 15:35:11.129675 => 15:35:14.029409
[0m15:35:14.031404 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CB90410>]}
[0m15:35:14.032401 [info ] [Thread-3 (]: 19 of 22 OK created sql incremental model mart.mrt_bing_ads_basic_campaign_stats  [[32mCREATE TABLE (3.2k rows, 957.9 KiB processed)[0m in 2.91s]
[0m15:35:14.033398 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m15:35:14.514487 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m15:35:14.516482 [debug] [Thread-4 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

    
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m15:35:14.601716 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a73e82d2-72ae-4d83-8f13-a4ebaf4a75b1&page=queryresults
[0m15:35:14.602713 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a73e82d2-72ae-4d83-8f13-a4ebaf4a75b1&page=queryresults
[0m15:35:14.603710 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (execute): 15:35:13.208580 => 15:35:14.603710
[0m15:35:14.607701 [debug] [Thread-2 (]: Database Error in model mrt_metainformation_campaigns (models\mart\multi_source_data\mrt_metainformation_campaigns.sql)
  Syntax error: Unexpected identifier "_final" at [65:1]
  compiled Code at target\run\bq_evo\models\mart\multi_source_data\mrt_metainformation_campaigns.sql
[0m15:35:14.607701 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CD0A950>]}
[0m15:35:14.608697 [error] [Thread-2 (]: 21 of 22 ERROR creating sql table model mart.mrt_metainformation_campaigns ..... [[31mERROR[0m in 1.41s]
[0m15:35:14.610694 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_metainformation_campaigns
[0m15:35:14.850909 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:1f1fe6ee-b845-4808-a3cc-975e2e7c727b&page=queryresults
[0m15:35:17.220767 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (execute): 15:35:13.991962 => 15:35:17.219768
[0m15:35:17.222709 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96CDCB590>]}
[0m15:35:17.223669 [info ] [Thread-4 (]: 22 of 22 OK created sql incremental model mart.mrt_google_ads_basic_campaign_stats  [[32mCREATE TABLE (87.8k rows, 10.2 MiB processed)[0m in 3.30s]
[0m15:35:17.224699 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m15:35:21.206894 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (execute): 15:35:10.848515 => 15:35:21.206894
[0m15:35:21.207891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3ba4ca-23aa-4432-90a1-5d8faaf9228f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96C8F9650>]}
[0m15:35:21.208925 [info ] [Thread-1 (]: 16 of 22 OK created sql incremental model mart.mrt_google_analytics_campaign_webperformance  [[32mCREATE TABLE (11.2k rows, 1.2 GiB processed)[0m in 10.37s]
[0m15:35:21.209886 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m15:35:21.211881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:21.212912 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:35:21.212912 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:35:21.214375 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:35:21.214375 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m15:35:21.215375 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m15:35:21.215375 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m15:35:21.216372 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance' was properly closed.
[0m15:35:21.216372 [debug] [MainThread]: Connection 'model.bq_evo.mrt_metainformation_campaigns' was properly closed.
[0m15:35:21.217370 [debug] [MainThread]: Connection 'model.bq_evo.mrt_bing_ads_basic_campaign_stats' was properly closed.
[0m15:35:21.217370 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_ads_basic_campaign_stats' was properly closed.
[0m15:35:21.218369 [info ] [MainThread]: 
[0m15:35:21.219364 [info ] [MainThread]: Finished running 16 view models, 5 incremental models, 1 table model in 0 hours 0 minutes and 19.32 seconds (19.32s).
[0m15:35:21.224353 [debug] [MainThread]: Command end result
[0m15:35:21.237829 [info ] [MainThread]: 
[0m15:35:21.238830 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:35:21.239827 [info ] [MainThread]: 
[0m15:35:21.240824 [error] [MainThread]:   Database Error in model mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (models\mart\single_source_data\google_analytics\mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized.sql)
  Unrecognized name: Date at [35:11]
  compiled Code at target\run\bq_evo\models\mart\single_source_data\google_analytics\mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized.sql
[0m15:35:21.242843 [info ] [MainThread]: 
[0m15:35:21.243867 [error] [MainThread]:   Database Error in model mrt_google_analytics_merged_ua_ga4_transactions_summarized (models\mart\single_source_data\google_analytics\mrt_google_analytics_merged_ua_ga4_transactions_summarized.sql)
  Unrecognized name: Date at [51:9]
  compiled Code at target\run\bq_evo\models\mart\single_source_data\google_analytics\mrt_google_analytics_merged_ua_ga4_transactions_summarized.sql
[0m15:35:21.244896 [info ] [MainThread]: 
[0m15:35:21.246042 [error] [MainThread]:   Database Error in model mrt_metainformation_campaigns (models\mart\multi_source_data\mrt_metainformation_campaigns.sql)
  Syntax error: Unexpected identifier "_final" at [65:1]
  compiled Code at target\run\bq_evo\models\mart\multi_source_data\mrt_metainformation_campaigns.sql
[0m15:35:21.247075 [info ] [MainThread]: 
[0m15:35:21.248079 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=3 SKIP=0 TOTAL=22
[0m15:35:21.249258 [debug] [MainThread]: Command `dbt run` failed at 15:35:21.249258 after 20.00 seconds
[0m15:35:21.249258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96AD456D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96AD9F390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96AA49C10>]}
[0m15:35:22.231221 [debug] [MainThread]: Flushing usage events
[0m15:40:16.711642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDD66EF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDD6FC8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDD929C50>]}


============================== 15:40:16.715665 | db7ea425-dd3e-4f54-9923-f945d30adeee ==============================
[0m15:40:16.715665 [info ] [MainThread]: Running with dbt=1.6.2
[0m15:40:16.716405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:40:17.055369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF011AD0>]}
[0m15:40:17.063348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDD92A650>]}
[0m15:40:17.064314 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m15:40:17.113799 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m15:40:17.205591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:40:17.206591 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\sources.yml
[0m15:40:17.206591 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\google_analytics\stg_google_analytics_historic_goal_conversions.sql
[0m15:40:17.207573 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\google_analytics\stg_google_analytics_historic_transactions.sql
[0m15:40:17.293936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF4662D0>]}
[0m15:40:17.313509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF61C290>]}
[0m15:40:17.315472 [info ] [MainThread]: Found 22 models, 18 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:40:17.316469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF586910>]}
[0m15:40:17.319462 [info ] [MainThread]: 
[0m15:40:17.320457 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:40:17.322452 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:40:17.323450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:17.323450 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:40:17.324475 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:40:17.325445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:17.326442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:20.015585 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m15:40:20.018103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:20.019096 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m15:40:20.021127 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m15:40:20.024117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:20.025082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:20.691670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF446750>]}
[0m15:40:20.692669 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:40:20.693666 [info ] [MainThread]: 
[0m15:40:20.697655 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_bing_ads_campaign_history
[0m15:40:20.698662 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:40:20.698662 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_google_ads_campaign_history
[0m15:40:20.699685 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m15:40:20.699685 [info ] [Thread-1 (]: 1 of 22 START sql view model staging.stg_bing_ads_campaign_history ............. [RUN]
[0m15:40:20.700647 [info ] [Thread-2 (]: 2 of 22 START sql view model staging.stg_bing_ads_campaign_performance_daily_report  [RUN]
[0m15:40:20.701646 [info ] [Thread-3 (]: 3 of 22 START sql view model staging.stg_google_ads_campaign_history ........... [RUN]
[0m15:40:20.703643 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_history'
[0m15:40:20.702642 [info ] [Thread-4 (]: 4 of 22 START sql view model staging.stg_google_ads_campaign_stats ............. [RUN]
[0m15:40:20.704639 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_performance_daily_report'
[0m15:40:20.706635 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_history'
[0m15:40:20.707637 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_history
[0m15:40:20.708630 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m15:40:20.709665 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:40:20.710627 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_history
[0m15:40:20.718119 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m15:40:20.719123 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m15:40:20.722113 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m15:40:20.726103 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_history"
[0m15:40:20.730125 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m15:40:20.730125 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (compile): 15:40:20.710627 => 15:40:20.730125
[0m15:40:20.732088 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (compile): 15:40:20.719123 => 15:40:20.732088
[0m15:40:20.734081 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (compile): 15:40:20.723145 => 15:40:20.733087
[0m15:40:20.734081 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_history
[0m15:40:20.735079 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 15:40:20.727100 => 15:40:20.735079
[0m15:40:20.736075 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:40:20.737074 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_google_ads_campaign_history
[0m15:40:20.767992 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m15:40:20.768987 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m15:40:20.772528 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m15:40:20.775540 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_history"
[0m15:40:20.779069 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m15:40:20.780016 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:40:20.781017 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:40:20.782014 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:40:20.783011 [debug] [Thread-1 (]: On model.bq_evo.stg_bing_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_history`
),


_added_columns AS (
    SELECT
        *,
        'cpc' as Medium,
        'bing' as Source,
        (CASE 
            WHEN account_id = 156001989 THEN 'EVO'
        END) as Partner,
    FROM _raw
),

_added_campaignid AS (
    SELECT 
        *,
        LOWER (CONCAT(name, Source, Medium, Partner)) as CampaignID
    FROM _added_columns
),

_final AS(
    SELECT *
    FROM _added_campaignid
)

SELECT * FROM _final;


[0m15:40:20.784010 [debug] [Thread-2 (]: On model.bq_evo.stg_bing_ads_campaign_performance_daily_report: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_performance_daily_report`
),

_renamed_columns AS(
    SELECT 
        _fivetran_id,
        _fivetran_synced,
        account_id,
        ad_distribution,
        ad_relevance,
        all_conversions,
        all_conversions_qualified,
        all_return_on_ad_spend,
        all_revenue,
        assists,
        average_cpc,
        average_position,
        bid_match_type,
        budget_association_status,
        campaign_id,
        campaign_name,
        campaign_status,
        clicks as Clicks,
        conversions,
        conversions_qualified,
        ctr,
        currency_code,
        date as Date,
        delivered_match_type,
        device_os,
        device_type,
        expected_ctr,
        historical_ad_relevance,
        historical_expected_ctr,
        historical_landing_page_experience,
        historical_quality_score,
        impressions as Impressions,
        landing_page_experience,
        low_quality_clicks,
        low_quality_clicks_percent,
        low_quality_conversion_rate,
        low_quality_conversions,
        low_quality_conversions_qualified,
        low_quality_general_clicks,
        low_quality_impressions,
        low_quality_impressions_percent,
        low_quality_sophisticated_clicks,
        network,
        phone_calls,
        phone_impressions,
        quality_score,
        return_on_ad_spend,
        revenue,
        spend as Cost,
        top_vs_other,
        view_through_conversions
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m15:40:20.785094 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:40:20.786037 [debug] [Thread-3 (]: On model.bq_evo.stg_google_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_history`
),

_renamed_columns AS(
  SELECT
    _fivetran_start,
    id,
    _fivetran_active,
    _fivetran_end,
    _fivetran_synced,
    ad_serving_optimization_status,
    advertising_channel_subtype,
    advertising_channel_type,
    base_campaign_id,
    customer_id,
    end_date,
    experiment_type,
    final_url_suffix,
    frequency_caps,
    name as campaign,
    optimization_score,
    payment_mode,
    serving_status,
    start_date,
    status,
    tracking_url_template,
    updated_at,
    vanity_pharma_display_url_mode,
    vanity_pharma_text,
    video_brand_safety_suitability
  FROM _raw
),

_add_new_columns AS(
  SELECT 
    *,
    'google' as Source,
    'cpc' as Medium,
    (CASE
      WHEN customer_id = 6607387807 THEN 'EVO'  
      ELSE '(null)'
    END) as Partner
  FROM _renamed_columns
),

_final AS(
  SELECT
    *,
    LOWER(CONCAT(campaign, Source, Medium, Partner)) as CampaignID
  FROM _add_new_columns
)

SELECT * FROM _final;


[0m15:40:20.789993 [debug] [Thread-4 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Google Ads Kampagnen"""
    )
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_transformed_cost AS(
    SELECT
        _fivetran_id,
        customer_id,
        date,
        _fivetran_synced,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability,
        ad_network_type,
        base_campaign,
        clicks,
        conversions,
        conversions_value,
        cost_micros/1000000 as cost,
        device,
        id,
        impressions,
        interaction_event_types,
        interactions,
        view_through_conversions,
    FROM _raw
),

_final AS(
    SELECT * FROM _transformed_cost
)

SELECT * FROM _final;


[0m15:40:21.567084 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c9da3e65-0fa0-4544-a502-e180235e85c8&page=queryresults
[0m15:40:21.567084 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:345ed85d-43ec-400e-bdd8-efecc93b860a&page=queryresults
[0m15:40:21.568116 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a3e27678-c5fa-48ab-a37c-c6b4fbc6e514&page=queryresults
[0m15:40:21.573858 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3f79c698-4c8b-4430-8773-074c2f505594&page=queryresults
[0m15:40:21.807153 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (execute): 15:40:20.768987 => 15:40:21.806156
[0m15:40:21.809148 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF764990>]}
[0m15:40:21.810162 [info ] [Thread-2 (]: 2 of 22 OK created sql view model staging.stg_bing_ads_campaign_performance_daily_report  [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m15:40:21.811173 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:40:21.812138 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_google_analytics_352128287
[0m15:40:21.813136 [info ] [Thread-2 (]: 5 of 22 START sql view model staging.stg_google_analytics_352128287 ............ [RUN]
[0m15:40:21.814133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_performance_daily_report, now model.bq_evo.stg_google_analytics_352128287)
[0m15:40:21.815131 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_google_analytics_352128287
[0m15:40:21.819119 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_352128287"
[0m15:40:21.820621 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (compile): 15:40:21.815131 => 15:40:21.820117
[0m15:40:21.820621 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_google_analytics_352128287
[0m15:40:21.824613 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_352128287"
[0m15:40:21.825610 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:40:21.827606 [debug] [Thread-2 (]: On model.bq_evo.stg_google_analytics_352128287: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_352128287"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
  OPTIONS(
      description="""Enth\u00e4lt alle GA4-Events in Tabellenform ohne Schachtelung. Bereinigt fehlerhafte Events ohne Session-ID. Offzielle Doku Google > https://support.google.com/analytics/answer/7029846?hl=en#zippy="""
    )
  as WITH _source AS(
  SELECT
    PARSE_DATE('%Y%m%d', event_date) as event_date,
    TIMESTAMP_MICROS(event_timestamp) as event_ts,
    
    MAX(CASE WHEN params.key = 'ga_session_id' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_id,
    user_pseudo_id,
    TIMESTAMP_MICROS(user_first_touch_timestamp) as user_first_touch_ts,

    event_name,

    params.key as params_key,
    params.value.string_value as params_string_value,
    params.value.int_value as params_int_value,
    params.value.float_value as params_float_value,
    params.value.double_value as params_double_value,

    (CASE WHEN traffic_source.name IS NULL THEN '(not set)' ELSE traffic_source.name END) as utm_campaign,
    (CASE WHEN traffic_source.medium IS NULL THEN '(not set)' ELSE traffic_source.medium END) as utm_medium,
    (CASE WHEN traffic_source.source IS NULL THEN '(not set)' ELSE traffic_source.source END) as utm_source,
    'EVO' as Partner,

    MAX(CASE WHEN params.key = 'page_title' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_title,
    MAX(CASE WHEN params.key = 'page_location' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_location,
    MAX(CASE WHEN params.key = 'page_referrer' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_referrer,
    MAX(CASE WHEN params.key = 'page_path' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_path,
    MAX(CASE WHEN params.key = 'percent_scrolled' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as percent_scrolled,
    MAX(CASE WHEN params.key = 'session_engaged' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_engaged,

    privacy_info.analytics_storage as analytics_storage,
    privacy_info.ads_storage as ads_storage,
    privacy_info.uses_transient_token as uses_transient_token,

    user_ltv.revenue as ltv_revenue,
    user_ltv.currency as ltv_currency,

    device.category as device_category,
    device.mobile_brand_name as device_brand,
    device.mobile_model_name as device_model_name,
    device.mobile_marketing_name as device_marketing_name,
    device.mobile_os_hardware_model as device_mobile_os_hardware_model,
    device.operating_system as device_os,
    device.operating_system_version as device_os_version,
    device.vendor_id as device_vendor_id,
    device.advertising_id as device_advertising_id,
    device.language as device_language,
    device.is_limited_ad_tracking as device_is_limited_ad_tracking,
    device.time_zone_offset_seconds as device_time_zone_offset_seconds,
    device.browser as device_browser,
    device.browser_version as device_browser_version,
    device.web_info.browser as device_web_info_browser,
    device.web_info.browser_version as device_web_info_browser_version,
    device.web_info.hostname as browser_web_info_hostname,

    geo.continent as continent,
    geo.country as country,
    geo.region as region,
    geo.city as city,
    geo.sub_continent as sub_continent,
    geo.metro as metropolitan_area,

    app_info.id as app_id,
    app_info.version as app_version,
    app_info.install_store as app_install_store,
    app_info.firebase_app_id as app_firebase_app_id,
    app_info.install_source as app_install_source,

    event_dimensions.hostname as event_hostname,

    ecommerce.total_item_quantity as total_item_quantity,
    ecommerce.purchase_revenue_in_usd as purchase_revenue_in_usd,
    ecommerce.purchase_revenue as purchase_revenue,
    ecommerce.refund_value_in_usd as refund_value_in_usd,
    ecommerce.refund_value as refund_value,
    ecommerce.shipping_value_in_usd as shipping_value_in_usd,
    ecommerce.shipping_value as shipping_value,
    ecommerce.tax_value_in_usd as tax_value_in_usd,
    ecommerce.tax_value as tax_value,
    ecommerce.unique_items as unique_items,
    ecommerce.transaction_id as transaction_id,
    
    items.item_id as item_id,
    items.item_name as item_name,
    items.item_brand as item_brand,
    items.item_variant as item_variant,
    items.item_category as item_category,
    items.item_category2 as item_category2,
    items.item_category3 as item_category3,
    items.item_category4 as item_category4,
    items.item_category5 as item_category5,
    items.price_in_usd as price_in_usd,
    items.price as price,
    items.quantity as quantity,
    items.item_revenue_in_usd as item_revenue_in_usd,
    items.item_revenue as item_revenue,
    items.item_refund_in_usd as item_refund_in_usd,
    items.item_refund as item_refund,
    items.coupon as coupon,
    items.affiliation as affiliation,
    items.location_id as location_id,
    items.item_list_id as item_list_id,
    items.item_list_name as item_list_name,
    items.item_list_index as item_list_index,
    items.promotion_id as promotion_id,
    items.promotion_name as promotion_name,
    items.creative_name as creative_name,
    items.creative_slot as creative_slot,

    collected_traffic_source.manual_campaign_id as manual_campaign_id,
    collected_traffic_source.manual_campaign_name as manual_campaign_name,
    collected_traffic_source.manual_source as manual_source,
    collected_traffic_source.manual_medium as manual_medium,
    collected_traffic_source.manual_term as manual_term,
    collected_traffic_source.manual_content as manual_content,
    collected_traffic_source.gclid as gclid,
    collected_traffic_source.dclid as dclid,
    collected_traffic_source.srsltid as srsltid

  FROM `oss-big-query-dashboard-prod`.`analytics_352128287`.`events_*` as events
  LEFT JOIN UNNEST (event_params) as params
  /*LEFT JOIN UNNEST (privacy_info) as privacy_info
  LEFT JOIN UNNEST (user_ltv) as user_ltv*/
  LEFT JOIN UNNEST(items) as items 
),

events_aggregated as (
  SELECT
    event_date,
    event_ts,
    session_id,
    user_pseudo_id,
    user_first_touch_ts,
    event_name,

--Kampagneninformationen
    MAX(utm_campaign) as utm_campaign,
    MAX(utm_medium) as utm_medium,
    (CASE WHEN MAX(utm_source) = 'ig' THEN 'instagram' ELSE MAX(utm_source) END) as utm_source,
  --  (CASE WHEN MAX(utm_campaign) IS NULL THEN '(not set)' ELSE MAX(utm_campaign) END) as utm_campaign,
  --  (CASE WHEN MAX(utm_medium) IS NULL THEN '(not set)' ELSE MAX(utm_medium) END) as utm_medium,
  --  (CASE WHEN MAX(utm_source) IS NULL THEN '(not set)' ELSE MAX(utm_source) END) as utm_source,

--Seiteninformationen
    MAX(page_title) as page_title,
    MAX(page_location) as page_location,
    MAX(page_referrer) as page_referrer,
    MAX(page_path) as page_path,
    MAX(percent_scrolled) as percent_scrolled,
    MAX(session_engaged) as session_engaged,

--Privacy-Infos
    MAX(analytics_storage) as analytics_storage,
    MAX(ads_storage) as ads_storage,
    MAX(uses_transient_token) as uses_transient_token,

--Kundenwertinformationen
    MAX(ltv_revenue) as ltv_revenue,
    MAX(ltv_currency) as ltv_currency,

--Geräteinformationen
    MAX(device_category) as device_category,
    MAX(device_brand) as device_brand,
    MAX(device_model_name) as device_model_name,
    MAX(device_marketing_name) as device_marketing_name,
    MAX(device_mobile_os_hardware_model) as device_mobile_os_hardware_model,
    MAX(device_os) as device_os,
    MAX(device_os_version) as device_os_version,
    MAX(device_vendor_id) as device_vendor_id,
    MAX(device_advertising_id) as device_advertising_id,
    MAX(device_language) as device_language,
    MAX(device_is_limited_ad_tracking) as device_is_limited_ad_tracking,
    MAX(device_time_zone_offset_seconds) as device_time_zone_offset_seconds,
    MAX(device_browser) as device_browser,
    MAX(device_browser_version) as device_browser_version,
    MAX(device_web_info_browser) as device_web_info_browser,
    MAX(device_web_info_browser_version) as device_web_info_browser_version,
    MAX(browser_web_info_hostname) as browser_web_info_hostname,

--Gebietsinformationen
    MAX(continent) as continent,
    MAX(country) as country,
    MAX(region) as region,
    MAX(city) as city,
    MAX(sub_continent) as sub_continent,
    MAX(metropolitan_area) as metropolitan_area,

--App-Informationen
    MAX(app_id) as app_id,
    MAX(app_version) as app_version,
    MAX(app_install_store) as app_install_store,
    MAX(app_firebase_app_id) as app_firebase_app_id,
    MAX(app_install_source) as app_install_source,

    MAX(event_hostname) as event_hostname,

--E-Commerceinformationen
    MAX(total_item_quantity) as total_item_quantity,
    MAX(purchase_revenue_in_usd) as purchase_revenue_in_usd,
    MAX(purchase_revenue) as purchase_revenue,
    MAX(refund_value_in_usd) as refund_value_in_usd,
    MAX(refund_value) as refund_value,
    MAX(shipping_value_in_usd) as shipping_value_in_usd,
    MAX(shipping_value) as shipping_value,
    MAX(tax_value_in_usd) as tax_value_in_usd,
    MAX(tax_value) as tax_value,
    MAX(unique_items) as unique_items,
    MAX(transaction_id) as transaction_id,

--Warenkorbinformationen
    MAX(item_id) as item_id,
    MAX(item_name) as item_name,
    MAX(item_brand) as item_brand,
    MAX(item_variant) as item_variant,
    MAX(item_category) as item_category,
    MAX(item_category2) as item_category2,
    MAX(item_category3) as item_category3,
    MAX(item_category4) as item_category4,
    MAX(item_category5) as item_category5,
    MAX(price_in_usd) as price_in_usd,
    MAX(price) as price,
    MAX(quantity) as quantity,
    MAX(item_revenue_in_usd) as item_revenue_in_usd,
    MAX(item_revenue) as item_revenue,
    MAX(item_refund_in_usd) as item_refund_in_usd,
    MAX(item_refund) as item_refund,
    MAX(coupon) as coupon,
    MAX(affiliation) as affiliation,
    MAX(location_id) as location_id,
    MAX(item_list_id) as item_list_id,
    MAX(item_list_name) as item_list_name,
    MAX(item_list_index) as item_list_index,
    MAX(promotion_id) as promotion_id,
    MAX(promotion_name) as promotion_name,
    MAX(creative_name) as creative_name,
    MAX(creative_slot) as creative_slot,

--Manuelle Trackingparameter
    MAX(manual_campaign_id) as manual_campaign_id,
    MAX(manual_campaign_name) as manual_campaign_name,
    MAX(manual_source) as manual_source,
    MAX(manual_medium) as manual_medium,
    MAX(manual_term) as manual_term,
    MAX(manual_content) as manual_content,
    MAX(gclid) as gclid,
    MAX(dclid) as dclid,
    MAX(srsltid) as srsltid

  FROM _source
  WHERE session_id <> 0
  GROUP BY 1,2,3,4,5,6
)

SELECT *
  --DISTINCT event_date
FROM events_aggregated;


[0m15:40:22.102224 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (execute): 15:40:20.738069 => 15:40:22.101228
[0m15:40:22.103227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF7544D0>]}
[0m15:40:22.105182 [info ] [Thread-1 (]: 1 of 22 OK created sql view model staging.stg_bing_ads_campaign_history ........ [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m15:40:22.106185 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_history
[0m15:40:22.106185 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_analytics_historic_campaigns
[0m15:40:22.107180 [info ] [Thread-1 (]: 6 of 22 START sql view model staging.stg_google_analytics_historic_campaigns ... [RUN]
[0m15:40:22.108210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_history, now model.bq_evo.stg_google_analytics_historic_campaigns)
[0m15:40:22.109175 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_campaigns
[0m15:40:22.112201 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_campaigns"
[0m15:40:22.113197 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_historic_campaigns (compile): 15:40:22.109175 => 15:40:22.113197
[0m15:40:22.114162 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_analytics_historic_campaigns
[0m15:40:22.117153 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_campaigns"
[0m15:40:22.119150 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (execute): 15:40:20.772528 => 15:40:22.119150
[0m15:40:22.120659 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF432F10>]}
[0m15:40:22.120659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:22.122656 [debug] [Thread-1 (]: On model.bq_evo.stg_google_analytics_historic_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle historischen Kampagnen aus Universal Analytics / GA3"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_campaigns`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m15:40:22.121659 [info ] [Thread-3 (]: 3 of 22 OK created sql view model staging.stg_google_ads_campaign_history ...... [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m15:40:22.124652 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_google_ads_campaign_history
[0m15:40:22.125651 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m15:40:22.126648 [info ] [Thread-3 (]: 7 of 22 START sql view model staging.stg_google_analytics_historic_goal_conversions  [RUN]
[0m15:40:22.127663 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_ads_campaign_history, now model.bq_evo.stg_google_analytics_historic_goal_conversions)
[0m15:40:22.128643 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m15:40:22.131634 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_goal_conversions"
[0m15:40:22.133633 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_analytics_historic_goal_conversions (compile): 15:40:22.128643 => 15:40:22.132632
[0m15:40:22.133633 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m15:40:22.137619 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_goal_conversions"
[0m15:40:22.138617 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:40:22.139615 [debug] [Thread-3 (]: On model.bq_evo.stg_google_analytics_historic_goal_conversions: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_goal_conversions"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_goal_conversions`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_goal_conversions`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m15:40:22.153613 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 15:40:20.775540 => 15:40:22.153613
[0m15:40:22.154607 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF7428D0>]}
[0m15:40:22.155569 [info ] [Thread-4 (]: 4 of 22 OK created sql view model staging.stg_google_ads_campaign_stats ........ [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m15:40:22.157598 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m15:40:22.158560 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_google_analytics_historic_transactions
[0m15:40:22.159558 [info ] [Thread-4 (]: 8 of 22 START sql view model staging.stg_google_analytics_historic_transactions  [RUN]
[0m15:40:22.160592 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_ads_campaign_stats, now model.bq_evo.stg_google_analytics_historic_transactions)
[0m15:40:22.161552 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_transactions
[0m15:40:22.164544 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_transactions"
[0m15:40:22.165542 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_analytics_historic_transactions (compile): 15:40:22.161552 => 15:40:22.165542
[0m15:40:22.166539 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_google_analytics_historic_transactions
[0m15:40:22.173520 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_transactions"
[0m15:40:22.174518 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:40:22.175515 [debug] [Thread-4 (]: On model.bq_evo.stg_google_analytics_historic_transactions: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_transactions"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_transactions`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_transactions`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m15:40:22.533473 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c44a9607-2978-4d04-bb72-710755a37df9&page=queryresults
[0m15:40:22.843912 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:907889c8-7450-4a96-a07b-9ef122c5b327&page=queryresults
[0m15:40:22.887426 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:b7fee0eb-c446-426b-a9a9-1a1f8cccb349&page=queryresults
[0m15:40:22.890566 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7684e0ec-b268-4261-b66f-06a3fc3e22f8&page=queryresults
[0m15:40:23.030474 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_analytics_historic_goal_conversions (execute): 15:40:22.134628 => 15:40:23.030474
[0m15:40:23.031433 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF7D6F50>]}
[0m15:40:23.032432 [info ] [Thread-3 (]: 7 of 22 OK created sql view model staging.stg_google_analytics_historic_goal_conversions  [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m15:40:23.034427 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m15:40:23.035424 [debug] [Thread-3 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:40:23.036424 [info ] [Thread-3 (]: 9 of 22 START sql view model intermediate.int_bing_ads_unique_campaigns ........ [RUN]
[0m15:40:23.037422 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_historic_goal_conversions, now model.bq_evo.int_bing_ads_unique_campaigns)
[0m15:40:23.038416 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:40:23.041442 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m15:40:23.043403 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (compile): 15:40:23.039414 => 15:40:23.043403
[0m15:40:23.044402 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:40:23.050383 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m15:40:23.051384 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:40:23.053414 [debug] [Thread-3 (]: On model.bq_evo.int_bing_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Bing Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id,
        MAX(name) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m15:40:23.056404 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (execute): 15:40:21.821622 => 15:40:23.056404
[0m15:40:23.058364 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF5572D0>]}
[0m15:40:23.059361 [info ] [Thread-2 (]: 5 of 22 OK created sql view model staging.stg_google_analytics_352128287 ....... [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m15:40:23.060359 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_google_analytics_352128287
[0m15:40:23.061356 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m15:40:23.062351 [info ] [Thread-2 (]: 10 of 22 START sql view model intermediate.int_google_ads_unique_campaigns ..... [RUN]
[0m15:40:23.064347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_352128287, now model.bq_evo.int_google_ads_unique_campaigns)
[0m15:40:23.064347 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m15:40:23.067338 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m15:40:23.069335 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 15:40:23.065343 => 15:40:23.069335
[0m15:40:23.070332 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m15:40:23.075317 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m15:40:23.076347 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:40:23.078348 [debug] [Thread-2 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id ,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m15:40:23.298915 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_analytics_historic_transactions (execute): 15:40:22.167536 => 15:40:23.297917
[0m15:40:23.298915 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF699E50>]}
[0m15:40:23.299877 [info ] [Thread-4 (]: 8 of 22 OK created sql view model staging.stg_google_analytics_historic_transactions  [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m15:40:23.301876 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_google_analytics_historic_transactions
[0m15:40:23.302906 [debug] [Thread-4 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m15:40:23.303902 [info ] [Thread-4 (]: 11 of 22 START sql view model intermediate.int_google_analytics_all_events ..... [RUN]
[0m15:40:23.305895 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_historic_transactions, now model.bq_evo.int_google_analytics_all_events)
[0m15:40:23.306894 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m15:40:23.309921 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m15:40:23.310918 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 15:40:23.306894 => 15:40:23.310918
[0m15:40:23.311883 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m15:40:23.314907 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m15:40:23.315872 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:40:23.316869 [debug] [Thread-4 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_final AS(
    SELECT *
    FROM _rename_columns
)

SELECT * FROM _final;


[0m15:40:23.581306 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_historic_campaigns (execute): 15:40:22.114162 => 15:40:23.580308
[0m15:40:23.581306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF46BE50>]}
[0m15:40:23.582303 [info ] [Thread-1 (]: 6 of 22 OK created sql view model staging.stg_google_analytics_historic_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m15:40:23.584335 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_analytics_historic_campaigns
[0m15:40:23.786600 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4b8d9b02-ba77-42c5-922e-31621afc45be&page=queryresults
[0m15:40:23.796724 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6ee8426e-e8b2-49d3-82f7-7e2995e51282&page=queryresults
[0m15:40:24.042108 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6a461533-802e-4285-95a2-7783b3e7bf28&page=queryresults
[0m15:40:24.471500 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 15:40:23.071334 => 15:40:24.471500
[0m15:40:24.472491 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF754D10>]}
[0m15:40:24.473455 [info ] [Thread-2 (]: 10 of 22 OK created sql view model intermediate.int_google_ads_unique_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m15:40:24.475424 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m15:40:24.476421 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m15:40:24.476421 [info ] [Thread-1 (]: 12 of 22 START sql view model intermediate.int_google_ads_campaign_stats ....... [RUN]
[0m15:40:24.477660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_historic_campaigns, now model.bq_evo.int_google_ads_campaign_stats)
[0m15:40:24.478695 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m15:40:24.481654 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m15:40:24.483681 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 15:40:24.478695 => 15:40:24.483681
[0m15:40:24.484650 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m15:40:24.488662 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m15:40:24.490662 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (execute): 15:40:23.044402 => 15:40:24.489669
[0m15:40:24.491629 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF4B6110>]}
[0m15:40:24.492631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:24.492631 [info ] [Thread-3 (]: 9 of 22 OK created sql view model intermediate.int_bing_ads_unique_campaigns ... [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m15:40:24.493623 [debug] [Thread-1 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
),

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m15:40:24.495616 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:40:24.497638 [debug] [Thread-2 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:40:24.498660 [info ] [Thread-2 (]: 13 of 22 START sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [RUN]
[0m15:40:24.499606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_unique_campaigns, now model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names)
[0m15:40:24.500629 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:40:24.504592 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m15:40:24.506617 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (compile): 15:40:24.501623 => 15:40:24.505619
[0m15:40:24.507611 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:40:24.510603 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m15:40:24.512574 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:40:24.513592 [debug] [Thread-2 (]: On model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne inkl. Klartext der Kampagne."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m15:40:24.782899 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 15:40:23.312879 => 15:40:24.782899
[0m15:40:24.783896 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDFA83C10>]}
[0m15:40:24.784893 [info ] [Thread-4 (]: 11 of 22 OK created sql view model intermediate.int_google_analytics_all_events  [[32mCREATE VIEW (0 processed)[0m in 1.48s]
[0m15:40:24.785891 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m15:40:24.786888 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m15:40:24.786888 [debug] [Thread-4 (]: Began running node model.bq_evo.int_google_analytics_all_campaigns
[0m15:40:24.787885 [info ] [Thread-3 (]: 14 of 22 START sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [RUN]
[0m15:40:24.789881 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_unique_campaigns, now model.bq_evo.int_google_analytics_NDG_conversionevents_GA4)
[0m15:40:24.788883 [info ] [Thread-4 (]: 15 of 22 START sql view model intermediate.int_google_analytics_all_campaigns .. [RUN]
[0m15:40:24.789881 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m15:40:24.790877 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_events, now model.bq_evo.int_google_analytics_all_campaigns)
[0m15:40:24.795031 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m15:40:24.795031 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_google_analytics_all_campaigns
[0m15:40:24.799252 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (compile): 15:40:24.791875 => 15:40:24.799252
[0m15:40:24.806712 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m15:40:24.807718 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m15:40:24.811145 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m15:40:24.812148 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (compile): 15:40:24.796035 => 15:40:24.812148
[0m15:40:24.813153 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_google_analytics_all_campaigns
[0m15:40:24.814149 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:40:24.817247 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m15:40:24.818251 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_NDG_conversionevents_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle relevanten Conversionevents aus Google Analytics 4 f\u00fcr NDG-Vermarktung. Inklusive aller E-Commerce-Events (ohne Metainformationen)."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_conversions_NDG as(
  SELECT 
    event_date as Date,
    event_name as ZielvorhabenName, 
    CampaignID,
    Source,
    Medium,

    MAX(Partner) as Partner,

    count(event_date) as Conversions,

  FROM _raw
  WHERE (
    event_name = 'lead_form_evo_solar_lp' OR
    event_name = 'evo_solar_pva_check_sent_available' OR
    event_name = 'contact_form_button' OR
    event_name = 'click_online_application' OR
    event_name = 'oss_registration_doi' OR
    event_name = 'click_tarifrechnernutzung' OR
    event_name = 'conversion_solarrechner' OR
    event_name = 'purchase'
  )

  GROUP BY 1,2,3,4,5
),

_added_columns AS(
  SELECT 
      Date,
      ZielvorhabenName,
      LOWER(CONCAT(ZielvorhabenName, Partner)) as ZielvorhabenID,
      CampaignID,
      Source,
      Medium,
      Partner,
      '(not set)' as Keyword,
      '(not set)' as KeywordMatchType,
      Conversions
  FROM _conversions_NDG
),

_final AS(
  SELECT *
  FROM _added_columns
)

SELECT * FROM _final;


[0m15:40:24.820428 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:40:24.821422 [debug] [Thread-4 (]: On model.bq_evo.int_google_analytics_all_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagnen aus GA4 und GA3."""
    )
  as WITH _historic_ua_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
),

ga4_campaigns AS(
    SELECT 
        MAX(Campaign),
        MAX(Partner),
        MAX(Source),
        MAX(Medium),
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
    GROUP BY 5
),

_final AS(
    SELECT * FROM _historic_ua_campaigns
    UNION DISTINCT
    SELECT * FROM ga4_campaigns
)

SELECT * FROM _final;


[0m15:40:25.243520 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a9175065-fae7-46dd-969c-d0f74b49acdf&page=queryresults
[0m15:40:25.273474 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3d1a932a-0760-4aa2-8242-1b1758acda93&page=queryresults
[0m15:40:25.543595 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:d50f46eb-f47c-47e1-970f-0dcee0826f44&page=queryresults
[0m15:40:25.582797 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:65ff5961-1c2b-4f1b-8510-9f056f7ccf5a&page=queryresults
[0m15:40:25.910113 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 15:40:24.484650 => 15:40:25.910113
[0m15:40:25.911115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF430690>]}
[0m15:40:25.912110 [info ] [Thread-1 (]: 12 of 22 OK created sql view model intermediate.int_google_ads_campaign_stats .. [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m15:40:25.913122 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m15:40:25.914107 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:40:25.915105 [info ] [Thread-1 (]: 16 of 22 START sql view model intermediate.int_google_analytics_all_purchases_GA4  [RUN]
[0m15:40:25.916137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_campaign_stats, now model.bq_evo.int_google_analytics_all_purchases_GA4)
[0m15:40:25.916137 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:40:25.919130 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m15:40:25.921089 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (compile): 15:40:25.917115 => 15:40:25.921089
[0m15:40:25.922094 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:40:25.926076 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m15:40:25.931586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:25.932577 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_all_purchases_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_purchases_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle <purchase-events> aus Google Analytics 4. Inkl. aller zugeh\u00f6rigen Metainformationen aus GA4."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_select_purchase_events AS(
  SELECT * FROM _raw
  WHERE event_name = "purchase"
),

_final AS(
    SELECT *
    FROM _select_purchase_events
)

SELECT * FROM _final;


[0m15:40:25.953555 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (execute): 15:40:24.507611 => 15:40:25.953555
[0m15:40:25.954521 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDFAB28D0>]}
[0m15:40:25.955515 [info ] [Thread-2 (]: 13 of 22 OK created sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m15:40:25.957510 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:40:25.958507 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m15:40:25.959506 [info ] [Thread-2 (]: 17 of 22 START sql incremental model mart.mrt_google_analytics_campaign_webperformance  [RUN]
[0m15:40:25.960503 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names, now model.bq_evo.mrt_google_analytics_campaign_webperformance)
[0m15:40:25.961500 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m15:40:25.973468 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m15:40:25.975464 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (compile): 15:40:25.962522 => 15:40:25.974464
[0m15:40:25.981445 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m15:40:26.016353 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:40:26.186527 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (execute): 15:40:24.807718 => 15:40:26.186527
[0m15:40:26.187525 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDFA81D50>]}
[0m15:40:26.188524 [info ] [Thread-3 (]: 14 of 22 OK created sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m15:40:26.190515 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m15:40:26.191545 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m15:40:26.192509 [info ] [Thread-3 (]: 18 of 22 START sql incremental model mart.mrt_google_ads_basic_campaign_stats .. [RUN]
[0m15:40:26.194504 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_NDG_conversionevents_GA4, now model.bq_evo.mrt_google_ads_basic_campaign_stats)
[0m15:40:26.194504 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m15:40:26.199516 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m15:40:26.200522 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (compile): 15:40:26.195502 => 15:40:26.200522
[0m15:40:26.202482 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m15:40:26.213458 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:40:26.233914 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (execute): 15:40:24.814149 => 15:40:26.233914
[0m15:40:26.234911 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF7EB090>]}
[0m15:40:26.235908 [info ] [Thread-4 (]: 15 of 22 OK created sql view model intermediate.int_google_analytics_all_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m15:40:26.236907 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_google_analytics_all_campaigns
[0m15:40:26.237904 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m15:40:26.238902 [info ] [Thread-4 (]: 19 of 22 START sql incremental model mart.mrt_bing_ads_basic_campaign_stats .... [RUN]
[0m15:40:26.240896 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_campaigns, now model.bq_evo.mrt_bing_ads_basic_campaign_stats)
[0m15:40:26.240896 [debug] [Thread-4 (]: Began compiling node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m15:40:26.244884 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m15:40:26.246879 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (compile): 15:40:26.241893 => 15:40:26.246879
[0m15:40:26.246879 [debug] [Thread-4 (]: Began executing node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m15:40:26.250869 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:40:26.696425 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2a11ea1b-7004-498a-b686-709b5772af29&page=queryresults
[0m15:40:26.703945 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m15:40:26.706943 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt grundlegende Web-Performancewerte aller \u00fcber GA4 erfassten Kampagnen."""
    )
    as (
      

WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`

    
),

sessions_by_campaign AS(
  SELECT
    event_date as Date,
    CampaignID,

    COUNT(DISTINCT(CONCAT(user_pseudo_id,session_id))) as Sessions,
    COUNT(DISTINCT 
      CASE 
        WHEN session_engaged = '1' THEN CONCAT(user_pseudo_id,session_id) 
      END) as Sessions_Engaged,
    MAX(Medium) as Medium,
    MAX(Source) as Source,
    MAX(Partner) as Partner,

  FROM _raw
  GROUP BY 1,2
),

_add_engagement_rate AS(
    SELECT 
        Date,
        CampaignID,
        Sessions,
        Sessions_Engaged,
        (CASE
            WHEN Sessions > 0 THEN (Sessions_Engaged / Sessions) 
            ELSE 0
        END) as Engagement_Rate,
        Medium,
        Source,
        Partner
    FROM sessions_by_campaign
),

_added_columns AS(
    SELECT
        *,
        '(not set)' as Keyword,
        '(not set)' as KeywordMatchType
    FROM _add_engagement_rate
),

_final AS(
    SELECT *
    FROM _added_columns
)

SELECT * FROM _final
    );
  
[0m15:40:26.826797 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m15:40:26.830429 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

    
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m15:40:26.888839 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m15:40:26.891795 [debug] [Thread-4 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
 
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m15:40:26.905345 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:290be53b-0b99-438a-a63a-edbbb084fff8&page=queryresults
[0m15:40:27.073725 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:d695f34e-69c9-44a4-a8f5-c07ae1165e72&page=queryresults
[0m15:40:27.150992 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:aa97e9c4-b1da-4da6-a6b6-3aae3669afda&page=queryresults
[0m15:40:27.456819 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (execute): 15:40:25.922094 => 15:40:27.455784
[0m15:40:27.456819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDFA25050>]}
[0m15:40:27.457818 [info ] [Thread-1 (]: 16 of 22 OK created sql view model intermediate.int_google_analytics_all_purchases_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.54s]
[0m15:40:27.458781 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:40:27.459814 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m15:40:27.460775 [info ] [Thread-1 (]: 20 of 22 START sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [RUN]
[0m15:40:27.461773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_purchases_GA4, now model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized)
[0m15:40:27.461773 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m15:40:27.465277 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m15:40:27.466274 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (compile): 15:40:27.462772 => 15:40:27.466274
[0m15:40:27.467273 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m15:40:27.472258 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m15:40:27.472258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:27.473768 [debug] [Thread-1 (]: On model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Conversiondaten bis einschl. 04.06.2023 aus Unisversal Analytics, alle Conversions ab 05.06.2023 aus Google Analytics 4."""
    )
    as (
      WITH ga4_conversions AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
    WHERE 
        Date > '2023-06-04'
),

ua_conversions AS(
    SELECT
        Date,
        NameZielvorhaben as ZielvorhabenName,
        LOWER(CONCAT(NameZielvorhaben, Partner)) as ZielvorhabenID,
        CampaignID,
        Source,
        Medium,
        Partner,
        Keyword,
        KeywordMatchType,
        Conversions
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_goal_conversions`
    WHERE Date <= '2023-06-04'
),

_merged_step1 AS(
    SELECT * FROM ga4_conversions
    UNION ALL
    SELECT * FROM ua_conversions
),

_final AS(
    SELECT *
    FROM _merged_step1
)

SELECT * FROM _final
    );
  
[0m15:40:28.141881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:d9a2f8e1-c0d1-4602-b6b7-896468ec90d4&page=queryresults
[0m15:40:28.284668 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column 10 in UNION ALL has incompatible types: INT64, STRING at [41:5]')
[0m15:40:29.239688 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (execute): 15:40:26.247878 => 15:40:29.238741
[0m15:40:29.241682 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e454cd11-7659-46b5-85e9-77a3d51f8d2f&page=queryresults
[0m15:40:29.244275 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF7A6B90>]}
[0m15:40:29.248610 [info ] [Thread-4 (]: 19 of 22 OK created sql incremental model mart.mrt_bing_ads_basic_campaign_stats  [[32mCREATE TABLE (3.2k rows, 957.9 KiB processed)[0m in 3.00s]
[0m15:40:29.251562 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m15:40:29.253594 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_metainformation_campaigns
[0m15:40:29.254137 [info ] [Thread-4 (]: 21 of 22 START sql table model mart.mrt_metainformation_campaigns .............. [RUN]
[0m15:40:29.256141 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_bing_ads_basic_campaign_stats, now model.bq_evo.mrt_metainformation_campaigns)
[0m15:40:29.257140 [debug] [Thread-4 (]: Began compiling node model.bq_evo.mrt_metainformation_campaigns
[0m15:40:29.262158 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.mrt_metainformation_campaigns"
[0m15:40:29.263693 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (compile): 15:40:29.258133 => 15:40:29.263693
[0m15:40:29.264692 [debug] [Thread-4 (]: Began executing node model.bq_evo.mrt_metainformation_campaigns
[0m15:40:29.276742 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.mrt_metainformation_campaigns"
[0m15:40:29.277739 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:40:29.278735 [debug] [Thread-4 (]: On model.bq_evo.mrt_metainformation_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_metainformation_campaigns"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_metainformation_campaigns`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt Kampagnen aus allen Quelldatensystemen mit Metainformationen."""
    )
    as (
      

WITH _googleads_campaigns AS(
    SELECT
        campaign as Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_google_analytics_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        CASE
            WHEN Medium IN ('cpc', 'ppc','cpa', 'cpm', 'cpv', 'cpp') THEN 'true' 
            ELSE 'false'
        END as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
),

_bingads_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_merged_googleads_and_analytics AS(
    SELECT * FROM _googleads_campaigns
    UNION ALL
    SELECT * FROM _google_analytics_campaigns
),

_merged_bingads AS(
    SELECT * FROM _merged_googleads_and_analytics
    UNION ALL
    SELECT * FROM _bingads_campaigns    
)

_final AS(
    SELECT 
        DISTINCT *
    FROM _merged_bingads
)

SELECT * FROM _final
    );
  
[0m15:40:29.385123 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e454cd11-7659-46b5-85e9-77a3d51f8d2f&page=queryresults
[0m15:40:29.386084 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (execute): 15:40:27.468268 => 15:40:29.386084
[0m15:40:29.392100 [debug] [Thread-1 (]: Database Error in model mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (models\mart\single_source_data\google_analytics\mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized.sql)
  Column 10 in UNION ALL has incompatible types: INT64, STRING at [41:5]
  compiled Code at target\run\bq_evo\models\mart\single_source_data\google_analytics\mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized.sql
[0m15:40:29.392100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDFB63510>]}
[0m15:40:29.393640 [error] [Thread-1 (]: 20 of 22 ERROR creating sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [[31mERROR[0m in 1.93s]
[0m15:40:29.394654 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m15:40:29.395840 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m15:40:29.396841 [info ] [Thread-1 (]: 22 of 22 START sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [RUN]
[0m15:40:29.397839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized, now model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized)
[0m15:40:29.398875 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m15:40:29.403402 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m15:40:29.404416 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (compile): 15:40:29.399833 => 15:40:29.404416
[0m15:40:29.405626 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m15:40:29.415606 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m15:40:29.417603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:29.418602 [debug] [Thread-1 (]: On model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_merged_ua_ga4_transactions_summarized`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle aggregierten Transaktionen bis einschl. 04.06.2023 aus Unisversal Analytics, alle Conversions ab 05.06.2023 aus Google Analytics 4. Enth\u00e4lt keine Detailinformationen je Transaktion."""
    )
    as (
      WITH _raw AS(
  SELECT 
    event_date as Date,
    Campaign,
    Medium,
    Source,
    item_category as ProductCategory,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  WHERE 
    transaction_id NOT LIKE 'TEST%'
),

_aggregation_on_day AS(
  SELECT
    Date,
    Campaign,
    Medium,
    Source,
    ProductCategory,
    count(Date) as Transactions,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    MAX(Partner) as Partner,
    CampaignID
  FROM _raw
  WHERE Date >= '2023-06-05'
  GROUP BY 1,2,3,4,5,10
),

evo_ecommerce_ua AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_transactions`
  WHERE Date < '2023-06-05'
),

_merged_step1 AS(
  SELECT * FROM _aggregation_on_day
  UNION ALL
  SELECT * FROM evo_ecommerce_ua
),

_final AS(
  SELECT * FROM _merged_step1
)

SELECT * FROM _final
    );
  
[0m15:40:29.490202 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (execute): 15:40:26.203490 => 15:40:29.490202
[0m15:40:29.491199 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDF677850>]}
[0m15:40:29.492196 [info ] [Thread-3 (]: 18 of 22 OK created sql incremental model mart.mrt_google_ads_basic_campaign_stats  [[32mCREATE TABLE (87.8k rows, 10.2 MiB processed)[0m in 3.30s]
[0m15:40:29.493194 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m15:40:29.856353 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:52a45a87-5ed2-4320-a8a1-1d76c636ae36&page=queryresults
[0m15:40:29.857349 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "_final" at [65:1]')
[0m15:40:30.167811 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:840d2335-a2f3-47a3-ad53-d1b1a9fa3d6a&page=queryresults
[0m15:40:30.307069 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column 6 in UNION ALL has incompatible types: INT64, STRING at [57:3]')
[0m15:40:30.480562 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5bdbdb8c-a088-4eaf-8d1c-614fd62f85dd&page=queryresults
[0m15:40:30.481597 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5bdbdb8c-a088-4eaf-8d1c-614fd62f85dd&page=queryresults
[0m15:40:30.482562 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (execute): 15:40:29.264692 => 15:40:30.482562
[0m15:40:30.485604 [debug] [Thread-4 (]: Database Error in model mrt_metainformation_campaigns (models\mart\multi_source_data\mrt_metainformation_campaigns.sql)
  Syntax error: Unexpected identifier "_final" at [65:1]
  compiled Code at target\run\bq_evo\models\mart\multi_source_data\mrt_metainformation_campaigns.sql
[0m15:40:30.486637 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDFB15B90>]}
[0m15:40:30.486637 [error] [Thread-4 (]: 21 of 22 ERROR creating sql table model mart.mrt_metainformation_campaigns ..... [[31mERROR[0m in 1.23s]
[0m15:40:30.488600 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_metainformation_campaigns
[0m15:40:31.062778 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:bf81c0e9-9555-43e8-ae1c-39c634bcbdf2&page=queryresults
[0m15:40:31.435017 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:bf81c0e9-9555-43e8-ae1c-39c634bcbdf2&page=queryresults
[0m15:40:31.436052 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (execute): 15:40:29.406626 => 15:40:31.436052
[0m15:40:31.440006 [debug] [Thread-1 (]: Database Error in model mrt_google_analytics_merged_ua_ga4_transactions_summarized (models\mart\single_source_data\google_analytics\mrt_google_analytics_merged_ua_ga4_transactions_summarized.sql)
  Column 6 in UNION ALL has incompatible types: INT64, STRING at [57:3]
  compiled Code at target\run\bq_evo\models\mart\single_source_data\google_analytics\mrt_google_analytics_merged_ua_ga4_transactions_summarized.sql
[0m15:40:31.440006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDFB128D0>]}
[0m15:40:31.441004 [error] [Thread-1 (]: 22 of 22 ERROR creating sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [[31mERROR[0m in 2.04s]
[0m15:40:31.442002 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m15:40:36.737768 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (execute): 15:40:25.983439 => 15:40:36.737768
[0m15:40:36.738765 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ea425-dd3e-4f54-9923-f945d30adeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDFAED690>]}
[0m15:40:36.740289 [info ] [Thread-2 (]: 17 of 22 OK created sql incremental model mart.mrt_google_analytics_campaign_webperformance  [[32mCREATE TABLE (11.2k rows, 1.2 GiB processed)[0m in 10.78s]
[0m15:40:36.741326 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m15:40:36.743864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:36.743955 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:40:36.743955 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:40:36.744953 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:40:36.745949 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m15:40:36.745949 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m15:40:36.746951 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m15:40:36.747947 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized' was properly closed.
[0m15:40:36.747947 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance' was properly closed.
[0m15:40:36.748945 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_ads_basic_campaign_stats' was properly closed.
[0m15:40:36.748945 [debug] [MainThread]: Connection 'model.bq_evo.mrt_metainformation_campaigns' was properly closed.
[0m15:40:36.749943 [info ] [MainThread]: 
[0m15:40:36.750939 [info ] [MainThread]: Finished running 16 view models, 5 incremental models, 1 table model in 0 hours 0 minutes and 19.43 seconds (19.43s).
[0m15:40:36.755549 [debug] [MainThread]: Command end result
[0m15:40:36.769936 [info ] [MainThread]: 
[0m15:40:36.770932 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:40:36.771965 [info ] [MainThread]: 
[0m15:40:36.773474 [error] [MainThread]:   Database Error in model mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (models\mart\single_source_data\google_analytics\mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized.sql)
  Column 10 in UNION ALL has incompatible types: INT64, STRING at [41:5]
  compiled Code at target\run\bq_evo\models\mart\single_source_data\google_analytics\mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized.sql
[0m15:40:36.774511 [info ] [MainThread]: 
[0m15:40:36.775589 [error] [MainThread]:   Database Error in model mrt_metainformation_campaigns (models\mart\multi_source_data\mrt_metainformation_campaigns.sql)
  Syntax error: Unexpected identifier "_final" at [65:1]
  compiled Code at target\run\bq_evo\models\mart\multi_source_data\mrt_metainformation_campaigns.sql
[0m15:40:36.776592 [info ] [MainThread]: 
[0m15:40:36.776592 [error] [MainThread]:   Database Error in model mrt_google_analytics_merged_ua_ga4_transactions_summarized (models\mart\single_source_data\google_analytics\mrt_google_analytics_merged_ua_ga4_transactions_summarized.sql)
  Column 6 in UNION ALL has incompatible types: INT64, STRING at [57:3]
  compiled Code at target\run\bq_evo\models\mart\single_source_data\google_analytics\mrt_google_analytics_merged_ua_ga4_transactions_summarized.sql
[0m15:40:36.777589 [info ] [MainThread]: 
[0m15:40:36.778585 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=3 SKIP=0 TOTAL=22
[0m15:40:36.780581 [debug] [MainThread]: Command `dbt run` failed at 15:40:36.779583 after 20.08 seconds
[0m15:40:36.780581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CDD999F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CD814D810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CD814C9D0>]}
[0m15:40:37.764674 [debug] [MainThread]: Flushing usage events
[0m15:57:36.406915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A183F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A18F0D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A1388550>]}


============================== 15:57:36.409907 | 1e55b336-7ed8-4474-8ed8-cbb78e638124 ==============================
[0m15:57:36.409907 [info ] [MainThread]: Running with dbt=1.6.2
[0m15:57:36.411184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:36.795557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A296E910>]}
[0m15:57:36.804501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A1389D10>]}
[0m15:57:36.805499 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m15:57:36.854959 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m15:57:36.947361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:57:36.948327 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\mart\multi_source_data\mrt_metainformation_campaigns.sql
[0m15:57:37.007206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A3466550>]}
[0m15:57:37.027148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A32062D0>]}
[0m15:57:37.029113 [info ] [MainThread]: Found 22 models, 18 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:57:37.029113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A2EDF050>]}
[0m15:57:37.032718 [info ] [MainThread]: 
[0m15:57:37.033681 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:57:37.035715 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:57:37.036715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:37.036715 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:57:37.037746 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:57:37.038776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:37.038776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:39.781349 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m15:57:39.782349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:39.782349 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m15:57:39.784343 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m15:57:39.785375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:39.786362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:40.458695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A3226E90>]}
[0m15:57:40.459732 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:57:40.460690 [info ] [MainThread]: 
[0m15:57:40.466213 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_bing_ads_campaign_history
[0m15:57:40.466213 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:57:40.467248 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_google_ads_campaign_history
[0m15:57:40.468690 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m15:57:40.468211 [info ] [Thread-1 (]: 1 of 22 START sql view model staging.stg_bing_ads_campaign_history ............. [RUN]
[0m15:57:40.469697 [info ] [Thread-2 (]: 2 of 22 START sql view model staging.stg_bing_ads_campaign_performance_daily_report  [RUN]
[0m15:57:40.470690 [info ] [Thread-3 (]: 3 of 22 START sql view model staging.stg_google_ads_campaign_history ........... [RUN]
[0m15:57:40.471725 [info ] [Thread-4 (]: 4 of 22 START sql view model staging.stg_google_ads_campaign_stats ............. [RUN]
[0m15:57:40.473684 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_history'
[0m15:57:40.474680 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_performance_daily_report'
[0m15:57:40.476675 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_history'
[0m15:57:40.478667 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m15:57:40.478667 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_history
[0m15:57:40.479665 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:57:40.480663 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_history
[0m15:57:40.481659 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m15:57:40.491662 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m15:57:40.494657 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m15:57:40.497618 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_history"
[0m15:57:40.502651 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m15:57:40.505410 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (compile): 15:57:40.481659 => 15:57:40.505410
[0m15:57:40.506406 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (compile): 15:57:40.491662 => 15:57:40.506406
[0m15:57:40.507401 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (compile): 15:57:40.495624 => 15:57:40.507401
[0m15:57:40.508420 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_history
[0m15:57:40.509395 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 15:57:40.498617 => 15:57:40.509395
[0m15:57:40.510392 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:57:40.510392 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_google_ads_campaign_history
[0m15:57:40.542922 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m15:57:40.542922 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m15:57:40.546911 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m15:57:40.549905 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_history"
[0m15:57:40.553860 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m15:57:40.554856 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:40.555855 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:57:40.556852 [debug] [Thread-1 (]: On model.bq_evo.stg_bing_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_history`
),


_added_columns AS (
    SELECT
        *,
        'cpc' as Medium,
        'bing' as Source,
        (CASE 
            WHEN account_id = 156001989 THEN 'EVO'
        END) as Partner,
    FROM _raw
),

_added_campaignid AS (
    SELECT 
        *,
        LOWER (CONCAT(name, Source, Medium, Partner)) as CampaignID
    FROM _added_columns
),

_final AS(
    SELECT *
    FROM _added_campaignid
)

SELECT * FROM _final;


[0m15:57:40.557885 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:57:40.557885 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:57:40.558849 [debug] [Thread-2 (]: On model.bq_evo.stg_bing_ads_campaign_performance_daily_report: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_performance_daily_report`
),

_renamed_columns AS(
    SELECT 
        _fivetran_id,
        _fivetran_synced,
        account_id,
        ad_distribution,
        ad_relevance,
        all_conversions,
        all_conversions_qualified,
        all_return_on_ad_spend,
        all_revenue,
        assists,
        average_cpc,
        average_position,
        bid_match_type,
        budget_association_status,
        campaign_id,
        campaign_name,
        campaign_status,
        clicks as Clicks,
        conversions,
        conversions_qualified,
        ctr,
        currency_code,
        date as Date,
        delivered_match_type,
        device_os,
        device_type,
        expected_ctr,
        historical_ad_relevance,
        historical_expected_ctr,
        historical_landing_page_experience,
        historical_quality_score,
        impressions as Impressions,
        landing_page_experience,
        low_quality_clicks,
        low_quality_clicks_percent,
        low_quality_conversion_rate,
        low_quality_conversions,
        low_quality_conversions_qualified,
        low_quality_general_clicks,
        low_quality_impressions,
        low_quality_impressions_percent,
        low_quality_sophisticated_clicks,
        network,
        phone_calls,
        phone_impressions,
        quality_score,
        return_on_ad_spend,
        revenue,
        spend as Cost,
        top_vs_other,
        view_through_conversions
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m15:57:40.560840 [debug] [Thread-3 (]: On model.bq_evo.stg_google_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_history`
),

_renamed_columns AS(
  SELECT
    _fivetran_start,
    id,
    _fivetran_active,
    _fivetran_end,
    _fivetran_synced,
    ad_serving_optimization_status,
    advertising_channel_subtype,
    advertising_channel_type,
    base_campaign_id,
    customer_id,
    end_date,
    experiment_type,
    final_url_suffix,
    frequency_caps,
    name as campaign,
    optimization_score,
    payment_mode,
    serving_status,
    start_date,
    status,
    tracking_url_template,
    updated_at,
    vanity_pharma_display_url_mode,
    vanity_pharma_text,
    video_brand_safety_suitability
  FROM _raw
),

_add_new_columns AS(
  SELECT 
    *,
    'google' as Source,
    'cpc' as Medium,
    (CASE
      WHEN customer_id = 6607387807 THEN 'EVO'  
      ELSE '(null)'
    END) as Partner
  FROM _renamed_columns
),

_final AS(
  SELECT
    *,
    LOWER(CONCAT(campaign, Source, Medium, Partner)) as CampaignID
  FROM _add_new_columns
)

SELECT * FROM _final;


[0m15:57:40.561837 [debug] [Thread-4 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Google Ads Kampagnen"""
    )
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_transformed_cost AS(
    SELECT
        _fivetran_id,
        customer_id,
        date,
        _fivetran_synced,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability,
        ad_network_type,
        base_campaign,
        clicks,
        conversions,
        conversions_value,
        cost_micros/1000000 as cost,
        device,
        id,
        impressions,
        interaction_event_types,
        interactions,
        view_through_conversions,
    FROM _raw
),

_final AS(
    SELECT * FROM _transformed_cost
)

SELECT * FROM _final;


[0m15:57:41.403071 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a53fece4-b7d7-4b78-8795-7ac956cf14e1&page=queryresults
[0m15:57:41.407013 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:26f523f7-33ca-4943-a119-8ff929d1e5c5&page=queryresults
[0m15:57:41.409005 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:57b435d3-1963-4b95-9b58-b0b8cc7f2afd&page=queryresults
[0m15:57:41.410994 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:03b12934-b5aa-42a6-ba63-4e424d5a0f6a&page=queryresults
[0m15:57:41.646261 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (execute): 15:57:40.543919 => 15:57:41.646261
[0m15:57:41.651249 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A3496150>]}
[0m15:57:41.652212 [info ] [Thread-2 (]: 2 of 22 OK created sql view model staging.stg_bing_ads_campaign_performance_daily_report  [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m15:57:41.653210 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m15:57:41.653210 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_google_analytics_352128287
[0m15:57:41.654207 [info ] [Thread-2 (]: 5 of 22 START sql view model staging.stg_google_analytics_352128287 ............ [RUN]
[0m15:57:41.655204 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_performance_daily_report, now model.bq_evo.stg_google_analytics_352128287)
[0m15:57:41.659195 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_google_analytics_352128287
[0m15:57:41.665212 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_352128287"
[0m15:57:41.667173 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (compile): 15:57:41.660207 => 15:57:41.666174
[0m15:57:41.667173 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_google_analytics_352128287
[0m15:57:41.672160 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_352128287"
[0m15:57:41.674168 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:41.675154 [debug] [Thread-2 (]: On model.bq_evo.stg_google_analytics_352128287: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_352128287"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
  OPTIONS(
      description="""Enth\u00e4lt alle GA4-Events in Tabellenform ohne Schachtelung. Bereinigt fehlerhafte Events ohne Session-ID. Offzielle Doku Google > https://support.google.com/analytics/answer/7029846?hl=en#zippy="""
    )
  as WITH _source AS(
  SELECT
    PARSE_DATE('%Y%m%d', event_date) as event_date,
    TIMESTAMP_MICROS(event_timestamp) as event_ts,
    
    MAX(CASE WHEN params.key = 'ga_session_id' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_id,
    user_pseudo_id,
    TIMESTAMP_MICROS(user_first_touch_timestamp) as user_first_touch_ts,

    event_name,

    params.key as params_key,
    params.value.string_value as params_string_value,
    params.value.int_value as params_int_value,
    params.value.float_value as params_float_value,
    params.value.double_value as params_double_value,

    (CASE WHEN traffic_source.name IS NULL THEN '(not set)' ELSE traffic_source.name END) as utm_campaign,
    (CASE WHEN traffic_source.medium IS NULL THEN '(not set)' ELSE traffic_source.medium END) as utm_medium,
    (CASE WHEN traffic_source.source IS NULL THEN '(not set)' ELSE traffic_source.source END) as utm_source,
    'EVO' as Partner,

    MAX(CASE WHEN params.key = 'page_title' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_title,
    MAX(CASE WHEN params.key = 'page_location' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_location,
    MAX(CASE WHEN params.key = 'page_referrer' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_referrer,
    MAX(CASE WHEN params.key = 'page_path' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_path,
    MAX(CASE WHEN params.key = 'percent_scrolled' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as percent_scrolled,
    MAX(CASE WHEN params.key = 'session_engaged' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_engaged,

    privacy_info.analytics_storage as analytics_storage,
    privacy_info.ads_storage as ads_storage,
    privacy_info.uses_transient_token as uses_transient_token,

    user_ltv.revenue as ltv_revenue,
    user_ltv.currency as ltv_currency,

    device.category as device_category,
    device.mobile_brand_name as device_brand,
    device.mobile_model_name as device_model_name,
    device.mobile_marketing_name as device_marketing_name,
    device.mobile_os_hardware_model as device_mobile_os_hardware_model,
    device.operating_system as device_os,
    device.operating_system_version as device_os_version,
    device.vendor_id as device_vendor_id,
    device.advertising_id as device_advertising_id,
    device.language as device_language,
    device.is_limited_ad_tracking as device_is_limited_ad_tracking,
    device.time_zone_offset_seconds as device_time_zone_offset_seconds,
    device.browser as device_browser,
    device.browser_version as device_browser_version,
    device.web_info.browser as device_web_info_browser,
    device.web_info.browser_version as device_web_info_browser_version,
    device.web_info.hostname as browser_web_info_hostname,

    geo.continent as continent,
    geo.country as country,
    geo.region as region,
    geo.city as city,
    geo.sub_continent as sub_continent,
    geo.metro as metropolitan_area,

    app_info.id as app_id,
    app_info.version as app_version,
    app_info.install_store as app_install_store,
    app_info.firebase_app_id as app_firebase_app_id,
    app_info.install_source as app_install_source,

    event_dimensions.hostname as event_hostname,

    ecommerce.total_item_quantity as total_item_quantity,
    ecommerce.purchase_revenue_in_usd as purchase_revenue_in_usd,
    ecommerce.purchase_revenue as purchase_revenue,
    ecommerce.refund_value_in_usd as refund_value_in_usd,
    ecommerce.refund_value as refund_value,
    ecommerce.shipping_value_in_usd as shipping_value_in_usd,
    ecommerce.shipping_value as shipping_value,
    ecommerce.tax_value_in_usd as tax_value_in_usd,
    ecommerce.tax_value as tax_value,
    ecommerce.unique_items as unique_items,
    ecommerce.transaction_id as transaction_id,
    
    items.item_id as item_id,
    items.item_name as item_name,
    items.item_brand as item_brand,
    items.item_variant as item_variant,
    items.item_category as item_category,
    items.item_category2 as item_category2,
    items.item_category3 as item_category3,
    items.item_category4 as item_category4,
    items.item_category5 as item_category5,
    items.price_in_usd as price_in_usd,
    items.price as price,
    items.quantity as quantity,
    items.item_revenue_in_usd as item_revenue_in_usd,
    items.item_revenue as item_revenue,
    items.item_refund_in_usd as item_refund_in_usd,
    items.item_refund as item_refund,
    items.coupon as coupon,
    items.affiliation as affiliation,
    items.location_id as location_id,
    items.item_list_id as item_list_id,
    items.item_list_name as item_list_name,
    items.item_list_index as item_list_index,
    items.promotion_id as promotion_id,
    items.promotion_name as promotion_name,
    items.creative_name as creative_name,
    items.creative_slot as creative_slot,

    collected_traffic_source.manual_campaign_id as manual_campaign_id,
    collected_traffic_source.manual_campaign_name as manual_campaign_name,
    collected_traffic_source.manual_source as manual_source,
    collected_traffic_source.manual_medium as manual_medium,
    collected_traffic_source.manual_term as manual_term,
    collected_traffic_source.manual_content as manual_content,
    collected_traffic_source.gclid as gclid,
    collected_traffic_source.dclid as dclid,
    collected_traffic_source.srsltid as srsltid

  FROM `oss-big-query-dashboard-prod`.`analytics_352128287`.`events_*` as events
  LEFT JOIN UNNEST (event_params) as params
  /*LEFT JOIN UNNEST (privacy_info) as privacy_info
  LEFT JOIN UNNEST (user_ltv) as user_ltv*/
  LEFT JOIN UNNEST(items) as items 
),

events_aggregated as (
  SELECT
    event_date,
    event_ts,
    session_id,
    user_pseudo_id,
    user_first_touch_ts,
    event_name,

--Kampagneninformationen
    MAX(utm_campaign) as utm_campaign,
    MAX(utm_medium) as utm_medium,
    (CASE WHEN MAX(utm_source) = 'ig' THEN 'instagram' ELSE MAX(utm_source) END) as utm_source,
  --  (CASE WHEN MAX(utm_campaign) IS NULL THEN '(not set)' ELSE MAX(utm_campaign) END) as utm_campaign,
  --  (CASE WHEN MAX(utm_medium) IS NULL THEN '(not set)' ELSE MAX(utm_medium) END) as utm_medium,
  --  (CASE WHEN MAX(utm_source) IS NULL THEN '(not set)' ELSE MAX(utm_source) END) as utm_source,

--Seiteninformationen
    MAX(page_title) as page_title,
    MAX(page_location) as page_location,
    MAX(page_referrer) as page_referrer,
    MAX(page_path) as page_path,
    MAX(percent_scrolled) as percent_scrolled,
    MAX(session_engaged) as session_engaged,

--Privacy-Infos
    MAX(analytics_storage) as analytics_storage,
    MAX(ads_storage) as ads_storage,
    MAX(uses_transient_token) as uses_transient_token,

--Kundenwertinformationen
    MAX(ltv_revenue) as ltv_revenue,
    MAX(ltv_currency) as ltv_currency,

--Geräteinformationen
    MAX(device_category) as device_category,
    MAX(device_brand) as device_brand,
    MAX(device_model_name) as device_model_name,
    MAX(device_marketing_name) as device_marketing_name,
    MAX(device_mobile_os_hardware_model) as device_mobile_os_hardware_model,
    MAX(device_os) as device_os,
    MAX(device_os_version) as device_os_version,
    MAX(device_vendor_id) as device_vendor_id,
    MAX(device_advertising_id) as device_advertising_id,
    MAX(device_language) as device_language,
    MAX(device_is_limited_ad_tracking) as device_is_limited_ad_tracking,
    MAX(device_time_zone_offset_seconds) as device_time_zone_offset_seconds,
    MAX(device_browser) as device_browser,
    MAX(device_browser_version) as device_browser_version,
    MAX(device_web_info_browser) as device_web_info_browser,
    MAX(device_web_info_browser_version) as device_web_info_browser_version,
    MAX(browser_web_info_hostname) as browser_web_info_hostname,

--Gebietsinformationen
    MAX(continent) as continent,
    MAX(country) as country,
    MAX(region) as region,
    MAX(city) as city,
    MAX(sub_continent) as sub_continent,
    MAX(metropolitan_area) as metropolitan_area,

--App-Informationen
    MAX(app_id) as app_id,
    MAX(app_version) as app_version,
    MAX(app_install_store) as app_install_store,
    MAX(app_firebase_app_id) as app_firebase_app_id,
    MAX(app_install_source) as app_install_source,

    MAX(event_hostname) as event_hostname,

--E-Commerceinformationen
    MAX(total_item_quantity) as total_item_quantity,
    MAX(purchase_revenue_in_usd) as purchase_revenue_in_usd,
    MAX(purchase_revenue) as purchase_revenue,
    MAX(refund_value_in_usd) as refund_value_in_usd,
    MAX(refund_value) as refund_value,
    MAX(shipping_value_in_usd) as shipping_value_in_usd,
    MAX(shipping_value) as shipping_value,
    MAX(tax_value_in_usd) as tax_value_in_usd,
    MAX(tax_value) as tax_value,
    MAX(unique_items) as unique_items,
    MAX(transaction_id) as transaction_id,

--Warenkorbinformationen
    MAX(item_id) as item_id,
    MAX(item_name) as item_name,
    MAX(item_brand) as item_brand,
    MAX(item_variant) as item_variant,
    MAX(item_category) as item_category,
    MAX(item_category2) as item_category2,
    MAX(item_category3) as item_category3,
    MAX(item_category4) as item_category4,
    MAX(item_category5) as item_category5,
    MAX(price_in_usd) as price_in_usd,
    MAX(price) as price,
    MAX(quantity) as quantity,
    MAX(item_revenue_in_usd) as item_revenue_in_usd,
    MAX(item_revenue) as item_revenue,
    MAX(item_refund_in_usd) as item_refund_in_usd,
    MAX(item_refund) as item_refund,
    MAX(coupon) as coupon,
    MAX(affiliation) as affiliation,
    MAX(location_id) as location_id,
    MAX(item_list_id) as item_list_id,
    MAX(item_list_name) as item_list_name,
    MAX(item_list_index) as item_list_index,
    MAX(promotion_id) as promotion_id,
    MAX(promotion_name) as promotion_name,
    MAX(creative_name) as creative_name,
    MAX(creative_slot) as creative_slot,

--Manuelle Trackingparameter
    MAX(manual_campaign_id) as manual_campaign_id,
    MAX(manual_campaign_name) as manual_campaign_name,
    MAX(manual_source) as manual_source,
    MAX(manual_medium) as manual_medium,
    MAX(manual_term) as manual_term,
    MAX(manual_content) as manual_content,
    MAX(gclid) as gclid,
    MAX(dclid) as dclid,
    MAX(srsltid) as srsltid

  FROM _source
  WHERE session_id <> 0
  GROUP BY 1,2,3,4,5,6
)

SELECT *
  --DISTINCT event_date
FROM events_aggregated;


[0m15:57:41.955303 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (execute): 15:57:40.511389 => 15:57:41.955303
[0m15:57:41.956300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A35BA850>]}
[0m15:57:41.957298 [info ] [Thread-1 (]: 1 of 22 OK created sql view model staging.stg_bing_ads_campaign_history ........ [[32mCREATE VIEW (0 processed)[0m in 1.48s]
[0m15:57:41.958294 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_history
[0m15:57:41.959293 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 15:57:40.550906 => 15:57:41.959293
[0m15:57:41.960316 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_analytics_historic_campaigns
[0m15:57:41.961287 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A3231F10>]}
[0m15:57:41.962286 [info ] [Thread-1 (]: 6 of 22 START sql view model staging.stg_google_analytics_historic_campaigns ... [RUN]
[0m15:57:41.964278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_history, now model.bq_evo.stg_google_analytics_historic_campaigns)
[0m15:57:41.963299 [info ] [Thread-4 (]: 4 of 22 OK created sql view model staging.stg_google_ads_campaign_stats ........ [[32mCREATE VIEW (0 processed)[0m in 1.48s]
[0m15:57:41.965276 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_campaigns
[0m15:57:41.966276 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m15:57:41.970296 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_campaigns"
[0m15:57:41.971292 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m15:57:41.973257 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_historic_campaigns (compile): 15:57:41.967300 => 15:57:41.973257
[0m15:57:41.972262 [info ] [Thread-4 (]: 7 of 22 START sql view model staging.stg_google_analytics_historic_goal_conversions  [RUN]
[0m15:57:41.974255 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_analytics_historic_campaigns
[0m15:57:41.975267 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_ads_campaign_stats, now model.bq_evo.stg_google_analytics_historic_goal_conversions)
[0m15:57:41.978268 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m15:57:41.986222 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_campaigns"
[0m15:57:41.989213 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_goal_conversions"
[0m15:57:41.991208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:41.992204 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_analytics_historic_goal_conversions (compile): 15:57:41.987247 => 15:57:41.991208
[0m15:57:41.992204 [debug] [Thread-1 (]: On model.bq_evo.stg_google_analytics_historic_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle historischen Kampagnen aus Universal Analytics / GA3"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_campaigns`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m15:57:41.993203 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m15:57:41.998223 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_goal_conversions"
[0m15:57:42.001183 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:57:42.002179 [debug] [Thread-4 (]: On model.bq_evo.stg_google_analytics_historic_goal_conversions: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_goal_conversions"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_goal_conversions`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_goal_conversions`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m15:57:42.008188 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (execute): 15:57:40.546911 => 15:57:42.008188
[0m15:57:42.009159 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A3512B50>]}
[0m15:57:42.010157 [info ] [Thread-3 (]: 3 of 22 OK created sql view model staging.stg_google_ads_campaign_history ...... [[32mCREATE VIEW (0 processed)[0m in 1.53s]
[0m15:57:42.011156 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_google_ads_campaign_history
[0m15:57:42.012153 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_google_analytics_historic_transactions
[0m15:57:42.013154 [info ] [Thread-3 (]: 8 of 22 START sql view model staging.stg_google_analytics_historic_transactions  [RUN]
[0m15:57:42.015143 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_ads_campaign_history, now model.bq_evo.stg_google_analytics_historic_transactions)
[0m15:57:42.016140 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_transactions
[0m15:57:42.020130 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_transactions"
[0m15:57:42.022126 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_analytics_historic_transactions (compile): 15:57:42.016140 => 15:57:42.022126
[0m15:57:42.023128 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_google_analytics_historic_transactions
[0m15:57:42.027143 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_transactions"
[0m15:57:42.028142 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:57:42.029114 [debug] [Thread-3 (]: On model.bq_evo.stg_google_analytics_historic_transactions: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_transactions"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_transactions`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_transactions`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m15:57:42.346644 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:fc16c207-0dd9-4aa4-b599-03f4e2e30806&page=queryresults
[0m15:57:42.720375 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:d127166c-664a-469c-988e-458085d556c6&page=queryresults
[0m15:57:42.737126 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:61ff4fb6-65fc-4303-a8a1-10e03a81e092&page=queryresults
[0m15:57:42.750933 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:b5028392-db1f-409c-9355-696108f83396&page=queryresults
[0m15:57:43.119768 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_analytics_historic_goal_conversions (execute): 15:57:41.995231 => 15:57:43.118772
[0m15:57:43.121709 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A3506090>]}
[0m15:57:43.127698 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (execute): 15:57:41.668169 => 15:57:43.126701
[0m15:57:43.124701 [info ] [Thread-4 (]: 7 of 22 OK created sql view model staging.stg_google_analytics_historic_goal_conversions  [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m15:57:43.131690 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_analytics_historic_transactions (execute): 15:57:42.024124 => 15:57:43.131690
[0m15:57:43.132684 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_historic_campaigns (execute): 15:57:41.976248 => 15:57:43.132684
[0m15:57:43.133681 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A3504D10>]}
[0m15:57:43.134677 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m15:57:43.135677 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A33B35D0>]}
[0m15:57:43.136673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A334CB50>]}
[0m15:57:43.137739 [debug] [Thread-4 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:57:43.136673 [info ] [Thread-2 (]: 5 of 22 OK created sql view model staging.stg_google_analytics_352128287 ....... [[32mCREATE VIEW (0 processed)[0m in 1.48s]
[0m15:57:43.138740 [info ] [Thread-3 (]: 8 of 22 OK created sql view model staging.stg_google_analytics_historic_transactions  [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m15:57:43.139738 [info ] [Thread-1 (]: 6 of 22 OK created sql view model staging.stg_google_analytics_historic_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m15:57:43.142250 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_google_analytics_352128287
[0m15:57:43.141243 [info ] [Thread-4 (]: 9 of 22 START sql view model intermediate.int_bing_ads_unique_campaigns ........ [RUN]
[0m15:57:43.143240 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_google_analytics_historic_transactions
[0m15:57:43.144236 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_analytics_historic_campaigns
[0m15:57:43.145227 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m15:57:43.146264 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_historic_goal_conversions, now model.bq_evo.int_bing_ads_unique_campaigns)
[0m15:57:43.147225 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m15:57:43.148223 [info ] [Thread-2 (]: 10 of 22 START sql view model intermediate.int_google_ads_unique_campaigns ..... [RUN]
[0m15:57:43.149220 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:57:43.150218 [info ] [Thread-3 (]: 11 of 22 START sql view model intermediate.int_google_analytics_all_events ..... [RUN]
[0m15:57:43.151215 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_352128287, now model.bq_evo.int_google_ads_unique_campaigns)
[0m15:57:43.154242 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m15:57:43.154242 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_historic_transactions, now model.bq_evo.int_google_analytics_all_events)
[0m15:57:43.155204 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m15:57:43.156201 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m15:57:43.157198 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (compile): 15:57:43.151215 => 15:57:43.157198
[0m15:57:43.160190 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m15:57:43.163217 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m15:57:43.164180 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:57:43.165180 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 15:57:43.157198 => 15:57:43.165180
[0m15:57:43.170164 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m15:57:43.171161 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 15:57:43.161221 => 15:57:43.171161
[0m15:57:43.172159 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m15:57:43.173156 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m15:57:43.176147 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m15:57:43.177145 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:57:43.184160 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m15:57:43.185127 [debug] [Thread-4 (]: On model.bq_evo.int_bing_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Bing Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id,
        MAX(name) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m15:57:43.185127 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:43.188116 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:57:43.188116 [debug] [Thread-2 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id ,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m15:57:43.190110 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_final AS(
    SELECT *
    FROM _rename_columns
)

SELECT * FROM _final;


[0m15:57:43.916258 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7155eb72-2dea-40b6-9930-b15dbd05728e&page=queryresults
[0m15:57:43.937368 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a4eb0bc5-c2f6-4095-ad62-ac93c1db56a4&page=queryresults
[0m15:57:43.983805 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:04c5afd9-afae-4fed-8027-38dbc93e0b83&page=queryresults
[0m15:57:44.507844 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 15:57:43.173156 => 15:57:44.506847
[0m15:57:44.508803 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A3206BD0>]}
[0m15:57:44.510797 [info ] [Thread-2 (]: 10 of 22 OK created sql view model intermediate.int_google_ads_unique_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m15:57:44.511794 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m15:57:44.512790 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m15:57:44.513824 [info ] [Thread-1 (]: 12 of 22 START sql view model intermediate.int_google_ads_campaign_stats ....... [RUN]
[0m15:57:44.514787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_historic_campaigns, now model.bq_evo.int_google_ads_campaign_stats)
[0m15:57:44.514787 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m15:57:44.518815 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m15:57:44.519810 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 15:57:44.515817 => 15:57:44.519810
[0m15:57:44.520770 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m15:57:44.523797 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m15:57:44.524792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:44.525756 [debug] [Thread-1 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
),

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m15:57:44.640998 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (execute): 15:57:43.166175 => 15:57:44.640998
[0m15:57:44.641993 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A35121D0>]}
[0m15:57:44.642957 [info ] [Thread-4 (]: 9 of 22 OK created sql view model intermediate.int_bing_ads_unique_campaigns ... [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m15:57:44.643956 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m15:57:44.643956 [debug] [Thread-2 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:57:44.645222 [info ] [Thread-2 (]: 13 of 22 START sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [RUN]
[0m15:57:44.646220 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_unique_campaigns, now model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names)
[0m15:57:44.647250 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:57:44.650209 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m15:57:44.652205 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (compile): 15:57:44.648214 => 15:57:44.651206
[0m15:57:44.652205 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:57:44.656193 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m15:57:44.657190 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:44.657190 [debug] [Thread-2 (]: On model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne inkl. Klartext der Kampagne."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m15:57:44.689143 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 15:57:43.177145 => 15:57:44.688108
[0m15:57:44.690105 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A183DA90>]}
[0m15:57:44.691104 [info ] [Thread-3 (]: 11 of 22 OK created sql view model intermediate.int_google_analytics_all_events  [[32mCREATE VIEW (0 processed)[0m in 1.54s]
[0m15:57:44.692100 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m15:57:44.693097 [debug] [Thread-4 (]: Began running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m15:57:44.694093 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_all_campaigns
[0m15:57:44.694093 [info ] [Thread-4 (]: 14 of 22 START sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [RUN]
[0m15:57:44.696087 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_unique_campaigns, now model.bq_evo.int_google_analytics_NDG_conversionevents_GA4)
[0m15:57:44.695092 [info ] [Thread-3 (]: 15 of 22 START sql view model intermediate.int_google_analytics_all_campaigns .. [RUN]
[0m15:57:44.697084 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m15:57:44.698082 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_events, now model.bq_evo.int_google_analytics_all_campaigns)
[0m15:57:44.701075 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m15:57:44.702072 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_all_campaigns
[0m15:57:44.707059 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m15:57:44.708056 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (compile): 15:57:44.699080 => 15:57:44.707059
[0m15:57:44.708056 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m15:57:44.709053 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (compile): 15:57:44.703110 => 15:57:44.709053
[0m15:57:44.712081 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m15:57:44.713076 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_all_campaigns
[0m15:57:44.714040 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:57:44.719028 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m15:57:44.720024 [debug] [Thread-4 (]: On model.bq_evo.int_google_analytics_NDG_conversionevents_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle relevanten Conversionevents aus Google Analytics 4 f\u00fcr NDG-Vermarktung. Inklusive aller E-Commerce-Events (ohne Metainformationen)."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_conversions_NDG as(
  SELECT 
    event_date as Date,
    event_name as ZielvorhabenName, 
    CampaignID,
    Source,
    Medium,

    MAX(Partner) as Partner,

    count(event_date) as Conversions,

  FROM _raw
  WHERE (
    event_name = 'lead_form_evo_solar_lp' OR
    event_name = 'evo_solar_pva_check_sent_available' OR
    event_name = 'contact_form_button' OR
    event_name = 'click_online_application' OR
    event_name = 'oss_registration_doi' OR
    event_name = 'click_tarifrechnernutzung' OR
    event_name = 'conversion_solarrechner' OR
    event_name = 'purchase'
  )

  GROUP BY 1,2,3,4,5
),

_added_columns AS(
  SELECT 
      Date,
      ZielvorhabenName,
      LOWER(CONCAT(ZielvorhabenName, Partner)) as ZielvorhabenID,
      CampaignID,
      Source,
      Medium,
      Partner,
      '(not set)' as Keyword,
      '(not set)' as KeywordMatchType,
      Conversions
  FROM _conversions_NDG
),

_final AS(
  SELECT *
  FROM _added_columns
)

SELECT * FROM _final;


[0m15:57:44.723019 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:57:44.724014 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_all_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagnen aus GA4 und GA3."""
    )
  as WITH _historic_ua_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
),

ga4_campaigns AS(
    SELECT 
        MAX(Campaign),
        MAX(Partner),
        MAX(Source),
        MAX(Medium),
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
    GROUP BY 5
),

_final AS(
    SELECT * FROM _historic_ua_campaigns
    UNION DISTINCT
    SELECT * FROM ga4_campaigns
)

SELECT * FROM _final;


[0m15:57:45.287031 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:bf2990de-b179-4982-99d1-33d1f8f99dba&page=queryresults
[0m15:57:45.426568 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:775335f4-78e0-4eae-9778-0c90c30c3227&page=queryresults
[0m15:57:45.480148 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6ef707c4-2701-4912-b863-536c2c930ac1&page=queryresults
[0m15:57:45.518602 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:f82bcfa7-cf7d-4622-9dc3-52885a270147&page=queryresults
[0m15:57:45.917731 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 15:57:44.520770 => 15:57:45.916733
[0m15:57:45.918699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A3486CD0>]}
[0m15:57:45.920702 [info ] [Thread-1 (]: 12 of 22 OK created sql view model intermediate.int_google_ads_campaign_stats .. [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m15:57:45.922654 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m15:57:45.922654 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:57:45.923651 [info ] [Thread-1 (]: 16 of 22 START sql view model intermediate.int_google_analytics_all_purchases_GA4  [RUN]
[0m15:57:45.925646 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (execute): 15:57:44.710051 => 15:57:45.925646
[0m15:57:45.926678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_campaign_stats, now model.bq_evo.int_google_analytics_all_purchases_GA4)
[0m15:57:45.927641 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A32B5110>]}
[0m15:57:45.927641 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:57:45.928621 [info ] [Thread-4 (]: 14 of 22 OK created sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m15:57:45.932621 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m15:57:45.933650 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m15:57:45.934614 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m15:57:45.936611 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (compile): 15:57:45.929625 => 15:57:45.935613
[0m15:57:45.935613 [info ] [Thread-4 (]: 17 of 22 START sql incremental model mart.mrt_google_analytics_campaign_webperformance  [RUN]
[0m15:57:45.937609 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:57:45.938604 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_NDG_conversionevents_GA4, now model.bq_evo.mrt_google_analytics_campaign_webperformance)
[0m15:57:45.942626 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m15:57:45.942626 [debug] [Thread-4 (]: Began compiling node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m15:57:45.952074 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m15:57:45.953072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:45.954072 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_all_purchases_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_purchases_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle <purchase-events> aus Google Analytics 4. Inkl. aller zugeh\u00f6rigen Metainformationen aus GA4."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_select_purchase_events AS(
  SELECT * FROM _raw
  WHERE event_name = "purchase"
),

_final AS(
    SELECT *
    FROM _select_purchase_events
)

SELECT * FROM _final;


[0m15:57:45.955069 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (compile): 15:57:45.943590 => 15:57:45.955069
[0m15:57:45.958062 [debug] [Thread-4 (]: Began executing node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m15:57:45.989973 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:57:46.025858 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (execute): 15:57:44.715035 => 15:57:46.025858
[0m15:57:46.026888 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A38409D0>]}
[0m15:57:46.027852 [info ] [Thread-3 (]: 15 of 22 OK created sql view model intermediate.int_google_analytics_all_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m15:57:46.028851 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_all_campaigns
[0m15:57:46.029846 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m15:57:46.030882 [info ] [Thread-3 (]: 18 of 22 START sql incremental model mart.mrt_google_ads_basic_campaign_stats .. [RUN]
[0m15:57:46.031843 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_campaigns, now model.bq_evo.mrt_google_ads_basic_campaign_stats)
[0m15:57:46.031843 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m15:57:46.036833 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m15:57:46.037830 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (compile): 15:57:46.032843 => 15:57:46.037830
[0m15:57:46.038829 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m15:57:46.043814 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:57:46.122116 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (execute): 15:57:44.653202 => 15:57:46.122116
[0m15:57:46.123113 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A323E810>]}
[0m15:57:46.124110 [info ] [Thread-2 (]: 13 of 22 OK created sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.48s]
[0m15:57:46.125108 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m15:57:46.126105 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m15:57:46.127103 [info ] [Thread-2 (]: 19 of 22 START sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [RUN]
[0m15:57:46.128100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names, now model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized)
[0m15:57:46.129107 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m15:57:46.132126 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m15:57:46.134087 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (compile): 15:57:46.130094 => 15:57:46.134087
[0m15:57:46.135084 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m15:57:46.164584 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m15:57:46.166578 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:46.167574 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Conversiondaten bis einschl. 04.06.2023 aus Unisversal Analytics, alle Conversions ab 05.06.2023 aus Google Analytics 4."""
    )
    as (
      WITH ga4_conversions AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
    WHERE 
        Date > '2023-06-04'
),

ua_conversions AS(
    SELECT
        Date,
        NameZielvorhaben as ZielvorhabenName,
        LOWER(CONCAT(NameZielvorhaben, Partner)) as ZielvorhabenID,
        CampaignID,
        Source,
        Medium,
        Partner,
        Keyword,
        KeywordMatchType,
        Conversions
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_goal_conversions`
    WHERE Date <= '2023-06-04'
),

_merged_step1 AS(
    SELECT * FROM ga4_conversions
    UNION ALL
    SELECT * FROM ua_conversions
),

_final AS(
    SELECT *
    FROM _merged_step1
)

SELECT * FROM _final
    );
  
[0m15:57:46.638710 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m15:57:46.639707 [debug] [Thread-4 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt grundlegende Web-Performancewerte aller \u00fcber GA4 erfassten Kampagnen."""
    )
    as (
      

WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`

    
),

sessions_by_campaign AS(
  SELECT
    event_date as Date,
    CampaignID,

    COUNT(DISTINCT(CONCAT(user_pseudo_id,session_id))) as Sessions,
    COUNT(DISTINCT 
      CASE 
        WHEN session_engaged = '1' THEN CONCAT(user_pseudo_id,session_id) 
      END) as Sessions_Engaged,
    MAX(Medium) as Medium,
    MAX(Source) as Source,
    MAX(Partner) as Partner,

  FROM _raw
  GROUP BY 1,2
),

_add_engagement_rate AS(
    SELECT 
        Date,
        CampaignID,
        Sessions,
        Sessions_Engaged,
        (CASE
            WHEN Sessions > 0 THEN (Sessions_Engaged / Sessions) 
            ELSE 0
        END) as Engagement_Rate,
        Medium,
        Source,
        Partner
    FROM sessions_by_campaign
),

_added_columns AS(
    SELECT
        *,
        '(not set)' as Keyword,
        '(not set)' as KeywordMatchType
    FROM _add_engagement_rate
),

_final AS(
    SELECT *
    FROM _added_columns
)

SELECT * FROM _final
    );
  
[0m15:57:46.728702 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m15:57:46.731694 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

    
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m15:57:46.735727 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2a247d37-7cf1-4013-9e1a-58d9db11a70b&page=queryresults
[0m15:57:46.874041 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:988e6a61-56ff-4a5d-bc9f-efcc0ec0f543&page=queryresults
[0m15:57:46.984484 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:34a09346-4d1d-4086-9098-4afe091c47c5&page=queryresults
[0m15:57:46.991479 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:1f83a5d8-7471-4615-a1df-df3e4c25e549&page=queryresults
[0m15:57:47.387731 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (execute): 15:57:45.939603 => 15:57:47.387731
[0m15:57:47.388725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A38C2810>]}
[0m15:57:47.389699 [info ] [Thread-1 (]: 16 of 22 OK created sql view model intermediate.int_google_analytics_all_purchases_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m15:57:47.390690 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:57:47.391684 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_metainformation_campaigns
[0m15:57:47.391684 [info ] [Thread-1 (]: 20 of 22 START sql table model mart.mrt_metainformation_campaigns .............. [RUN]
[0m15:57:47.393677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_purchases_GA4, now model.bq_evo.mrt_metainformation_campaigns)
[0m15:57:47.393677 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_metainformation_campaigns
[0m15:57:47.397666 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_metainformation_campaigns"
[0m15:57:47.398663 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (compile): 15:57:47.394675 => 15:57:47.398663
[0m15:57:47.399661 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_metainformation_campaigns
[0m15:57:47.411629 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_metainformation_campaigns"
[0m15:57:47.413627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:47.414623 [debug] [Thread-1 (]: On model.bq_evo.mrt_metainformation_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_metainformation_campaigns"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_metainformation_campaigns`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt Kampagnen aus allen Quelldatensystemen mit Metainformationen."""
    )
    as (
      

WITH _googleads_campaigns AS(
    SELECT
        campaign as Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_google_analytics_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        CASE
            WHEN Medium IN ('cpc', 'ppc','cpa', 'cpm', 'cpv', 'cpp') THEN 'true' 
            ELSE 'false'
        END as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
),

_bingads_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_merged_googleads_and_analytics AS(
    SELECT * FROM _googleads_campaigns
    UNION ALL
    SELECT * FROM _google_analytics_campaigns
),

_merged_bingads AS(
    SELECT * FROM _merged_googleads_and_analytics
    UNION ALL
    SELECT * FROM _bingads_campaigns    
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _merged_bingads
)

SELECT * FROM _final
    );
  
[0m15:57:48.183182 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:737d4672-f25a-4a13-a3b9-004782a0df08&page=queryresults
[0m15:57:49.321261 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (execute): 15:57:46.039822 => 15:57:49.321261
[0m15:57:49.322258 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A355EE10>]}
[0m15:57:49.323291 [info ] [Thread-3 (]: 18 of 22 OK created sql incremental model mart.mrt_google_ads_basic_campaign_stats  [[32mCREATE TABLE (87.8k rows, 10.2 MiB processed)[0m in 3.29s]
[0m15:57:49.325283 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m15:57:49.326247 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m15:57:49.326247 [info ] [Thread-3 (]: 21 of 22 START sql incremental model mart.mrt_bing_ads_basic_campaign_stats .... [RUN]
[0m15:57:49.328277 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_google_ads_basic_campaign_stats, now model.bq_evo.mrt_bing_ads_basic_campaign_stats)
[0m15:57:49.328277 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m15:57:49.332265 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m15:57:49.333261 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (compile): 15:57:49.329239 => 15:57:49.333261
[0m15:57:49.334226 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m15:57:49.338251 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:57:49.865276 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m15:57:49.867274 [debug] [Thread-3 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
 
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m15:57:50.140142 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:973c119d-c231-4a56-9991-b2584fe50c3f&page=queryresults
[0m15:57:52.238913 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (execute): 15:57:49.335222 => 15:57:52.237916
[0m15:57:52.239911 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A38409D0>]}
[0m15:57:52.240899 [info ] [Thread-3 (]: 21 of 22 OK created sql incremental model mart.mrt_bing_ads_basic_campaign_stats  [[32mCREATE TABLE (3.2k rows, 957.9 KiB processed)[0m in 2.91s]
[0m15:57:52.241896 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m15:57:52.242894 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m15:57:52.243896 [info ] [Thread-3 (]: 22 of 22 START sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [RUN]
[0m15:57:52.245891 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_bing_ads_basic_campaign_stats, now model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized)
[0m15:57:52.245891 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m15:57:52.249880 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m15:57:52.250877 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (compile): 15:57:52.246888 => 15:57:52.250877
[0m15:57:52.251875 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m15:57:52.255863 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m15:57:52.256861 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:57:52.257862 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_merged_ua_ga4_transactions_summarized`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle aggregierten Transaktionen bis einschl. 04.06.2023 aus Unisversal Analytics, alle Conversions ab 05.06.2023 aus Google Analytics 4. Enth\u00e4lt keine Detailinformationen je Transaktion."""
    )
    as (
      WITH _raw AS(
  SELECT 
    event_date as Date,
    Campaign,
    Medium,
    Source,
    item_category as ProductCategory,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  WHERE 
    transaction_id NOT LIKE 'TEST%'
),

_aggregation_on_day AS(
  SELECT
    Date,
    Campaign,
    Medium,
    Source,
    ProductCategory,
    count(Date) as Transactions,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    MAX(Partner) as Partner,
    CampaignID
  FROM _raw
  WHERE Date >= '2023-06-05'
  GROUP BY 1,2,3,4,5,10
),

evo_ecommerce_ua AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_transactions`
  WHERE Date < '2023-06-05'
),

_merged_step1 AS(
  SELECT * FROM _aggregation_on_day
  UNION ALL
  SELECT * FROM evo_ecommerce_ua
),

_final AS(
  SELECT * FROM _merged_step1
)

SELECT * FROM _final
    );
  
[0m15:57:52.968560 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4ec542b9-8552-4b17-b8d5-5fc0da3326c5&page=queryresults
[0m15:57:53.966946 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (execute): 15:57:46.136114 => 15:57:53.965948
[0m15:57:53.970934 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A388D3D0>]}
[0m15:57:53.973925 [info ] [Thread-2 (]: 19 of 22 OK created sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [[32mCREATE TABLE (25.0k rows, 714.8 MiB processed)[0m in 7.84s]
[0m15:57:53.975046 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m15:57:55.193894 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (execute): 15:57:47.399661 => 15:57:55.193894
[0m15:57:55.194884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A32E62D0>]}
[0m15:57:55.195849 [info ] [Thread-1 (]: 20 of 22 OK created sql table model mart.mrt_metainformation_campaigns ......... [[32mCREATE TABLE (2.2k rows, 711.7 MiB processed)[0m in 7.80s]
[0m15:57:55.196847 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_metainformation_campaigns
[0m15:57:55.860840 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (execute): 15:57:45.959056 => 15:57:55.860840
[0m15:57:55.861840 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A34EAAD0>]}
[0m15:57:55.862799 [info ] [Thread-4 (]: 17 of 22 OK created sql incremental model mart.mrt_google_analytics_campaign_webperformance  [[32mCREATE TABLE (11.2k rows, 1.2 GiB processed)[0m in 9.92s]
[0m15:57:55.864306 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m15:58:00.783284 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (execute): 15:57:52.252872 => 15:58:00.782268
[0m15:58:00.783284 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e55b336-7ed8-4474-8ed8-cbb78e638124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A3541B10>]}
[0m15:58:00.784244 [info ] [Thread-3 (]: 22 of 22 OK created sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [[32mCREATE TABLE (5.5k rows, 712.2 MiB processed)[0m in 8.54s]
[0m15:58:00.786205 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m15:58:00.789231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:00.789231 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:58:00.790195 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:58:00.790671 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:58:00.790671 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m15:58:00.791671 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m15:58:00.791671 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m15:58:00.792668 [debug] [MainThread]: Connection 'model.bq_evo.mrt_metainformation_campaigns' was properly closed.
[0m15:58:00.792668 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized' was properly closed.
[0m15:58:00.793666 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized' was properly closed.
[0m15:58:00.793666 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance' was properly closed.
[0m15:58:00.794664 [info ] [MainThread]: 
[0m15:58:00.795672 [info ] [MainThread]: Finished running 16 view models, 5 incremental models, 1 table model in 0 hours 0 minutes and 23.76 seconds (23.76s).
[0m15:58:00.800647 [debug] [MainThread]: Command end result
[0m15:58:00.823586 [info ] [MainThread]: 
[0m15:58:00.824584 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:00.825622 [info ] [MainThread]: 
[0m15:58:00.826578 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
[0m15:58:00.828635 [debug] [MainThread]: Command `dbt run` succeeded at 15:58:00.827633 after 24.44 seconds
[0m15:58:00.828635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A1388550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002609BD6FC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002609BD7CE10>]}
[0m15:58:01.849983 [debug] [MainThread]: Flushing usage events
[0m17:57:19.032452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A353E3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A3569B1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A356A81D0>]}


============================== 17:57:19.047422 | 97d8fc58-f14c-4df1-9c4c-332e2abdcb0a ==============================
[0m17:57:19.047422 [info ] [MainThread]: Running with dbt=1.6.2
[0m17:57:19.047888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m *linkedin*', 'send_anonymous_usage_stats': 'True'}
[0m17:57:20.817448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97d8fc58-f14c-4df1-9c4c-332e2abdcb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A368BDA90>]}
[0m17:57:20.826465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97d8fc58-f14c-4df1-9c4c-332e2abdcb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A368DB710>]}
[0m17:57:20.832449 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m17:57:20.888950 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m17:57:21.548190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 10 files added, 4 files changed.
[0m17:57:21.549188 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\meta\int_meta_unique_campaigns.sql
[0m17:57:21.550185 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\single_source_data\meta\mrt_meta_basic_campaign_stats.sql
[0m17:57:21.551183 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\meta\stg_meta_campaign_stats.sql
[0m17:57:21.552180 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\single_source_data\linkedin\mrt_linkedin_basic_campaign_stats.sql
[0m17:57:21.552180 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql
[0m17:57:21.553179 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql
[0m17:57:21.553179 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\linkedin\stg_linkedin_campaign_history.sql
[0m17:57:21.554174 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\meta\stg_meta_campaign_information.sql
[0m17:57:21.554174 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\linkedin\stg_linkedin_ad_analytics_by_campaign.sql
[0m17:57:21.555172 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql
[0m17:57:21.556170 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\schema.yml
[0m17:57:21.557167 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\mart\schema.yml
[0m17:57:21.557167 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\schema.yml
[0m17:57:21.558166 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\sources.yml
[0m17:57:21.659580 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bq_evo.stg_linkedin_campaign_history' (models\staging\linkedin\stg_linkedin_campaign_history.sql) depends on a source named 'linkedin.campaign_history' which was not found
[0m17:57:21.660578 [debug] [MainThread]: Command `dbt run` failed at 17:57:21.660578 after 2.66 seconds
[0m17:57:21.661575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A356A8510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A35C5DC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A35C5F7D0>]}
[0m17:57:21.662573 [debug] [MainThread]: Flushing usage events
[0m17:58:06.124804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B013B6B390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0140A64D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B013BFED50>]}


============================== 17:58:06.129325 | b0007bbc-da4d-4425-a33a-017d56199fb3 ==============================
[0m17:58:06.129325 [info ] [MainThread]: Running with dbt=1.6.2
[0m17:58:06.130834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m *linkedin*', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:58:06.479308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0007bbc-da4d-4425-a33a-017d56199fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B015732890>]}
[0m17:58:06.489318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0007bbc-da4d-4425-a33a-017d56199fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B014019590>]}
[0m17:58:06.490280 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m17:58:06.539184 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m17:58:06.638540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 10 files added, 4 files changed.
[0m17:58:06.639538 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\linkedin\stg_linkedin_ad_analytics_by_campaign.sql
[0m17:58:06.639538 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\linkedin\stg_linkedin_campaign_history.sql
[0m17:58:06.640501 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\meta\int_meta_unique_campaigns.sql
[0m17:58:06.640501 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\single_source_data\linkedin\mrt_linkedin_basic_campaign_stats.sql
[0m17:58:06.641497 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\meta\stg_meta_campaign_information.sql
[0m17:58:06.641497 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql
[0m17:58:06.642495 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\mart\single_source_data\meta\mrt_meta_basic_campaign_stats.sql
[0m17:58:06.642495 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\staging\meta\stg_meta_campaign_stats.sql
[0m17:58:06.643492 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql
[0m17:58:06.643492 [debug] [MainThread]: Partial parsing: added file: bq_evo://models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql
[0m17:58:06.644527 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\mart\schema.yml
[0m17:58:06.645487 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\schema.yml
[0m17:58:06.645487 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\sources.yml
[0m17:58:06.646484 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\schema.yml
[0m17:58:06.753819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0007bbc-da4d-4425-a33a-017d56199fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B015BC7890>]}
[0m17:58:06.782258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0007bbc-da4d-4425-a33a-017d56199fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B01578F090>]}
[0m17:58:06.782258 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:58:06.783256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0007bbc-da4d-4425-a33a-017d56199fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0132A4B50>]}
[0m17:58:06.785250 [info ] [MainThread]: 
[0m17:58:06.787279 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:58:06.788242 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m17:58:06.789243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:06.790238 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m17:58:06.791237 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m17:58:06.791237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:06.792233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:09.991003 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m17:58:09.992004 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m17:58:09.993039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:09.993999 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m17:58:09.995032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:09.997988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:10.666350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0007bbc-da4d-4425-a33a-017d56199fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B013A17F50>]}
[0m17:58:10.669299 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:58:10.671299 [info ] [MainThread]: 
[0m17:58:10.690401 [debug] [Thread-1 (]: Began running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m17:58:10.691398 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m17:58:10.691398 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_linkedin_campaign_history
[0m17:58:10.692394 [info ] [Thread-1 (]: 1 of 5 START sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [RUN]
[0m17:58:10.693391 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_linkedin_ad_analytics_by_campaign ...... [RUN]
[0m17:58:10.694390 [info ] [Thread-3 (]: 3 of 5 START sql view model staging.stg_linkedin_campaign_history .............. [RUN]
[0m17:58:10.696385 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names'
[0m17:58:10.697381 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign'
[0m17:58:10.698379 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_campaign_history'
[0m17:58:10.699379 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m17:58:10.700374 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m17:58:10.701370 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_linkedin_campaign_history
[0m17:58:10.708382 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m17:58:10.712357 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m17:58:10.715334 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_campaign_history"
[0m17:58:10.718322 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (compile): 17:58:10.701370 => 17:58:10.718322
[0m17:58:10.720318 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (compile): 17:58:10.709381 => 17:58:10.719324
[0m17:58:10.721319 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m17:58:10.722315 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (compile): 17:58:10.713354 => 17:58:10.721319
[0m17:58:10.722315 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m17:58:10.756256 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m17:58:10.756256 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_linkedin_campaign_history
[0m17:58:10.760212 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m17:58:10.763638 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_campaign_history"
[0m17:58:10.765631 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:10.766629 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:58:10.766629 [debug] [Thread-1 (]: On model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.Campaign = _raw_performance.Campaign
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m17:58:10.767626 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:58:10.768624 [debug] [Thread-2 (]: On model.bq_evo.stg_linkedin_ad_analytics_by_campaign: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Linkedin-Kampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS (
    SELECT *    
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`ad_analytics_by_campaign`
),

_renamed_columns AS (
    SELECT
        campaign_id,
        day as Date,
        _fivetran_synced,
        action_clicks,
        ad_unit_clicks,
        approximate_unique_impressions,
        card_clicks,
        card_impressions,
        clicks as Clicks,
        comment_likes,
        comments,
        company_page_clicks,
        conversion_value_in_local_currency,
        cost_in_local_currency as Cost,
        cost_in_usd,
        external_website_conversions,
        external_website_post_click_conversions,
        external_website_post_view_conversions,
        follows,
        full_screen_plays,
        impressions as Impressions,
        landing_page_clicks,
        lead_generation_mail_contact_info_shares,
        lead_generation_mail_interested_clicks,
        likes,
        one_click_lead_form_opens,
        one_click_leads,
        opens,
        other_engagements,
        sends,
        shares,
        text_url_clicks,
        total_engagements,
        video_completions,
        video_first_quartile_completions,
        video_midpoint_completions,
        video_starts,
        video_third_quartile_completions,
        video_views,
        viral_card_clicks,
        viral_card_impressions,
        viral_clicks,
        viral_comment_likes,
        viral_comments,
        viral_company_page_clicks,
        viral_external_website_conversions,
        viral_external_website_post_click_conversions,
        viral_external_website_post_view_conversions,
        viral_follows,
        viral_full_screen_plays,
        viral_impressions,
        viral_landing_page_clicks,
        viral_likes,
        viral_one_click_lead_form_opens,
        viral_one_click_leads,
        viral_other_engagements,
        viral_shares,
        viral_total_engagements,
        viral_video_completions,
        viral_video_first_quartile_completions,
        viral_video_midpoint_completions,
        viral_video_starts,
        viral_video_third_quartile_completions,
        viral_video_views,
        average_daily_reach_metrics_approximate_cost_in_currency_per_thousand_members_reached,
        average_daily_reach_metrics_approximate_reach,
        average_previous_seven_day_reach_metrics_approximate_frequency,
        average_previous_thirty_day_reach_metrics_approximate_cost_in_currency_per_thousand_members_reached,
        average_daily_reach_metrics_approximate_frequency,
        average_previous_seven_day_reach_metrics_approximate_cost_in_currency_per_thousand_members_reached,
        average_previous_thirty_day_reach_metrics_approximate_frequency,
        average_previous_thirty_day_reach_metrics_approximate_reach,
        average_previous_seven_day_reach_metrics_approximate_reach
    FROM _raw
);


[0m17:58:10.771614 [debug] [Thread-3 (]: On model.bq_evo.stg_linkedin_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`campaign_history`
),

_renamed_columns AS(
    SELECT
        id,
        last_modified_time,
        _fivetran_synced,
        account_id,
        associated_entity,
        audience_expansion_enabled,
        campaign_group_id,
        cost_type,
        created_time,
        creative_selection,
        daily_budget_amount,
        daily_budget_currency_code,
        format,
        locale_country,
        locale_language,
        name as Campaign,
        objective_type,
        offsite_delivery_enabled,
        optimization_target_type,
        run_schedule_end,
        run_schedule_start,
        status,
        type,
        unit_cost_amount,
        unit_cost_currency_code,
        version_tag
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m17:58:11.571967 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:669315ef-2416-4c4f-a1fe-10a6985d05f7&page=queryresults
[0m17:58:11.572967 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a95d08a7-abb3-4214-a7dc-fcf11ec8eac9&page=queryresults
[0m17:58:11.572967 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.Campaign = _raw_performance.Campaign
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m17:58:11.573964 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ";" at [89:2]')
[0m17:58:11.573964 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_unique_campaigns was not found in location europe-west3

Location: europe-west3
Job ID: 669315ef-2416-4c4f-a1fe-10a6985d05f7

[0m17:58:11.576382 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (execute): 17:58:10.723332 => 17:58:11.576382
[0m17:58:11.600449 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:22fa711e-994d-40c6-9e41-3ccfbb820aa5&page=queryresults
[0m17:58:11.663793 [debug] [Thread-1 (]: Runtime Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_unique_campaigns was not found in location europe-west3
  
  Location: europe-west3
  Job ID: 669315ef-2416-4c4f-a1fe-10a6985d05f7
  
[0m17:58:11.663793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0007bbc-da4d-4425-a33a-017d56199fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B015B1D450>]}
[0m17:58:11.664791 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [[31mERROR[0m in 0.97s]
[0m17:58:11.665788 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m17:58:11.666786 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m17:58:11.667783 [info ] [Thread-4 (]: 4 of 5 SKIP relation mart.mrt_linkedin_basic_campaign_stats .................... [[33mSKIP[0m]
[0m17:58:11.668780 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m17:58:11.805445 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5e351f62-1df6-4b55-851f-739c6832c03b&page=queryresults
[0m17:58:11.806441 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5e351f62-1df6-4b55-851f-739c6832c03b&page=queryresults
[0m17:58:11.807438 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (execute): 17:58:10.757253 => 17:58:11.807438
[0m17:58:11.811427 [debug] [Thread-2 (]: Database Error in model stg_linkedin_ad_analytics_by_campaign (models\staging\linkedin\stg_linkedin_ad_analytics_by_campaign.sql)
  Syntax error: Unexpected ";" at [89:2]
  compiled Code at target\run\bq_evo\models\staging\linkedin\stg_linkedin_ad_analytics_by_campaign.sql
[0m17:58:11.811427 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0007bbc-da4d-4425-a33a-017d56199fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B015BC77D0>]}
[0m17:58:11.812425 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model staging.stg_linkedin_ad_analytics_by_campaign  [[31mERROR[0m in 1.11s]
[0m17:58:11.813423 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m17:58:11.878596 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (execute): 17:58:10.760641 => 17:58:11.877557
[0m17:58:11.878596 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0007bbc-da4d-4425-a33a-017d56199fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B015C57110>]}
[0m17:58:11.879890 [info ] [Thread-3 (]: 3 of 5 OK created sql view model staging.stg_linkedin_campaign_history ......... [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m17:58:11.880890 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_linkedin_campaign_history
[0m17:58:11.882384 [debug] [Thread-1 (]: Began running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m17:58:11.883385 [info ] [Thread-1 (]: 5 of 5 START sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [RUN]
[0m17:58:11.884454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names, now model.bq_evo.int_linkedin_unique_campaigns_reduced_information)
[0m17:58:11.885838 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m17:58:11.888450 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m17:58:11.889488 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (compile): 17:58:11.885838 => 17:58:11.889488
[0m17:58:11.890896 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m17:58:11.894290 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m17:58:11.895329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:11.896331 [debug] [Thread-1 (]: On model.bq_evo.int_linkedin_unique_campaigns_reduced_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Linkedin-Kampagnen - gg\u00fc. Quelldaten nur ausgew\u00e4hlte Spalten f\u00fcr Weiterverarbeitung NDG."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
),

_selected_columns AS (
    SELECT
        Campaign, 
        "EVO" as Partner, 
        "cpc" as Medium, 
        "linkedin" as Source, 
        LOWER(CONCAT( name, "linkedin", "cpc", "EVO")) AS CampaignID 
    
    FROM _selected_columns
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _selected_columns
)

SELECT * FROM _final;


[0m17:58:12.534269 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8c45cccb-c676-49c4-a72e-bcb6031da51b&page=queryresults
[0m17:58:12.535286 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "_selected_columns" must be qualified with a dataset (e.g. dataset.table).')
[0m17:58:12.697627 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8517a691-c845-42b4-aef7-1e9fcc808a5f&page=queryresults
[0m17:58:12.698626 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8517a691-c845-42b4-aef7-1e9fcc808a5f&page=queryresults
[0m17:58:12.700618 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (execute): 17:58:11.891897 => 17:58:12.700618
[0m17:58:12.709626 [debug] [Thread-1 (]: Database Error in model int_linkedin_unique_campaigns_reduced_information (models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql)
  Table "_selected_columns" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target\run\bq_evo\models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql
[0m17:58:12.710591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0007bbc-da4d-4425-a33a-017d56199fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B015D3BB90>]}
[0m17:58:12.712589 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [[31mERROR[0m in 0.83s]
[0m17:58:12.714584 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m17:58:12.717601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:12.717601 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m17:58:12.718607 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m17:58:12.718607 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m17:58:12.719604 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m17:58:12.720566 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m17:58:12.720566 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m17:58:12.721564 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information' was properly closed.
[0m17:58:12.721564 [debug] [MainThread]: Connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign' was properly closed.
[0m17:58:12.722559 [debug] [MainThread]: Connection 'model.bq_evo.stg_linkedin_campaign_history' was properly closed.
[0m17:58:12.722559 [info ] [MainThread]: 
[0m17:58:12.723584 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 5.94 seconds (5.94s).
[0m17:58:12.726577 [debug] [MainThread]: Command end result
[0m17:58:12.742505 [info ] [MainThread]: 
[0m17:58:12.743512 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m17:58:12.744518 [info ] [MainThread]: 
[0m17:58:12.745499 [error] [MainThread]:   Runtime Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_unique_campaigns was not found in location europe-west3
  
  Location: europe-west3
  Job ID: 669315ef-2416-4c4f-a1fe-10a6985d05f7
  
[0m17:58:12.746511 [info ] [MainThread]: 
[0m17:58:12.748497 [error] [MainThread]:   Database Error in model stg_linkedin_ad_analytics_by_campaign (models\staging\linkedin\stg_linkedin_ad_analytics_by_campaign.sql)
  Syntax error: Unexpected ";" at [89:2]
  compiled Code at target\run\bq_evo\models\staging\linkedin\stg_linkedin_ad_analytics_by_campaign.sql
[0m17:58:12.749489 [info ] [MainThread]: 
[0m17:58:12.750519 [error] [MainThread]:   Database Error in model int_linkedin_unique_campaigns_reduced_information (models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql)
  Table "_selected_columns" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target\run\bq_evo\models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql
[0m17:58:12.751483 [info ] [MainThread]: 
[0m17:58:12.753477 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=1 TOTAL=5
[0m17:58:12.754475 [debug] [MainThread]: Command `dbt run` failed at 17:58:12.754475 after 6.64 seconds
[0m17:58:12.755474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B013C0B810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B015C100D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B01465B9D0>]}
[0m17:58:12.756470 [debug] [MainThread]: Flushing usage events
[0m17:59:19.273056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002455E21A490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002455E697810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002455E016790>]}


============================== 17:59:19.277051 | 6597a0fa-3df1-47ac-b1c2-dbf44a3ab3be ==============================
[0m17:59:19.277051 [info ] [MainThread]: Running with dbt=1.6.2
[0m17:59:19.277412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m *linkedin*', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:59:19.619276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6597a0fa-3df1-47ac-b1c2-dbf44a3ab3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002455E62E190>]}
[0m17:59:19.628289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6597a0fa-3df1-47ac-b1c2-dbf44a3ab3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002455F9AE490>]}
[0m17:59:19.629286 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m17:59:19.678700 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m17:59:19.779085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:59:19.781046 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\linkedin\stg_linkedin_ad_analytics_by_campaign.sql
[0m17:59:19.830984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6597a0fa-3df1-47ac-b1c2-dbf44a3ab3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002456004A650>]}
[0m17:59:19.850420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6597a0fa-3df1-47ac-b1c2-dbf44a3ab3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245602CC210>]}
[0m17:59:19.851416 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:59:19.851416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6597a0fa-3df1-47ac-b1c2-dbf44a3ab3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002455F412110>]}
[0m17:59:19.854441 [info ] [MainThread]: 
[0m17:59:19.855405 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:59:19.857432 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m17:59:19.857432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:19.858429 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m17:59:19.859394 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m17:59:19.859394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:19.860393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:22.399354 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m17:59:22.400352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:22.401350 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m17:59:22.403379 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m17:59:22.404342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:22.405369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:23.072061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6597a0fa-3df1-47ac-b1c2-dbf44a3ab3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002455C853910>]}
[0m17:59:23.073051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:59:23.074050 [info ] [MainThread]: 
[0m17:59:23.078345 [debug] [Thread-1 (]: Began running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m17:59:23.078345 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m17:59:23.079346 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_linkedin_campaign_history
[0m17:59:23.079346 [info ] [Thread-1 (]: 1 of 5 START sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [RUN]
[0m17:59:23.080344 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_linkedin_ad_analytics_by_campaign ...... [RUN]
[0m17:59:23.082337 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names'
[0m17:59:23.081341 [info ] [Thread-3 (]: 3 of 5 START sql view model staging.stg_linkedin_campaign_history .............. [RUN]
[0m17:59:23.083335 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign'
[0m17:59:23.084361 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m17:59:23.085329 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_campaign_history'
[0m17:59:23.086362 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m17:59:23.095303 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m17:59:23.095303 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_linkedin_campaign_history
[0m17:59:23.099292 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m17:59:23.106308 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_campaign_history"
[0m17:59:23.107271 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (compile): 17:59:23.087325 => 17:59:23.107271
[0m17:59:23.109267 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (compile): 17:59:23.096345 => 17:59:23.108273
[0m17:59:23.110304 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m17:59:23.111264 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (compile): 17:59:23.100320 => 17:59:23.111264
[0m17:59:23.112259 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m17:59:23.143801 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m17:59:23.144801 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_linkedin_campaign_history
[0m17:59:23.147798 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m17:59:23.151747 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_campaign_history"
[0m17:59:23.152745 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:23.153744 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:59:23.155737 [debug] [Thread-1 (]: On model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.Campaign = _raw_performance.Campaign
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m17:59:23.156734 [debug] [Thread-2 (]: On model.bq_evo.stg_linkedin_ad_analytics_by_campaign: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Linkedin-Kampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS (
    SELECT *    
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`ad_analytics_by_campaign`
),

_renamed_columns AS (
    SELECT
        campaign_id,
        day as Date,
        _fivetran_synced,
        action_clicks,
        ad_unit_clicks,
        approximate_unique_impressions,
        card_clicks,
        card_impressions,
        clicks as Clicks,
        comment_likes,
        comments,
        company_page_clicks,
        conversion_value_in_local_currency,
        cost_in_local_currency as Cost,
        cost_in_usd,
        external_website_conversions,
        external_website_post_click_conversions,
        external_website_post_view_conversions,
        follows,
        full_screen_plays,
        impressions as Impressions,
        landing_page_clicks,
        lead_generation_mail_contact_info_shares,
        lead_generation_mail_interested_clicks,
        likes,
        one_click_lead_form_opens,
        one_click_leads,
        opens,
        other_engagements,
        sends,
        shares,
        text_url_clicks,
        total_engagements,
        video_completions,
        video_first_quartile_completions,
        video_midpoint_completions,
        video_starts,
        video_third_quartile_completions,
        video_views,
        viral_card_clicks,
        viral_card_impressions,
        viral_clicks,
        viral_comment_likes,
        viral_comments,
        viral_company_page_clicks,
        viral_external_website_conversions,
        viral_external_website_post_click_conversions,
        viral_external_website_post_view_conversions,
        viral_follows,
        viral_full_screen_plays,
        viral_impressions,
        viral_landing_page_clicks,
        viral_likes,
        viral_one_click_lead_form_opens,
        viral_one_click_leads,
        viral_other_engagements,
        viral_shares,
        viral_total_engagements,
        viral_video_completions,
        viral_video_first_quartile_completions,
        viral_video_midpoint_completions,
        viral_video_starts,
        viral_video_third_quartile_completions,
        viral_video_views,
        average_daily_reach_metrics_approximate_cost_in_currency_per_thousand_members_reached,
        average_daily_reach_metrics_approximate_reach,
        average_previous_seven_day_reach_metrics_approximate_frequency,
        average_previous_thirty_day_reach_metrics_approximate_cost_in_currency_per_thousand_members_reached,
        average_daily_reach_metrics_approximate_frequency,
        average_previous_seven_day_reach_metrics_approximate_cost_in_currency_per_thousand_members_reached,
        average_previous_thirty_day_reach_metrics_approximate_frequency,
        average_previous_thirty_day_reach_metrics_approximate_reach,
        average_previous_seven_day_reach_metrics_approximate_reach
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m17:59:23.156734 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:59:23.160723 [debug] [Thread-3 (]: On model.bq_evo.stg_linkedin_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`campaign_history`
),

_renamed_columns AS(
    SELECT
        id,
        last_modified_time,
        _fivetran_synced,
        account_id,
        associated_entity,
        audience_expansion_enabled,
        campaign_group_id,
        cost_type,
        created_time,
        creative_selection,
        daily_budget_amount,
        daily_budget_currency_code,
        format,
        locale_country,
        locale_language,
        name as Campaign,
        objective_type,
        offsite_delivery_enabled,
        optimization_target_type,
        run_schedule_end,
        run_schedule_start,
        status,
        type,
        unit_cost_amount,
        unit_cost_currency_code,
        version_tag
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m17:59:23.877830 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3e5a0cee-4219-421d-bb78-3eb8f8b12d6d&page=queryresults
[0m17:59:23.880822 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.Campaign = _raw_performance.Campaign
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m17:59:23.881775 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_unique_campaigns was not found in location europe-west3

Location: europe-west3
Job ID: 3e5a0cee-4219-421d-bb78-3eb8f8b12d6d

[0m17:59:23.881775 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (execute): 17:59:23.112259 => 17:59:23.881775
[0m17:59:23.887777 [debug] [Thread-1 (]: Runtime Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_unique_campaigns was not found in location europe-west3
  
  Location: europe-west3
  Job ID: 3e5a0cee-4219-421d-bb78-3eb8f8b12d6d
  
[0m17:59:23.888771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6597a0fa-3df1-47ac-b1c2-dbf44a3ab3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002456031BB90>]}
[0m17:59:23.889745 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [[31mERROR[0m in 0.81s]
[0m17:59:23.890732 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m17:59:23.891729 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m17:59:23.892729 [info ] [Thread-4 (]: 4 of 5 SKIP relation mart.mrt_linkedin_basic_campaign_stats .................... [[33mSKIP[0m]
[0m17:59:23.893732 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m17:59:23.960451 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:9290a81f-bfbd-4450-8e7d-a084e8129687&page=queryresults
[0m17:59:24.031560 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6f732ec0-787a-4d61-8a65-53b90127e001&page=queryresults
[0m17:59:24.182088 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (execute): 17:59:23.148775 => 17:59:24.182088
[0m17:59:24.183084 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6597a0fa-3df1-47ac-b1c2-dbf44a3ab3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002456000E050>]}
[0m17:59:24.184081 [info ] [Thread-3 (]: 3 of 5 OK created sql view model staging.stg_linkedin_campaign_history ......... [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m17:59:24.185080 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_linkedin_campaign_history
[0m17:59:24.187074 [debug] [Thread-1 (]: Began running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m17:59:24.187074 [info ] [Thread-1 (]: 5 of 5 START sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [RUN]
[0m17:59:24.189069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names, now model.bq_evo.int_linkedin_unique_campaigns_reduced_information)
[0m17:59:24.190066 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m17:59:24.194056 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m17:59:24.196053 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (compile): 17:59:24.190066 => 17:59:24.195055
[0m17:59:24.197050 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m17:59:24.202034 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m17:59:24.204029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:24.206032 [debug] [Thread-1 (]: On model.bq_evo.int_linkedin_unique_campaigns_reduced_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Linkedin-Kampagnen - gg\u00fc. Quelldaten nur ausgew\u00e4hlte Spalten f\u00fcr Weiterverarbeitung NDG."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
),

_selected_columns AS (
    SELECT
        Campaign, 
        "EVO" as Partner, 
        "cpc" as Medium, 
        "linkedin" as Source, 
        LOWER(CONCAT( name, "linkedin", "cpc", "EVO")) AS CampaignID 
    
    FROM _selected_columns
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _selected_columns
)

SELECT * FROM _final;


[0m17:59:24.267718 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: average_daily_reach_metrics_approximate_cost_in_currency_per_thousand_members_reached at [79:9]')
[0m17:59:24.764868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a3b05b1a-7af8-4712-abb8-9b624a7bae41&page=queryresults
[0m17:59:24.765900 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "_selected_columns" must be qualified with a dataset (e.g. dataset.table).')
[0m17:59:24.969855 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3c45fdc2-23fd-4aaa-bdf5-c6ad871b59c0&page=queryresults
[0m17:59:24.970891 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3c45fdc2-23fd-4aaa-bdf5-c6ad871b59c0&page=queryresults
[0m17:59:24.972882 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (execute): 17:59:24.198044 => 17:59:24.971881
[0m17:59:24.975355 [debug] [Thread-1 (]: Database Error in model int_linkedin_unique_campaigns_reduced_information (models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql)
  Table "_selected_columns" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target\run\bq_evo\models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql
[0m17:59:24.977387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6597a0fa-3df1-47ac-b1c2-dbf44a3ab3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024560329A90>]}
[0m17:59:24.979347 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [[31mERROR[0m in 0.79s]
[0m17:59:24.980344 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m17:59:25.203124 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:f7ad0f1f-4641-41c3-b9cd-b81e5e95eb19&page=queryresults
[0m17:59:25.387965 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:f7ad0f1f-4641-41c3-b9cd-b81e5e95eb19&page=queryresults
[0m17:59:25.390917 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (execute): 17:59:23.144801 => 17:59:25.389959
[0m17:59:25.393944 [debug] [Thread-2 (]: Database Error in model stg_linkedin_ad_analytics_by_campaign (models\staging\linkedin\stg_linkedin_ad_analytics_by_campaign.sql)
  Unrecognized name: average_daily_reach_metrics_approximate_cost_in_currency_per_thousand_members_reached at [79:9]
  compiled Code at target\run\bq_evo\models\staging\linkedin\stg_linkedin_ad_analytics_by_campaign.sql
[0m17:59:25.394935 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6597a0fa-3df1-47ac-b1c2-dbf44a3ab3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002456031C490>]}
[0m17:59:25.395901 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model staging.stg_linkedin_ad_analytics_by_campaign  [[31mERROR[0m in 2.31s]
[0m17:59:25.396898 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m17:59:25.399889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:25.400917 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m17:59:25.400917 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m17:59:25.401887 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m17:59:25.402882 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m17:59:25.402882 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m17:59:25.403879 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m17:59:25.404877 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information' was properly closed.
[0m17:59:25.405878 [debug] [MainThread]: Connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign' was properly closed.
[0m17:59:25.405878 [debug] [MainThread]: Connection 'model.bq_evo.stg_linkedin_campaign_history' was properly closed.
[0m17:59:25.406871 [info ] [MainThread]: 
[0m17:59:25.407868 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m17:59:25.409896 [debug] [MainThread]: Command end result
[0m17:59:25.429818 [info ] [MainThread]: 
[0m17:59:25.430815 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m17:59:25.431831 [info ] [MainThread]: 
[0m17:59:25.432809 [error] [MainThread]:   Runtime Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_unique_campaigns was not found in location europe-west3
  
  Location: europe-west3
  Job ID: 3e5a0cee-4219-421d-bb78-3eb8f8b12d6d
  
[0m17:59:25.433807 [info ] [MainThread]: 
[0m17:59:25.434803 [error] [MainThread]:   Database Error in model int_linkedin_unique_campaigns_reduced_information (models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql)
  Table "_selected_columns" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target\run\bq_evo\models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql
[0m17:59:25.435799 [info ] [MainThread]: 
[0m17:59:25.437798 [error] [MainThread]:   Database Error in model stg_linkedin_ad_analytics_by_campaign (models\staging\linkedin\stg_linkedin_ad_analytics_by_campaign.sql)
  Unrecognized name: average_daily_reach_metrics_approximate_cost_in_currency_per_thousand_members_reached at [79:9]
  compiled Code at target\run\bq_evo\models\staging\linkedin\stg_linkedin_ad_analytics_by_campaign.sql
[0m17:59:25.438793 [info ] [MainThread]: 
[0m17:59:25.439789 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=1 TOTAL=5
[0m17:59:25.440789 [debug] [MainThread]: Command `dbt run` failed at 17:59:25.440789 after 6.18 seconds
[0m17:59:25.441784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002455E3ED450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002455E62EE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002455E62C250>]}
[0m17:59:25.442783 [debug] [MainThread]: Flushing usage events
[0m18:01:45.082497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024043717C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240438FAA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024043D3E3D0>]}


============================== 18:01:45.087337 | fe496971-e92f-4829-9823-596338b3b329 ==============================
[0m18:01:45.087337 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:01:45.088336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m *linkedin*', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:01:45.429018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe496971-e92f-4829-9823-596338b3b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024045229050>]}
[0m18:01:45.437447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe496971-e92f-4829-9823-596338b3b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404387D050>]}
[0m18:01:45.438560 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:01:45.490109 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:01:45.591398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:01:45.592392 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql
[0m18:01:45.593390 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\linkedin\stg_linkedin_ad_analytics_by_campaign.sql
[0m18:01:45.647860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe496971-e92f-4829-9823-596338b3b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024045630710>]}
[0m18:01:45.666675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe496971-e92f-4829-9823-596338b3b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240456DE750>]}
[0m18:01:45.666675 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:01:45.667647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe496971-e92f-4829-9823-596338b3b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240456CDB90>]}
[0m18:01:45.670678 [info ] [MainThread]: 
[0m18:01:45.671103 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:01:45.673139 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:01:45.673139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:45.674133 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:01:45.676093 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:01:45.676093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:45.677128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:48.303542 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:01:48.304542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:48.304542 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m18:01:48.306536 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m18:01:48.307568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:48.308582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:48.960632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe496971-e92f-4829-9823-596338b3b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024044DDA850>]}
[0m18:01:48.961601 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:01:48.962595 [info ] [MainThread]: 
[0m18:01:48.967099 [debug] [Thread-1 (]: Began running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:01:48.967099 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:01:48.968095 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_linkedin_campaign_history
[0m18:01:48.968478 [info ] [Thread-1 (]: 1 of 5 START sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [RUN]
[0m18:01:48.969025 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_linkedin_ad_analytics_by_campaign ...... [RUN]
[0m18:01:48.971024 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names'
[0m18:01:48.970027 [info ] [Thread-3 (]: 3 of 5 START sql view model staging.stg_linkedin_campaign_history .............. [RUN]
[0m18:01:48.972021 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign'
[0m18:01:48.973018 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:01:48.974014 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_campaign_history'
[0m18:01:48.975026 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:01:48.984986 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:01:48.985942 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_linkedin_campaign_history
[0m18:01:48.989935 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:01:48.993923 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:01:48.994601 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (compile): 18:01:48.975026 => 18:01:48.994601
[0m18:01:48.996603 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (compile): 18:01:48.986950 => 18:01:48.995604
[0m18:01:48.996603 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:01:48.997597 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (compile): 18:01:48.990964 => 18:01:48.997597
[0m18:01:48.998595 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:01:49.033624 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:01:49.034619 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_linkedin_campaign_history
[0m18:01:49.038627 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:01:49.041637 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:01:49.042628 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:49.043594 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:01:49.044594 [debug] [Thread-1 (]: On model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.Campaign = _raw_performance.Campaign
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m18:01:49.045598 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:01:49.046587 [debug] [Thread-2 (]: On model.bq_evo.stg_linkedin_ad_analytics_by_campaign: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Linkedin-Kampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS (
    SELECT *    
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`ad_analytics_by_campaign`
),

_renamed_columns AS (
    SELECT
        campaign_id,
        day as Date,
        _fivetran_synced,
        action_clicks,
        ad_unit_clicks,
        approximate_unique_impressions,
        card_clicks,
        card_impressions,
        clicks as Clicks,
        comment_likes,
        comments,
        company_page_clicks,
        conversion_value_in_local_currency,
        cost_in_local_currency as Cost,
        cost_in_usd,
        external_website_conversions,
        external_website_post_click_conversions,
        external_website_post_view_conversions,
        follows,
        full_screen_plays,
        impressions as Impressions,
        landing_page_clicks,
        lead_generation_mail_contact_info_shares,
        lead_generation_mail_interested_clicks,
        likes,
        one_click_lead_form_opens,
        one_click_leads,
        opens,
        other_engagements,
        sends,
        shares,
        text_url_clicks,
        total_engagements,
        video_completions,
        video_first_quartile_completions,
        video_midpoint_completions,
        video_starts,
        video_third_quartile_completions,
        video_views,
        viral_card_clicks,
        viral_card_impressions,
        viral_clicks,
        viral_comment_likes,
        viral_comments,
        viral_company_page_clicks,
        viral_external_website_conversions,
        viral_external_website_post_click_conversions,
        viral_external_website_post_view_conversions,
        viral_follows,
        viral_full_screen_plays,
        viral_impressions,
        viral_landing_page_clicks,
        viral_likes,
        viral_one_click_lead_form_opens,
        viral_one_click_leads,
        viral_other_engagements,
        viral_shares,
        viral_total_engagements,
        viral_video_completions,
        viral_video_first_quartile_completions,
        viral_video_midpoint_completions,
        viral_video_starts,
        viral_video_third_quartile_completions,
        viral_video_views

    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:01:49.048582 [debug] [Thread-3 (]: On model.bq_evo.stg_linkedin_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`campaign_history`
),

_renamed_columns AS(
    SELECT
        id,
        last_modified_time,
        _fivetran_synced,
        account_id,
        associated_entity,
        audience_expansion_enabled,
        campaign_group_id,
        cost_type,
        created_time,
        creative_selection,
        daily_budget_amount,
        daily_budget_currency_code,
        format,
        locale_country,
        locale_language,
        name as Campaign,
        objective_type,
        offsite_delivery_enabled,
        optimization_target_type,
        run_schedule_end,
        run_schedule_start,
        status,
        type,
        unit_cost_amount,
        unit_cost_currency_code,
        version_tag
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:01:49.772239 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:087f73d0-aaaf-4dc5-9463-e958dd04b9a1&page=queryresults
[0m18:01:49.774318 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.Campaign = _raw_performance.Campaign
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m18:01:49.775320 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_unique_campaigns was not found in location europe-west3

Location: europe-west3
Job ID: 087f73d0-aaaf-4dc5-9463-e958dd04b9a1

[0m18:01:49.777315 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (execute): 18:01:48.999604 => 18:01:49.776317
[0m18:01:49.780306 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3c70c0e6-583e-4b66-a51d-6d8179c4176d&page=queryresults
[0m18:01:49.787286 [debug] [Thread-1 (]: Runtime Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_unique_campaigns was not found in location europe-west3
  
  Location: europe-west3
  Job ID: 087f73d0-aaaf-4dc5-9463-e958dd04b9a1
  
[0m18:01:49.788284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe496971-e92f-4829-9823-596338b3b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024045754A50>]}
[0m18:01:49.789282 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [[31mERROR[0m in 0.82s]
[0m18:01:49.790279 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:01:49.791291 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:01:49.792279 [info ] [Thread-4 (]: 4 of 5 SKIP relation mart.mrt_linkedin_basic_campaign_stats .................... [[33mSKIP[0m]
[0m18:01:49.793288 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:01:49.806278 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5200b44f-f9d1-48dd-b82b-2560a6ecb6fb&page=queryresults
[0m18:01:50.022526 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (execute): 18:01:49.039632 => 18:01:50.022526
[0m18:01:50.023523 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe496971-e92f-4829-9823-596338b3b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024045632C10>]}
[0m18:01:50.024523 [info ] [Thread-3 (]: 3 of 5 OK created sql view model staging.stg_linkedin_campaign_history ......... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m18:01:50.025518 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_linkedin_campaign_history
[0m18:01:50.026515 [debug] [Thread-1 (]: Began running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:01:50.027512 [info ] [Thread-1 (]: 5 of 5 START sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [RUN]
[0m18:01:50.028508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names, now model.bq_evo.int_linkedin_unique_campaigns_reduced_information)
[0m18:01:50.029505 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:01:50.032498 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:01:50.034493 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (compile): 18:01:50.029505 => 18:01:50.033495
[0m18:01:50.035491 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:01:50.038481 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:01:50.040480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:50.041474 [debug] [Thread-1 (]: On model.bq_evo.int_linkedin_unique_campaigns_reduced_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Linkedin-Kampagnen - gg\u00fc. Quelldaten nur ausgew\u00e4hlte Spalten f\u00fcr Weiterverarbeitung NDG."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
),

_selected_columns AS (
    SELECT
        Campaign, 
        "EVO" as Partner, 
        "cpc" as Medium, 
        "linkedin" as Source, 
        LOWER(CONCAT( name, "linkedin", "cpc", "EVO")) AS CampaignID 
    
    FROM _raw
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _selected_columns
)

SELECT * FROM _final;


[0m18:01:50.044466 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (execute): 18:01:49.035617 => 18:01:50.044466
[0m18:01:50.047493 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe496971-e92f-4829-9823-596338b3b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240459203D0>]}
[0m18:01:50.048479 [info ] [Thread-2 (]: 2 of 5 OK created sql view model staging.stg_linkedin_ad_analytics_by_campaign . [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m18:01:50.049452 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:01:50.678999 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:64c51e0d-0690-45d6-88d0-9257c47722b8&page=queryresults
[0m18:01:50.822456 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: name at [19:23]')
[0m18:01:52.051459 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7be5fc7a-079d-41b6-bd22-7225df7af120&page=queryresults
[0m18:01:52.235680 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7be5fc7a-079d-41b6-bd22-7225df7af120&page=queryresults
[0m18:01:52.240664 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (execute): 18:01:50.035491 => 18:01:52.239626
[0m18:01:52.247598 [debug] [Thread-1 (]: Database Error in model int_linkedin_unique_campaigns_reduced_information (models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql)
  Unrecognized name: name at [19:23]
  compiled Code at target\run\bq_evo\models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql
[0m18:01:52.248633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe496971-e92f-4829-9823-596338b3b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024045928310>]}
[0m18:01:52.249630 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [[31mERROR[0m in 2.22s]
[0m18:01:52.250593 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:01:52.254581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:52.254581 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:01:52.255578 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:01:52.255578 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:01:52.257037 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:01:52.257037 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m18:01:52.258037 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m18:01:52.258037 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information' was properly closed.
[0m18:01:52.258037 [debug] [MainThread]: Connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign' was properly closed.
[0m18:01:52.259034 [debug] [MainThread]: Connection 'model.bq_evo.stg_linkedin_campaign_history' was properly closed.
[0m18:01:52.260035 [info ] [MainThread]: 
[0m18:01:52.261030 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 6.59 seconds (6.59s).
[0m18:01:52.262078 [debug] [MainThread]: Command end result
[0m18:01:52.283290 [info ] [MainThread]: 
[0m18:01:52.284289 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:01:52.285287 [info ] [MainThread]: 
[0m18:01:52.286284 [error] [MainThread]:   Runtime Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_unique_campaigns was not found in location europe-west3
  
  Location: europe-west3
  Job ID: 087f73d0-aaaf-4dc5-9463-e958dd04b9a1
  
[0m18:01:52.288277 [info ] [MainThread]: 
[0m18:01:52.288277 [error] [MainThread]:   Database Error in model int_linkedin_unique_campaigns_reduced_information (models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql)
  Unrecognized name: name at [19:23]
  compiled Code at target\run\bq_evo\models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql
[0m18:01:52.289273 [info ] [MainThread]: 
[0m18:01:52.290283 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
[0m18:01:52.292269 [debug] [MainThread]: Command `dbt run` failed at 18:01:52.292269 after 7.22 seconds
[0m18:01:52.293266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024043717C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404435DD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024041A5EE10>]}
[0m18:01:52.294289 [debug] [MainThread]: Flushing usage events
[0m18:03:21.339193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BB9A5F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BBA715D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BBA728D0>]}


============================== 18:03:21.344182 | c52c112f-6692-4dcd-8366-f95c1ac9534b ==============================
[0m18:03:21.344182 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:03:21.345179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m *linkedin*', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:03:21.711444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c52c112f-6692-4dcd-8366-f95c1ac9534b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BBD3A850>]}
[0m18:03:21.722063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c52c112f-6692-4dcd-8366-f95c1ac9534b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BBA41690>]}
[0m18:03:21.723060 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:03:21.775618 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:03:21.884356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:03:21.885354 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql
[0m18:03:21.938274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c52c112f-6692-4dcd-8366-f95c1ac9534b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BD833D90>]}
[0m18:03:21.959954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c52c112f-6692-4dcd-8366-f95c1ac9534b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BD99C310>]}
[0m18:03:21.959954 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:03:21.961953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c52c112f-6692-4dcd-8366-f95c1ac9534b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BD825B90>]}
[0m18:03:21.964943 [info ] [MainThread]: 
[0m18:03:21.965940 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:03:21.967934 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:03:21.970044 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:03:21.970044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:21.971045 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:03:21.972055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:21.974036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:24.820034 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m18:03:24.821068 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m18:03:24.822068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:24.823029 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:03:24.823029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:24.826021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:25.507652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c52c112f-6692-4dcd-8366-f95c1ac9534b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BBDA6310>]}
[0m18:03:25.508157 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:03:25.509665 [info ] [MainThread]: 
[0m18:03:25.513668 [debug] [Thread-1 (]: Began running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:03:25.514665 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:03:25.514665 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_linkedin_campaign_history
[0m18:03:25.515662 [info ] [Thread-1 (]: 1 of 5 START sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [RUN]
[0m18:03:25.516660 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_linkedin_ad_analytics_by_campaign ...... [RUN]
[0m18:03:25.518162 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names'
[0m18:03:25.516660 [info ] [Thread-3 (]: 3 of 5 START sql view model staging.stg_linkedin_campaign_history .............. [RUN]
[0m18:03:25.519162 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign'
[0m18:03:25.520159 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:03:25.521159 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_campaign_history'
[0m18:03:25.521159 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:03:25.530735 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:03:25.531733 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_linkedin_campaign_history
[0m18:03:25.539226 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:03:25.544252 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:03:25.545213 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (compile): 18:03:25.522157 => 18:03:25.545213
[0m18:03:25.546214 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:03:25.547723 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (compile): 18:03:25.531733 => 18:03:25.547723
[0m18:03:25.594889 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:03:25.594889 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (compile): 18:03:25.540224 => 18:03:25.594889
[0m18:03:25.595919 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:03:25.596883 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_linkedin_campaign_history
[0m18:03:25.597880 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:03:25.604050 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:03:25.607629 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:03:25.608133 [debug] [Thread-1 (]: On model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.Campaign = _raw_performance.Campaign
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m18:03:25.610863 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:03:25.613861 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:03:25.613861 [debug] [Thread-2 (]: On model.bq_evo.stg_linkedin_ad_analytics_by_campaign: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Linkedin-Kampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS (
    SELECT *    
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`ad_analytics_by_campaign`
),

_renamed_columns AS (
    SELECT
        campaign_id,
        day as Date,
        _fivetran_synced,
        action_clicks,
        ad_unit_clicks,
        approximate_unique_impressions,
        card_clicks,
        card_impressions,
        clicks as Clicks,
        comment_likes,
        comments,
        company_page_clicks,
        conversion_value_in_local_currency,
        cost_in_local_currency as Cost,
        cost_in_usd,
        external_website_conversions,
        external_website_post_click_conversions,
        external_website_post_view_conversions,
        follows,
        full_screen_plays,
        impressions as Impressions,
        landing_page_clicks,
        lead_generation_mail_contact_info_shares,
        lead_generation_mail_interested_clicks,
        likes,
        one_click_lead_form_opens,
        one_click_leads,
        opens,
        other_engagements,
        sends,
        shares,
        text_url_clicks,
        total_engagements,
        video_completions,
        video_first_quartile_completions,
        video_midpoint_completions,
        video_starts,
        video_third_quartile_completions,
        video_views,
        viral_card_clicks,
        viral_card_impressions,
        viral_clicks,
        viral_comment_likes,
        viral_comments,
        viral_company_page_clicks,
        viral_external_website_conversions,
        viral_external_website_post_click_conversions,
        viral_external_website_post_view_conversions,
        viral_follows,
        viral_full_screen_plays,
        viral_impressions,
        viral_landing_page_clicks,
        viral_likes,
        viral_one_click_lead_form_opens,
        viral_one_click_leads,
        viral_other_engagements,
        viral_shares,
        viral_total_engagements,
        viral_video_completions,
        viral_video_first_quartile_completions,
        viral_video_midpoint_completions,
        viral_video_starts,
        viral_video_third_quartile_completions,
        viral_video_views

    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:03:25.614856 [debug] [Thread-3 (]: On model.bq_evo.stg_linkedin_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`campaign_history`
),

_renamed_columns AS(
    SELECT
        id,
        last_modified_time,
        _fivetran_synced,
        account_id,
        associated_entity,
        audience_expansion_enabled,
        campaign_group_id,
        cost_type,
        created_time,
        creative_selection,
        daily_budget_amount,
        daily_budget_currency_code,
        format,
        locale_country,
        locale_language,
        name as Campaign,
        objective_type,
        offsite_delivery_enabled,
        optimization_target_type,
        run_schedule_end,
        run_schedule_start,
        status,
        type,
        unit_cost_amount,
        unit_cost_currency_code,
        version_tag
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:03:26.376557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:fdd4b651-5593-4167-8eb0-15e01e3a3b2c&page=queryresults
[0m18:03:26.376557 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.Campaign = _raw_performance.Campaign
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m18:03:26.378066 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_unique_campaigns was not found in location europe-west3

Location: europe-west3
Job ID: fdd4b651-5593-4167-8eb0-15e01e3a3b2c

[0m18:03:26.378066 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (execute): 18:03:25.548745 => 18:03:26.378066
[0m18:03:26.385134 [debug] [Thread-1 (]: Runtime Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_unique_campaigns was not found in location europe-west3
  
  Location: europe-west3
  Job ID: fdd4b651-5593-4167-8eb0-15e01e3a3b2c
  
[0m18:03:26.385134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c52c112f-6692-4dcd-8366-f95c1ac9534b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BD905ED0>]}
[0m18:03:26.386098 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [[31mERROR[0m in 0.87s]
[0m18:03:26.387095 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:03:26.388607 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:03:26.389606 [info ] [Thread-4 (]: 4 of 5 SKIP relation mart.mrt_linkedin_basic_campaign_stats .................... [[33mSKIP[0m]
[0m18:03:26.389606 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:03:26.440475 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5cb82ecd-7b22-4c03-bd29-b5da7efd9ff0&page=queryresults
[0m18:03:26.482088 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:345a1673-925b-40f6-8072-63f6bac043d1&page=queryresults
[0m18:03:26.664188 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (execute): 18:03:25.600139 => 18:03:26.664188
[0m18:03:26.667690 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (execute): 18:03:25.604634 => 18:03:26.667690
[0m18:03:26.668321 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c52c112f-6692-4dcd-8366-f95c1ac9534b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BD84D2D0>]}
[0m18:03:26.669323 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c52c112f-6692-4dcd-8366-f95c1ac9534b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BD5F5550>]}
[0m18:03:26.669323 [info ] [Thread-2 (]: 2 of 5 OK created sql view model staging.stg_linkedin_ad_analytics_by_campaign . [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m18:03:26.671760 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:03:26.670761 [info ] [Thread-3 (]: 3 of 5 OK created sql view model staging.stg_linkedin_campaign_history ......... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m18:03:26.673755 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_linkedin_campaign_history
[0m18:03:26.674753 [debug] [Thread-1 (]: Began running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:03:26.674753 [info ] [Thread-1 (]: 5 of 5 START sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [RUN]
[0m18:03:26.676749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names, now model.bq_evo.int_linkedin_unique_campaigns_reduced_information)
[0m18:03:26.677773 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:03:26.681591 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:03:26.683584 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (compile): 18:03:26.677773 => 18:03:26.682623
[0m18:03:26.683584 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:03:26.686575 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:03:26.689153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:26.690438 [debug] [Thread-1 (]: On model.bq_evo.int_linkedin_unique_campaigns_reduced_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Linkedin-Kampagnen - gg\u00fc. Quelldaten nur ausgew\u00e4hlte Spalten f\u00fcr Weiterverarbeitung NDG."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
),

_selected_columns AS (
    SELECT
        Campaign, 
        "EVO" as Partner, 
        "cpc" as Medium, 
        "linkedin" as Source, 
        LOWER(CONCAT(Campaign, "linkedin", "cpc", "EVO")) AS CampaignID 
    
    FROM _raw
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _selected_columns
)

SELECT * FROM _final;


[0m18:03:27.371469 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:cafac8a4-a04e-4276-9104-44921043dfdd&page=queryresults
[0m18:03:27.538976 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (execute): 18:03:26.684581 => 18:03:27.538976
[0m18:03:27.540493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c52c112f-6692-4dcd-8366-f95c1ac9534b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BDAB8890>]}
[0m18:03:27.541493 [info ] [Thread-1 (]: 5 of 5 OK created sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m18:03:27.543490 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:03:27.545484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:27.546481 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:03:27.546481 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:03:27.546481 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:03:27.547990 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m18:03:27.549036 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m18:03:27.550032 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:03:27.550032 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information' was properly closed.
[0m18:03:27.551031 [debug] [MainThread]: Connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign' was properly closed.
[0m18:03:27.551031 [debug] [MainThread]: Connection 'model.bq_evo.stg_linkedin_campaign_history' was properly closed.
[0m18:03:27.552029 [info ] [MainThread]: 
[0m18:03:27.552029 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 5.59 seconds (5.59s).
[0m18:03:27.555022 [debug] [MainThread]: Command end result
[0m18:03:27.575676 [info ] [MainThread]: 
[0m18:03:27.576670 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:03:27.577668 [info ] [MainThread]: 
[0m18:03:27.577668 [error] [MainThread]:   Runtime Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_unique_campaigns was not found in location europe-west3
  
  Location: europe-west3
  Job ID: fdd4b651-5593-4167-8eb0-15e01e3a3b2c
  
[0m18:03:27.579037 [info ] [MainThread]: 
[0m18:03:27.580337 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m18:03:27.582338 [debug] [MainThread]: Command `dbt run` failed at 18:03:27.581337 after 6.26 seconds
[0m18:03:27.582338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BBA6A650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BC55B790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0BB9A5ED0>]}
[0m18:03:27.583332 [debug] [MainThread]: Flushing usage events
[0m18:21:26.052029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9877681D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C987CF7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C98776D010>]}


============================== 18:21:26.056020 | faf41d19-ed0b-479f-ba04-b14764e0d567 ==============================
[0m18:21:26.056020 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:21:26.057018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m *linkedin*', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:21:26.397302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'faf41d19-ed0b-479f-ba04-b14764e0d567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C989341190>]}
[0m18:21:26.406278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'faf41d19-ed0b-479f-ba04-b14764e0d567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C98827BD10>]}
[0m18:21:26.407267 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:21:26.458169 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:21:26.561380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m18:21:26.562378 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql
[0m18:21:26.562378 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\linkedin\stg_linkedin_ad_analytics_by_campaign.sql
[0m18:21:26.563626 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql
[0m18:21:26.620031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'faf41d19-ed0b-479f-ba04-b14764e0d567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C98962CA50>]}
[0m18:21:26.639386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'faf41d19-ed0b-479f-ba04-b14764e0d567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9893329D0>]}
[0m18:21:26.639386 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:21:26.640386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'faf41d19-ed0b-479f-ba04-b14764e0d567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C986EA5210>]}
[0m18:21:26.643378 [info ] [MainThread]: 
[0m18:21:26.644380 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:21:26.646336 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:21:26.647334 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:21:26.647334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:26.648332 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:21:26.649368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:26.651324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:29.324097 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:21:29.325095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:29.326093 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m18:21:29.328087 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m18:21:29.329084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:29.329084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:29.993279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'faf41d19-ed0b-479f-ba04-b14764e0d567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C986EA5210>]}
[0m18:21:29.994249 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:21:29.995247 [info ] [MainThread]: 
[0m18:21:29.998977 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:21:29.999958 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_linkedin_campaign_history
[0m18:21:30.000955 [info ] [Thread-1 (]: 1 of 5 START sql view model staging.stg_linkedin_ad_analytics_by_campaign ...... [RUN]
[0m18:21:30.000955 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_linkedin_campaign_history .............. [RUN]
[0m18:21:30.002951 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign'
[0m18:21:30.003947 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_campaign_history'
[0m18:21:30.003947 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:21:30.004945 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_linkedin_campaign_history
[0m18:21:30.013957 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:21:30.017909 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:21:30.019781 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (compile): 18:21:30.005942 => 18:21:30.019781
[0m18:21:30.020775 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (compile): 18:21:30.014918 => 18:21:30.020775
[0m18:21:30.021770 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:21:30.022793 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_linkedin_campaign_history
[0m18:21:30.054681 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:21:30.058705 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:21:30.059667 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:21:30.060665 [debug] [Thread-1 (]: On model.bq_evo.stg_linkedin_ad_analytics_by_campaign: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Linkedin-Kampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS (
    SELECT *    
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`ad_analytics_by_campaign`
),

_renamed_columns AS (
    SELECT
        campaign_id,
        day as Date,
        _fivetran_synced,
        action_clicks,
        ad_unit_clicks,
        approximate_unique_impressions,
        card_clicks,
        card_impressions,
        clicks as Clicks,
        comment_likes,
        comments,
        company_page_clicks,
        conversion_value_in_local_currency,
        cost_in_local_currency as Cost,
        cost_in_usd,
        external_website_conversions,
        external_website_post_click_conversions,
        external_website_post_view_conversions,
        follows,
        full_screen_plays,
        impressions as Impressions,
        landing_page_clicks,
        lead_generation_mail_contact_info_shares,
        lead_generation_mail_interested_clicks,
        likes,
        one_click_lead_form_opens,
        one_click_leads,
        opens,
        other_engagements,
        sends,
        shares,
        text_url_clicks,
        total_engagements,
        video_completions,
        video_first_quartile_completions,
        video_midpoint_completions,
        video_starts,
        video_third_quartile_completions,
        video_views,
        viral_card_clicks,
        viral_card_impressions,
        viral_clicks,
        viral_comment_likes,
        viral_comments,
        viral_company_page_clicks,
        viral_external_website_conversions,
        viral_external_website_post_click_conversions,
        viral_external_website_post_view_conversions,
        viral_follows,
        viral_full_screen_plays,
        viral_impressions,
        viral_landing_page_clicks,
        viral_likes,
        viral_one_click_lead_form_opens,
        viral_one_click_leads,
        viral_other_engagements,
        viral_shares,
        viral_total_engagements,
        viral_video_completions,
        viral_video_first_quartile_completions,
        viral_video_midpoint_completions,
        viral_video_starts,
        viral_video_third_quartile_completions,
        viral_video_views
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:21:30.061661 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:21:30.063695 [debug] [Thread-2 (]: On model.bq_evo.stg_linkedin_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`campaign_history`
),

_renamed_columns AS(
    SELECT
        id,
        last_modified_time,
        _fivetran_synced,
        account_id,
        associated_entity,
        audience_expansion_enabled,
        campaign_group_id,
        cost_type,
        created_time,
        creative_selection,
        daily_budget_amount,
        daily_budget_currency_code,
        format,
        locale_country,
        locale_language,
        name as Campaign,
        objective_type,
        offsite_delivery_enabled,
        optimization_target_type,
        run_schedule_end,
        run_schedule_start,
        status,
        type,
        unit_cost_amount,
        unit_cost_currency_code,
        version_tag
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:21:30.816610 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:fe8bfad7-8640-4380-a006-fdbdf4a7c72c&page=queryresults
[0m18:21:30.820599 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:001bd767-54d9-4507-b08c-1af428f9952c&page=queryresults
[0m18:21:31.063641 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (execute): 18:21:30.055714 => 18:21:31.063641
[0m18:21:31.066607 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (execute): 18:21:30.022793 => 18:21:31.066607
[0m18:21:31.067603 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faf41d19-ed0b-479f-ba04-b14764e0d567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C989665DD0>]}
[0m18:21:31.068612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faf41d19-ed0b-479f-ba04-b14764e0d567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C989665AD0>]}
[0m18:21:31.069630 [info ] [Thread-2 (]: 2 of 5 OK created sql view model staging.stg_linkedin_campaign_history ......... [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m18:21:31.070613 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_linkedin_campaign_history
[0m18:21:31.070613 [info ] [Thread-1 (]: 1 of 5 OK created sql view model staging.stg_linkedin_ad_analytics_by_campaign . [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m18:21:31.072593 [debug] [Thread-4 (]: Began running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:21:31.072593 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:21:31.074586 [info ] [Thread-4 (]: 3 of 5 START sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [RUN]
[0m18:21:31.077578 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information'
[0m18:21:31.078573 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:21:31.082080 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:21:31.083078 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (compile): 18:21:31.078573 => 18:21:31.083078
[0m18:21:31.084075 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:21:31.088064 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:21:31.090059 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:21:31.092059 [debug] [Thread-4 (]: On model.bq_evo.int_linkedin_unique_campaigns_reduced_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Linkedin-Kampagnen - gg\u00fc. Quelldaten nur ausgew\u00e4hlte Spalten f\u00fcr Weiterverarbeitung NDG."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
),

_selected_columns AS (
    SELECT
        Campaign, 
        "EVO" as Partner, 
        "cpc" as Medium, 
        "linkedin" as Source, 
        LOWER(CONCAT(Campaign, "linkedin", "cpc", "EVO")) AS CampaignID 
    
    FROM _raw
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _selected_columns
)

SELECT * FROM _final;


[0m18:21:31.770402 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:53910971-d448-47fd-b116-95f0a9663820&page=queryresults
[0m18:21:32.018698 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (execute): 18:21:31.084075 => 18:21:32.018698
[0m18:21:32.019744 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faf41d19-ed0b-479f-ba04-b14764e0d567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C989819CD0>]}
[0m18:21:32.020727 [info ] [Thread-4 (]: 3 of 5 OK created sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m18:21:32.022117 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:21:32.023117 [debug] [Thread-2 (]: Began running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:21:32.024114 [info ] [Thread-2 (]: 4 of 5 START sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [RUN]
[0m18:21:32.025112 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_linkedin_campaign_history, now model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names)
[0m18:21:32.026143 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:21:32.029135 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:21:32.030131 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (compile): 18:21:32.026143 => 18:21:32.030131
[0m18:21:32.031097 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:21:32.035087 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:21:32.037083 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:21:32.038080 [debug] [Thread-2 (]: On model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.Campaign = _raw_performance.Campaign
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m18:21:32.702698 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:1b68edf9-d650-4e3e-8d97-381cb58ca816&page=queryresults
[0m18:21:32.862269 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name Campaign not found inside _raw_performance at [21:58]')
[0m18:21:33.469908 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:15be271f-c520-467e-9da8-02982657a280&page=queryresults
[0m18:21:33.640003 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:15be271f-c520-467e-9da8-02982657a280&page=queryresults
[0m18:21:33.642868 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (execute): 18:21:32.032094 => 18:21:33.641868
[0m18:21:33.655699 [debug] [Thread-2 (]: Database Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  Name Campaign not found inside _raw_performance at [21:58]
  compiled Code at target\run\bq_evo\models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql
[0m18:21:33.656696 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faf41d19-ed0b-479f-ba04-b14764e0d567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C98985A250>]}
[0m18:21:33.657694 [error] [Thread-2 (]: 4 of 5 ERROR creating sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [[31mERROR[0m in 1.63s]
[0m18:21:33.659691 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:21:33.660690 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:21:33.661683 [info ] [Thread-1 (]: 5 of 5 SKIP relation mart.mrt_linkedin_basic_campaign_stats .................... [[33mSKIP[0m]
[0m18:21:33.662680 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:21:33.664330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:21:33.665351 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:21:33.665351 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:21:33.666348 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:21:33.667175 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:21:33.667175 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m18:21:33.668175 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m18:21:33.668728 [debug] [MainThread]: Connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign' was properly closed.
[0m18:21:33.669729 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names' was properly closed.
[0m18:21:33.670752 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information' was properly closed.
[0m18:21:33.670752 [info ] [MainThread]: 
[0m18:21:33.671723 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 7.03 seconds (7.03s).
[0m18:21:33.673748 [debug] [MainThread]: Command end result
[0m18:21:33.688129 [info ] [MainThread]: 
[0m18:21:33.689147 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:21:33.690124 [info ] [MainThread]: 
[0m18:21:33.691121 [error] [MainThread]:   Database Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  Name Campaign not found inside _raw_performance at [21:58]
  compiled Code at target\run\bq_evo\models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql
[0m18:21:33.693117 [info ] [MainThread]: 
[0m18:21:33.694116 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m18:21:33.695111 [debug] [MainThread]: Command `dbt run` failed at 18:21:33.695111 after 7.66 seconds
[0m18:21:33.696109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C98596AD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C98825E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C98248CA10>]}
[0m18:21:33.697118 [debug] [MainThread]: Flushing usage events
[0m18:22:19.518899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221868E3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022186A73D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218AE5BF50>]}


============================== 18:22:19.524352 | 20f51f35-ae9d-47e1-a4e8-0655e43db67f ==============================
[0m18:22:19.524352 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:22:19.526326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m *linkedin*', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:22:19.866511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20f51f35-ae9d-47e1-a4e8-0655e43db67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218A82CFD0>]}
[0m18:22:19.875488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20f51f35-ae9d-47e1-a4e8-0655e43db67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218508CAD0>]}
[0m18:22:19.876484 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:22:19.925321 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:22:20.027640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:22:20.028638 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql
[0m18:22:20.029635 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql
[0m18:22:20.082082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20f51f35-ae9d-47e1-a4e8-0655e43db67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218C21C9D0>]}
[0m18:22:20.101574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20f51f35-ae9d-47e1-a4e8-0655e43db67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218C3CBF50>]}
[0m18:22:20.102572 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:22:20.103896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20f51f35-ae9d-47e1-a4e8-0655e43db67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218BF1EC50>]}
[0m18:22:20.105928 [info ] [MainThread]: 
[0m18:22:20.107924 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:22:20.108886 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:22:20.109928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:20.110881 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:22:20.111880 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:22:20.112396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:20.112396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:22.737517 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:22:22.737517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:22.738573 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m18:22:22.740611 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m18:22:22.741654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:22.741654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:23.428990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20f51f35-ae9d-47e1-a4e8-0655e43db67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218BAAC250>]}
[0m18:22:23.429977 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:22:23.430976 [info ] [MainThread]: 
[0m18:22:23.435434 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:22:23.435434 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_linkedin_campaign_history
[0m18:22:23.436434 [info ] [Thread-1 (]: 1 of 5 START sql view model staging.stg_linkedin_ad_analytics_by_campaign ...... [RUN]
[0m18:22:23.436911 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_linkedin_campaign_history .............. [RUN]
[0m18:22:23.438909 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign'
[0m18:22:23.439906 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_campaign_history'
[0m18:22:23.439906 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:22:23.440922 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_linkedin_campaign_history
[0m18:22:23.450888 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:22:23.453877 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:22:23.455616 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (compile): 18:22:23.441900 => 18:22:23.454613
[0m18:22:23.455616 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:22:23.475136 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (compile): 18:22:23.450888 => 18:22:23.475136
[0m18:22:23.488101 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:22:23.488989 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_linkedin_campaign_history
[0m18:22:23.489989 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:22:23.494014 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:22:23.494978 [debug] [Thread-1 (]: On model.bq_evo.stg_linkedin_ad_analytics_by_campaign: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Linkedin-Kampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS (
    SELECT *    
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`ad_analytics_by_campaign`
),

_renamed_columns AS (
    SELECT
        campaign_id,
        day as Date,
        _fivetran_synced,
        action_clicks,
        ad_unit_clicks,
        approximate_unique_impressions,
        card_clicks,
        card_impressions,
        clicks as Clicks,
        comment_likes,
        comments,
        company_page_clicks,
        conversion_value_in_local_currency,
        cost_in_local_currency as Cost,
        cost_in_usd,
        external_website_conversions,
        external_website_post_click_conversions,
        external_website_post_view_conversions,
        follows,
        full_screen_plays,
        impressions as Impressions,
        landing_page_clicks,
        lead_generation_mail_contact_info_shares,
        lead_generation_mail_interested_clicks,
        likes,
        one_click_lead_form_opens,
        one_click_leads,
        opens,
        other_engagements,
        sends,
        shares,
        text_url_clicks,
        total_engagements,
        video_completions,
        video_first_quartile_completions,
        video_midpoint_completions,
        video_starts,
        video_third_quartile_completions,
        video_views,
        viral_card_clicks,
        viral_card_impressions,
        viral_clicks,
        viral_comment_likes,
        viral_comments,
        viral_company_page_clicks,
        viral_external_website_conversions,
        viral_external_website_post_click_conversions,
        viral_external_website_post_view_conversions,
        viral_follows,
        viral_full_screen_plays,
        viral_impressions,
        viral_landing_page_clicks,
        viral_likes,
        viral_one_click_lead_form_opens,
        viral_one_click_leads,
        viral_other_engagements,
        viral_shares,
        viral_total_engagements,
        viral_video_completions,
        viral_video_first_quartile_completions,
        viral_video_midpoint_completions,
        viral_video_starts,
        viral_video_third_quartile_completions,
        viral_video_views
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:22:23.497968 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:22:23.498965 [debug] [Thread-2 (]: On model.bq_evo.stg_linkedin_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`campaign_history`
),

_renamed_columns AS(
    SELECT
        id,
        last_modified_time,
        _fivetran_synced,
        account_id,
        associated_entity,
        audience_expansion_enabled,
        campaign_group_id,
        cost_type,
        created_time,
        creative_selection,
        daily_budget_amount,
        daily_budget_currency_code,
        format,
        locale_country,
        locale_language,
        name as Campaign,
        objective_type,
        offsite_delivery_enabled,
        optimization_target_type,
        run_schedule_end,
        run_schedule_start,
        status,
        type,
        unit_cost_amount,
        unit_cost_currency_code,
        version_tag
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:22:24.213351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:37c1dd74-4ee7-4668-b3b7-ac8bafd531ba&page=queryresults
[0m18:22:24.244355 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5a65ffa4-3215-4861-ac4f-227379508033&page=queryresults
[0m18:22:24.437343 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (execute): 18:22:23.490989 => 18:22:24.437343
[0m18:22:24.438340 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20f51f35-ae9d-47e1-a4e8-0655e43db67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218C3C3050>]}
[0m18:22:24.439338 [info ] [Thread-2 (]: 2 of 5 OK created sql view model staging.stg_linkedin_campaign_history ......... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m18:22:24.440335 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_linkedin_campaign_history
[0m18:22:24.441332 [debug] [Thread-4 (]: Began running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:22:24.441332 [info ] [Thread-4 (]: 3 of 5 START sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [RUN]
[0m18:22:24.443326 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information'
[0m18:22:24.443326 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:22:24.446352 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:22:24.448314 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (compile): 18:22:24.444327 => 18:22:24.447347
[0m18:22:24.448314 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:22:24.452308 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:22:24.454301 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:22:24.454301 [debug] [Thread-4 (]: On model.bq_evo.int_linkedin_unique_campaigns_reduced_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Linkedin-Kampagnen - gg\u00fc. Quelldaten nur ausgew\u00e4hlte Spalten f\u00fcr Weiterverarbeitung NDG."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
),

_selected_columns AS (
    SELECT
        Campaign, 
        "EVO" as Partner, 
        "cpc" as Medium, 
        "linkedin" as Source, 
        LOWER(CONCAT(Campaign, "linkedin", "cpc", "EVO")) AS CampaignID 
    
    FROM _raw
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _selected_columns
)

SELECT * FROM _final;


[0m18:22:24.638334 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (execute): 18:22:23.456611 => 18:22:24.637337
[0m18:22:24.638334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20f51f35-ae9d-47e1-a4e8-0655e43db67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218C4315D0>]}
[0m18:22:24.639333 [info ] [Thread-1 (]: 1 of 5 OK created sql view model staging.stg_linkedin_ad_analytics_by_campaign . [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m18:22:24.640294 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:22:25.071391 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3573cc53-cff8-4bda-8ec2-39418e2a8c60&page=queryresults
[0m18:22:25.269586 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (execute): 18:22:24.449316 => 18:22:25.268589
[0m18:22:25.270552 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20f51f35-ae9d-47e1-a4e8-0655e43db67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218BF31ED0>]}
[0m18:22:25.271548 [info ] [Thread-4 (]: 3 of 5 OK created sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m18:22:25.272545 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:22:25.273544 [debug] [Thread-2 (]: Began running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:22:25.274540 [info ] [Thread-2 (]: 4 of 5 START sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [RUN]
[0m18:22:25.276534 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_linkedin_campaign_history, now model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names)
[0m18:22:25.277532 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:22:25.281529 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:22:25.283516 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (compile): 18:22:25.277532 => 18:22:25.282555
[0m18:22:25.283516 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:22:25.287505 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:22:25.289500 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:22:25.289500 [debug] [Thread-2 (]: On model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.campaign_id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m18:22:25.951124 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:d5eb024d-5be4-4440-8031-3246ff06f1dc&page=queryresults
[0m18:22:26.123121 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name campaign_id not found inside _raw_unique_campaigns at [21:30]')
[0m18:22:26.815804 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:923e7a6a-a247-4728-98ed-631245d358e9&page=queryresults
[0m18:22:26.973643 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:923e7a6a-a247-4728-98ed-631245d358e9&page=queryresults
[0m18:22:26.978574 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (execute): 18:22:25.284513 => 18:22:26.976574
[0m18:22:26.993560 [debug] [Thread-2 (]: Database Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  Name campaign_id not found inside _raw_unique_campaigns at [21:30]
  compiled Code at target\run\bq_evo\models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql
[0m18:22:26.995521 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20f51f35-ae9d-47e1-a4e8-0655e43db67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218C458350>]}
[0m18:22:26.996519 [error] [Thread-2 (]: 4 of 5 ERROR creating sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [[31mERROR[0m in 1.72s]
[0m18:22:26.998515 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:22:26.999512 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:22:27.000544 [info ] [Thread-1 (]: 5 of 5 SKIP relation mart.mrt_linkedin_basic_campaign_stats .................... [[33mSKIP[0m]
[0m18:22:27.001435 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:22:27.004103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:22:27.005133 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:22:27.006096 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:22:27.006096 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:22:27.006096 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:22:27.007094 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m18:22:27.007094 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m18:22:27.008091 [debug] [MainThread]: Connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign' was properly closed.
[0m18:22:27.008091 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names' was properly closed.
[0m18:22:27.009088 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information' was properly closed.
[0m18:22:27.009088 [info ] [MainThread]: 
[0m18:22:27.010086 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 6.90 seconds (6.90s).
[0m18:22:27.013078 [debug] [MainThread]: Command end result
[0m18:22:27.026546 [info ] [MainThread]: 
[0m18:22:27.028559 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:22:27.029539 [info ] [MainThread]: 
[0m18:22:27.030535 [error] [MainThread]:   Database Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  Name campaign_id not found inside _raw_unique_campaigns at [21:30]
  compiled Code at target\run\bq_evo\models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql
[0m18:22:27.032529 [info ] [MainThread]: 
[0m18:22:27.034523 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m18:22:27.036519 [debug] [MainThread]: Command `dbt run` failed at 18:22:27.035521 after 7.53 seconds
[0m18:22:27.036519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218AE5BC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022184C8C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002218A81AC90>]}
[0m18:22:27.037584 [debug] [MainThread]: Flushing usage events
[0m18:23:55.661967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D6F17CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D7069590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D7088DD0>]}


============================== 18:23:55.665858 | cc65b256-2799-443c-a5e4-438ea3de0011 ==============================
[0m18:23:55.665858 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:23:55.666858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m *linkedin*', 'send_anonymous_usage_stats': 'True'}
[0m18:23:56.037285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc65b256-2799-443c-a5e4-438ea3de0011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D85BDB90>]}
[0m18:23:56.046261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc65b256-2799-443c-a5e4-438ea3de0011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D8A1B710>]}
[0m18:23:56.047260 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:23:56.096166 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:23:56.201438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:23:56.202404 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\linkedin\int_linkedin_unique_campaigns_reduced_information.sql
[0m18:23:56.202404 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\meta\int_meta_unique_campaigns.sql
[0m18:23:56.261794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc65b256-2799-443c-a5e4-438ea3de0011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D8E59A90>]}
[0m18:23:56.283509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc65b256-2799-443c-a5e4-438ea3de0011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D8F06250>]}
[0m18:23:56.283509 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:23:56.284585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc65b256-2799-443c-a5e4-438ea3de0011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D5716D50>]}
[0m18:23:56.288579 [info ] [MainThread]: 
[0m18:23:56.291005 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:23:56.292082 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:23:56.293299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:56.294595 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:23:56.295182 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:23:56.296184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:56.297181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:58.966453 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m18:23:58.967451 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:23:58.967451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:58.968448 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m18:23:58.969445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:58.971440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:59.622329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc65b256-2799-443c-a5e4-438ea3de0011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D8B32410>]}
[0m18:23:59.623326 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:23:59.624324 [info ] [MainThread]: 
[0m18:23:59.628996 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:23:59.628996 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_linkedin_campaign_history
[0m18:23:59.630146 [info ] [Thread-1 (]: 1 of 5 START sql view model staging.stg_linkedin_ad_analytics_by_campaign ...... [RUN]
[0m18:23:59.631150 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign'
[0m18:23:59.630146 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_linkedin_campaign_history .............. [RUN]
[0m18:23:59.632146 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:23:59.633142 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_campaign_history'
[0m18:23:59.643117 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:23:59.643117 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_linkedin_campaign_history
[0m18:23:59.648134 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:23:59.649099 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (compile): 18:23:59.634173 => 18:23:59.648134
[0m18:23:59.649099 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:23:59.650097 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (compile): 18:23:59.645111 => 18:23:59.650097
[0m18:23:59.682010 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:23:59.682823 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_linkedin_campaign_history
[0m18:23:59.686815 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:23:59.686815 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:23:59.687814 [debug] [Thread-1 (]: On model.bq_evo.stg_linkedin_ad_analytics_by_campaign: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Linkedin-Kampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS (
    SELECT *    
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`ad_analytics_by_campaign`
),

_renamed_columns AS (
    SELECT
        campaign_id,
        day as Date,
        _fivetran_synced,
        action_clicks,
        ad_unit_clicks,
        approximate_unique_impressions,
        card_clicks,
        card_impressions,
        clicks as Clicks,
        comment_likes,
        comments,
        company_page_clicks,
        conversion_value_in_local_currency,
        cost_in_local_currency as Cost,
        cost_in_usd,
        external_website_conversions,
        external_website_post_click_conversions,
        external_website_post_view_conversions,
        follows,
        full_screen_plays,
        impressions as Impressions,
        landing_page_clicks,
        lead_generation_mail_contact_info_shares,
        lead_generation_mail_interested_clicks,
        likes,
        one_click_lead_form_opens,
        one_click_leads,
        opens,
        other_engagements,
        sends,
        shares,
        text_url_clicks,
        total_engagements,
        video_completions,
        video_first_quartile_completions,
        video_midpoint_completions,
        video_starts,
        video_third_quartile_completions,
        video_views,
        viral_card_clicks,
        viral_card_impressions,
        viral_clicks,
        viral_comment_likes,
        viral_comments,
        viral_company_page_clicks,
        viral_external_website_conversions,
        viral_external_website_post_click_conversions,
        viral_external_website_post_view_conversions,
        viral_follows,
        viral_full_screen_plays,
        viral_impressions,
        viral_landing_page_clicks,
        viral_likes,
        viral_one_click_lead_form_opens,
        viral_one_click_leads,
        viral_other_engagements,
        viral_shares,
        viral_total_engagements,
        viral_video_completions,
        viral_video_first_quartile_completions,
        viral_video_midpoint_completions,
        viral_video_starts,
        viral_video_third_quartile_completions,
        viral_video_views
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:23:59.689808 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:23:59.692800 [debug] [Thread-2 (]: On model.bq_evo.stg_linkedin_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`campaign_history`
),

_renamed_columns AS(
    SELECT
        id,
        last_modified_time,
        _fivetran_synced,
        account_id,
        associated_entity,
        audience_expansion_enabled,
        campaign_group_id,
        cost_type,
        created_time,
        creative_selection,
        daily_budget_amount,
        daily_budget_currency_code,
        format,
        locale_country,
        locale_language,
        name as Campaign,
        objective_type,
        offsite_delivery_enabled,
        optimization_target_type,
        run_schedule_end,
        run_schedule_start,
        status,
        type,
        unit_cost_amount,
        unit_cost_currency_code,
        version_tag
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:24:00.400202 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:f8c5f191-e3bd-4cb2-9c6c-ec8b76247f78&page=queryresults
[0m18:24:00.401237 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:cd8c26f9-6ca1-44b3-b131-fc188c20910e&page=queryresults
[0m18:24:00.838573 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (execute): 18:23:59.683823 => 18:24:00.838573
[0m18:24:00.841598 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (execute): 18:23:59.650097 => 18:24:00.841598
[0m18:24:00.842562 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc65b256-2799-443c-a5e4-438ea3de0011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D6F15C90>]}
[0m18:24:00.843424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc65b256-2799-443c-a5e4-438ea3de0011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D8F77590>]}
[0m18:24:00.844425 [info ] [Thread-2 (]: 2 of 5 OK created sql view model staging.stg_linkedin_campaign_history ......... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m18:24:00.846420 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_linkedin_campaign_history
[0m18:24:00.845423 [info ] [Thread-1 (]: 1 of 5 OK created sql view model staging.stg_linkedin_ad_analytics_by_campaign . [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m18:24:00.847704 [debug] [Thread-4 (]: Began running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:24:00.848758 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:24:00.849418 [info ] [Thread-4 (]: 3 of 5 START sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [RUN]
[0m18:24:00.850926 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information'
[0m18:24:00.851998 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:24:00.855028 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:24:00.856025 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (compile): 18:24:00.851998 => 18:24:00.856025
[0m18:24:00.856987 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:24:00.860014 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:24:00.861011 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:24:00.861974 [debug] [Thread-4 (]: On model.bq_evo.int_linkedin_unique_campaigns_reduced_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Linkedin-Kampagnen - gg\u00fc. Quelldaten nur ausgew\u00e4hlte Spalten f\u00fcr Weiterverarbeitung NDG."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
),

_selected_columns AS (
    SELECT
        id as campaign_id,
        Campaign, 
        "EVO" as Partner, 
        "cpc" as Medium, 
        "linkedin" as Source, 
        LOWER(CONCAT(Campaign, "linkedin", "cpc", "EVO")) AS CampaignID 
    
    FROM _raw
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _selected_columns
)

SELECT * FROM _final;


[0m18:24:01.481781 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:42da6ec8-1c4c-45ee-8f8a-7147d86304ef&page=queryresults
[0m18:24:01.893602 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (execute): 18:24:00.856987 => 18:24:01.893602
[0m18:24:01.895596 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc65b256-2799-443c-a5e4-438ea3de0011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D8EED190>]}
[0m18:24:01.897589 [info ] [Thread-4 (]: 3 of 5 OK created sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m18:24:01.899584 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:24:01.900584 [debug] [Thread-2 (]: Began running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:24:01.901581 [info ] [Thread-2 (]: 4 of 5 START sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [RUN]
[0m18:24:01.903577 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_linkedin_campaign_history, now model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names)
[0m18:24:01.904599 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:24:01.909562 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:24:01.910591 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (compile): 18:24:01.905572 => 18:24:01.910591
[0m18:24:01.911555 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:24:01.915056 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:24:01.916090 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:24:01.917055 [debug] [Thread-2 (]: On model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.campaign_id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m18:24:02.645328 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5aec0663-47ac-455a-b67f-39152f572538&page=queryresults
[0m18:24:02.796445 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW has columns with duplicate name campaign_id at [8:6]')
[0m18:24:03.259168 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e8eeb8e2-8a4b-4111-aeea-160bb2e474b4&page=queryresults
[0m18:24:03.417648 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e8eeb8e2-8a4b-4111-aeea-160bb2e474b4&page=queryresults
[0m18:24:03.419155 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (execute): 18:24:01.912553 => 18:24:03.419155
[0m18:24:03.425181 [debug] [Thread-2 (]: Database Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  CREATE VIEW has columns with duplicate name campaign_id at [8:6]
  compiled Code at target\run\bq_evo\models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql
[0m18:24:03.426172 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc65b256-2799-443c-a5e4-438ea3de0011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D9193110>]}
[0m18:24:03.427195 [error] [Thread-2 (]: 4 of 5 ERROR creating sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [[31mERROR[0m in 1.52s]
[0m18:24:03.428134 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:24:03.430129 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:24:03.431126 [info ] [Thread-1 (]: 5 of 5 SKIP relation mart.mrt_linkedin_basic_campaign_stats .................... [[33mSKIP[0m]
[0m18:24:03.432123 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:24:03.434120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:03.435117 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:24:03.435117 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:24:03.436114 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:24:03.436114 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m18:24:03.437109 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:24:03.437109 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m18:24:03.438107 [debug] [MainThread]: Connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign' was properly closed.
[0m18:24:03.438107 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names' was properly closed.
[0m18:24:03.439219 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information' was properly closed.
[0m18:24:03.439219 [info ] [MainThread]: 
[0m18:24:03.440219 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 7.15 seconds (7.15s).
[0m18:24:03.442214 [debug] [MainThread]: Command end result
[0m18:24:03.456178 [info ] [MainThread]: 
[0m18:24:03.457176 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:24:03.458171 [info ] [MainThread]: 
[0m18:24:03.459169 [error] [MainThread]:   Database Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  CREATE VIEW has columns with duplicate name campaign_id at [8:6]
  compiled Code at target\run\bq_evo\models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql
[0m18:24:03.461165 [info ] [MainThread]: 
[0m18:24:03.462161 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m18:24:03.463193 [debug] [MainThread]: Command `dbt run` failed at 18:24:03.462161 after 7.82 seconds
[0m18:24:03.463193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D7539F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D7B5BB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D75A4150>]}
[0m18:24:03.464158 [debug] [MainThread]: Flushing usage events
[0m18:26:35.468420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784498C790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027844E9F690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027844BE3210>]}


============================== 18:26:35.474113 | 596a09a5-2411-4ee1-ac62-5ab531803885 ==============================
[0m18:26:35.474113 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:26:35.475074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m *linkedin*', 'send_anonymous_usage_stats': 'True'}
[0m18:26:35.822038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '596a09a5-2411-4ee1-ac62-5ab531803885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278460D9B50>]}
[0m18:26:35.831017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '596a09a5-2411-4ee1-ac62-5ab531803885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027846073710>]}
[0m18:26:35.832012 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:26:35.886460 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:26:35.984809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:35.985772 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql
[0m18:26:36.034678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '596a09a5-2411-4ee1-ac62-5ab531803885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027846432550>]}
[0m18:26:36.052630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '596a09a5-2411-4ee1-ac62-5ab531803885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027843C0D550>]}
[0m18:26:36.053627 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:26:36.054625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '596a09a5-2411-4ee1-ac62-5ab531803885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278461DF010>]}
[0m18:26:36.056652 [info ] [MainThread]: 
[0m18:26:36.057434 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:26:36.059467 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:26:36.059467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:36.060464 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:26:36.061971 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:26:36.061971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:36.063009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:38.743405 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m18:26:38.744407 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m18:26:38.745714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:38.746724 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:26:38.747988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:38.751072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:39.406618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '596a09a5-2411-4ee1-ac62-5ab531803885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278461DF010>]}
[0m18:26:39.407652 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:26:39.408612 [info ] [MainThread]: 
[0m18:26:39.412601 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:26:39.412601 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_linkedin_campaign_history
[0m18:26:39.413598 [info ] [Thread-1 (]: 1 of 5 START sql view model staging.stg_linkedin_ad_analytics_by_campaign ...... [RUN]
[0m18:26:39.414596 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_linkedin_campaign_history .............. [RUN]
[0m18:26:39.415594 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign'
[0m18:26:39.416591 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_campaign_history'
[0m18:26:39.417623 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:26:39.418616 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_linkedin_campaign_history
[0m18:26:39.426598 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:26:39.429556 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:26:39.431551 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (compile): 18:26:39.419584 => 18:26:39.431551
[0m18:26:39.432548 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (compile): 18:26:39.427561 => 18:26:39.432548
[0m18:26:39.433549 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:26:39.434543 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_linkedin_campaign_history
[0m18:26:39.465498 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:26:39.469004 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:26:39.470001 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:26:39.470999 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:26:39.471997 [debug] [Thread-1 (]: On model.bq_evo.stg_linkedin_ad_analytics_by_campaign: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Linkedin-Kampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS (
    SELECT *    
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`ad_analytics_by_campaign`
),

_renamed_columns AS (
    SELECT
        campaign_id,
        day as Date,
        _fivetran_synced,
        action_clicks,
        ad_unit_clicks,
        approximate_unique_impressions,
        card_clicks,
        card_impressions,
        clicks as Clicks,
        comment_likes,
        comments,
        company_page_clicks,
        conversion_value_in_local_currency,
        cost_in_local_currency as Cost,
        cost_in_usd,
        external_website_conversions,
        external_website_post_click_conversions,
        external_website_post_view_conversions,
        follows,
        full_screen_plays,
        impressions as Impressions,
        landing_page_clicks,
        lead_generation_mail_contact_info_shares,
        lead_generation_mail_interested_clicks,
        likes,
        one_click_lead_form_opens,
        one_click_leads,
        opens,
        other_engagements,
        sends,
        shares,
        text_url_clicks,
        total_engagements,
        video_completions,
        video_first_quartile_completions,
        video_midpoint_completions,
        video_starts,
        video_third_quartile_completions,
        video_views,
        viral_card_clicks,
        viral_card_impressions,
        viral_clicks,
        viral_comment_likes,
        viral_comments,
        viral_company_page_clicks,
        viral_external_website_conversions,
        viral_external_website_post_click_conversions,
        viral_external_website_post_view_conversions,
        viral_follows,
        viral_full_screen_plays,
        viral_impressions,
        viral_landing_page_clicks,
        viral_likes,
        viral_one_click_lead_form_opens,
        viral_one_click_leads,
        viral_other_engagements,
        viral_shares,
        viral_total_engagements,
        viral_video_completions,
        viral_video_first_quartile_completions,
        viral_video_midpoint_completions,
        viral_video_starts,
        viral_video_third_quartile_completions,
        viral_video_views
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:26:39.472993 [debug] [Thread-2 (]: On model.bq_evo.stg_linkedin_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`campaign_history`
),

_renamed_columns AS(
    SELECT
        id,
        last_modified_time,
        _fivetran_synced,
        account_id,
        associated_entity,
        audience_expansion_enabled,
        campaign_group_id,
        cost_type,
        created_time,
        creative_selection,
        daily_budget_amount,
        daily_budget_currency_code,
        format,
        locale_country,
        locale_language,
        name as Campaign,
        objective_type,
        offsite_delivery_enabled,
        optimization_target_type,
        run_schedule_end,
        run_schedule_start,
        status,
        type,
        unit_cost_amount,
        unit_cost_currency_code,
        version_tag
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:26:40.231782 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ea343d7e-08d8-4311-9b4d-7b990a490a0b&page=queryresults
[0m18:26:40.240483 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ca18234d-3163-4bd1-836b-208d3cf59466&page=queryresults
[0m18:26:40.425552 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (execute): 18:26:39.435542 => 18:26:40.425552
[0m18:26:40.428579 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (execute): 18:26:39.465498 => 18:26:40.428579
[0m18:26:40.429576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596a09a5-2411-4ee1-ac62-5ab531803885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278469A0110>]}
[0m18:26:40.430539 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596a09a5-2411-4ee1-ac62-5ab531803885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784655FF90>]}
[0m18:26:40.431537 [info ] [Thread-1 (]: 1 of 5 OK created sql view model staging.stg_linkedin_ad_analytics_by_campaign . [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m18:26:40.433533 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:26:40.431537 [info ] [Thread-2 (]: 2 of 5 OK created sql view model staging.stg_linkedin_campaign_history ......... [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m18:26:40.434529 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_linkedin_campaign_history
[0m18:26:40.435525 [debug] [Thread-4 (]: Began running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:26:40.436550 [info ] [Thread-4 (]: 3 of 5 START sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [RUN]
[0m18:26:40.438535 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information'
[0m18:26:40.438535 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:26:40.441511 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:26:40.443504 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (compile): 18:26:40.439516 => 18:26:40.442507
[0m18:26:40.444503 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:26:40.448526 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:26:40.450488 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:26:40.451485 [debug] [Thread-4 (]: On model.bq_evo.int_linkedin_unique_campaigns_reduced_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Linkedin-Kampagnen - gg\u00fc. Quelldaten nur ausgew\u00e4hlte Spalten f\u00fcr Weiterverarbeitung NDG."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
),

_selected_columns AS (
    SELECT
        id as campaign_id,
        Campaign, 
        "EVO" as Partner, 
        "cpc" as Medium, 
        "linkedin" as Source, 
        LOWER(CONCAT(Campaign, "linkedin", "cpc", "EVO")) AS CampaignID 
    
    FROM _raw
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _selected_columns
)

SELECT * FROM _final;


[0m18:26:41.124384 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:fc5fd144-b746-458b-8e70-f3c53f940242&page=queryresults
[0m18:26:41.300518 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (execute): 18:26:40.444503 => 18:26:41.300518
[0m18:26:41.302478 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596a09a5-2411-4ee1-ac62-5ab531803885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784698A590>]}
[0m18:26:41.302478 [info ] [Thread-4 (]: 3 of 5 OK created sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m18:26:41.303509 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:26:41.305469 [debug] [Thread-1 (]: Began running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:26:41.305469 [info ] [Thread-1 (]: 4 of 5 START sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [RUN]
[0m18:26:41.306954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_linkedin_ad_analytics_by_campaign, now model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names)
[0m18:26:41.307791 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:26:41.310819 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:26:41.311818 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (compile): 18:26:41.307791 => 18:26:41.311818
[0m18:26:41.312781 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:26:41.317769 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:26:41.319764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:41.320761 [debug] [Thread-1 (]: On model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.campaign_id = _raw_performance.campaign_id
),

_final AS(
    SELECT * EXCEPT (campaign_id)
    FROM _joined
)

SELECT * FROM _final;


[0m18:26:42.002057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e0e18d5e-458f-4d17-bbb3-1c1876d91e7f&page=queryresults
[0m18:26:42.183734 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (execute): 18:26:41.313778 => 18:26:42.183734
[0m18:26:42.185698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596a09a5-2411-4ee1-ac62-5ab531803885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278469B15D0>]}
[0m18:26:42.186695 [info ] [Thread-1 (]: 4 of 5 OK created sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m18:26:42.188688 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:26:42.189685 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:26:42.190714 [info ] [Thread-3 (]: 5 of 5 START sql incremental model mart.mrt_linkedin_basic_campaign_stats ...... [RUN]
[0m18:26:42.191680 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_linkedin_basic_campaign_stats'
[0m18:26:42.192710 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:26:42.203647 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_linkedin_basic_campaign_stats"
[0m18:26:42.206657 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (compile): 18:26:42.193706 => 18:26:42.205642
[0m18:26:42.207641 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:26:42.265518 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_linkedin_basic_campaign_stats"
[0m18:26:42.266515 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:26:42.267484 [debug] [Thread-3 (]: On model.bq_evo.mrt_linkedin_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_linkedin_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der LinkedinKampagnen."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`

    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:26:43.050768 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:44146081-9792-4d55-bdc8-03f0daaf8014&page=queryresults
[0m18:26:44.991501 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (execute): 18:26:42.207641 => 18:26:44.991501
[0m18:26:44.993505 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596a09a5-2411-4ee1-ac62-5ab531803885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027846861910>]}
[0m18:26:44.993505 [info ] [Thread-3 (]: 5 of 5 OK created sql incremental model mart.mrt_linkedin_basic_campaign_stats . [[32mCREATE TABLE (318.0 rows, 20.1 KiB processed)[0m in 2.80s]
[0m18:26:44.995491 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:26:44.997485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:44.998483 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:26:44.998483 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:26:44.999480 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:26:44.999480 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m18:26:45.000502 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m18:26:45.000502 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:26:45.001475 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names' was properly closed.
[0m18:26:45.002472 [debug] [MainThread]: Connection 'model.bq_evo.stg_linkedin_campaign_history' was properly closed.
[0m18:26:45.002472 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information' was properly closed.
[0m18:26:45.003470 [debug] [MainThread]: Connection 'model.bq_evo.mrt_linkedin_basic_campaign_stats' was properly closed.
[0m18:26:45.004467 [info ] [MainThread]: 
[0m18:26:45.005465 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 8.95 seconds (8.95s).
[0m18:26:45.007459 [debug] [MainThread]: Command end result
[0m18:26:45.019427 [info ] [MainThread]: 
[0m18:26:45.021422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:26:45.022419 [info ] [MainThread]: 
[0m18:26:45.022419 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:26:45.024414 [debug] [MainThread]: Command `dbt run` succeeded at 18:26:45.024414 after 9.57 seconds
[0m18:26:45.025412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027844E9F290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002783F227150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002783F26FB90>]}
[0m18:26:45.025412 [debug] [MainThread]: Flushing usage events
[0m18:31:30.172983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7F675CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7F01CED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7ED4BB90>]}


============================== 18:31:30.176971 | d0aa1782-cb7b-4408-8fc2-aaee1210ac29 ==============================
[0m18:31:30.176971 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:31:30.178656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:31:30.523196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0aa1782-cb7b-4408-8fc2-aaee1210ac29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A000BE290>]}
[0m18:31:30.532167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0aa1782-cb7b-4408-8fc2-aaee1210ac29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A0006CE90>]}
[0m18:31:30.533167 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:31:30.587605 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:31:30.691926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:31:30.691926 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:31:30.699908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0aa1782-cb7b-4408-8fc2-aaee1210ac29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A00036A90>]}
[0m18:31:30.718821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0aa1782-cb7b-4408-8fc2-aaee1210ac29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A00795B10>]}
[0m18:31:30.718821 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:31:30.719818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0aa1782-cb7b-4408-8fc2-aaee1210ac29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A001DD8D0>]}
[0m18:31:30.722833 [info ] [MainThread]: 
[0m18:31:30.723807 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:31:30.725827 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:31:30.725827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:32.946889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_oss-big-query-dashboard-prod, now create_oss-big-query-dashboard-prod_mart)
[0m18:31:32.947886 [debug] [ThreadPool]: Creating schema "database: "oss-big-query-dashboard-prod"
schema: "mart"
"
[0m18:31:32.956909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:32.956909 [debug] [ThreadPool]: On create_oss-big-query-dashboard-prod_mart: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "connection_name": "create_oss-big-query-dashboard-prod_mart"} */
create schema if not exists `oss-big-query-dashboard-prod`.`mart`
  
[0m18:31:33.549960 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e20e5c6e-7dd9-4ee4-a685-63819636a053&page=queryresults
[0m18:31:35.625547 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m18:31:35.625547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:35.626544 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m18:31:35.627583 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:31:35.629536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:35.630535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:36.313484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0aa1782-cb7b-4408-8fc2-aaee1210ac29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7F755D90>]}
[0m18:31:36.315479 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:31:36.316476 [info ] [MainThread]: 
[0m18:31:36.322498 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m18:31:36.323495 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m18:31:36.323495 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m18:31:36.324491 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m18:31:36.324491 [info ] [Thread-1 (]: 1 of 8 START sql incremental model mart.mrt_bing_ads_basic_campaign_stats ...... [RUN]
[0m18:31:36.325490 [info ] [Thread-2 (]: 2 of 8 START sql incremental model mart.mrt_google_ads_basic_campaign_stats .... [RUN]
[0m18:31:36.327520 [info ] [Thread-3 (]: 3 of 8 START sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [RUN]
[0m18:31:36.329504 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_bing_ads_basic_campaign_stats'
[0m18:31:36.328481 [info ] [Thread-4 (]: 4 of 8 START sql incremental model mart.mrt_google_analytics_campaign_webperformance  [RUN]
[0m18:31:36.330476 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_ads_basic_campaign_stats'
[0m18:31:36.331498 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized'
[0m18:31:36.331498 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m18:31:36.333490 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance'
[0m18:31:36.335463 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m18:31:36.335463 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m18:31:36.347430 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m18:31:36.348427 [debug] [Thread-4 (]: Began compiling node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m18:31:36.353448 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m18:31:36.360456 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m18:31:36.366417 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m18:31:36.367416 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (compile): 18:31:36.336461 => 18:31:36.366417
[0m18:31:36.368413 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (compile): 18:31:36.349440 => 18:31:36.368413
[0m18:31:36.370408 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (compile): 18:31:36.353448 => 18:31:36.369413
[0m18:31:36.370408 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m18:31:36.371917 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (compile): 18:31:36.361430 => 18:31:36.371917
[0m18:31:36.372919 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m18:31:36.373916 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m18:31:36.435785 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m18:31:36.436782 [debug] [Thread-4 (]: Began executing node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m18:31:36.440737 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m18:31:36.445063 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m18:31:36.448432 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m18:31:36.449488 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:36.450493 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:31:36.451855 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:31:36.452852 [debug] [Thread-1 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
 
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:31:36.452852 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:31:36.454152 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

    
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:31:36.454152 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Conversiondaten bis einschl. 04.06.2023 aus Unisversal Analytics, alle Conversions ab 05.06.2023 aus Google Analytics 4."""
    )
    as (
      WITH ga4_conversions AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
    WHERE 
        Date > '2023-06-04'
),

ua_conversions AS(
    SELECT
        Date,
        NameZielvorhaben as ZielvorhabenName,
        LOWER(CONCAT(NameZielvorhaben, Partner)) as ZielvorhabenID,
        CampaignID,
        Source,
        Medium,
        Partner,
        Keyword,
        KeywordMatchType,
        Conversions
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_goal_conversions`
    WHERE Date <= '2023-06-04'
),

_merged_step1 AS(
    SELECT * FROM ga4_conversions
    UNION ALL
    SELECT * FROM ua_conversions
),

_final AS(
    SELECT *
    FROM _merged_step1
)

SELECT * FROM _final
    );
  
[0m18:31:36.457676 [debug] [Thread-4 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt grundlegende Web-Performancewerte aller \u00fcber GA4 erfassten Kampagnen."""
    )
    as (
      

WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`

    
),

sessions_by_campaign AS(
  SELECT
    event_date as Date,
    CampaignID,

    COUNT(DISTINCT(CONCAT(user_pseudo_id,session_id))) as Sessions,
    COUNT(DISTINCT 
      CASE 
        WHEN session_engaged = '1' THEN CONCAT(user_pseudo_id,session_id) 
      END) as Sessions_Engaged,
    MAX(Medium) as Medium,
    MAX(Source) as Source,
    MAX(Partner) as Partner,

  FROM _raw
  GROUP BY 1,2
),

_add_engagement_rate AS(
    SELECT 
        Date,
        CampaignID,
        Sessions,
        Sessions_Engaged,
        (CASE
            WHEN Sessions > 0 THEN (Sessions_Engaged / Sessions) 
            ELSE 0
        END) as Engagement_Rate,
        Medium,
        Source,
        Partner
    FROM sessions_by_campaign
),

_added_columns AS(
    SELECT
        *,
        '(not set)' as Keyword,
        '(not set)' as KeywordMatchType
    FROM _add_engagement_rate
),

_final AS(
    SELECT *
    FROM _added_columns
)

SELECT * FROM _final
    );
  
[0m18:31:37.340601 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8ae8840f-9e7d-4e9f-bcb9-ee63b338c5a4&page=queryresults
[0m18:31:37.341596 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:444f4639-0b96-442f-b774-571994f3a209&page=queryresults
[0m18:31:37.364320 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c6467aed-fa44-43b6-888c-16d2db4d0ad7&page=queryresults
[0m18:31:37.410756 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:44c86c11-db92-40a5-9cd7-c27a2e90dea0&page=queryresults
[0m18:31:39.548797 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (execute): 18:31:36.374914 => 18:31:39.547802
[0m18:31:39.550733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0aa1782-cb7b-4408-8fc2-aaee1210ac29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A00741650>]}
[0m18:31:39.550733 [info ] [Thread-1 (]: 1 of 8 OK created sql incremental model mart.mrt_bing_ads_basic_campaign_stats . [[32mCREATE TABLE (3.2k rows, 957.9 KiB processed)[0m in 3.22s]
[0m18:31:39.552728 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m18:31:39.552728 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m18:31:39.554361 [info ] [Thread-1 (]: 5 of 8 START sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [RUN]
[0m18:31:39.555361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_bing_ads_basic_campaign_stats, now model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized)
[0m18:31:39.556358 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m18:31:39.559385 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m18:31:39.560388 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (compile): 18:31:39.556358 => 18:31:39.560388
[0m18:31:39.561346 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m18:31:39.569370 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m18:31:39.571331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:39.572329 [debug] [Thread-1 (]: On model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_merged_ua_ga4_transactions_summarized`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle aggregierten Transaktionen bis einschl. 04.06.2023 aus Unisversal Analytics, alle Conversions ab 05.06.2023 aus Google Analytics 4. Enth\u00e4lt keine Detailinformationen je Transaktion."""
    )
    as (
      WITH _raw AS(
  SELECT 
    event_date as Date,
    Campaign,
    Medium,
    Source,
    item_category as ProductCategory,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  WHERE 
    transaction_id NOT LIKE 'TEST%'
),

_aggregation_on_day AS(
  SELECT
    Date,
    Campaign,
    Medium,
    Source,
    ProductCategory,
    count(Date) as Transactions,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    MAX(Partner) as Partner,
    CampaignID
  FROM _raw
  WHERE Date >= '2023-06-05'
  GROUP BY 1,2,3,4,5,10
),

evo_ecommerce_ua AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_transactions`
  WHERE Date < '2023-06-05'
),

_merged_step1 AS(
  SELECT * FROM _aggregation_on_day
  UNION ALL
  SELECT * FROM evo_ecommerce_ua
),

_final AS(
  SELECT * FROM _merged_step1
)

SELECT * FROM _final
    );
  
[0m18:31:40.173698 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (execute): 18:31:36.437745 => 18:31:40.172701
[0m18:31:40.175689 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0aa1782-cb7b-4408-8fc2-aaee1210ac29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A00750790>]}
[0m18:31:40.176686 [info ] [Thread-2 (]: 2 of 8 OK created sql incremental model mart.mrt_google_ads_basic_campaign_stats  [[32mCREATE TABLE (87.8k rows, 10.2 MiB processed)[0m in 3.85s]
[0m18:31:40.177686 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m18:31:40.177686 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:31:40.179195 [info ] [Thread-2 (]: 6 of 8 START sql incremental model mart.mrt_linkedin_basic_campaign_stats ...... [RUN]
[0m18:31:40.180195 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_google_ads_basic_campaign_stats, now model.bq_evo.mrt_linkedin_basic_campaign_stats)
[0m18:31:40.181207 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:31:40.184216 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_linkedin_basic_campaign_stats"
[0m18:31:40.186181 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (compile): 18:31:40.181207 => 18:31:40.185214
[0m18:31:40.187179 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:31:40.192198 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_linkedin_basic_campaign_stats"
[0m18:31:40.194160 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:31:40.194160 [debug] [Thread-2 (]: On model.bq_evo.mrt_linkedin_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_linkedin_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der LinkedinKampagnen."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`

    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:31:40.347024 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4454b149-0822-46a0-ba5b-a60e70888c8f&page=queryresults
[0m18:31:40.960152 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5a9bdf08-8d1d-4841-b498-8191c5eb6fa9&page=queryresults
[0m18:31:43.251018 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (execute): 18:31:40.188175 => 18:31:43.250018
[0m18:31:43.254005 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0aa1782-cb7b-4408-8fc2-aaee1210ac29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A00BCFA90>]}
[0m18:31:43.256950 [info ] [Thread-2 (]: 6 of 8 OK created sql incremental model mart.mrt_linkedin_basic_campaign_stats . [[32mCREATE TABLE (318.0 rows, 20.1 KiB processed)[0m in 3.07s]
[0m18:31:43.259979 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:31:43.261978 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m18:31:43.262962 [info ] [Thread-2 (]: 7 of 8 START sql incremental model mart.mrt_meta_basic_campaign_stats .......... [RUN]
[0m18:31:43.264929 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_linkedin_basic_campaign_stats, now model.bq_evo.mrt_meta_basic_campaign_stats)
[0m18:31:43.265964 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_meta_basic_campaign_stats
[0m18:31:43.271949 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_meta_basic_campaign_stats"
[0m18:31:43.272947 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_meta_basic_campaign_stats (compile): 18:31:43.266922 => 18:31:43.272947
[0m18:31:43.273942 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_meta_basic_campaign_stats
[0m18:31:43.277931 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_meta_basic_campaign_stats"
[0m18:31:43.279926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:31:43.279926 [debug] [Thread-2 (]: On model.bq_evo.mrt_meta_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_meta_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_meta_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der Metakampagnen."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_campaign_stats_joined_campaign_names`

    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,   
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:31:43.868207 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4afd7a61-ed94-4ee3-bbf9-b490f3486c28&page=queryresults
[0m18:31:43.871203 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_meta_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_meta_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der Metakampagnen."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_campaign_stats_joined_campaign_names`

    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,   
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:31:43.871203 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_campaign_stats_joined_campaign_names was not found in location europe-west3

Location: europe-west3
Job ID: 4afd7a61-ed94-4ee3-bbf9-b490f3486c28

[0m18:31:43.872202 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_meta_basic_campaign_stats (execute): 18:31:43.274951 => 18:31:43.872202
[0m18:31:43.879216 [debug] [Thread-2 (]: Runtime Error in model mrt_meta_basic_campaign_stats (models\mart\single_source_data\meta\mrt_meta_basic_campaign_stats.sql)
  404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_campaign_stats_joined_campaign_names was not found in location europe-west3
  
  Location: europe-west3
  Job ID: 4afd7a61-ed94-4ee3-bbf9-b490f3486c28
  
[0m18:31:43.880217 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0aa1782-cb7b-4408-8fc2-aaee1210ac29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A00BB7A90>]}
[0m18:31:43.881178 [error] [Thread-2 (]: 7 of 8 ERROR creating sql incremental model mart.mrt_meta_basic_campaign_stats . [[31mERROR[0m in 0.62s]
[0m18:31:43.882173 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m18:31:43.882173 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_metainformation_campaigns
[0m18:31:43.883173 [info ] [Thread-2 (]: 8 of 8 START sql table model mart.mrt_metainformation_campaigns ................ [RUN]
[0m18:31:43.884170 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_meta_basic_campaign_stats, now model.bq_evo.mrt_metainformation_campaigns)
[0m18:31:43.884170 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_metainformation_campaigns
[0m18:31:43.888707 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_metainformation_campaigns"
[0m18:31:43.889679 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (compile): 18:31:43.885679 => 18:31:43.889679
[0m18:31:43.890681 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_metainformation_campaigns
[0m18:31:43.902636 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_metainformation_campaigns"
[0m18:31:43.904634 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:31:43.905630 [debug] [Thread-2 (]: On model.bq_evo.mrt_metainformation_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_metainformation_campaigns"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_metainformation_campaigns`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt Kampagnen aus allen Quelldatensystemen mit Metainformationen."""
    )
    as (
      

WITH _googleads_campaigns AS(
    SELECT
        campaign as Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_google_analytics_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        CASE
            WHEN Medium IN ('cpc', 'ppc','cpa', 'cpm', 'cpv', 'cpp') THEN 'true' 
            ELSE 'false'
        END as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
),

_bingads_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_merged_googleads_and_analytics AS(
    SELECT * FROM _googleads_campaigns
    UNION ALL
    SELECT * FROM _google_analytics_campaigns
),

_merged_bingads AS(
    SELECT * FROM _merged_googleads_and_analytics
    UNION ALL
    SELECT * FROM _bingads_campaigns    
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _merged_bingads
)

SELECT * FROM _final
    );
  
[0m18:31:44.734159 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:bd3d3ede-8220-4e4b-ba11-4fbf7a91e9bf&page=queryresults
[0m18:31:44.818902 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (execute): 18:31:36.441563 => 18:31:44.817906
[0m18:31:44.822898 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0aa1782-cb7b-4408-8fc2-aaee1210ac29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A007854D0>]}
[0m18:31:44.824883 [info ] [Thread-3 (]: 3 of 8 OK created sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [[32mCREATE TABLE (25.0k rows, 714.8 MiB processed)[0m in 8.49s]
[0m18:31:44.826880 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m18:31:46.781749 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (execute): 18:31:36.445395 => 18:31:46.781749
[0m18:31:46.782751 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0aa1782-cb7b-4408-8fc2-aaee1210ac29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A00C26C10>]}
[0m18:31:46.783738 [info ] [Thread-4 (]: 4 of 8 OK created sql incremental model mart.mrt_google_analytics_campaign_webperformance  [[32mCREATE TABLE (11.2k rows, 1.2 GiB processed)[0m in 10.45s]
[0m18:31:46.784323 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m18:31:47.829070 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (execute): 18:31:39.562349 => 18:31:47.828080
[0m18:31:47.830064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0aa1782-cb7b-4408-8fc2-aaee1210ac29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7EB886D0>]}
[0m18:31:47.831044 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [[32mCREATE TABLE (5.5k rows, 712.2 MiB processed)[0m in 8.27s]
[0m18:31:47.832007 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m18:31:51.766723 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (execute): 18:31:43.891678 => 18:31:51.765762
[0m18:31:51.767755 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0aa1782-cb7b-4408-8fc2-aaee1210ac29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A00CA4710>]}
[0m18:31:51.767755 [info ] [Thread-2 (]: 8 of 8 OK created sql table model mart.mrt_metainformation_campaigns ........... [[32mCREATE TABLE (2.2k rows, 711.7 MiB processed)[0m in 7.88s]
[0m18:31:51.769750 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_metainformation_campaigns
[0m18:31:51.771743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:51.771743 [debug] [MainThread]: Connection 'create_oss-big-query-dashboard-prod_mart' was properly closed.
[0m18:31:51.772708 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m18:31:51.773197 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m18:31:51.773197 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:31:51.774197 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized' was properly closed.
[0m18:31:51.774197 [debug] [MainThread]: Connection 'model.bq_evo.mrt_metainformation_campaigns' was properly closed.
[0m18:31:51.775194 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized' was properly closed.
[0m18:31:51.775194 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance' was properly closed.
[0m18:31:51.776192 [info ] [MainThread]: 
[0m18:31:51.777190 [info ] [MainThread]: Finished running 7 incremental models, 1 table model in 0 hours 0 minutes and 21.05 seconds (21.05s).
[0m18:31:51.779184 [debug] [MainThread]: Command end result
[0m18:31:51.800649 [info ] [MainThread]: 
[0m18:31:51.801645 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:31:51.802641 [info ] [MainThread]: 
[0m18:31:51.802641 [error] [MainThread]:   Runtime Error in model mrt_meta_basic_campaign_stats (models\mart\single_source_data\meta\mrt_meta_basic_campaign_stats.sql)
  404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_campaign_stats_joined_campaign_names was not found in location europe-west3
  
  Location: europe-west3
  Job ID: 4afd7a61-ed94-4ee3-bbf9-b490f3486c28
  
[0m18:31:51.804635 [info ] [MainThread]: 
[0m18:31:51.805632 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m18:31:51.806630 [debug] [MainThread]: Command `dbt run` failed at 18:31:51.806630 after 21.65 seconds
[0m18:31:51.806630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7EBFAED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A7EDDB650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A00726AD0>]}
[0m18:31:51.807627 [debug] [MainThread]: Flushing usage events
[0m18:32:23.554155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B8E58290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B8E5BE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B983C4D0>]}


============================== 18:32:23.558451 | 5d18b710-0f01-4b30-9659-d0a9d2e4b8ac ==============================
[0m18:32:23.558451 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:32:23.558451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart *bing*', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:32:23.905369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BA0B5390>]}
[0m18:32:23.914346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BA3DB710>]}
[0m18:32:23.915343 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:32:23.966772 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:32:24.070995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:32:24.070995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:32:24.078973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BAC84510>]}
[0m18:32:24.096926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BAC94990>]}
[0m18:32:24.097923 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:32:24.099169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B3D4C750>]}
[0m18:32:24.101167 [info ] [MainThread]: 
[0m18:32:24.102164 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:32:24.104834 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:32:24.105869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:24.105869 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:32:24.107101 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:32:24.108125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:24.108125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:26.802077 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:32:26.803077 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m18:32:26.803077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:26.804071 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m18:32:26.805037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:26.808027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:27.494215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B9A3B9D0>]}
[0m18:32:27.495254 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:32:27.496297 [info ] [MainThread]: 
[0m18:32:27.500575 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m18:32:27.500575 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m18:32:27.501735 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m18:32:27.502771 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m18:32:27.501735 [info ] [Thread-1 (]: 1 of 12 START sql incremental model mart.mrt_google_ads_basic_campaign_stats ... [RUN]
[0m18:32:27.503774 [info ] [Thread-2 (]: 2 of 12 START sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [RUN]
[0m18:32:27.504770 [info ] [Thread-3 (]: 3 of 12 START sql incremental model mart.mrt_google_analytics_campaign_webperformance  [RUN]
[0m18:32:27.506211 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_ads_basic_campaign_stats'
[0m18:32:27.504770 [info ] [Thread-4 (]: 4 of 12 START sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [RUN]
[0m18:32:27.507496 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized'
[0m18:32:27.509516 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance'
[0m18:32:27.509516 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m18:32:27.511764 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized'
[0m18:32:27.511764 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m18:32:27.513010 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m18:32:27.527059 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m18:32:27.528094 [debug] [Thread-4 (]: Began compiling node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m18:32:27.532079 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m18:32:27.538063 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m18:32:27.542055 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m18:32:27.544014 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (compile): 18:32:27.513010 => 18:32:27.543017
[0m18:32:27.545011 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (compile): 18:32:27.529056 => 18:32:27.545011
[0m18:32:27.547006 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (compile): 18:32:27.533076 => 18:32:27.546042
[0m18:32:27.548006 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m18:32:27.548006 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (compile): 18:32:27.539028 => 18:32:27.548006
[0m18:32:27.549004 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m18:32:27.550000 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m18:32:27.614414 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:32:27.615411 [debug] [Thread-4 (]: Began executing node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m18:32:27.618403 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:32:27.622392 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:32:27.623389 [debug] [Thread-1 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

    

      WHERE
      --Update table for the past seven days + today
      date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:32:27.626381 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:32:27.628344 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt grundlegende Web-Performancewerte aller \u00fcber GA4 erfassten Kampagnen.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`

    

      WHERE
      --Update table for the past seven days + today
      event_date >= current_date()-7
        
    
),

sessions_by_campaign AS(
  SELECT
    event_date as Date,
    CampaignID,

    COUNT(DISTINCT(CONCAT(user_pseudo_id,session_id))) as Sessions,
    COUNT(DISTINCT 
      CASE 
        WHEN session_engaged = '1' THEN CONCAT(user_pseudo_id,session_id) 
      END) as Sessions_Engaged,
    MAX(Medium) as Medium,
    MAX(Source) as Source,
    MAX(Partner) as Partner,

  FROM _raw
  GROUP BY 1,2
),

_add_engagement_rate AS(
    SELECT 
        Date,
        CampaignID,
        Sessions,
        Sessions_Engaged,
        (CASE
            WHEN Sessions > 0 THEN (Sessions_Engaged / Sessions) 
            ELSE 0
        END) as Engagement_Rate,
        Medium,
        Source,
        Partner
    FROM sessions_by_campaign
),

_added_columns AS(
    SELECT
        *,
        '(not set)' as Keyword,
        '(not set)' as KeywordMatchType
    FROM _add_engagement_rate
),

_final AS(
    SELECT *
    FROM _added_columns
)

SELECT * FROM _final
    );
  
[0m18:32:28.312921 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m18:32:28.314915 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m18:32:28.315946 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized` as DBT_INTERNAL_DEST
        using (WITH ga4_conversions AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
    WHERE 
        Date > '2023-06-04'
),

ua_conversions AS(
    SELECT
        Date,
        NameZielvorhaben as ZielvorhabenName,
        LOWER(CONCAT(NameZielvorhaben, Partner)) as ZielvorhabenID,
        CampaignID,
        Source,
        Medium,
        Partner,
        Keyword,
        KeywordMatchType,
        Conversions
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_goal_conversions`
    WHERE Date <= '2023-06-04'
),

_merged_step1 AS(
    SELECT * FROM ga4_conversions
    UNION ALL
    SELECT * FROM ua_conversions
),

_final AS(
    SELECT *
    FROM _merged_step1
)

SELECT * FROM _final
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`Date`, `ZielvorhabenName`, `ZielvorhabenID`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Conversions`)
    values
        (`Date`, `ZielvorhabenName`, `ZielvorhabenID`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Conversions`)


    
[0m18:32:28.316909 [debug] [Thread-4 (]: On model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_merged_ua_ga4_transactions_summarized` as DBT_INTERNAL_DEST
        using (WITH _raw AS(
  SELECT 
    event_date as Date,
    Campaign,
    Medium,
    Source,
    item_category as ProductCategory,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  WHERE 
    transaction_id NOT LIKE 'TEST%'
),

_aggregation_on_day AS(
  SELECT
    Date,
    Campaign,
    Medium,
    Source,
    ProductCategory,
    count(Date) as Transactions,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    MAX(Partner) as Partner,
    CampaignID
  FROM _raw
  WHERE Date >= '2023-06-05'
  GROUP BY 1,2,3,4,5,10
),

evo_ecommerce_ua AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_transactions`
  WHERE Date < '2023-06-05'
),

_merged_step1 AS(
  SELECT * FROM _aggregation_on_day
  UNION ALL
  SELECT * FROM evo_ecommerce_ua
),

_final AS(
  SELECT * FROM _merged_step1
)

SELECT * FROM _final
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`Date`, `Campaign`, `Medium`, `Source`, `ProductCategory`, `Transactions`, `Keyword`, `KeywordMatchType`, `Partner`, `CampaignID`)
    values
        (`Date`, `Campaign`, `Medium`, `Source`, `ProductCategory`, `Transactions`, `Keyword`, `KeywordMatchType`, `Partner`, `CampaignID`)


    
[0m18:32:28.522869 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2adcef6b-10e8-4b62-90fc-b818286efea4&page=queryresults
[0m18:32:28.525808 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:1957d075-4e2a-4cff-9552-d271bbebec19&page=queryresults
[0m18:32:28.646297 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3933f2a0-74ae-4b6e-b9f1-fb7e4762731b&page=queryresults
[0m18:32:28.677449 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:86815b92-4878-4815-92ae-53ff832f4148&page=queryresults
[0m18:32:30.290014 [debug] [Thread-1 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:32:30.292010 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m18:32:30.292975 [debug] [Thread-1 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.date = DBT_INTERNAL_DEST.date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m18:32:30.573545 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7c325b20-3812-4489-b4e6-bfce62581ec5&page=queryresults
[0m18:32:33.261748 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (execute): 18:32:27.550000 => 18:32:33.261748
[0m18:32:33.262743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BAD9F710>]}
[0m18:32:33.263707 [info ] [Thread-1 (]: 1 of 12 OK created sql incremental model mart.mrt_google_ads_basic_campaign_stats  [[32mMERGE (178.0 rows, 11.3 MiB processed)[0m in 5.76s]
[0m18:32:33.264703 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m18:32:33.265712 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:32:33.266700 [info ] [Thread-1 (]: 5 of 12 START sql incremental model mart.mrt_linkedin_basic_campaign_stats ..... [RUN]
[0m18:32:33.267695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_google_ads_basic_campaign_stats, now model.bq_evo.mrt_linkedin_basic_campaign_stats)
[0m18:32:33.267695 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:32:33.276227 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_linkedin_basic_campaign_stats"
[0m18:32:33.278223 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (compile): 18:32:33.268701 => 18:32:33.277225
[0m18:32:33.279219 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:32:33.284207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:33.284207 [debug] [Thread-1 (]: On model.bq_evo.mrt_linkedin_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_linkedin_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der LinkedinKampagnen.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`

    

      WHERE
      --Update table for the past seven days + today
      date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:32:34.044360 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8457b025-f9dd-4d8d-b733-4a6c5a1d32f2&page=queryresults
[0m18:32:34.183084 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator >= for argument types: TIMESTAMP, DATE. Supported signature: ANY >= ANY at [27:7]')
[0m18:32:34.810170 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:92b2cff7-8f82-45c1-89ad-06babb66a419&page=queryresults
[0m18:32:34.946664 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:92b2cff7-8f82-45c1-89ad-06babb66a419&page=queryresults
[0m18:32:34.947626 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (execute): 18:32:33.279219 => 18:32:34.947626
[0m18:32:34.954606 [debug] [Thread-1 (]: Database Error in model mrt_linkedin_basic_campaign_stats (models\mart\single_source_data\linkedin\mrt_linkedin_basic_campaign_stats.sql)
  No matching signature for operator >= for argument types: TIMESTAMP, DATE. Supported signature: ANY >= ANY at [27:7]
[0m18:32:34.954606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BAC4D490>]}
[0m18:32:34.955604 [error] [Thread-1 (]: 5 of 12 ERROR creating sql incremental model mart.mrt_linkedin_basic_campaign_stats  [[31mERROR[0m in 1.69s]
[0m18:32:34.956660 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:32:34.957599 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m18:32:34.958616 [info ] [Thread-1 (]: 6 of 12 START sql incremental model mart.mrt_meta_basic_campaign_stats ......... [RUN]
[0m18:32:34.960655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_linkedin_basic_campaign_stats, now model.bq_evo.mrt_meta_basic_campaign_stats)
[0m18:32:34.961611 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_meta_basic_campaign_stats
[0m18:32:34.965600 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_meta_basic_campaign_stats"
[0m18:32:34.967595 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_meta_basic_campaign_stats (compile): 18:32:34.961611 => 18:32:34.966597
[0m18:32:34.967595 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_meta_basic_campaign_stats
[0m18:32:34.972581 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_meta_basic_campaign_stats"
[0m18:32:34.973580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:34.974578 [debug] [Thread-1 (]: On model.bq_evo.mrt_meta_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_meta_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_meta_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der Metakampagnen."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_campaign_stats_joined_campaign_names`

    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,   
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:32:35.275754 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (execute): 18:32:27.616374 => 18:32:35.275754
[0m18:32:35.276751 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BAC51F90>]}
[0m18:32:35.277748 [info ] [Thread-2 (]: 2 of 12 OK created sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [[32mMERGE (25.0k rows, 714.8 MiB processed)[0m in 7.77s]
[0m18:32:35.279743 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m18:32:35.279743 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_bing_ads_campaign_history
[0m18:32:35.280740 [info ] [Thread-2 (]: 7 of 12 START sql view model staging.stg_bing_ads_campaign_history ............. [RUN]
[0m18:32:35.281738 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized, now model.bq_evo.stg_bing_ads_campaign_history)
[0m18:32:35.282735 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_history
[0m18:32:35.285727 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m18:32:35.286724 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (compile): 18:32:35.283733 => 18:32:35.286724
[0m18:32:35.287736 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_history
[0m18:32:35.310661 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m18:32:35.312655 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:32:35.312655 [debug] [Thread-2 (]: On model.bq_evo.stg_bing_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_history`
),


_added_columns AS (
    SELECT
        *,
        'cpc' as Medium,
        'bing' as Source,
        (CASE 
            WHEN account_id = 156001989 THEN 'EVO'
        END) as Partner,
    FROM _raw
),

_added_campaignid AS (
    SELECT 
        *,
        LOWER (CONCAT(name, Source, Medium, Partner)) as CampaignID
    FROM _added_columns
),

_final AS(
    SELECT *
    FROM _added_campaignid
)

SELECT * FROM _final;


[0m18:32:35.558036 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8d923428-56c1-4440-a220-f1a8c5d0d4a9&page=queryresults
[0m18:32:35.558036 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_meta_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_meta_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der Metakampagnen."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_campaign_stats_joined_campaign_names`

    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,   
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:32:35.559035 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_campaign_stats_joined_campaign_names was not found in location europe-west3

Location: europe-west3
Job ID: 8d923428-56c1-4440-a220-f1a8c5d0d4a9

[0m18:32:35.560031 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_meta_basic_campaign_stats (execute): 18:32:34.968593 => 18:32:35.560031
[0m18:32:35.563027 [debug] [Thread-1 (]: Runtime Error in model mrt_meta_basic_campaign_stats (models\mart\single_source_data\meta\mrt_meta_basic_campaign_stats.sql)
  404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_campaign_stats_joined_campaign_names was not found in location europe-west3
  
  Location: europe-west3
  Job ID: 8d923428-56c1-4440-a220-f1a8c5d0d4a9
  
[0m18:32:35.564024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BAF6DA10>]}
[0m18:32:35.565038 [error] [Thread-1 (]: 6 of 12 ERROR creating sql incremental model mart.mrt_meta_basic_campaign_stats  [[31mERROR[0m in 0.60s]
[0m18:32:35.566019 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m18:32:35.566019 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m18:32:35.567016 [info ] [Thread-1 (]: 8 of 12 START sql view model staging.stg_bing_ads_campaign_performance_daily_report  [RUN]
[0m18:32:35.568014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_meta_basic_campaign_stats, now model.bq_evo.stg_bing_ads_campaign_performance_daily_report)
[0m18:32:35.569011 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m18:32:35.572003 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m18:32:35.573998 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (compile): 18:32:35.569011 => 18:32:35.573998
[0m18:32:35.575506 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m18:32:35.582492 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m18:32:35.584487 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (execute): 18:32:27.624354 => 18:32:35.584487
[0m18:32:35.585485 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BAC8E110>]}
[0m18:32:35.586483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:35.587479 [info ] [Thread-4 (]: 4 of 12 OK created sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [[32mMERGE (5.5k rows, 712.2 MiB processed)[0m in 8.07s]
[0m18:32:35.588476 [debug] [Thread-1 (]: On model.bq_evo.stg_bing_ads_campaign_performance_daily_report: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_performance_daily_report`
),

_renamed_columns AS(
    SELECT 
        _fivetran_id,
        _fivetran_synced,
        account_id,
        ad_distribution,
        ad_relevance,
        all_conversions,
        all_conversions_qualified,
        all_return_on_ad_spend,
        all_revenue,
        assists,
        average_cpc,
        average_position,
        bid_match_type,
        budget_association_status,
        campaign_id,
        campaign_name,
        campaign_status,
        clicks as Clicks,
        conversions,
        conversions_qualified,
        ctr,
        currency_code,
        date as Date,
        delivered_match_type,
        device_os,
        device_type,
        expected_ctr,
        historical_ad_relevance,
        historical_expected_ctr,
        historical_landing_page_experience,
        historical_quality_score,
        impressions as Impressions,
        landing_page_experience,
        low_quality_clicks,
        low_quality_clicks_percent,
        low_quality_conversion_rate,
        low_quality_conversions,
        low_quality_conversions_qualified,
        low_quality_general_clicks,
        low_quality_impressions,
        low_quality_impressions_percent,
        low_quality_sophisticated_clicks,
        network,
        phone_calls,
        phone_impressions,
        quality_score,
        return_on_ad_spend,
        revenue,
        spend as Cost,
        top_vs_other,
        view_through_conversions
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:32:35.589477 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m18:32:35.979383 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7076b7aa-e76e-47c2-94ae-bb7271f78abf&page=queryresults
[0m18:32:36.244568 [debug] [Thread-3 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:32:36.245530 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:dd927890-017b-4d03-bf2b-d5d307ba4b63&page=queryresults
[0m18:32:36.247524 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m18:32:36.250519 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.Date = DBT_INTERNAL_DEST.Date
                ) and (
                    DBT_INTERNAL_SOURCE.CampaignID = DBT_INTERNAL_DEST.CampaignID
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Sessions` = DBT_INTERNAL_SOURCE.`Sessions`,`Sessions_Engaged` = DBT_INTERNAL_SOURCE.`Sessions_Engaged`,`Engagement_Rate` = DBT_INTERNAL_SOURCE.`Engagement_Rate`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`
    

    when not matched then insert
        (`Date`, `CampaignID`, `Sessions`, `Sessions_Engaged`, `Engagement_Rate`, `Medium`, `Source`, `Partner`, `Keyword`, `KeywordMatchType`)
    values
        (`Date`, `CampaignID`, `Sessions`, `Sessions_Engaged`, `Engagement_Rate`, `Medium`, `Source`, `Partner`, `Keyword`, `KeywordMatchType`)


    
[0m18:32:36.402163 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (execute): 18:32:35.576522 => 18:32:36.401166
[0m18:32:36.404158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BAC71850>]}
[0m18:32:36.405123 [info ] [Thread-1 (]: 8 of 12 OK created sql view model staging.stg_bing_ads_campaign_performance_daily_report  [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m18:32:36.406121 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m18:32:36.486913 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3cb961bc-b1b9-4c91-a656-695840b68408&page=queryresults
[0m18:32:36.658084 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (execute): 18:32:35.287736 => 18:32:36.658084
[0m18:32:36.659079 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BAEB5110>]}
[0m18:32:36.660077 [info ] [Thread-2 (]: 7 of 12 OK created sql view model staging.stg_bing_ads_campaign_history ........ [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m18:32:36.661075 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_history
[0m18:32:36.662804 [debug] [Thread-4 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m18:32:36.662804 [info ] [Thread-4 (]: 9 of 12 START sql view model intermediate.int_bing_ads_unique_campaigns ........ [RUN]
[0m18:32:36.664802 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized, now model.bq_evo.int_bing_ads_unique_campaigns)
[0m18:32:36.665800 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_bing_ads_unique_campaigns
[0m18:32:36.671783 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m18:32:36.673788 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (compile): 18:32:36.665800 => 18:32:36.672780
[0m18:32:36.674775 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_bing_ads_unique_campaigns
[0m18:32:36.676769 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m18:32:36.679276 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:32:36.679276 [debug] [Thread-4 (]: On model.bq_evo.int_bing_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Bing Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id,
        MAX(name) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m18:32:37.303415 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8f52a1b4-4209-4f88-9bfc-fd4a3ca99f78&page=queryresults
[0m18:32:37.954822 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (execute): 18:32:36.674775 => 18:32:37.953778
[0m18:32:37.956817 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BAEFBC10>]}
[0m18:32:37.957778 [info ] [Thread-4 (]: 9 of 12 OK created sql view model intermediate.int_bing_ads_unique_campaigns ... [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m18:32:37.958757 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m18:32:37.959755 [debug] [Thread-2 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m18:32:37.960753 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_metainformation_campaigns
[0m18:32:37.960753 [info ] [Thread-2 (]: 10 of 12 START sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [RUN]
[0m18:32:37.962747 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_history, now model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names)
[0m18:32:37.961750 [info ] [Thread-1 (]: 11 of 12 START sql table model mart.mrt_metainformation_campaigns .............. [RUN]
[0m18:32:37.963745 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m18:32:37.964747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_performance_daily_report, now model.bq_evo.mrt_metainformation_campaigns)
[0m18:32:37.967736 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m18:32:37.968734 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_metainformation_campaigns
[0m18:32:37.976746 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_metainformation_campaigns"
[0m18:32:37.978710 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (compile): 18:32:37.964747 => 18:32:37.977710
[0m18:32:37.979704 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m18:32:37.980702 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (compile): 18:32:37.969731 => 18:32:37.979704
[0m18:32:37.984788 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m18:32:37.985783 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_metainformation_campaigns
[0m18:32:37.998783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:37.999747 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:32:38.001741 [debug] [Thread-2 (]: On model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne inkl. Klartext der Kampagne."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m18:32:38.496080 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (execute): 18:32:27.619400 => 18:32:38.495083
[0m18:32:38.498070 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BAC8E110>]}
[0m18:32:38.498070 [info ] [Thread-3 (]: 3 of 12 OK created sql incremental model mart.mrt_google_analytics_campaign_webperformance  [[32mMERGE (407.0 rows, 1.3 MiB processed)[0m in 10.99s]
[0m18:32:38.500065 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m18:32:38.627197 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_metainformation_campaigns"
[0m18:32:38.630187 [debug] [Thread-1 (]: On model.bq_evo.mrt_metainformation_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_metainformation_campaigns"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_metainformation_campaigns`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt Kampagnen aus allen Quelldatensystemen mit Metainformationen."""
    )
    as (
      

WITH _googleads_campaigns AS(
    SELECT
        campaign as Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_google_analytics_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        CASE
            WHEN Medium IN ('cpc', 'ppc','cpa', 'cpm', 'cpv', 'cpp') THEN 'true' 
            ELSE 'false'
        END as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
),

_bingads_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_merged_googleads_and_analytics AS(
    SELECT * FROM _googleads_campaigns
    UNION ALL
    SELECT * FROM _google_analytics_campaigns
),

_merged_bingads AS(
    SELECT * FROM _merged_googleads_and_analytics
    UNION ALL
    SELECT * FROM _bingads_campaigns    
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _merged_bingads
)

SELECT * FROM _final
    );
  
[0m18:32:38.776931 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ead47b3b-2dec-4b25-9001-48b8bea55338&page=queryresults
[0m18:32:38.939633 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:390c14e2-7454-4d07-8a67-cb3e0c5dcbf5&page=queryresults
[0m18:32:39.477872 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (execute): 18:32:37.980702 => 18:32:39.476875
[0m18:32:39.479867 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BAEC5010>]}
[0m18:32:39.481862 [info ] [Thread-2 (]: 10 of 12 OK created sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.52s]
[0m18:32:39.484369 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m18:32:39.486370 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m18:32:39.487405 [info ] [Thread-4 (]: 12 of 12 START sql incremental model mart.mrt_bing_ads_basic_campaign_stats .... [RUN]
[0m18:32:39.490363 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_unique_campaigns, now model.bq_evo.mrt_bing_ads_basic_campaign_stats)
[0m18:32:39.491359 [debug] [Thread-4 (]: Began compiling node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m18:32:39.498336 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m18:32:39.500331 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (compile): 18:32:39.492389 => 18:32:39.499374
[0m18:32:39.500331 [debug] [Thread-4 (]: Began executing node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m18:32:39.504319 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:32:39.505354 [debug] [Thread-4 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
 
    

      WHERE
      --Update table for the past seven days + today
      Date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:32:40.239691 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:af73eaba-e87b-46f0-ae60-225c6685cc86&page=queryresults
[0m18:32:41.959116 [debug] [Thread-4 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:32:41.961110 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m18:32:41.963105 [debug] [Thread-4 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.Date = DBT_INTERNAL_DEST.Date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m18:32:42.190058 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:601bc670-d17c-4ccf-ac82-a6b5f52c7e37&page=queryresults
[0m18:32:44.194095 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (execute): 18:32:39.501330 => 18:32:44.193098
[0m18:32:44.195093 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BAE75E90>]}
[0m18:32:44.195093 [info ] [Thread-4 (]: 12 of 12 OK created sql incremental model mart.mrt_bing_ads_basic_campaign_stats  [[32mMERGE (0.0 rows, 387.5 KiB processed)[0m in 4.70s]
[0m18:32:44.197087 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m18:32:46.696129 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (execute): 18:32:37.986782 => 18:32:46.694587
[0m18:32:46.697131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d18b710-0f01-4b30-9659-d0a9d2e4b8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BB8A8B90>]}
[0m18:32:46.697131 [info ] [Thread-1 (]: 11 of 12 OK created sql table model mart.mrt_metainformation_campaigns ......... [[32mCREATE TABLE (2.2k rows, 711.7 MiB processed)[0m in 8.73s]
[0m18:32:46.699126 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_metainformation_campaigns
[0m18:32:46.701118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:46.702148 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:32:46.702148 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:32:46.703115 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:32:46.703115 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:32:46.704111 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m18:32:46.704111 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m18:32:46.705109 [debug] [MainThread]: Connection 'model.bq_evo.mrt_metainformation_campaigns' was properly closed.
[0m18:32:46.706106 [debug] [MainThread]: Connection 'model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names' was properly closed.
[0m18:32:46.706106 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance' was properly closed.
[0m18:32:46.707103 [debug] [MainThread]: Connection 'model.bq_evo.mrt_bing_ads_basic_campaign_stats' was properly closed.
[0m18:32:46.707103 [info ] [MainThread]: 
[0m18:32:46.708099 [info ] [MainThread]: Finished running 7 incremental models, 4 view models, 1 table model in 0 hours 0 minutes and 22.60 seconds (22.60s).
[0m18:32:46.712122 [debug] [MainThread]: Command end result
[0m18:32:46.734032 [info ] [MainThread]: 
[0m18:32:46.735029 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:32:46.736025 [info ] [MainThread]: 
[0m18:32:46.737025 [error] [MainThread]:   Database Error in model mrt_linkedin_basic_campaign_stats (models\mart\single_source_data\linkedin\mrt_linkedin_basic_campaign_stats.sql)
  No matching signature for operator >= for argument types: TIMESTAMP, DATE. Supported signature: ANY >= ANY at [27:7]
[0m18:32:46.738068 [info ] [MainThread]: 
[0m18:32:46.740016 [error] [MainThread]:   Runtime Error in model mrt_meta_basic_campaign_stats (models\mart\single_source_data\meta\mrt_meta_basic_campaign_stats.sql)
  404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_campaign_stats_joined_campaign_names was not found in location europe-west3
  
  Location: europe-west3
  Job ID: 8d923428-56c1-4440-a220-f1a8c5d0d4a9
  
[0m18:32:46.741012 [info ] [MainThread]: 
[0m18:32:46.742011 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m18:32:46.744005 [debug] [MainThread]: Command `dbt run` failed at 18:32:46.743007 after 23.20 seconds
[0m18:32:46.744005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B91AC150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B8E5BE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0B8E58990>]}
[0m18:32:46.745003 [debug] [MainThread]: Flushing usage events
[0m18:34:02.492510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBC082190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBC05AF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBC0FB910>]}


============================== 18:34:02.496502 | 0cfc5205-b887-4e49-ab6e-d67bcec465b3 ==============================
[0m18:34:02.496502 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:34:02.498502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart *bing_*', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:34:02.837870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBDE31110>]}
[0m18:34:02.846814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBD57B710>]}
[0m18:34:02.847844 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:34:02.903664 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:34:03.004950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:34:03.005947 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\mart\single_source_data\linkedin\mrt_linkedin_basic_campaign_stats.sql
[0m18:34:03.074885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBDEAB050>]}
[0m18:34:03.093444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBDE3E9D0>]}
[0m18:34:03.093444 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:34:03.094717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBDEF6110>]}
[0m18:34:03.098238 [info ] [MainThread]: 
[0m18:34:03.099268 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:34:03.101322 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:34:03.102347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:03.102347 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:34:03.103737 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:34:03.104988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:03.104988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:05.654103 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:34:05.657082 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m18:34:05.659038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:05.662075 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m18:34:05.664043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:05.671035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:06.340314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBC059E10>]}
[0m18:34:06.341356 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:34:06.342820 [info ] [MainThread]: 
[0m18:34:06.347647 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m18:34:06.347647 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m18:34:06.348647 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m18:34:06.349645 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m18:34:06.348647 [info ] [Thread-1 (]: 1 of 12 START sql incremental model mart.mrt_google_ads_basic_campaign_stats ... [RUN]
[0m18:34:06.350642 [info ] [Thread-2 (]: 2 of 12 START sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [RUN]
[0m18:34:06.350642 [info ] [Thread-3 (]: 3 of 12 START sql incremental model mart.mrt_google_analytics_campaign_webperformance  [RUN]
[0m18:34:06.351649 [info ] [Thread-4 (]: 4 of 12 START sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [RUN]
[0m18:34:06.353663 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_ads_basic_campaign_stats'
[0m18:34:06.354635 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized'
[0m18:34:06.355632 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance'
[0m18:34:06.357625 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized'
[0m18:34:06.357625 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m18:34:06.359618 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m18:34:06.360617 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m18:34:06.360617 [debug] [Thread-4 (]: Began compiling node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m18:34:06.373229 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m18:34:06.376185 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m18:34:06.379841 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m18:34:06.383689 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m18:34:06.385692 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (compile): 18:34:06.362220 => 18:34:06.384689
[0m18:34:06.386683 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (compile): 18:34:06.373229 => 18:34:06.386683
[0m18:34:06.387679 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m18:34:06.388679 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (compile): 18:34:06.376847 => 18:34:06.388679
[0m18:34:06.389677 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (compile): 18:34:06.380693 => 18:34:06.389677
[0m18:34:06.389677 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m18:34:06.446080 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m18:34:06.459078 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:06.460076 [debug] [Thread-4 (]: Began executing node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m18:34:06.463035 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:34:06.468055 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:34:06.469054 [debug] [Thread-1 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

    

      WHERE
      --Update table for the past seven days + today
      date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:34:06.472009 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:34:06.474120 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt grundlegende Web-Performancewerte aller \u00fcber GA4 erfassten Kampagnen.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`

    

      WHERE
      --Update table for the past seven days + today
      event_date >= current_date()-7
        
    
),

sessions_by_campaign AS(
  SELECT
    event_date as Date,
    CampaignID,

    COUNT(DISTINCT(CONCAT(user_pseudo_id,session_id))) as Sessions,
    COUNT(DISTINCT 
      CASE 
        WHEN session_engaged = '1' THEN CONCAT(user_pseudo_id,session_id) 
      END) as Sessions_Engaged,
    MAX(Medium) as Medium,
    MAX(Source) as Source,
    MAX(Partner) as Partner,

  FROM _raw
  GROUP BY 1,2
),

_add_engagement_rate AS(
    SELECT 
        Date,
        CampaignID,
        Sessions,
        Sessions_Engaged,
        (CASE
            WHEN Sessions > 0 THEN (Sessions_Engaged / Sessions) 
            ELSE 0
        END) as Engagement_Rate,
        Medium,
        Source,
        Partner
    FROM sessions_by_campaign
),

_added_columns AS(
    SELECT
        *,
        '(not set)' as Keyword,
        '(not set)' as KeywordMatchType
    FROM _add_engagement_rate
),

_final AS(
    SELECT *
    FROM _added_columns
)

SELECT * FROM _final
    );
  
[0m18:34:07.145388 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m18:34:07.147344 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized` as DBT_INTERNAL_DEST
        using (WITH ga4_conversions AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
    WHERE 
        Date > '2023-06-04'
),

ua_conversions AS(
    SELECT
        Date,
        NameZielvorhaben as ZielvorhabenName,
        LOWER(CONCAT(NameZielvorhaben, Partner)) as ZielvorhabenID,
        CampaignID,
        Source,
        Medium,
        Partner,
        Keyword,
        KeywordMatchType,
        Conversions
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_goal_conversions`
    WHERE Date <= '2023-06-04'
),

_merged_step1 AS(
    SELECT * FROM ga4_conversions
    UNION ALL
    SELECT * FROM ua_conversions
),

_final AS(
    SELECT *
    FROM _merged_step1
)

SELECT * FROM _final
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`Date`, `ZielvorhabenName`, `ZielvorhabenID`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Conversions`)
    values
        (`Date`, `ZielvorhabenName`, `ZielvorhabenID`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Conversions`)


    
[0m18:34:07.152351 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m18:34:07.154325 [debug] [Thread-4 (]: On model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_merged_ua_ga4_transactions_summarized` as DBT_INTERNAL_DEST
        using (WITH _raw AS(
  SELECT 
    event_date as Date,
    Campaign,
    Medium,
    Source,
    item_category as ProductCategory,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  WHERE 
    transaction_id NOT LIKE 'TEST%'
),

_aggregation_on_day AS(
  SELECT
    Date,
    Campaign,
    Medium,
    Source,
    ProductCategory,
    count(Date) as Transactions,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    MAX(Partner) as Partner,
    CampaignID
  FROM _raw
  WHERE Date >= '2023-06-05'
  GROUP BY 1,2,3,4,5,10
),

evo_ecommerce_ua AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_transactions`
  WHERE Date < '2023-06-05'
),

_merged_step1 AS(
  SELECT * FROM _aggregation_on_day
  UNION ALL
  SELECT * FROM evo_ecommerce_ua
),

_final AS(
  SELECT * FROM _merged_step1
)

SELECT * FROM _final
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`Date`, `Campaign`, `Medium`, `Source`, `ProductCategory`, `Transactions`, `Keyword`, `KeywordMatchType`, `Partner`, `CampaignID`)
    values
        (`Date`, `Campaign`, `Medium`, `Source`, `ProductCategory`, `Transactions`, `Keyword`, `KeywordMatchType`, `Partner`, `CampaignID`)


    
[0m18:34:07.309122 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ae12ab7c-dd40-4268-9556-cfe7eb36a325&page=queryresults
[0m18:34:07.329821 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:d05fffd5-5fc0-4bbe-a81c-213d64376ee6&page=queryresults
[0m18:34:07.482003 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:aff699b7-06a8-4213-b7ef-db6e44659ebd&page=queryresults
[0m18:34:07.484998 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4c4d0237-6847-4c1d-a32c-365fb1e3d0ea&page=queryresults
[0m18:34:10.292278 [debug] [Thread-1 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:34:10.294272 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m18:34:10.295260 [debug] [Thread-1 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.date = DBT_INTERNAL_DEST.date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m18:34:10.532153 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a6d339ae-6a5a-464a-8c7b-15c3160db8f4&page=queryresults
[0m18:34:12.851630 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (execute): 18:34:06.390676 => 18:34:12.851630
[0m18:34:12.852627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBDE52450>]}
[0m18:34:12.853624 [info ] [Thread-1 (]: 1 of 12 OK created sql incremental model mart.mrt_google_ads_basic_campaign_stats  [[32mMERGE (178.0 rows, 11.3 MiB processed)[0m in 6.50s]
[0m18:34:12.855619 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m18:34:12.856583 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:34:12.857582 [info ] [Thread-1 (]: 5 of 12 START sql incremental model mart.mrt_linkedin_basic_campaign_stats ..... [RUN]
[0m18:34:12.858611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_google_ads_basic_campaign_stats, now model.bq_evo.mrt_linkedin_basic_campaign_stats)
[0m18:34:12.859577 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:34:12.864595 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_linkedin_basic_campaign_stats"
[0m18:34:12.866556 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (compile): 18:34:12.860605 => 18:34:12.866556
[0m18:34:12.868550 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:34:12.873547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:12.874536 [debug] [Thread-1 (]: On model.bq_evo.mrt_linkedin_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_linkedin_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der LinkedinKampagnen.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`

    

      WHERE
      --Update table for the past seven days + today
      Date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:34:13.587434 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:00d36b66-0e3a-4b15-96a1-35cc66c4d649&page=queryresults
[0m18:34:13.737118 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator >= for argument types: TIMESTAMP, DATE. Supported signature: ANY >= ANY at [27:7]')
[0m18:34:14.568136 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3984138d-0708-4ed0-b95b-9f7935bdc021&page=queryresults
[0m18:34:14.721528 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3984138d-0708-4ed0-b95b-9f7935bdc021&page=queryresults
[0m18:34:14.723522 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (execute): 18:34:12.868550 => 18:34:14.722519
[0m18:34:14.732529 [debug] [Thread-1 (]: Database Error in model mrt_linkedin_basic_campaign_stats (models\mart\single_source_data\linkedin\mrt_linkedin_basic_campaign_stats.sql)
  No matching signature for operator >= for argument types: TIMESTAMP, DATE. Supported signature: ANY >= ANY at [27:7]
[0m18:34:14.732529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBE1A9E50>]}
[0m18:34:14.734174 [error] [Thread-1 (]: 5 of 12 ERROR creating sql incremental model mart.mrt_linkedin_basic_campaign_stats  [[31mERROR[0m in 1.87s]
[0m18:34:14.735175 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:34:14.736172 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m18:34:14.737680 [info ] [Thread-1 (]: 6 of 12 START sql incremental model mart.mrt_meta_basic_campaign_stats ......... [RUN]
[0m18:34:14.738715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_linkedin_basic_campaign_stats, now model.bq_evo.mrt_meta_basic_campaign_stats)
[0m18:34:14.739679 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_meta_basic_campaign_stats
[0m18:34:14.743702 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_meta_basic_campaign_stats"
[0m18:34:14.745677 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_meta_basic_campaign_stats (compile): 18:34:14.739679 => 18:34:14.745677
[0m18:34:14.746659 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_meta_basic_campaign_stats
[0m18:34:14.751646 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_meta_basic_campaign_stats"
[0m18:34:14.752643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:14.753641 [debug] [Thread-1 (]: On model.bq_evo.mrt_meta_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_meta_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_meta_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der Metakampagnen."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_campaign_stats_joined_campaign_names`

    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,   
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:34:14.887220 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (execute): 18:34:06.461039 => 18:34:14.887220
[0m18:34:14.888215 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (execute): 18:34:06.470048 => 18:34:14.888215
[0m18:34:14.889214 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBDF3F550>]}
[0m18:34:14.890178 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBDE26A90>]}
[0m18:34:14.891175 [info ] [Thread-2 (]: 2 of 12 OK created sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [[32mMERGE (25.0k rows, 714.8 MiB processed)[0m in 8.54s]
[0m18:34:14.891175 [info ] [Thread-4 (]: 4 of 12 OK created sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [[32mMERGE (5.5k rows, 712.2 MiB processed)[0m in 8.53s]
[0m18:34:14.893202 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m18:34:14.894199 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m18:34:14.895165 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_bing_ads_campaign_history
[0m18:34:14.895165 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m18:34:14.896161 [info ] [Thread-2 (]: 7 of 12 START sql view model staging.stg_bing_ads_campaign_history ............. [RUN]
[0m18:34:14.897159 [info ] [Thread-4 (]: 8 of 12 START sql view model staging.stg_bing_ads_campaign_performance_daily_report  [RUN]
[0m18:34:14.898156 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized, now model.bq_evo.stg_bing_ads_campaign_history)
[0m18:34:14.899179 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized, now model.bq_evo.stg_bing_ads_campaign_performance_daily_report)
[0m18:34:14.900194 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_history
[0m18:34:14.901177 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m18:34:14.905167 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m18:34:14.916131 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m18:34:14.916131 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (compile): 18:34:14.902145 => 18:34:14.916131
[0m18:34:14.917105 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_history
[0m18:34:14.929125 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (compile): 18:34:14.905167 => 18:34:14.929125
[0m18:34:14.938686 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m18:34:14.938686 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m18:34:14.944670 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m18:34:14.945631 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:34:14.946627 [debug] [Thread-2 (]: On model.bq_evo.stg_bing_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_history`
),


_added_columns AS (
    SELECT
        *,
        'cpc' as Medium,
        'bing' as Source,
        (CASE 
            WHEN account_id = 156001989 THEN 'EVO'
        END) as Partner,
    FROM _raw
),

_added_campaignid AS (
    SELECT 
        *,
        LOWER (CONCAT(name, Source, Medium, Partner)) as CampaignID
    FROM _added_columns
),

_final AS(
    SELECT *
    FROM _added_campaignid
)

SELECT * FROM _final;


[0m18:34:14.948623 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:34:14.950620 [debug] [Thread-4 (]: On model.bq_evo.stg_bing_ads_campaign_performance_daily_report: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_performance_daily_report`
),

_renamed_columns AS(
    SELECT 
        _fivetran_id,
        _fivetran_synced,
        account_id,
        ad_distribution,
        ad_relevance,
        all_conversions,
        all_conversions_qualified,
        all_return_on_ad_spend,
        all_revenue,
        assists,
        average_cpc,
        average_position,
        bid_match_type,
        budget_association_status,
        campaign_id,
        campaign_name,
        campaign_status,
        clicks as Clicks,
        conversions,
        conversions_qualified,
        ctr,
        currency_code,
        date as Date,
        delivered_match_type,
        device_os,
        device_type,
        expected_ctr,
        historical_ad_relevance,
        historical_expected_ctr,
        historical_landing_page_experience,
        historical_quality_score,
        impressions as Impressions,
        landing_page_experience,
        low_quality_clicks,
        low_quality_clicks_percent,
        low_quality_conversion_rate,
        low_quality_conversions,
        low_quality_conversions_qualified,
        low_quality_general_clicks,
        low_quality_impressions,
        low_quality_impressions_percent,
        low_quality_sophisticated_clicks,
        network,
        phone_calls,
        phone_impressions,
        quality_score,
        return_on_ad_spend,
        revenue,
        spend as Cost,
        top_vs_other,
        view_through_conversions
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:34:15.382874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c09c27f6-c018-4056-94c7-10d7fcd88c5b&page=queryresults
[0m18:34:15.384060 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_meta_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_meta_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der Metakampagnen."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_campaign_stats_joined_campaign_names`

    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,   
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:34:15.385069 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_campaign_stats_joined_campaign_names was not found in location europe-west3

Location: europe-west3
Job ID: c09c27f6-c018-4056-94c7-10d7fcd88c5b

[0m18:34:15.386165 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_meta_basic_campaign_stats (execute): 18:34:14.746659 => 18:34:15.386165
[0m18:34:15.389213 [debug] [Thread-1 (]: Runtime Error in model mrt_meta_basic_campaign_stats (models\mart\single_source_data\meta\mrt_meta_basic_campaign_stats.sql)
  404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_campaign_stats_joined_campaign_names was not found in location europe-west3
  
  Location: europe-west3
  Job ID: c09c27f6-c018-4056-94c7-10d7fcd88c5b
  
[0m18:34:15.390253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBE141490>]}
[0m18:34:15.390253 [error] [Thread-1 (]: 6 of 12 ERROR creating sql incremental model mart.mrt_meta_basic_campaign_stats  [[31mERROR[0m in 0.65s]
[0m18:34:15.392266 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m18:34:15.462878 [debug] [Thread-3 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:34:15.464885 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m18:34:15.466880 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.Date = DBT_INTERNAL_DEST.Date
                ) and (
                    DBT_INTERNAL_SOURCE.CampaignID = DBT_INTERNAL_DEST.CampaignID
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Sessions` = DBT_INTERNAL_SOURCE.`Sessions`,`Sessions_Engaged` = DBT_INTERNAL_SOURCE.`Sessions_Engaged`,`Engagement_Rate` = DBT_INTERNAL_SOURCE.`Engagement_Rate`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`
    

    when not matched then insert
        (`Date`, `CampaignID`, `Sessions`, `Sessions_Engaged`, `Engagement_Rate`, `Medium`, `Source`, `Partner`, `Keyword`, `KeywordMatchType`)
    values
        (`Date`, `CampaignID`, `Sessions`, `Sessions_Engaged`, `Engagement_Rate`, `Medium`, `Source`, `Partner`, `Keyword`, `KeywordMatchType`)


    
[0m18:34:15.661770 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e170d2a9-ff00-4a00-9f90-dc95cfb265cd&page=queryresults
[0m18:34:15.670143 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:1a63cd2e-b135-41fb-bf3c-10b61683df24&page=queryresults
[0m18:34:15.739549 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:52ed0fa6-9e5b-4922-9991-44fc496530dd&page=queryresults
[0m18:34:16.070075 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (execute): 18:34:14.939683 => 18:34:16.070075
[0m18:34:16.071072 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBDEEF010>]}
[0m18:34:16.072075 [info ] [Thread-4 (]: 8 of 12 OK created sql view model staging.stg_bing_ads_campaign_performance_daily_report  [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m18:34:16.073103 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m18:34:16.337491 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (execute): 18:34:14.918132 => 18:34:16.337491
[0m18:34:16.338489 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBE1CC510>]}
[0m18:34:16.339451 [info ] [Thread-2 (]: 7 of 12 OK created sql view model staging.stg_bing_ads_campaign_history ........ [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m18:34:16.340448 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_history
[0m18:34:16.340952 [debug] [Thread-1 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m18:34:16.341955 [info ] [Thread-1 (]: 9 of 12 START sql view model intermediate.int_bing_ads_unique_campaigns ........ [RUN]
[0m18:34:16.343981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_meta_basic_campaign_stats, now model.bq_evo.int_bing_ads_unique_campaigns)
[0m18:34:16.343981 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_bing_ads_unique_campaigns
[0m18:34:16.346939 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m18:34:16.348934 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (compile): 18:34:16.344944 => 18:34:16.347936
[0m18:34:16.348934 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_bing_ads_unique_campaigns
[0m18:34:16.352923 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m18:34:16.353920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:16.354918 [debug] [Thread-1 (]: On model.bq_evo.int_bing_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Bing Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id,
        MAX(name) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m18:34:16.975841 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:62ddf4c3-441b-420c-a493-e29b08873c2a&page=queryresults
[0m18:34:17.680567 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (execute): 18:34:16.349931 => 18:34:17.679574
[0m18:34:17.681566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBD5D8610>]}
[0m18:34:17.682528 [info ] [Thread-1 (]: 9 of 12 OK created sql view model intermediate.int_bing_ads_unique_campaigns ... [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m18:34:17.684561 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m18:34:17.685522 [debug] [Thread-2 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m18:34:17.686518 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_metainformation_campaigns
[0m18:34:17.687551 [info ] [Thread-2 (]: 10 of 12 START sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [RUN]
[0m18:34:17.688514 [info ] [Thread-4 (]: 11 of 12 START sql table model mart.mrt_metainformation_campaigns .............. [RUN]
[0m18:34:17.690509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_history, now model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names)
[0m18:34:17.692503 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_performance_daily_report, now model.bq_evo.mrt_metainformation_campaigns)
[0m18:34:17.693500 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m18:34:17.694499 [debug] [Thread-4 (]: Began compiling node model.bq_evo.mrt_metainformation_campaigns
[0m18:34:17.698486 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m18:34:17.703475 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.mrt_metainformation_campaigns"
[0m18:34:17.705468 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (compile): 18:34:17.695494 => 18:34:17.704470
[0m18:34:17.706465 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m18:34:17.706465 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (compile): 18:34:17.699483 => 18:34:17.706465
[0m18:34:17.710453 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m18:34:17.710453 [debug] [Thread-4 (]: Began executing node model.bq_evo.mrt_metainformation_campaigns
[0m18:34:17.721458 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:34:17.728443 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:34:17.728443 [debug] [Thread-2 (]: On model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne inkl. Klartext der Kampagne."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m18:34:17.849208 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (execute): 18:34:06.464032 => 18:34:17.849208
[0m18:34:17.850205 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBF210850>]}
[0m18:34:17.852200 [info ] [Thread-3 (]: 3 of 12 OK created sql incremental model mart.mrt_google_analytics_campaign_webperformance  [[32mMERGE (407.0 rows, 1.3 MiB processed)[0m in 11.49s]
[0m18:34:17.853197 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m18:34:18.313497 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.mrt_metainformation_campaigns"
[0m18:34:18.314494 [debug] [Thread-4 (]: On model.bq_evo.mrt_metainformation_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_metainformation_campaigns"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_metainformation_campaigns`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt Kampagnen aus allen Quelldatensystemen mit Metainformationen."""
    )
    as (
      

WITH _googleads_campaigns AS(
    SELECT
        campaign as Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_google_analytics_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        CASE
            WHEN Medium IN ('cpc', 'ppc','cpa', 'cpm', 'cpv', 'cpp') THEN 'true' 
            ELSE 'false'
        END as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
),

_bingads_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_merged_googleads_and_analytics AS(
    SELECT * FROM _googleads_campaigns
    UNION ALL
    SELECT * FROM _google_analytics_campaigns
),

_merged_bingads AS(
    SELECT * FROM _merged_googleads_and_analytics
    UNION ALL
    SELECT * FROM _bingads_campaigns    
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _merged_bingads
)

SELECT * FROM _final
    );
  
[0m18:34:18.491249 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:26baa5ca-f387-4806-8591-daef9493039b&page=queryresults
[0m18:34:18.615044 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6928a8b9-ef82-4ae0-b924-d21ee0f22997&page=queryresults
[0m18:34:19.195746 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (execute): 18:34:17.707461 => 18:34:19.195746
[0m18:34:19.196741 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBDE48F50>]}
[0m18:34:19.197739 [info ] [Thread-2 (]: 10 of 12 OK created sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.51s]
[0m18:34:19.198735 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m18:34:19.199733 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m18:34:19.199733 [info ] [Thread-1 (]: 12 of 12 START sql incremental model mart.mrt_bing_ads_basic_campaign_stats .... [RUN]
[0m18:34:19.200763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_unique_campaigns, now model.bq_evo.mrt_bing_ads_basic_campaign_stats)
[0m18:34:19.201754 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m18:34:19.205741 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m18:34:19.206716 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (compile): 18:34:19.201754 => 18:34:19.206716
[0m18:34:19.207712 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m18:34:19.211735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:19.212699 [debug] [Thread-1 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
 
    

      WHERE
      --Update table for the past seven days + today
      Date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:34:19.909647 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:42cf25a5-f891-4870-a2f6-bdc154ebfbd5&page=queryresults
[0m18:34:21.981861 [debug] [Thread-1 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:34:21.983857 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m18:34:21.984855 [debug] [Thread-1 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.Date = DBT_INTERNAL_DEST.Date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m18:34:22.212142 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:49cbf947-a8c1-4d9f-bfbd-e825e6fec824&page=queryresults
[0m18:34:24.520042 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (execute): 18:34:19.208737 => 18:34:24.520042
[0m18:34:24.521039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBC083690>]}
[0m18:34:24.522001 [info ] [Thread-1 (]: 12 of 12 OK created sql incremental model mart.mrt_bing_ads_basic_campaign_stats  [[32mMERGE (0.0 rows, 387.5 KiB processed)[0m in 5.32s]
[0m18:34:24.523042 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m18:34:27.641461 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (execute): 18:34:17.712449 => 18:34:27.641461
[0m18:34:27.642458 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfc5205-b887-4e49-ab6e-d67bcec465b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBE105710>]}
[0m18:34:27.643459 [info ] [Thread-4 (]: 11 of 12 OK created sql table model mart.mrt_metainformation_campaigns ......... [[32mCREATE TABLE (2.2k rows, 711.7 MiB processed)[0m in 9.95s]
[0m18:34:27.644452 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_metainformation_campaigns
[0m18:34:27.647445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:27.647445 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:34:27.648444 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:34:27.648444 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:34:27.649450 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:34:27.649450 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m18:34:27.650439 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m18:34:27.650439 [debug] [MainThread]: Connection 'model.bq_evo.mrt_bing_ads_basic_campaign_stats' was properly closed.
[0m18:34:27.651436 [debug] [MainThread]: Connection 'model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names' was properly closed.
[0m18:34:27.652433 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance' was properly closed.
[0m18:34:27.652433 [debug] [MainThread]: Connection 'model.bq_evo.mrt_metainformation_campaigns' was properly closed.
[0m18:34:27.653431 [info ] [MainThread]: 
[0m18:34:27.654428 [info ] [MainThread]: Finished running 7 incremental models, 4 view models, 1 table model in 0 hours 0 minutes and 24.55 seconds (24.55s).
[0m18:34:27.657420 [debug] [MainThread]: Command end result
[0m18:34:27.670897 [info ] [MainThread]: 
[0m18:34:27.671902 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:34:27.672892 [info ] [MainThread]: 
[0m18:34:27.673890 [error] [MainThread]:   Database Error in model mrt_linkedin_basic_campaign_stats (models\mart\single_source_data\linkedin\mrt_linkedin_basic_campaign_stats.sql)
  No matching signature for operator >= for argument types: TIMESTAMP, DATE. Supported signature: ANY >= ANY at [27:7]
[0m18:34:27.674887 [info ] [MainThread]: 
[0m18:34:27.675884 [error] [MainThread]:   Runtime Error in model mrt_meta_basic_campaign_stats (models\mart\single_source_data\meta\mrt_meta_basic_campaign_stats.sql)
  404 Not found: Table oss-big-query-dashboard-prod:intermediate.int_meta_campaign_stats_joined_campaign_names was not found in location europe-west3
  
  Location: europe-west3
  Job ID: c09c27f6-c018-4056-94c7-10d7fcd88c5b
  
[0m18:34:27.677879 [info ] [MainThread]: 
[0m18:34:27.678876 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m18:34:27.679874 [debug] [MainThread]: Command `dbt run` failed at 18:34:27.679874 after 25.20 seconds
[0m18:34:27.680871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBC339450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBCB5BC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBC05A790>]}
[0m18:34:27.680871 [debug] [MainThread]: Flushing usage events
[0m18:34:39.025201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6EF5B450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6EE0FE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6F00B150>]}


============================== 18:34:39.028194 | e1488335-e264-463a-b0ce-7442b0d2dd65 ==============================
[0m18:34:39.028194 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:34:39.030164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m *linkedin*', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:34:39.372352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1488335-e264-463a-b0ce-7442b0d2dd65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6FB3EC90>]}
[0m18:34:39.380330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1488335-e264-463a-b0ce-7442b0d2dd65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B70B39BD0>]}
[0m18:34:39.381326 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:34:39.432523 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:34:39.532624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:39.533623 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:39.540602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1488335-e264-463a-b0ce-7442b0d2dd65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B70B8EE90>]}
[0m18:34:39.559552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1488335-e264-463a-b0ce-7442b0d2dd65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B70B99690>]}
[0m18:34:39.560518 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:34:39.560518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1488335-e264-463a-b0ce-7442b0d2dd65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B70136850>]}
[0m18:34:39.563543 [info ] [MainThread]: 
[0m18:34:39.564539 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:34:39.566501 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:34:39.566501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:39.567531 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:34:39.568531 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:34:39.569507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:39.569507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:42.207607 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m18:34:42.208583 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:34:42.209580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:42.210545 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m18:34:42.210545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:42.213561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:42.844488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1488335-e264-463a-b0ce-7442b0d2dd65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6E647D90>]}
[0m18:34:42.845456 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:34:42.846454 [info ] [MainThread]: 
[0m18:34:42.850823 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:34:42.851327 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_linkedin_campaign_history
[0m18:34:42.851327 [info ] [Thread-1 (]: 1 of 5 START sql view model staging.stg_linkedin_ad_analytics_by_campaign ...... [RUN]
[0m18:34:42.853324 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign'
[0m18:34:42.852328 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_linkedin_campaign_history .............. [RUN]
[0m18:34:42.854322 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:34:42.855320 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_campaign_history'
[0m18:34:42.863300 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:34:42.864587 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_linkedin_campaign_history
[0m18:34:42.868579 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:34:42.869578 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (compile): 18:34:42.856317 => 18:34:42.869578
[0m18:34:42.870575 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:34:42.872575 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (compile): 18:34:42.865588 => 18:34:42.871573
[0m18:34:42.904989 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:34:42.905952 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_linkedin_campaign_history
[0m18:34:42.909974 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:34:42.910935 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:42.911935 [debug] [Thread-1 (]: On model.bq_evo.stg_linkedin_ad_analytics_by_campaign: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Linkedin-Kampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS (
    SELECT *    
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`ad_analytics_by_campaign`
),

_renamed_columns AS (
    SELECT
        campaign_id,
        day as Date,
        _fivetran_synced,
        action_clicks,
        ad_unit_clicks,
        approximate_unique_impressions,
        card_clicks,
        card_impressions,
        clicks as Clicks,
        comment_likes,
        comments,
        company_page_clicks,
        conversion_value_in_local_currency,
        cost_in_local_currency as Cost,
        cost_in_usd,
        external_website_conversions,
        external_website_post_click_conversions,
        external_website_post_view_conversions,
        follows,
        full_screen_plays,
        impressions as Impressions,
        landing_page_clicks,
        lead_generation_mail_contact_info_shares,
        lead_generation_mail_interested_clicks,
        likes,
        one_click_lead_form_opens,
        one_click_leads,
        opens,
        other_engagements,
        sends,
        shares,
        text_url_clicks,
        total_engagements,
        video_completions,
        video_first_quartile_completions,
        video_midpoint_completions,
        video_starts,
        video_third_quartile_completions,
        video_views,
        viral_card_clicks,
        viral_card_impressions,
        viral_clicks,
        viral_comment_likes,
        viral_comments,
        viral_company_page_clicks,
        viral_external_website_conversions,
        viral_external_website_post_click_conversions,
        viral_external_website_post_view_conversions,
        viral_follows,
        viral_full_screen_plays,
        viral_impressions,
        viral_landing_page_clicks,
        viral_likes,
        viral_one_click_lead_form_opens,
        viral_one_click_leads,
        viral_other_engagements,
        viral_shares,
        viral_total_engagements,
        viral_video_completions,
        viral_video_first_quartile_completions,
        viral_video_midpoint_completions,
        viral_video_starts,
        viral_video_third_quartile_completions,
        viral_video_views
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:34:42.914001 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:34:42.914994 [debug] [Thread-2 (]: On model.bq_evo.stg_linkedin_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`campaign_history`
),

_renamed_columns AS(
    SELECT
        id,
        last_modified_time,
        _fivetran_synced,
        account_id,
        associated_entity,
        audience_expansion_enabled,
        campaign_group_id,
        cost_type,
        created_time,
        creative_selection,
        daily_budget_amount,
        daily_budget_currency_code,
        format,
        locale_country,
        locale_language,
        name as Campaign,
        objective_type,
        offsite_delivery_enabled,
        optimization_target_type,
        run_schedule_end,
        run_schedule_start,
        status,
        type,
        unit_cost_amount,
        unit_cost_currency_code,
        version_tag
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:34:43.625796 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2b1390f8-a2cc-4452-bafd-4f20858fcd0a&page=queryresults
[0m18:34:43.626794 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:70504f04-7cbc-4a6f-b288-36113660195f&page=queryresults
[0m18:34:43.821835 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (execute): 18:34:42.872575 => 18:34:43.821835
[0m18:34:43.822834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1488335-e264-463a-b0ce-7442b0d2dd65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B70B385D0>]}
[0m18:34:43.823831 [info ] [Thread-1 (]: 1 of 5 OK created sql view model staging.stg_linkedin_ad_analytics_by_campaign . [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m18:34:43.825825 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:34:44.048642 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (execute): 18:34:42.906961 => 18:34:44.048642
[0m18:34:44.049627 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1488335-e264-463a-b0ce-7442b0d2dd65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B70B4D890>]}
[0m18:34:44.050624 [info ] [Thread-2 (]: 2 of 5 OK created sql view model staging.stg_linkedin_campaign_history ......... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m18:34:44.051669 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_linkedin_campaign_history
[0m18:34:44.052619 [debug] [Thread-4 (]: Began running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:34:44.053648 [info ] [Thread-4 (]: 3 of 5 START sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [RUN]
[0m18:34:44.055611 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information'
[0m18:34:44.055611 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:34:44.058602 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:34:44.060599 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (compile): 18:34:44.056624 => 18:34:44.059633
[0m18:34:44.060599 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:34:44.064588 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:34:44.066585 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:34:44.066585 [debug] [Thread-4 (]: On model.bq_evo.int_linkedin_unique_campaigns_reduced_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Linkedin-Kampagnen - gg\u00fc. Quelldaten nur ausgew\u00e4hlte Spalten f\u00fcr Weiterverarbeitung NDG."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
),

_selected_columns AS (
    SELECT
        id as campaign_id,
        Campaign, 
        "EVO" as Partner, 
        "cpc" as Medium, 
        "linkedin" as Source, 
        LOWER(CONCAT(Campaign, "linkedin", "cpc", "EVO")) AS CampaignID 
    
    FROM _raw
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _selected_columns
)

SELECT * FROM _final;


[0m18:34:44.702114 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:47d3383c-113b-4ef8-8ec5-6d9200fc08d6&page=queryresults
[0m18:34:45.120103 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (execute): 18:34:44.061595 => 18:34:45.120103
[0m18:34:45.122064 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1488335-e264-463a-b0ce-7442b0d2dd65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B70F7AB90>]}
[0m18:34:45.122064 [info ] [Thread-4 (]: 3 of 5 OK created sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m18:34:45.124093 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:34:45.125066 [debug] [Thread-1 (]: Began running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:34:45.125066 [info ] [Thread-1 (]: 4 of 5 START sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [RUN]
[0m18:34:45.127051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_linkedin_ad_analytics_by_campaign, now model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names)
[0m18:34:45.127051 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:34:45.131074 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:34:45.132036 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (compile): 18:34:45.128081 => 18:34:45.132036
[0m18:34:45.133034 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:34:45.136026 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:34:45.138020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:45.139018 [debug] [Thread-1 (]: On model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.campaign_id = _raw_performance.campaign_id
),

_final AS(
    SELECT * EXCEPT (campaign_id)
    FROM _joined
)

SELECT * FROM _final;


[0m18:34:45.805253 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5596ae7f-6900-4faa-9ec3-451d3330fb9f&page=queryresults
[0m18:34:46.199404 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (execute): 18:34:45.134032 => 18:34:46.198404
[0m18:34:46.200367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1488335-e264-463a-b0ce-7442b0d2dd65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B70F79610>]}
[0m18:34:46.201119 [info ] [Thread-1 (]: 4 of 5 OK created sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m18:34:46.201842 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:34:46.203840 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:34:46.203840 [info ] [Thread-3 (]: 5 of 5 START sql incremental model mart.mrt_linkedin_basic_campaign_stats ...... [RUN]
[0m18:34:46.205836 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_linkedin_basic_campaign_stats'
[0m18:34:46.206832 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:34:46.214843 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_linkedin_basic_campaign_stats"
[0m18:34:46.216814 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (compile): 18:34:46.206832 => 18:34:46.216814
[0m18:34:46.217811 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:34:46.278644 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:34:46.279698 [debug] [Thread-3 (]: On model.bq_evo.mrt_linkedin_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_linkedin_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der LinkedinKampagnen.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`

    

      WHERE
      --Update table for the past seven days + today
      Date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:34:46.994472 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:dfd5a81d-c882-4fd4-9c37-801a18abbc53&page=queryresults
[0m18:34:47.140019 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator >= for argument types: TIMESTAMP, DATE. Supported signature: ANY >= ANY at [27:7]')
[0m18:34:48.110366 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:91949d59-00ae-4596-937f-536adb0fb286&page=queryresults
[0m18:34:48.260649 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:91949d59-00ae-4596-937f-536adb0fb286&page=queryresults
[0m18:34:48.264578 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (execute): 18:34:46.217811 => 18:34:48.263581
[0m18:34:48.273586 [debug] [Thread-3 (]: Database Error in model mrt_linkedin_basic_campaign_stats (models\mart\single_source_data\linkedin\mrt_linkedin_basic_campaign_stats.sql)
  No matching signature for operator >= for argument types: TIMESTAMP, DATE. Supported signature: ANY >= ANY at [27:7]
[0m18:34:48.274548 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1488335-e264-463a-b0ce-7442b0d2dd65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B71026090>]}
[0m18:34:48.275546 [error] [Thread-3 (]: 5 of 5 ERROR creating sql incremental model mart.mrt_linkedin_basic_campaign_stats  [[31mERROR[0m in 2.07s]
[0m18:34:48.276544 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:34:48.279584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:48.280574 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:34:48.280574 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:34:48.281537 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:34:48.282533 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m18:34:48.282533 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:34:48.284274 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m18:34:48.284274 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names' was properly closed.
[0m18:34:48.285291 [debug] [MainThread]: Connection 'model.bq_evo.stg_linkedin_campaign_history' was properly closed.
[0m18:34:48.285291 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information' was properly closed.
[0m18:34:48.286305 [debug] [MainThread]: Connection 'model.bq_evo.mrt_linkedin_basic_campaign_stats' was properly closed.
[0m18:34:48.286305 [info ] [MainThread]: 
[0m18:34:48.287268 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 8.72 seconds (8.72s).
[0m18:34:48.289265 [debug] [MainThread]: Command end result
[0m18:34:48.303960 [info ] [MainThread]: 
[0m18:34:48.304970 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:34:48.306622 [info ] [MainThread]: 
[0m18:34:48.306622 [error] [MainThread]:   Database Error in model mrt_linkedin_basic_campaign_stats (models\mart\single_source_data\linkedin\mrt_linkedin_basic_campaign_stats.sql)
  No matching signature for operator >= for argument types: TIMESTAMP, DATE. Supported signature: ANY >= ANY at [27:7]
[0m18:34:48.307622 [info ] [MainThread]: 
[0m18:34:48.309618 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m18:34:48.310615 [debug] [MainThread]: Command `dbt run` failed at 18:34:48.310615 after 9.30 seconds
[0m18:34:48.311642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6FA5DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6F43EC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6F43EE90>]}
[0m18:34:48.311642 [debug] [MainThread]: Flushing usage events
[0m18:43:01.816262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE0393A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE034EEF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE039ED690>]}


============================== 18:43:01.820250 | 6f8d3912-c47e-45ae-abb8-1abe9514396a ==============================
[0m18:43:01.820250 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:43:01.821249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m *linkedin*', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:43:02.172303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f8d3912-c47e-45ae-abb8-1abe9514396a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE05247ED0>]}
[0m18:43:02.180779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f8d3912-c47e-45ae-abb8-1abe9514396a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE0497E350>]}
[0m18:43:02.181821 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:43:02.230362 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:43:02.339579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:43:02.340576 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql
[0m18:43:02.393741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f8d3912-c47e-45ae-abb8-1abe9514396a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE05280890>]}
[0m18:43:02.416647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f8d3912-c47e-45ae-abb8-1abe9514396a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE054BFF10>]}
[0m18:43:02.416647 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:43:02.417644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f8d3912-c47e-45ae-abb8-1abe9514396a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE04648690>]}
[0m18:43:02.420669 [info ] [MainThread]: 
[0m18:43:02.421672 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:43:02.422632 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:43:02.423629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:02.424652 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:43:02.425622 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:43:02.426620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:02.426620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:05.220941 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:43:05.221935 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m18:43:05.221935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:05.223099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m18:43:05.224015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:05.226479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:05.877909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f8d3912-c47e-45ae-abb8-1abe9514396a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE03857390>]}
[0m18:43:05.879850 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:43:05.879850 [info ] [MainThread]: 
[0m18:43:05.884871 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:43:05.884871 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_linkedin_campaign_history
[0m18:43:05.885871 [info ] [Thread-1 (]: 1 of 5 START sql view model staging.stg_linkedin_ad_analytics_by_campaign ...... [RUN]
[0m18:43:05.886393 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_linkedin_campaign_history .............. [RUN]
[0m18:43:05.888426 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign'
[0m18:43:05.889388 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_campaign_history'
[0m18:43:05.890386 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:43:05.891382 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_linkedin_campaign_history
[0m18:43:05.899363 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:43:05.903385 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:43:05.905344 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (compile): 18:43:05.891382 => 18:43:05.904348
[0m18:43:05.906343 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (compile): 18:43:05.900363 => 18:43:05.906343
[0m18:43:05.907340 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:43:05.908336 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_linkedin_campaign_history
[0m18:43:05.940287 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:43:05.943243 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:43:05.945239 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:43:05.946237 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:43:05.947234 [debug] [Thread-1 (]: On model.bq_evo.stg_linkedin_ad_analytics_by_campaign: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Linkedin-Kampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS (
    SELECT *    
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`ad_analytics_by_campaign`
),

_renamed_columns AS (
    SELECT
        campaign_id,
        day as Date,
        _fivetran_synced,
        action_clicks,
        ad_unit_clicks,
        approximate_unique_impressions,
        card_clicks,
        card_impressions,
        clicks as Clicks,
        comment_likes,
        comments,
        company_page_clicks,
        conversion_value_in_local_currency,
        cost_in_local_currency as Cost,
        cost_in_usd,
        external_website_conversions,
        external_website_post_click_conversions,
        external_website_post_view_conversions,
        follows,
        full_screen_plays,
        impressions as Impressions,
        landing_page_clicks,
        lead_generation_mail_contact_info_shares,
        lead_generation_mail_interested_clicks,
        likes,
        one_click_lead_form_opens,
        one_click_leads,
        opens,
        other_engagements,
        sends,
        shares,
        text_url_clicks,
        total_engagements,
        video_completions,
        video_first_quartile_completions,
        video_midpoint_completions,
        video_starts,
        video_third_quartile_completions,
        video_views,
        viral_card_clicks,
        viral_card_impressions,
        viral_clicks,
        viral_comment_likes,
        viral_comments,
        viral_company_page_clicks,
        viral_external_website_conversions,
        viral_external_website_post_click_conversions,
        viral_external_website_post_view_conversions,
        viral_follows,
        viral_full_screen_plays,
        viral_impressions,
        viral_landing_page_clicks,
        viral_likes,
        viral_one_click_lead_form_opens,
        viral_one_click_leads,
        viral_other_engagements,
        viral_shares,
        viral_total_engagements,
        viral_video_completions,
        viral_video_first_quartile_completions,
        viral_video_midpoint_completions,
        viral_video_starts,
        viral_video_third_quartile_completions,
        viral_video_views
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:43:05.948264 [debug] [Thread-2 (]: On model.bq_evo.stg_linkedin_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`campaign_history`
),

_renamed_columns AS(
    SELECT
        id,
        last_modified_time,
        _fivetran_synced,
        account_id,
        associated_entity,
        audience_expansion_enabled,
        campaign_group_id,
        cost_type,
        created_time,
        creative_selection,
        daily_budget_amount,
        daily_budget_currency_code,
        format,
        locale_country,
        locale_language,
        name as Campaign,
        objective_type,
        offsite_delivery_enabled,
        optimization_target_type,
        run_schedule_end,
        run_schedule_start,
        status,
        type,
        unit_cost_amount,
        unit_cost_currency_code,
        version_tag
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:43:06.733667 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:cb38bed6-48ed-4923-9322-a86808f86ee5&page=queryresults
[0m18:43:06.743564 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:30aada5c-cffb-465e-9e2d-02c28bc73ab8&page=queryresults
[0m18:43:06.962802 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (execute): 18:43:05.908336 => 18:43:06.961802
[0m18:43:06.964761 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (execute): 18:43:05.940287 => 18:43:06.964761
[0m18:43:06.965757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f8d3912-c47e-45ae-abb8-1abe9514396a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE053E3D90>]}
[0m18:43:06.967175 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f8d3912-c47e-45ae-abb8-1abe9514396a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE052F8F10>]}
[0m18:43:06.967175 [info ] [Thread-1 (]: 1 of 5 OK created sql view model staging.stg_linkedin_ad_analytics_by_campaign . [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m18:43:06.969169 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:43:06.968204 [info ] [Thread-2 (]: 2 of 5 OK created sql view model staging.stg_linkedin_campaign_history ......... [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m18:43:06.971100 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_linkedin_campaign_history
[0m18:43:06.972100 [debug] [Thread-4 (]: Began running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:43:06.973131 [info ] [Thread-4 (]: 3 of 5 START sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [RUN]
[0m18:43:06.974096 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information'
[0m18:43:06.974096 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:43:06.978085 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:43:06.979114 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (compile): 18:43:06.975127 => 18:43:06.979114
[0m18:43:06.980079 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:43:06.985067 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:43:06.987061 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:43:06.988057 [debug] [Thread-4 (]: On model.bq_evo.int_linkedin_unique_campaigns_reduced_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Linkedin-Kampagnen - gg\u00fc. Quelldaten nur ausgew\u00e4hlte Spalten f\u00fcr Weiterverarbeitung NDG."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
),

_selected_columns AS (
    SELECT
        id as campaign_id,
        Campaign, 
        "EVO" as Partner, 
        "cpc" as Medium, 
        "linkedin" as Source, 
        LOWER(CONCAT(Campaign, "linkedin", "cpc", "EVO")) AS CampaignID 
    
    FROM _raw
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _selected_columns
)

SELECT * FROM _final;


[0m18:43:07.657189 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4d333675-5d92-4d7f-a8aa-4fc23b6f4fb9&page=queryresults
[0m18:43:07.876066 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (execute): 18:43:06.981077 => 18:43:07.875066
[0m18:43:07.877027 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f8d3912-c47e-45ae-abb8-1abe9514396a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE05364D50>]}
[0m18:43:07.879058 [info ] [Thread-4 (]: 3 of 5 OK created sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m18:43:07.881017 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:43:07.883011 [debug] [Thread-1 (]: Began running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:43:07.884010 [info ] [Thread-1 (]: 4 of 5 START sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [RUN]
[0m18:43:07.886385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_linkedin_ad_analytics_by_campaign, now model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names)
[0m18:43:07.887384 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:43:07.892410 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:43:07.893407 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (compile): 18:43:07.888423 => 18:43:07.893407
[0m18:43:07.895368 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:43:07.899394 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:43:07.901351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:07.901351 [debug] [Thread-1 (]: On model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.campaign_id = _raw_performance.campaign_id
),

_drop_campaign_id AS(
    SELECT * EXCEPT (campaign_id)
    FROM _joined
),

_final AS(
    SELECT 
        * EXCEPT(Date),
        CAST(Date AS DATE) as Date
)

SELECT * FROM _final;


[0m18:43:08.617894 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ca589478-8aa4-4ade-86d1-33cd9a6600db&page=queryresults
[0m18:43:08.758882 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT * must have a FROM clause at [31:9]')
[0m18:43:10.015559 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4d6de97c-38ce-4e0a-b6e9-c18552c2d156&page=queryresults
[0m18:43:10.163520 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4d6de97c-38ce-4e0a-b6e9-c18552c2d156&page=queryresults
[0m18:43:10.168443 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (execute): 18:43:07.895368 => 18:43:10.167452
[0m18:43:10.179964 [debug] [Thread-1 (]: Database Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  SELECT * must have a FROM clause at [31:9]
  compiled Code at target\run\bq_evo\models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql
[0m18:43:10.179964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f8d3912-c47e-45ae-abb8-1abe9514396a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE0557B950>]}
[0m18:43:10.180927 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [[31mERROR[0m in 2.29s]
[0m18:43:10.181924 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:43:10.183922 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:43:10.183922 [info ] [Thread-3 (]: 5 of 5 SKIP relation mart.mrt_linkedin_basic_campaign_stats .................... [[33mSKIP[0m]
[0m18:43:10.184917 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:43:10.186913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:10.187943 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:43:10.187943 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:43:10.189148 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:43:10.189148 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:43:10.190148 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m18:43:10.190148 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m18:43:10.191146 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names' was properly closed.
[0m18:43:10.191146 [debug] [MainThread]: Connection 'model.bq_evo.stg_linkedin_campaign_history' was properly closed.
[0m18:43:10.192582 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information' was properly closed.
[0m18:43:10.192582 [info ] [MainThread]: 
[0m18:43:10.193582 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 7.77 seconds (7.77s).
[0m18:43:10.195602 [debug] [MainThread]: Command end result
[0m18:43:10.209541 [info ] [MainThread]: 
[0m18:43:10.210538 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:43:10.210538 [info ] [MainThread]: 
[0m18:43:10.211535 [error] [MainThread]:   Database Error in model int_linkedin_campaign_stats_joined_campaign_names (models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql)
  SELECT * must have a FROM clause at [31:9]
  compiled Code at target\run\bq_evo\models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql
[0m18:43:10.212532 [info ] [MainThread]: 
[0m18:43:10.213528 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m18:43:10.214526 [debug] [MainThread]: Command `dbt run` failed at 18:43:10.214526 after 8.41 seconds
[0m18:43:10.215526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE03F5B310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE03F68450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE03F69090>]}
[0m18:43:10.216524 [debug] [MainThread]: Flushing usage events
[0m18:43:29.643221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CB773410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CBD0D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CC138050>]}


============================== 18:43:29.647209 | 1cb0d4e5-ef37-4b06-bf85-b4cb32bc0ec7 ==============================
[0m18:43:29.647209 [info ] [MainThread]: Running with dbt=1.6.2
[0m18:43:29.647828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m *linkedin*', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:43:29.992775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cb0d4e5-ef37-4b06-bf85-b4cb32bc0ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CD3493D0>]}
[0m18:43:30.000722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cb0d4e5-ef37-4b06-bf85-b4cb32bc0ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CB7707D0>]}
[0m18:43:30.002716 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m18:43:30.054187 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m18:43:30.154540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:43:30.155536 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\linkedin\int_linkedin_campaign_stats_joined_campaign_names.sql
[0m18:43:30.205884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cb0d4e5-ef37-4b06-bf85-b4cb32bc0ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CD6E9290>]}
[0m18:43:30.224836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cb0d4e5-ef37-4b06-bf85-b4cb32bc0ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CD66B790>]}
[0m18:43:30.225835 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m18:43:30.226880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cb0d4e5-ef37-4b06-bf85-b4cb32bc0ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CC915250>]}
[0m18:43:30.228858 [info ] [MainThread]: 
[0m18:43:30.229857 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:43:30.231817 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:43:30.231817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:30.232852 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:43:30.233811 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m18:43:30.234811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:30.234811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:32.866172 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m18:43:32.868165 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m18:43:32.868165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:32.870127 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m18:43:32.871122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:32.875112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:33.517692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cb0d4e5-ef37-4b06-bf85-b4cb32bc0ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CC298210>]}
[0m18:43:33.517692 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:43:33.518723 [info ] [MainThread]: 
[0m18:43:33.523692 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:43:33.523692 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_linkedin_campaign_history
[0m18:43:33.524692 [info ] [Thread-1 (]: 1 of 5 START sql view model staging.stg_linkedin_ad_analytics_by_campaign ...... [RUN]
[0m18:43:33.525689 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_linkedin_campaign_history .............. [RUN]
[0m18:43:33.526687 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_ad_analytics_by_campaign'
[0m18:43:33.527684 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_linkedin_campaign_history'
[0m18:43:33.528682 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:43:33.528682 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_linkedin_campaign_history
[0m18:43:33.538657 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:43:33.541683 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:43:33.542644 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (compile): 18:43:33.529678 => 18:43:33.542644
[0m18:43:33.543642 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (compile): 18:43:33.538657 => 18:43:33.543642
[0m18:43:33.544639 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:43:33.545635 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_linkedin_campaign_history
[0m18:43:33.577550 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m18:43:33.581575 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_campaign_history"
[0m18:43:33.582537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:43:33.583534 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:43:33.583534 [debug] [Thread-1 (]: On model.bq_evo.stg_linkedin_ad_analytics_by_campaign: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Linkedin-Kampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS (
    SELECT *    
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`ad_analytics_by_campaign`
),

_renamed_columns AS (
    SELECT
        campaign_id,
        day as Date,
        _fivetran_synced,
        action_clicks,
        ad_unit_clicks,
        approximate_unique_impressions,
        card_clicks,
        card_impressions,
        clicks as Clicks,
        comment_likes,
        comments,
        company_page_clicks,
        conversion_value_in_local_currency,
        cost_in_local_currency as Cost,
        cost_in_usd,
        external_website_conversions,
        external_website_post_click_conversions,
        external_website_post_view_conversions,
        follows,
        full_screen_plays,
        impressions as Impressions,
        landing_page_clicks,
        lead_generation_mail_contact_info_shares,
        lead_generation_mail_interested_clicks,
        likes,
        one_click_lead_form_opens,
        one_click_leads,
        opens,
        other_engagements,
        sends,
        shares,
        text_url_clicks,
        total_engagements,
        video_completions,
        video_first_quartile_completions,
        video_midpoint_completions,
        video_starts,
        video_third_quartile_completions,
        video_views,
        viral_card_clicks,
        viral_card_impressions,
        viral_clicks,
        viral_comment_likes,
        viral_comments,
        viral_company_page_clicks,
        viral_external_website_conversions,
        viral_external_website_post_click_conversions,
        viral_external_website_post_view_conversions,
        viral_follows,
        viral_full_screen_plays,
        viral_impressions,
        viral_landing_page_clicks,
        viral_likes,
        viral_one_click_lead_form_opens,
        viral_one_click_leads,
        viral_other_engagements,
        viral_shares,
        viral_total_engagements,
        viral_video_completions,
        viral_video_first_quartile_completions,
        viral_video_midpoint_completions,
        viral_video_starts,
        viral_video_third_quartile_completions,
        viral_video_views
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:43:33.584533 [debug] [Thread-2 (]: On model.bq_evo.stg_linkedin_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`campaign_history`
),

_renamed_columns AS(
    SELECT
        id,
        last_modified_time,
        _fivetran_synced,
        account_id,
        associated_entity,
        audience_expansion_enabled,
        campaign_group_id,
        cost_type,
        created_time,
        creative_selection,
        daily_budget_amount,
        daily_budget_currency_code,
        format,
        locale_country,
        locale_language,
        name as Campaign,
        objective_type,
        offsite_delivery_enabled,
        optimization_target_type,
        run_schedule_end,
        run_schedule_start,
        status,
        type,
        unit_cost_amount,
        unit_cost_currency_code,
        version_tag
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m18:43:34.280735 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3b9f4aa7-cd41-4ce1-8444-b50aa45fb22d&page=queryresults
[0m18:43:34.287343 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c672b1e2-552c-415a-b2f9-29d6282bb673&page=queryresults
[0m18:43:34.457734 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (execute): 18:43:33.545635 => 18:43:34.457734
[0m18:43:34.458699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb0d4e5-ef37-4b06-bf85-b4cb32bc0ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CD3EDBD0>]}
[0m18:43:34.459696 [info ] [Thread-1 (]: 1 of 5 OK created sql view model staging.stg_linkedin_ad_analytics_by_campaign . [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m18:43:34.460708 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m18:43:34.469294 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (execute): 18:43:33.578583 => 18:43:34.468299
[0m18:43:34.470291 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb0d4e5-ef37-4b06-bf85-b4cb32bc0ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CD3F6150>]}
[0m18:43:34.471286 [info ] [Thread-2 (]: 2 of 5 OK created sql view model staging.stg_linkedin_campaign_history ......... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m18:43:34.473287 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_linkedin_campaign_history
[0m18:43:34.474282 [debug] [Thread-4 (]: Began running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:43:34.475278 [info ] [Thread-4 (]: 3 of 5 START sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [RUN]
[0m18:43:34.477272 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information'
[0m18:43:34.477990 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:43:34.480329 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:43:34.482290 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (compile): 18:43:34.477990 => 18:43:34.481328
[0m18:43:34.483289 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:43:34.488277 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m18:43:34.490270 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:43:34.491269 [debug] [Thread-4 (]: On model.bq_evo.int_linkedin_unique_campaigns_reduced_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Linkedin-Kampagnen - gg\u00fc. Quelldaten nur ausgew\u00e4hlte Spalten f\u00fcr Weiterverarbeitung NDG."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
),

_selected_columns AS (
    SELECT
        id as campaign_id,
        Campaign, 
        "EVO" as Partner, 
        "cpc" as Medium, 
        "linkedin" as Source, 
        LOWER(CONCAT(Campaign, "linkedin", "cpc", "EVO")) AS CampaignID 
    
    FROM _raw
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _selected_columns
)

SELECT * FROM _final;


[0m18:43:35.114653 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5d716ee6-3ef7-444c-be66-4f57ab363d47&page=queryresults
[0m18:43:35.285310 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (execute): 18:43:34.483289 => 18:43:35.285310
[0m18:43:35.286307 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb0d4e5-ef37-4b06-bf85-b4cb32bc0ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CD3EE610>]}
[0m18:43:35.287272 [info ] [Thread-4 (]: 3 of 5 OK created sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m18:43:35.289266 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m18:43:35.291261 [debug] [Thread-1 (]: Began running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:43:35.291261 [info ] [Thread-1 (]: 4 of 5 START sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [RUN]
[0m18:43:35.293271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_linkedin_ad_analytics_by_campaign, now model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names)
[0m18:43:35.293271 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:43:35.297247 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:43:35.299256 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (compile): 18:43:35.294274 => 18:43:35.299256
[0m18:43:35.300257 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:43:35.303280 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m18:43:35.304279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:35.305271 [debug] [Thread-1 (]: On model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.campaign_id = _raw_performance.campaign_id
),

_drop_campaign_id AS(
    SELECT * EXCEPT (campaign_id)
    FROM _joined
),

_final AS(
    SELECT 
        * EXCEPT(Date),
        CAST(Date AS DATE) as Date
    FROM _drop_campaign_id
)

SELECT * FROM _final;


[0m18:43:35.941817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2085f2d3-d5d3-41c2-817a-dacf8ac0f00e&page=queryresults
[0m18:43:36.366578 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (execute): 18:43:35.300257 => 18:43:36.365584
[0m18:43:36.367548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb0d4e5-ef37-4b06-bf85-b4cb32bc0ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CD897AD0>]}
[0m18:43:36.367548 [info ] [Thread-1 (]: 4 of 5 OK created sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m18:43:36.369551 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m18:43:36.370538 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:43:36.371531 [info ] [Thread-3 (]: 5 of 5 START sql incremental model mart.mrt_linkedin_basic_campaign_stats ...... [RUN]
[0m18:43:36.372528 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.mrt_linkedin_basic_campaign_stats'
[0m18:43:36.372528 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:43:36.381504 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_linkedin_basic_campaign_stats"
[0m18:43:36.383499 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (compile): 18:43:36.373526 => 18:43:36.382502
[0m18:43:36.383499 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:43:36.441855 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:43:36.442852 [debug] [Thread-3 (]: On model.bq_evo.mrt_linkedin_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_linkedin_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der LinkedinKampagnen.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`

    

      WHERE
      --Update table for the past seven days + today
      Date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m18:43:37.156024 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7dfe727f-dcd8-461d-9264-a11c65e469de&page=queryresults
[0m18:43:38.941025 [debug] [Thread-3 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats`:
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'Date', 'new_type': 'DATE'}]
  
[0m18:43:39.067834 [debug] [Thread-3 (]: On model.bq_evo.mrt_linkedin_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_linkedin_basic_campaign_stats"} */

    
  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der LinkedinKampagnen."""
    )
    as (
      
    select
          CAST(`Date` AS DATE) AS `Date`,
          `Campaign`,
          `CampaignID`,
          `Source`,
          `Medium`,
          `Partner`,
          `Keyword`,
          `KeywordMatchType`,
          `Impressions`,
          `Clicks`,
          `Cost`
    from `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats`
  
    );
  
[0m18:43:39.270796 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:fc4a81d3-80af-417b-b73c-b635539a4c74&page=queryresults
[0m18:43:40.589078 [debug] [Thread-3 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats`:
        Schema change approach: sync_all_columns
        Columns added: []
        Columns removed: []
        Data types changed: [{'column_name': 'Date', 'new_type': 'DATE'}]
  
[0m18:43:40.613087 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_linkedin_basic_campaign_stats"
[0m18:43:40.614050 [debug] [Thread-3 (]: On model.bq_evo.mrt_linkedin_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_linkedin_basic_campaign_stats"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.Date = DBT_INTERNAL_DEST.Date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m18:43:40.847147 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:87d1df44-3780-48f1-9563-6434237577d1&page=queryresults
[0m18:43:42.622652 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (execute): 18:43:36.384497 => 18:43:42.622652
[0m18:43:42.623651 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb0d4e5-ef37-4b06-bf85-b4cb32bc0ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CD79A250>]}
[0m18:43:42.624649 [info ] [Thread-3 (]: 5 of 5 OK created sql incremental model mart.mrt_linkedin_basic_campaign_stats . [[32mMERGE (0.0 rows, 63.2 KiB processed)[0m in 6.25s]
[0m18:43:42.625647 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m18:43:42.627641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:42.628663 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:43:42.628663 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:43:42.628663 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m18:43:42.630170 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m18:43:42.630170 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m18:43:42.631171 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m18:43:42.631171 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names' was properly closed.
[0m18:43:42.632167 [debug] [MainThread]: Connection 'model.bq_evo.stg_linkedin_campaign_history' was properly closed.
[0m18:43:42.633165 [debug] [MainThread]: Connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information' was properly closed.
[0m18:43:42.633165 [debug] [MainThread]: Connection 'model.bq_evo.mrt_linkedin_basic_campaign_stats' was properly closed.
[0m18:43:42.634174 [info ] [MainThread]: 
[0m18:43:42.634174 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 12.40 seconds (12.40s).
[0m18:43:42.637155 [debug] [MainThread]: Command end result
[0m18:43:42.656104 [info ] [MainThread]: 
[0m18:43:42.657102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:43:42.658184 [info ] [MainThread]: 
[0m18:43:42.659188 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:43:42.660184 [debug] [MainThread]: Command `dbt run` succeeded at 18:43:42.660184 after 13.03 seconds
[0m18:43:42.660184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CBC3CD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9CB82C150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C6027150>]}
[0m18:43:42.661180 [debug] [MainThread]: Flushing usage events
[0m08:40:49.080601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EF1DB550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EF50B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EF013450>]}


============================== 08:40:49.098372 | b6933a5f-aeeb-4e58-956d-81defc3ec8e1 ==============================
[0m08:40:49.098372 [info ] [MainThread]: Running with dbt=1.6.2
[0m08:40:49.099852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:40:51.045978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0B3C050>]}
[0m08:40:51.053957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EF8D0F50>]}
[0m08:40:51.059585 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m08:40:51.118515 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m08:40:51.889830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:40:51.889830 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:40:51.897812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0E9C2D0>]}
[0m08:40:51.923739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0728F10>]}
[0m08:40:51.923739 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m08:40:51.924777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0287290>]}
[0m08:40:51.927729 [info ] [MainThread]: 
[0m08:40:51.929724 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:40:51.931755 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:40:51.932716 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:40:51.933737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:51.934710 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:40:51.934710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:51.936705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:55.726445 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m08:40:55.727445 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m08:40:55.728482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:55.730480 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m08:40:55.730480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:55.734427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:56.475055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0710090>]}
[0m08:40:56.476056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:40:56.476056 [info ] [MainThread]: 
[0m08:40:56.491578 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_bing_ads_campaign_history
[0m08:40:56.491578 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m08:40:56.492611 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_google_ads_campaign_history
[0m08:40:56.492611 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m08:40:56.493658 [info ] [Thread-1 (]: 1 of 32 START sql view model staging.stg_bing_ads_campaign_history ............. [RUN]
[0m08:40:56.494145 [info ] [Thread-2 (]: 2 of 32 START sql view model staging.stg_bing_ads_campaign_performance_daily_report  [RUN]
[0m08:40:56.495170 [info ] [Thread-3 (]: 3 of 32 START sql view model staging.stg_google_ads_campaign_history ........... [RUN]
[0m08:40:56.496145 [info ] [Thread-4 (]: 4 of 32 START sql view model staging.stg_google_ads_campaign_stats ............. [RUN]
[0m08:40:56.497142 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_history'
[0m08:40:56.499135 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_performance_daily_report'
[0m08:40:56.500132 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_history'
[0m08:40:56.501138 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m08:40:56.502130 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_history
[0m08:40:56.503142 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m08:40:56.504136 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_history
[0m08:40:56.504136 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m08:40:56.513129 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m08:40:56.516089 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m08:40:56.519281 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_history"
[0m08:40:56.523307 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m08:40:56.525284 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (compile): 08:40:56.505127 => 08:40:56.525284
[0m08:40:56.527265 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (compile): 08:40:56.514128 => 08:40:56.526265
[0m08:40:56.528262 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (compile): 08:40:56.517283 => 08:40:56.528262
[0m08:40:56.529255 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_history
[0m08:40:56.530253 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 08:40:56.520280 => 08:40:56.529255
[0m08:40:56.530253 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m08:40:56.531251 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_google_ads_campaign_history
[0m08:40:56.564235 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m08:40:56.565233 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m08:40:56.568191 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m08:40:56.572286 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_history"
[0m08:40:56.576263 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m08:40:56.576263 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:40:56.578771 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:40:56.579768 [debug] [Thread-1 (]: On model.bq_evo.stg_bing_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_history`
),


_added_columns AS (
    SELECT
        *,
        'cpc' as Medium,
        'bing' as Source,
        (CASE 
            WHEN account_id = 156001989 THEN 'EVO'
        END) as Partner,
    FROM _raw
),

_added_campaignid AS (
    SELECT 
        *,
        LOWER (CONCAT(name, Source, Medium, Partner)) as CampaignID
    FROM _added_columns
),

_final AS(
    SELECT *
    FROM _added_campaignid
)

SELECT * FROM _final;


[0m08:40:56.579768 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:40:56.580765 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:40:56.580765 [debug] [Thread-2 (]: On model.bq_evo.stg_bing_ads_campaign_performance_daily_report: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_performance_daily_report`
),

_renamed_columns AS(
    SELECT 
        _fivetran_id,
        _fivetran_synced,
        account_id,
        ad_distribution,
        ad_relevance,
        all_conversions,
        all_conversions_qualified,
        all_return_on_ad_spend,
        all_revenue,
        assists,
        average_cpc,
        average_position,
        bid_match_type,
        budget_association_status,
        campaign_id,
        campaign_name,
        campaign_status,
        clicks as Clicks,
        conversions,
        conversions_qualified,
        ctr,
        currency_code,
        date as Date,
        delivered_match_type,
        device_os,
        device_type,
        expected_ctr,
        historical_ad_relevance,
        historical_expected_ctr,
        historical_landing_page_experience,
        historical_quality_score,
        impressions as Impressions,
        landing_page_experience,
        low_quality_clicks,
        low_quality_clicks_percent,
        low_quality_conversion_rate,
        low_quality_conversions,
        low_quality_conversions_qualified,
        low_quality_general_clicks,
        low_quality_impressions,
        low_quality_impressions_percent,
        low_quality_sophisticated_clicks,
        network,
        phone_calls,
        phone_impressions,
        quality_score,
        return_on_ad_spend,
        revenue,
        spend as Cost,
        top_vs_other,
        view_through_conversions
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m08:40:56.583756 [debug] [Thread-3 (]: On model.bq_evo.stg_google_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_history`
),

_renamed_columns AS(
  SELECT
    _fivetran_start,
    id,
    _fivetran_active,
    _fivetran_end,
    _fivetran_synced,
    ad_serving_optimization_status,
    advertising_channel_subtype,
    advertising_channel_type,
    base_campaign_id,
    customer_id,
    end_date,
    experiment_type,
    final_url_suffix,
    frequency_caps,
    name as campaign,
    optimization_score,
    payment_mode,
    serving_status,
    start_date,
    status,
    tracking_url_template,
    updated_at,
    vanity_pharma_display_url_mode,
    vanity_pharma_text,
    video_brand_safety_suitability
  FROM _raw
),

_add_new_columns AS(
  SELECT 
    *,
    'google' as Source,
    'cpc' as Medium,
    (CASE
      WHEN customer_id = 6607387807 THEN 'EVO'  
      ELSE '(null)'
    END) as Partner
  FROM _renamed_columns
),

_final AS(
  SELECT
    *,
    LOWER(CONCAT(campaign, Source, Medium, Partner)) as CampaignID
  FROM _add_new_columns
)

SELECT * FROM _final;


[0m08:40:56.584870 [debug] [Thread-4 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Google Ads Kampagnen"""
    )
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_transformed_cost AS(
    SELECT
        _fivetran_id,
        customer_id,
        date,
        _fivetran_synced,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability,
        ad_network_type,
        base_campaign,
        clicks,
        conversions,
        conversions_value,
        cost_micros/1000000 as cost,
        device,
        id,
        impressions,
        interaction_event_types,
        interactions,
        view_through_conversions,
    FROM _raw
),

_final AS(
    SELECT * FROM _transformed_cost
)

SELECT * FROM _final;


[0m08:40:57.516682 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:eea61249-2496-433e-94a3-5b5b82c88fb8&page=queryresults
[0m08:40:57.519675 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6271daa9-c3d5-46b4-8373-db9debb562f3&page=queryresults
[0m08:40:57.527585 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:060be1ea-9e71-447d-a00f-19a877036288&page=queryresults
[0m08:40:57.754912 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (execute): 08:40:56.566196 => 08:40:57.754912
[0m08:40:57.756906 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0B85F10>]}
[0m08:40:57.756906 [info ] [Thread-2 (]: 2 of 32 OK created sql view model staging.stg_bing_ads_campaign_performance_daily_report  [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m08:40:57.758908 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m08:40:57.759899 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_google_analytics_352128287
[0m08:40:57.760896 [info ] [Thread-2 (]: 5 of 32 START sql view model staging.stg_google_analytics_352128287 ............ [RUN]
[0m08:40:57.762891 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_performance_daily_report, now model.bq_evo.stg_google_analytics_352128287)
[0m08:40:57.762891 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_google_analytics_352128287
[0m08:40:57.767888 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_352128287"
[0m08:40:57.768885 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (compile): 08:40:57.763888 => 08:40:57.768885
[0m08:40:57.769883 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_google_analytics_352128287
[0m08:40:57.773872 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_352128287"
[0m08:40:57.775867 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:40:57.776866 [debug] [Thread-2 (]: On model.bq_evo.stg_google_analytics_352128287: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_352128287"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
  OPTIONS(
      description="""Enth\u00e4lt alle GA4-Events in Tabellenform ohne Schachtelung. Bereinigt fehlerhafte Events ohne Session-ID. Offzielle Doku Google > https://support.google.com/analytics/answer/7029846?hl=en#zippy="""
    )
  as WITH _source AS(
  SELECT
    PARSE_DATE('%Y%m%d', event_date) as event_date,
    TIMESTAMP_MICROS(event_timestamp) as event_ts,
    
    MAX(CASE WHEN params.key = 'ga_session_id' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_id,
    user_pseudo_id,
    TIMESTAMP_MICROS(user_first_touch_timestamp) as user_first_touch_ts,

    event_name,

    params.key as params_key,
    params.value.string_value as params_string_value,
    params.value.int_value as params_int_value,
    params.value.float_value as params_float_value,
    params.value.double_value as params_double_value,

    (CASE WHEN traffic_source.name IS NULL THEN '(not set)' ELSE traffic_source.name END) as utm_campaign,
    (CASE WHEN traffic_source.medium IS NULL THEN '(not set)' ELSE traffic_source.medium END) as utm_medium,
    (CASE WHEN traffic_source.source IS NULL THEN '(not set)' ELSE traffic_source.source END) as utm_source,
    'EVO' as Partner,

    MAX(CASE WHEN params.key = 'page_title' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_title,
    MAX(CASE WHEN params.key = 'page_location' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_location,
    MAX(CASE WHEN params.key = 'page_referrer' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_referrer,
    MAX(CASE WHEN params.key = 'page_path' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_path,
    MAX(CASE WHEN params.key = 'percent_scrolled' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as percent_scrolled,
    MAX(CASE WHEN params.key = 'session_engaged' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_engaged,

    privacy_info.analytics_storage as analytics_storage,
    privacy_info.ads_storage as ads_storage,
    privacy_info.uses_transient_token as uses_transient_token,

    user_ltv.revenue as ltv_revenue,
    user_ltv.currency as ltv_currency,

    device.category as device_category,
    device.mobile_brand_name as device_brand,
    device.mobile_model_name as device_model_name,
    device.mobile_marketing_name as device_marketing_name,
    device.mobile_os_hardware_model as device_mobile_os_hardware_model,
    device.operating_system as device_os,
    device.operating_system_version as device_os_version,
    device.vendor_id as device_vendor_id,
    device.advertising_id as device_advertising_id,
    device.language as device_language,
    device.is_limited_ad_tracking as device_is_limited_ad_tracking,
    device.time_zone_offset_seconds as device_time_zone_offset_seconds,
    device.browser as device_browser,
    device.browser_version as device_browser_version,
    device.web_info.browser as device_web_info_browser,
    device.web_info.browser_version as device_web_info_browser_version,
    device.web_info.hostname as browser_web_info_hostname,

    geo.continent as continent,
    geo.country as country,
    geo.region as region,
    geo.city as city,
    geo.sub_continent as sub_continent,
    geo.metro as metropolitan_area,

    app_info.id as app_id,
    app_info.version as app_version,
    app_info.install_store as app_install_store,
    app_info.firebase_app_id as app_firebase_app_id,
    app_info.install_source as app_install_source,

    event_dimensions.hostname as event_hostname,

    ecommerce.total_item_quantity as total_item_quantity,
    ecommerce.purchase_revenue_in_usd as purchase_revenue_in_usd,
    ecommerce.purchase_revenue as purchase_revenue,
    ecommerce.refund_value_in_usd as refund_value_in_usd,
    ecommerce.refund_value as refund_value,
    ecommerce.shipping_value_in_usd as shipping_value_in_usd,
    ecommerce.shipping_value as shipping_value,
    ecommerce.tax_value_in_usd as tax_value_in_usd,
    ecommerce.tax_value as tax_value,
    ecommerce.unique_items as unique_items,
    ecommerce.transaction_id as transaction_id,
    
    items.item_id as item_id,
    items.item_name as item_name,
    items.item_brand as item_brand,
    items.item_variant as item_variant,
    items.item_category as item_category,
    items.item_category2 as item_category2,
    items.item_category3 as item_category3,
    items.item_category4 as item_category4,
    items.item_category5 as item_category5,
    items.price_in_usd as price_in_usd,
    items.price as price,
    items.quantity as quantity,
    items.item_revenue_in_usd as item_revenue_in_usd,
    items.item_revenue as item_revenue,
    items.item_refund_in_usd as item_refund_in_usd,
    items.item_refund as item_refund,
    items.coupon as coupon,
    items.affiliation as affiliation,
    items.location_id as location_id,
    items.item_list_id as item_list_id,
    items.item_list_name as item_list_name,
    items.item_list_index as item_list_index,
    items.promotion_id as promotion_id,
    items.promotion_name as promotion_name,
    items.creative_name as creative_name,
    items.creative_slot as creative_slot,

    collected_traffic_source.manual_campaign_id as manual_campaign_id,
    collected_traffic_source.manual_campaign_name as manual_campaign_name,
    collected_traffic_source.manual_source as manual_source,
    collected_traffic_source.manual_medium as manual_medium,
    collected_traffic_source.manual_term as manual_term,
    collected_traffic_source.manual_content as manual_content,
    collected_traffic_source.gclid as gclid,
    collected_traffic_source.dclid as dclid,
    collected_traffic_source.srsltid as srsltid

  FROM `oss-big-query-dashboard-prod`.`analytics_352128287`.`events_*` as events
  LEFT JOIN UNNEST (event_params) as params
  /*LEFT JOIN UNNEST (privacy_info) as privacy_info
  LEFT JOIN UNNEST (user_ltv) as user_ltv*/
  LEFT JOIN UNNEST(items) as items 
),

events_aggregated as (
  SELECT
    event_date,
    event_ts,
    session_id,
    user_pseudo_id,
    user_first_touch_ts,
    event_name,

--Kampagneninformationen
    MAX(utm_campaign) as utm_campaign,
    MAX(utm_medium) as utm_medium,
    (CASE WHEN MAX(utm_source) = 'ig' THEN 'instagram' ELSE MAX(utm_source) END) as utm_source,
  --  (CASE WHEN MAX(utm_campaign) IS NULL THEN '(not set)' ELSE MAX(utm_campaign) END) as utm_campaign,
  --  (CASE WHEN MAX(utm_medium) IS NULL THEN '(not set)' ELSE MAX(utm_medium) END) as utm_medium,
  --  (CASE WHEN MAX(utm_source) IS NULL THEN '(not set)' ELSE MAX(utm_source) END) as utm_source,

--Seiteninformationen
    MAX(page_title) as page_title,
    MAX(page_location) as page_location,
    MAX(page_referrer) as page_referrer,
    MAX(page_path) as page_path,
    MAX(percent_scrolled) as percent_scrolled,
    MAX(session_engaged) as session_engaged,

--Privacy-Infos
    MAX(analytics_storage) as analytics_storage,
    MAX(ads_storage) as ads_storage,
    MAX(uses_transient_token) as uses_transient_token,

--Kundenwertinformationen
    MAX(ltv_revenue) as ltv_revenue,
    MAX(ltv_currency) as ltv_currency,

--Geräteinformationen
    MAX(device_category) as device_category,
    MAX(device_brand) as device_brand,
    MAX(device_model_name) as device_model_name,
    MAX(device_marketing_name) as device_marketing_name,
    MAX(device_mobile_os_hardware_model) as device_mobile_os_hardware_model,
    MAX(device_os) as device_os,
    MAX(device_os_version) as device_os_version,
    MAX(device_vendor_id) as device_vendor_id,
    MAX(device_advertising_id) as device_advertising_id,
    MAX(device_language) as device_language,
    MAX(device_is_limited_ad_tracking) as device_is_limited_ad_tracking,
    MAX(device_time_zone_offset_seconds) as device_time_zone_offset_seconds,
    MAX(device_browser) as device_browser,
    MAX(device_browser_version) as device_browser_version,
    MAX(device_web_info_browser) as device_web_info_browser,
    MAX(device_web_info_browser_version) as device_web_info_browser_version,
    MAX(browser_web_info_hostname) as browser_web_info_hostname,

--Gebietsinformationen
    MAX(continent) as continent,
    MAX(country) as country,
    MAX(region) as region,
    MAX(city) as city,
    MAX(sub_continent) as sub_continent,
    MAX(metropolitan_area) as metropolitan_area,

--App-Informationen
    MAX(app_id) as app_id,
    MAX(app_version) as app_version,
    MAX(app_install_store) as app_install_store,
    MAX(app_firebase_app_id) as app_firebase_app_id,
    MAX(app_install_source) as app_install_source,

    MAX(event_hostname) as event_hostname,

--E-Commerceinformationen
    MAX(total_item_quantity) as total_item_quantity,
    MAX(purchase_revenue_in_usd) as purchase_revenue_in_usd,
    MAX(purchase_revenue) as purchase_revenue,
    MAX(refund_value_in_usd) as refund_value_in_usd,
    MAX(refund_value) as refund_value,
    MAX(shipping_value_in_usd) as shipping_value_in_usd,
    MAX(shipping_value) as shipping_value,
    MAX(tax_value_in_usd) as tax_value_in_usd,
    MAX(tax_value) as tax_value,
    MAX(unique_items) as unique_items,
    MAX(transaction_id) as transaction_id,

--Warenkorbinformationen
    MAX(item_id) as item_id,
    MAX(item_name) as item_name,
    MAX(item_brand) as item_brand,
    MAX(item_variant) as item_variant,
    MAX(item_category) as item_category,
    MAX(item_category2) as item_category2,
    MAX(item_category3) as item_category3,
    MAX(item_category4) as item_category4,
    MAX(item_category5) as item_category5,
    MAX(price_in_usd) as price_in_usd,
    MAX(price) as price,
    MAX(quantity) as quantity,
    MAX(item_revenue_in_usd) as item_revenue_in_usd,
    MAX(item_revenue) as item_revenue,
    MAX(item_refund_in_usd) as item_refund_in_usd,
    MAX(item_refund) as item_refund,
    MAX(coupon) as coupon,
    MAX(affiliation) as affiliation,
    MAX(location_id) as location_id,
    MAX(item_list_id) as item_list_id,
    MAX(item_list_name) as item_list_name,
    MAX(item_list_index) as item_list_index,
    MAX(promotion_id) as promotion_id,
    MAX(promotion_name) as promotion_name,
    MAX(creative_name) as creative_name,
    MAX(creative_slot) as creative_slot,

--Manuelle Trackingparameter
    MAX(manual_campaign_id) as manual_campaign_id,
    MAX(manual_campaign_name) as manual_campaign_name,
    MAX(manual_source) as manual_source,
    MAX(manual_medium) as manual_medium,
    MAX(manual_term) as manual_term,
    MAX(manual_content) as manual_content,
    MAX(gclid) as gclid,
    MAX(dclid) as dclid,
    MAX(srsltid) as srsltid

  FROM _source
  WHERE session_id <> 0
  GROUP BY 1,2,3,4,5,6
)

SELECT *
  --DISTINCT event_date
FROM events_aggregated;


[0m08:40:58.064849 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 08:40:56.573281 => 08:40:58.064849
[0m08:40:58.065847 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0FBF910>]}
[0m08:40:58.067814 [info ] [Thread-4 (]: 4 of 32 OK created sql view model staging.stg_google_ads_campaign_stats ........ [[32mCREATE VIEW (0 processed)[0m in 1.56s]
[0m08:40:58.068812 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m08:40:58.069808 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_google_analytics_historic_campaigns
[0m08:40:58.070806 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (execute): 08:40:56.532257 => 08:40:58.070806
[0m08:40:58.071840 [info ] [Thread-4 (]: 6 of 32 START sql view model staging.stg_google_analytics_historic_campaigns ... [RUN]
[0m08:40:58.072821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0E65490>]}
[0m08:40:58.073830 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_ads_campaign_stats, now model.bq_evo.stg_google_analytics_historic_campaigns)
[0m08:40:58.074795 [info ] [Thread-1 (]: 1 of 32 OK created sql view model staging.stg_bing_ads_campaign_history ........ [[32mCREATE VIEW (0 processed)[0m in 1.58s]
[0m08:40:58.074795 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_campaigns
[0m08:40:58.076791 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_history
[0m08:40:58.086316 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_campaigns"
[0m08:40:58.087314 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m08:40:58.088314 [info ] [Thread-1 (]: 7 of 32 START sql view model staging.stg_google_analytics_historic_goal_conversions  [RUN]
[0m08:40:58.090310 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_analytics_historic_campaigns (compile): 08:40:58.077788 => 08:40:58.089313
[0m08:40:58.091306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_history, now model.bq_evo.stg_google_analytics_historic_goal_conversions)
[0m08:40:58.092302 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_google_analytics_historic_campaigns
[0m08:40:58.093298 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m08:40:58.097290 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_campaigns"
[0m08:40:58.098287 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c34a8383-cf0c-4073-b047-d451d1140ec6&page=queryresults
[0m08:40:58.101310 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_goal_conversions"
[0m08:40:58.103272 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:40:58.105266 [debug] [Thread-4 (]: On model.bq_evo.stg_google_analytics_historic_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle historischen Kampagnen aus Universal Analytics / GA3"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_campaigns`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m08:40:58.107262 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_historic_goal_conversions (compile): 08:40:58.098287 => 08:40:58.106267
[0m08:40:58.110253 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m08:40:58.115239 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_goal_conversions"
[0m08:40:58.116236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:40:58.117234 [debug] [Thread-1 (]: On model.bq_evo.stg_google_analytics_historic_goal_conversions: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_goal_conversions"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_goal_conversions`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_goal_conversions`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m08:40:58.479044 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:26b3f6d4-22bb-4b61-856f-45e871f18cdd&page=queryresults
[0m08:40:58.791070 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8fdaeef7-d296-42e8-9c41-170d387f05fa&page=queryresults
[0m08:40:58.822605 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:05bced3b-be8a-42e7-b51a-adcc5e4a3616&page=queryresults
[0m08:40:58.894060 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (execute): 08:40:56.569277 => 08:40:58.894060
[0m08:40:58.896050 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F10480D0>]}
[0m08:40:58.897048 [info ] [Thread-3 (]: 3 of 32 OK created sql view model staging.stg_google_ads_campaign_history ...... [[32mCREATE VIEW (0 processed)[0m in 2.40s]
[0m08:40:58.899043 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_google_ads_campaign_history
[0m08:40:58.899043 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_google_analytics_historic_transactions
[0m08:40:58.900040 [info ] [Thread-3 (]: 8 of 32 START sql view model staging.stg_google_analytics_historic_transactions  [RUN]
[0m08:40:58.901016 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_ads_campaign_history, now model.bq_evo.stg_google_analytics_historic_transactions)
[0m08:40:58.902050 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_transactions
[0m08:40:58.905042 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_transactions"
[0m08:40:58.906007 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_analytics_historic_transactions (compile): 08:40:58.902050 => 08:40:58.906007
[0m08:40:58.907005 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_google_analytics_historic_transactions
[0m08:40:58.911000 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_transactions"
[0m08:40:58.912030 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:40:58.912992 [debug] [Thread-3 (]: On model.bq_evo.stg_google_analytics_historic_transactions: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_transactions"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_transactions`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_transactions`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m08:40:59.051661 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (execute): 08:40:57.770880 => 08:40:59.050662
[0m08:40:59.052659 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0E2BC10>]}
[0m08:40:59.052659 [info ] [Thread-2 (]: 5 of 32 OK created sql view model staging.stg_google_analytics_352128287 ....... [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m08:40:59.053655 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_google_analytics_352128287
[0m08:40:59.054618 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m08:40:59.055615 [info ] [Thread-2 (]: 9 of 32 START sql view model staging.stg_linkedin_ad_analytics_by_campaign ..... [RUN]
[0m08:40:59.056613 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_352128287, now model.bq_evo.stg_linkedin_ad_analytics_by_campaign)
[0m08:40:59.057610 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m08:40:59.060602 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m08:40:59.061599 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (compile): 08:40:59.057610 => 08:40:59.061599
[0m08:40:59.062597 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m08:40:59.065622 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m08:40:59.067628 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:40:59.068580 [debug] [Thread-2 (]: On model.bq_evo.stg_linkedin_ad_analytics_by_campaign: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Linkedin-Kampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS (
    SELECT *    
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`ad_analytics_by_campaign`
),

_renamed_columns AS (
    SELECT
        campaign_id,
        day as Date,
        _fivetran_synced,
        action_clicks,
        ad_unit_clicks,
        approximate_unique_impressions,
        card_clicks,
        card_impressions,
        clicks as Clicks,
        comment_likes,
        comments,
        company_page_clicks,
        conversion_value_in_local_currency,
        cost_in_local_currency as Cost,
        cost_in_usd,
        external_website_conversions,
        external_website_post_click_conversions,
        external_website_post_view_conversions,
        follows,
        full_screen_plays,
        impressions as Impressions,
        landing_page_clicks,
        lead_generation_mail_contact_info_shares,
        lead_generation_mail_interested_clicks,
        likes,
        one_click_lead_form_opens,
        one_click_leads,
        opens,
        other_engagements,
        sends,
        shares,
        text_url_clicks,
        total_engagements,
        video_completions,
        video_first_quartile_completions,
        video_midpoint_completions,
        video_starts,
        video_third_quartile_completions,
        video_views,
        viral_card_clicks,
        viral_card_impressions,
        viral_clicks,
        viral_comment_likes,
        viral_comments,
        viral_company_page_clicks,
        viral_external_website_conversions,
        viral_external_website_post_click_conversions,
        viral_external_website_post_view_conversions,
        viral_follows,
        viral_full_screen_plays,
        viral_impressions,
        viral_landing_page_clicks,
        viral_likes,
        viral_one_click_lead_form_opens,
        viral_one_click_leads,
        viral_other_engagements,
        viral_shares,
        viral_total_engagements,
        viral_video_completions,
        viral_video_first_quartile_completions,
        viral_video_midpoint_completions,
        viral_video_starts,
        viral_video_third_quartile_completions,
        viral_video_views
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m08:40:59.174610 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_historic_goal_conversions (execute): 08:40:58.111251 => 08:40:59.173568
[0m08:40:59.174610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0EB9990>]}
[0m08:40:59.175648 [info ] [Thread-1 (]: 7 of 32 OK created sql view model staging.stg_google_analytics_historic_goal_conversions  [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m08:40:59.176673 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m08:40:59.178003 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_linkedin_campaign_history
[0m08:40:59.178003 [info ] [Thread-1 (]: 10 of 32 START sql view model staging.stg_linkedin_campaign_history ............ [RUN]
[0m08:40:59.179096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_historic_goal_conversions, now model.bq_evo.stg_linkedin_campaign_history)
[0m08:40:59.180349 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_linkedin_campaign_history
[0m08:40:59.182862 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_campaign_history"
[0m08:40:59.186405 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (compile): 08:40:59.180349 => 08:40:59.185403
[0m08:40:59.186405 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_linkedin_campaign_history
[0m08:40:59.189397 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_campaign_history"
[0m08:40:59.191877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:40:59.192881 [debug] [Thread-1 (]: On model.bq_evo.stg_linkedin_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`campaign_history`
),

_renamed_columns AS(
    SELECT
        id,
        last_modified_time,
        _fivetran_synced,
        account_id,
        associated_entity,
        audience_expansion_enabled,
        campaign_group_id,
        cost_type,
        created_time,
        creative_selection,
        daily_budget_amount,
        daily_budget_currency_code,
        format,
        locale_country,
        locale_language,
        name as Campaign,
        objective_type,
        offsite_delivery_enabled,
        optimization_target_type,
        run_schedule_end,
        run_schedule_start,
        status,
        type,
        unit_cost_amount,
        unit_cost_currency_code,
        version_tag
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m08:40:59.414972 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_analytics_historic_campaigns (execute): 08:40:58.094298 => 08:40:59.414972
[0m08:40:59.416004 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0B8FD10>]}
[0m08:40:59.416966 [info ] [Thread-4 (]: 6 of 32 OK created sql view model staging.stg_google_analytics_historic_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m08:40:59.418996 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_google_analytics_historic_campaigns
[0m08:40:59.419960 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_meta_campaign_information
[0m08:40:59.420956 [info ] [Thread-4 (]: 11 of 32 START sql view model staging.stg_meta_campaign_information ............ [RUN]
[0m08:40:59.421954 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_historic_campaigns, now model.bq_evo.stg_meta_campaign_information)
[0m08:40:59.421954 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_meta_campaign_information
[0m08:40:59.428968 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_meta_campaign_information"
[0m08:40:59.430932 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_meta_campaign_information (compile): 08:40:59.422950 => 08:40:59.429933
[0m08:40:59.431930 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_meta_campaign_information
[0m08:40:59.434920 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_meta_campaign_information"
[0m08:40:59.436915 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:40:59.437913 [debug] [Thread-4 (]: On model.bq_evo.stg_meta_campaign_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_meta_campaign_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen. Inklusive Informationen \u00fcber zugeh\u00f6rige Anzeigengruppen und Anzeigen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`facebook_ads`.`fb_campaign_information`
),

_renamed_columns AS(
    SELECT 
        * EXCEPT (campaign_name),
        campaign_name as Campaign
    FROM _raw
),

_added_more_metadata AS(
    SELECT 
        *,
        'cpc' as Medium,
        'EVO' as Partner,
        CASE
            WHEN campaign_name LIKE '%:IG%' AND campaign_name NOT LIKE '%:FB:IG:%' THEN 'instagram'
            WHEN campaign_name LIKE '%:FB:IG:%' OR campaign_name LIKE '%:FB:%' THEN 'facebook'
            ELSE '(not set)'
        END AS Source,
        'true' as IsPaid,
        LOWER (CONCAT(Campaign, Source, Medium, Partner)) as CampaignID
    FROM _renamed_columns
),

_final AS(
    SELECT *
    FROM _added_more_metadata
)

SELECT * FROM _final;


[0m08:40:59.566212 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3a26ca61-b8b5-4f39-b922-8612ec0d1324&page=queryresults
[0m08:40:59.726979 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_analytics_historic_transactions (execute): 08:40:58.908000 => 08:40:59.725984
[0m08:40:59.727944 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0FA6FD0>]}
[0m08:40:59.727944 [info ] [Thread-3 (]: 8 of 32 OK created sql view model staging.stg_google_analytics_historic_transactions  [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m08:40:59.728977 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_google_analytics_historic_transactions
[0m08:40:59.729940 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_meta_campaign_stats
[0m08:40:59.730937 [info ] [Thread-3 (]: 12 of 32 START sql view model staging.stg_meta_campaign_stats .................. [RUN]
[0m08:40:59.731935 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_historic_transactions, now model.bq_evo.stg_meta_campaign_stats)
[0m08:40:59.731935 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_meta_campaign_stats
[0m08:40:59.734926 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_meta_campaign_stats"
[0m08:40:59.736922 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_meta_campaign_stats (compile): 08:40:59.732932 => 08:40:59.735924
[0m08:40:59.736922 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_meta_campaign_stats
[0m08:40:59.740910 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_meta_campaign_stats"
[0m08:40:59.741905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:40:59.741905 [debug] [Thread-3 (]: On model.bq_evo.stg_meta_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_meta_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Metakampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`facebook_ads`.`fb_basic_performance_per_day`
),

_renamed_columns AS (
    SELECT
        _fivetran_id,
        ad_id,
        date as Date,
        _fivetran_synced,
        account_id,
        adset_name,
        campaign_name as Campaign,
        clicks as Clicks,
        cpc,
        cpm,
        ctr,
        impressions as Impressions,
        reach,
        spend as Cost
),

_final AS (
    SELECT *    
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m08:40:59.836206 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:36f391c0-cab6-4224-aa3b-a047659794db&page=queryresults
[0m08:41:00.034950 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:fa87c0ae-6ce2-4ab2-b737-21c8937aa891&page=queryresults
[0m08:41:00.174228 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a2f6709c-8e93-4f61-b80c-8d35acd22e41&page=queryresults
[0m08:41:00.231353 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (execute): 08:40:59.187402 => 08:41:00.231353
[0m08:41:00.233346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F102B790>]}
[0m08:41:00.237370 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (execute): 08:40:59.062597 => 08:41:00.237370
[0m08:41:00.239330 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0B33AD0>]}
[0m08:41:00.238370 [info ] [Thread-1 (]: 10 of 32 OK created sql view model staging.stg_linkedin_campaign_history ....... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m08:41:00.240327 [info ] [Thread-2 (]: 9 of 32 OK created sql view model staging.stg_linkedin_ad_analytics_by_campaign  [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m08:41:00.242323 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_linkedin_campaign_history
[0m08:41:00.243319 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m08:41:00.243996 [debug] [Thread-1 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m08:41:00.245000 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m08:41:00.245994 [info ] [Thread-1 (]: 13 of 32 START sql view model intermediate.int_bing_ads_unique_campaigns ....... [RUN]
[0m08:41:00.247993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_linkedin_campaign_history, now model.bq_evo.int_bing_ads_unique_campaigns)
[0m08:41:00.246993 [info ] [Thread-2 (]: 14 of 32 START sql view model intermediate.int_google_ads_unique_campaigns ..... [RUN]
[0m08:41:00.248990 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_bing_ads_unique_campaigns
[0m08:41:00.249985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_linkedin_ad_analytics_by_campaign, now model.bq_evo.int_google_ads_unique_campaigns)
[0m08:41:00.254009 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m08:41:00.254971 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m08:41:00.258994 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m08:41:00.259963 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (compile): 08:41:00.250984 => 08:41:00.259963
[0m08:41:00.260956 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_bing_ads_unique_campaigns
[0m08:41:00.267935 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m08:41:00.267935 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 08:41:00.255970 => 08:41:00.267935
[0m08:41:00.269945 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m08:41:00.270927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:41:00.274922 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m08:41:00.275920 [debug] [Thread-1 (]: On model.bq_evo.int_bing_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Bing Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id,
        MAX(name) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m08:41:00.278909 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:41:00.279908 [debug] [Thread-2 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id ,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m08:41:00.312311 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: campaign_name at [26:18]')
[0m08:41:00.945280 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:027cea6a-ccf8-4d59-b5b1-7d3cc1bbee10&page=queryresults
[0m08:41:00.985688 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:0f860c07-6ed7-4046-9200-24399c76affd&page=queryresults
[0m08:41:01.151259 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8540b231-d2ce-49af-8827-b5bd9386ed89&page=queryresults
[0m08:41:01.334930 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8540b231-d2ce-49af-8827-b5bd9386ed89&page=queryresults
[0m08:41:01.337878 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_meta_campaign_information (execute): 08:40:59.431930 => 08:41:01.336880
[0m08:41:01.349844 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c7764621-055b-4542-a4a2-3b843bce8b82&page=queryresults
[0m08:41:01.445246 [debug] [Thread-4 (]: Database Error in model stg_meta_campaign_information (models\staging\meta\stg_meta_campaign_information.sql)
  Unrecognized name: campaign_name at [26:18]
  compiled Code at target\run\bq_evo\models\staging\meta\stg_meta_campaign_information.sql
[0m08:41:01.446241 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EFA72990>]}
[0m08:41:01.447240 [error] [Thread-4 (]: 11 of 32 ERROR creating sql view model staging.stg_meta_campaign_information ... [[31mERROR[0m in 2.03s]
[0m08:41:01.448202 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_meta_campaign_information
[0m08:41:01.449200 [debug] [Thread-4 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m08:41:01.450231 [info ] [Thread-4 (]: 15 of 32 START sql view model intermediate.int_google_analytics_all_events ..... [RUN]
[0m08:41:01.451194 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_meta_campaign_information, now model.bq_evo.int_google_analytics_all_events)
[0m08:41:01.451194 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m08:41:01.454185 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m08:41:01.456180 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 08:41:01.452191 => 08:41:01.455183
[0m08:41:01.456180 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m08:41:01.462198 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m08:41:01.464162 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:41:01.464162 [debug] [Thread-4 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_final AS(
    SELECT *
    FROM _rename_columns
)

SELECT * FROM _final;


[0m08:41:01.663878 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (execute): 08:41:00.261968 => 08:41:01.663878
[0m08:41:01.664875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F227A210>]}
[0m08:41:01.665874 [info ] [Thread-1 (]: 13 of 32 OK created sql view model intermediate.int_bing_ads_unique_campaigns .. [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m08:41:01.666869 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m08:41:01.667867 [debug] [Thread-1 (]: Began running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m08:41:01.668866 [info ] [Thread-1 (]: 16 of 32 START sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [RUN]
[0m08:41:01.670860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_unique_campaigns, now model.bq_evo.int_linkedin_unique_campaigns_reduced_information)
[0m08:41:01.671856 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m08:41:01.674920 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m08:41:01.675882 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (compile): 08:41:01.671856 => 08:41:01.675882
[0m08:41:01.676881 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m08:41:01.679872 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m08:41:01.680869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:41:01.681866 [debug] [Thread-1 (]: On model.bq_evo.int_linkedin_unique_campaigns_reduced_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Linkedin-Kampagnen - gg\u00fc. Quelldaten nur ausgew\u00e4hlte Spalten f\u00fcr Weiterverarbeitung NDG."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
),

_selected_columns AS (
    SELECT
        id as campaign_id,
        Campaign, 
        "EVO" as Partner, 
        "cpc" as Medium, 
        "linkedin" as Source, 
        LOWER(CONCAT(Campaign, "linkedin", "cpc", "EVO")) AS CampaignID 
    
    FROM _raw
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _selected_columns
)

SELECT * FROM _final;


[0m08:41:01.719349 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 08:41:00.270927 => 08:41:01.719349
[0m08:41:01.720346 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0E2BC10>]}
[0m08:41:01.721343 [info ] [Thread-2 (]: 14 of 32 OK created sql view model intermediate.int_google_ads_unique_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m08:41:01.722342 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: _fivetran_id at [15:9]')
[0m08:41:01.723340 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m08:41:01.724337 [debug] [Thread-2 (]: Began running node model.bq_evo.int_meta_unique_campaigns
[0m08:41:01.725333 [info ] [Thread-2 (]: 17 of 32 SKIP relation intermediate.int_meta_unique_campaigns .................. [[33mSKIP[0m]
[0m08:41:01.726333 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_meta_unique_campaigns
[0m08:41:01.727328 [debug] [Thread-2 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m08:41:01.728325 [info ] [Thread-2 (]: 18 of 32 START sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [RUN]
[0m08:41:01.730321 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_unique_campaigns, now model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names)
[0m08:41:01.731317 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m08:41:01.735306 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m08:41:01.737301 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (compile): 08:41:01.732350 => 08:41:01.736303
[0m08:41:01.737301 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m08:41:01.741290 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m08:41:01.743284 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:41:01.744283 [debug] [Thread-2 (]: On model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne inkl. Klartext der Kampagne."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m08:41:02.110844 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4c6b021e-78f4-475f-b6cc-340f98bdb581&page=queryresults
[0m08:41:02.172675 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ee21bb6c-3bc7-474a-86ab-3a7c5904fb32&page=queryresults
[0m08:41:02.211154 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4c6b021e-78f4-475f-b6cc-340f98bdb581&page=queryresults
[0m08:41:02.212154 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_meta_campaign_stats (execute): 08:40:59.737921 => 08:41:02.212154
[0m08:41:02.216143 [debug] [Thread-3 (]: Database Error in model stg_meta_campaign_stats (models\staging\meta\stg_meta_campaign_stats.sql)
  Unrecognized name: _fivetran_id at [15:9]
  compiled Code at target\run\bq_evo\models\staging\meta\stg_meta_campaign_stats.sql
[0m08:41:02.216143 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0B7CF90>]}
[0m08:41:02.217138 [error] [Thread-3 (]: 12 of 32 ERROR creating sql view model staging.stg_meta_campaign_stats ......... [[31mERROR[0m in 2.49s]
[0m08:41:02.219134 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_meta_campaign_stats
[0m08:41:02.220131 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m08:41:02.221128 [info ] [Thread-3 (]: 19 of 32 START sql view model intermediate.int_google_ads_campaign_stats ....... [RUN]
[0m08:41:02.223123 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_meta_campaign_stats, now model.bq_evo.int_google_ads_campaign_stats)
[0m08:41:02.224120 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m08:41:02.227112 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m08:41:02.228109 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 08:41:02.224120 => 08:41:02.228109
[0m08:41:02.229107 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m08:41:02.232098 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m08:41:02.233096 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:41:02.235113 [debug] [Thread-3 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
),

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m08:41:02.400485 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:147bcffa-1c95-4d68-94c2-54e23cfb1800&page=queryresults
[0m08:41:02.487292 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4e434e63-d71a-4bbb-a9d9-2030cfa8ad6a&page=queryresults
[0m08:41:02.771273 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (execute): 08:41:01.676881 => 08:41:02.770280
[0m08:41:02.771273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F2227A50>]}
[0m08:41:02.772269 [info ] [Thread-1 (]: 16 of 32 OK created sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m08:41:02.774230 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m08:41:02.774230 [debug] [Thread-1 (]: Began running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:41:02.775227 [info ] [Thread-1 (]: 20 of 32 SKIP relation intermediate.int_meta_campaign_stats_joined_campaign_names  [[33mSKIP[0m]
[0m08:41:02.776241 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:41:02.777259 [debug] [Thread-1 (]: Began running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m08:41:02.778222 [info ] [Thread-1 (]: 21 of 32 START sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [RUN]
[0m08:41:02.779218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_linkedin_unique_campaigns_reduced_information, now model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names)
[0m08:41:02.780216 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m08:41:02.783241 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m08:41:02.785202 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (compile): 08:41:02.780216 => 08:41:02.784241
[0m08:41:02.786199 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m08:41:02.789226 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m08:41:02.790223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:41:02.791187 [debug] [Thread-1 (]: On model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.campaign_id = _raw_performance.campaign_id
),

_drop_campaign_id AS(
    SELECT * EXCEPT (campaign_id)
    FROM _joined
),

_final AS(
    SELECT 
        * EXCEPT(Date),
        CAST(Date AS DATE) as Date
    FROM _drop_campaign_id
)

SELECT * FROM _final;


[0m08:41:02.852600 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 08:41:01.457178 => 08:41:02.851601
[0m08:41:02.852600 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F10293D0>]}
[0m08:41:02.853597 [info ] [Thread-4 (]: 15 of 32 OK created sql view model intermediate.int_google_analytics_all_events  [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m08:41:02.854559 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m08:41:02.855593 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:41:02.856554 [info ] [Thread-4 (]: 22 of 32 SKIP relation mart.mrt_meta_basic_campaign_stats ...................... [[33mSKIP[0m]
[0m08:41:02.857552 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:41:02.857552 [debug] [Thread-4 (]: Began running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m08:41:02.858548 [info ] [Thread-4 (]: 23 of 32 START sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [RUN]
[0m08:41:02.859546 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_events, now model.bq_evo.int_google_analytics_NDG_conversionevents_GA4)
[0m08:41:02.860580 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m08:41:02.863574 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m08:41:02.865531 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (compile): 08:41:02.861541 => 08:41:02.865531
[0m08:41:02.866527 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m08:41:02.873508 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:f13c235d-0c74-40e0-b720-d03b810d88bd&page=queryresults
[0m08:41:02.878532 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m08:41:02.881526 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:41:02.882561 [debug] [Thread-4 (]: On model.bq_evo.int_google_analytics_NDG_conversionevents_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle relevanten Conversionevents aus Google Analytics 4 f\u00fcr NDG-Vermarktung. Inklusive aller E-Commerce-Events (ohne Metainformationen)."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_conversions_NDG as(
  SELECT 
    event_date as Date,
    event_name as ZielvorhabenName, 
    CampaignID,
    Source,
    Medium,

    MAX(Partner) as Partner,

    count(event_date) as Conversions,

  FROM _raw
  WHERE (
    event_name = 'lead_form_evo_solar_lp' OR
    event_name = 'evo_solar_pva_check_sent_available' OR
    event_name = 'contact_form_button' OR
    event_name = 'click_online_application' OR
    event_name = 'oss_registration_doi' OR
    event_name = 'click_tarifrechnernutzung' OR
    event_name = 'conversion_solarrechner' OR
    event_name = 'purchase'
  )

  GROUP BY 1,2,3,4,5
),

_added_columns AS(
  SELECT 
      Date,
      ZielvorhabenName,
      LOWER(CONCAT(ZielvorhabenName, Partner)) as ZielvorhabenID,
      CampaignID,
      Source,
      Medium,
      Partner,
      '(not set)' as Keyword,
      '(not set)' as KeywordMatchType,
      Conversions
  FROM _conversions_NDG
),

_final AS(
  SELECT *
  FROM _added_columns
)

SELECT * FROM _final;


[0m08:41:03.195009 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (execute): 08:41:01.738299 => 08:41:03.195009
[0m08:41:03.196006 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0B3DAD0>]}
[0m08:41:03.196976 [info ] [Thread-2 (]: 18 of 32 OK created sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m08:41:03.197974 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m08:41:03.197974 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_analytics_all_campaigns
[0m08:41:03.198971 [info ] [Thread-2 (]: 24 of 32 START sql view model intermediate.int_google_analytics_all_campaigns .. [RUN]
[0m08:41:03.200999 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names, now model.bq_evo.int_google_analytics_all_campaigns)
[0m08:41:03.201963 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_analytics_all_campaigns
[0m08:41:03.204984 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m08:41:03.207947 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (compile): 08:41:03.201963 => 08:41:03.206955
[0m08:41:03.208949 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_analytics_all_campaigns
[0m08:41:03.211964 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m08:41:03.213932 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:41:03.213932 [debug] [Thread-2 (]: On model.bq_evo.int_google_analytics_all_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagnen aus GA4 und GA3."""
    )
  as WITH _historic_ua_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
),

ga4_campaigns AS(
    SELECT 
        MAX(Campaign),
        MAX(Partner),
        MAX(Source),
        MAX(Medium),
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
    GROUP BY 5
),

_final AS(
    SELECT * FROM _historic_ua_campaigns
    UNION DISTINCT
    SELECT * FROM ga4_campaigns
)

SELECT * FROM _final;


[0m08:41:03.497504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:37b0ce14-1bf1-4acf-8292-1faa07619031&page=queryresults
[0m08:41:03.521430 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 08:41:02.229107 => 08:41:03.521430
[0m08:41:03.523398 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0E3C810>]}
[0m08:41:03.524398 [info ] [Thread-3 (]: 19 of 32 OK created sql view model intermediate.int_google_ads_campaign_stats .. [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m08:41:03.525393 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m08:41:03.525393 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m08:41:03.526393 [info ] [Thread-3 (]: 25 of 32 START sql view model intermediate.int_google_analytics_all_purchases_GA4  [RUN]
[0m08:41:03.527417 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_campaign_stats, now model.bq_evo.int_google_analytics_all_purchases_GA4)
[0m08:41:03.528388 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m08:41:03.531379 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m08:41:03.533373 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (compile): 08:41:03.529385 => 08:41:03.532377
[0m08:41:03.534372 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m08:41:03.537363 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m08:41:03.539358 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:41:03.540358 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_all_purchases_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_purchases_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle <purchase-events> aus Google Analytics 4. Inkl. aller zugeh\u00f6rigen Metainformationen aus GA4."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_select_purchase_events AS(
  SELECT * FROM _raw
  WHERE event_name = "purchase"
),

_final AS(
    SELECT *
    FROM _select_purchase_events
)

SELECT * FROM _final;


[0m08:41:03.582281 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:1ff47a05-327e-43d0-bddd-51c73c0f6551&page=queryresults
[0m08:41:03.882277 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (execute): 08:41:02.786199 => 08:41:03.882277
[0m08:41:03.883251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0ED34D0>]}
[0m08:41:03.884249 [info ] [Thread-1 (]: 21 of 32 OK created sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m08:41:03.886216 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m08:41:03.887247 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m08:41:03.888211 [info ] [Thread-1 (]: 26 of 32 START sql incremental model mart.mrt_google_analytics_campaign_webperformance  [RUN]
[0m08:41:03.889214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names, now model.bq_evo.mrt_google_analytics_campaign_webperformance)
[0m08:41:03.890215 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m08:41:03.902748 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m08:41:03.904708 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (compile): 08:41:03.891203 => 08:41:03.903711
[0m08:41:03.904708 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m08:41:03.954574 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2107740a-5659-41cb-b256-4d570c29d953&page=queryresults
[0m08:41:03.966580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:41:03.969535 [debug] [Thread-1 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt grundlegende Web-Performancewerte aller \u00fcber GA4 erfassten Kampagnen.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`

    

      WHERE
      --Update table for the past seven days + today
      event_date >= current_date()-7
        
    
),

sessions_by_campaign AS(
  SELECT
    event_date as Date,
    CampaignID,

    COUNT(DISTINCT(CONCAT(user_pseudo_id,session_id))) as Sessions,
    COUNT(DISTINCT 
      CASE 
        WHEN session_engaged = '1' THEN CONCAT(user_pseudo_id,session_id) 
      END) as Sessions_Engaged,
    MAX(Medium) as Medium,
    MAX(Source) as Source,
    MAX(Partner) as Partner,

  FROM _raw
  GROUP BY 1,2
),

_add_engagement_rate AS(
    SELECT 
        Date,
        CampaignID,
        Sessions,
        Sessions_Engaged,
        (CASE
            WHEN Sessions > 0 THEN (Sessions_Engaged / Sessions) 
            ELSE 0
        END) as Engagement_Rate,
        Medium,
        Source,
        Partner
    FROM sessions_by_campaign
),

_added_columns AS(
    SELECT
        *,
        '(not set)' as Keyword,
        '(not set)' as KeywordMatchType
    FROM _add_engagement_rate
),

_final AS(
    SELECT *
    FROM _added_columns
)

SELECT * FROM _final
    );
  
[0m08:41:04.210068 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:497f9bc1-b98c-42da-a9d2-45b3c311d11d&page=queryresults
[0m08:41:04.314405 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (execute): 08:41:02.867524 => 08:41:04.313407
[0m08:41:04.314405 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0FA5610>]}
[0m08:41:04.315402 [info ] [Thread-4 (]: 23 of 32 OK created sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m08:41:04.316379 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m08:41:04.317363 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m08:41:04.318366 [info ] [Thread-4 (]: 27 of 32 START sql incremental model mart.mrt_bing_ads_basic_campaign_stats .... [RUN]
[0m08:41:04.320357 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_NDG_conversionevents_GA4, now model.bq_evo.mrt_bing_ads_basic_campaign_stats)
[0m08:41:04.320357 [debug] [Thread-4 (]: Began compiling node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m08:41:04.324377 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m08:41:04.326341 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (compile): 08:41:04.321354 => 08:41:04.325374
[0m08:41:04.326341 [debug] [Thread-4 (]: Began executing node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m08:41:04.333353 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:41:04.334327 [debug] [Thread-4 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
 
    

      WHERE
      --Update table for the past seven days + today
      Date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m08:41:04.430651 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (execute): 08:41:03.208949 => 08:41:04.430651
[0m08:41:04.431682 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0E9FF50>]}
[0m08:41:04.432681 [info ] [Thread-2 (]: 24 of 32 OK created sql view model intermediate.int_google_analytics_all_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m08:41:04.433645 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_analytics_all_campaigns
[0m08:41:04.434649 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m08:41:04.435638 [info ] [Thread-2 (]: 28 of 32 START sql incremental model mart.mrt_google_ads_basic_campaign_stats .. [RUN]
[0m08:41:04.436635 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_campaigns, now model.bq_evo.mrt_google_ads_basic_campaign_stats)
[0m08:41:04.436635 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m08:41:04.441622 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m08:41:04.442620 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (compile): 08:41:04.437633 => 08:41:04.442620
[0m08:41:04.443617 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m08:41:04.447606 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:41:04.448604 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

    

      WHERE
      --Update table for the past seven days + today
      date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m08:41:04.643111 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:22c6fe91-3c77-4980-bfcd-04f1fa1cc831&page=queryresults
[0m08:41:04.891180 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (execute): 08:41:03.534372 => 08:41:04.890184
[0m08:41:04.892146 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F106E0D0>]}
[0m08:41:04.892146 [info ] [Thread-3 (]: 25 of 32 OK created sql view model intermediate.int_google_analytics_all_purchases_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m08:41:04.894175 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m08:41:04.894175 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m08:41:04.895643 [info ] [Thread-3 (]: 29 of 32 START sql incremental model mart.mrt_linkedin_basic_campaign_stats .... [RUN]
[0m08:41:04.896645 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_purchases_GA4, now model.bq_evo.mrt_linkedin_basic_campaign_stats)
[0m08:41:04.897642 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m08:41:04.902659 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_linkedin_basic_campaign_stats"
[0m08:41:04.903658 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (compile): 08:41:04.898636 => 08:41:04.903658
[0m08:41:04.904624 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m08:41:04.908646 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:41:04.909644 [debug] [Thread-3 (]: On model.bq_evo.mrt_linkedin_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_linkedin_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der LinkedinKampagnen.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`

    

      WHERE
      --Update table for the past seven days + today
      Date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m08:41:05.081577 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8456898f-7aa4-4748-9201-8f1ecbf82cfc&page=queryresults
[0m08:41:05.205411 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:170d5f77-fb3a-49b3-befe-3aa69d623a22&page=queryresults
[0m08:41:05.608947 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c44d8869-363a-4f05-8178-1bca5a4e75c9&page=queryresults
[0m08:41:06.840685 [debug] [Thread-4 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:41:06.863624 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m08:41:06.866646 [debug] [Thread-4 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.Date = DBT_INTERNAL_DEST.Date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m08:41:07.088043 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8c386f39-f6cb-4ce4-b394-bea95ec9059e&page=queryresults
[0m08:41:07.178195 [debug] [Thread-2 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:41:07.181186 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m08:41:07.183144 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.date = DBT_INTERNAL_DEST.date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m08:41:07.405579 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:542475c4-89c2-494b-8844-09ed61bca90d&page=queryresults
[0m08:41:07.644581 [debug] [Thread-3 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:41:07.651564 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_linkedin_basic_campaign_stats"
[0m08:41:07.654545 [debug] [Thread-3 (]: On model.bq_evo.mrt_linkedin_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_linkedin_basic_campaign_stats"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.Date = DBT_INTERNAL_DEST.Date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m08:41:07.846878 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7adcfd76-784c-46b1-bac2-4b9c69ab44d8&page=queryresults
[0m08:41:08.796075 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (execute): 08:41:04.327338 => 08:41:08.795078
[0m08:41:08.798027 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F2A74D10>]}
[0m08:41:09.717294 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (execute): 08:41:04.443617 => 08:41:09.716357
[0m08:41:09.718323 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0B7F6D0>]}
[0m08:41:09.785987 [info ] [Thread-4 (]: 27 of 32 OK created sql incremental model mart.mrt_bing_ads_basic_campaign_stats  [[32mMERGE (0.0 rows, 387.5 KiB processed)[0m in 4.48s]
[0m08:41:09.787579 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m08:41:09.786981 [info ] [Thread-2 (]: 28 of 32 OK created sql incremental model mart.mrt_google_ads_basic_campaign_stats  [[32mMERGE (172.0 rows, 11.3 MiB processed)[0m in 5.28s]
[0m08:41:09.789136 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m08:41:09.790139 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m08:41:09.792169 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_metainformation_campaigns
[0m08:41:09.791169 [info ] [Thread-4 (]: 30 of 32 START sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [RUN]
[0m08:41:09.793166 [info ] [Thread-2 (]: 31 of 32 START sql table model mart.mrt_metainformation_campaigns .............. [RUN]
[0m08:41:09.795162 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_bing_ads_basic_campaign_stats, now model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized)
[0m08:41:09.796160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_google_ads_basic_campaign_stats, now model.bq_evo.mrt_metainformation_campaigns)
[0m08:41:09.797190 [debug] [Thread-4 (]: Began compiling node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m08:41:09.798154 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_metainformation_campaigns
[0m08:41:09.803141 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m08:41:09.810743 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_metainformation_campaigns"
[0m08:41:09.811756 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (compile): 08:41:09.799150 => 08:41:09.811756
[0m08:41:09.813754 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (compile): 08:41:09.803141 => 08:41:09.812757
[0m08:41:09.813754 [debug] [Thread-4 (]: Began executing node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m08:41:09.814751 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_metainformation_campaigns
[0m08:41:09.818740 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:41:09.829743 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:41:09.861266 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (execute): 08:41:04.905621 => 08:41:09.861266
[0m08:41:09.862262 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F1054410>]}
[0m08:41:09.863253 [info ] [Thread-3 (]: 29 of 32 OK created sql incremental model mart.mrt_linkedin_basic_campaign_stats  [[32mMERGE (0.0 rows, 63.2 KiB processed)[0m in 4.97s]
[0m08:41:09.865222 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m08:41:09.866239 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m08:41:09.866239 [info ] [Thread-3 (]: 32 of 32 START sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [RUN]
[0m08:41:09.868249 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_linkedin_basic_campaign_stats, now model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized)
[0m08:41:09.869211 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m08:41:09.872234 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m08:41:09.873206 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (compile): 08:41:09.869211 => 08:41:09.873206
[0m08:41:09.874204 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m08:41:09.878186 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:41:10.487676 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_metainformation_campaigns"
[0m08:41:10.489670 [debug] [Thread-2 (]: On model.bq_evo.mrt_metainformation_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_metainformation_campaigns"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_metainformation_campaigns`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt Kampagnen aus allen Quelldatensystemen mit Metainformationen."""
    )
    as (
      

WITH _googleads_campaigns AS(
    SELECT
        campaign as Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_google_analytics_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        CASE
            WHEN Medium IN ('cpc', 'ppc','cpa', 'cpm', 'cpv', 'cpp') THEN 'true' 
            ELSE 'false'
        END as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
),

_bingads_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_merged_googleads_and_analytics AS(
    SELECT * FROM _googleads_campaigns
    UNION ALL
    SELECT * FROM _google_analytics_campaigns
),

_merged_bingads AS(
    SELECT * FROM _merged_googleads_and_analytics
    UNION ALL
    SELECT * FROM _bingads_campaigns    
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _merged_bingads
)

SELECT * FROM _final
    );
  
[0m08:41:10.514663 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m08:41:10.515661 [debug] [Thread-4 (]: On model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized` as DBT_INTERNAL_DEST
        using (WITH ga4_conversions AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
    WHERE 
        Date > '2023-06-04'
),

ua_conversions AS(
    SELECT
        Date,
        NameZielvorhaben as ZielvorhabenName,
        LOWER(CONCAT(NameZielvorhaben, Partner)) as ZielvorhabenID,
        CampaignID,
        Source,
        Medium,
        Partner,
        Keyword,
        KeywordMatchType,
        Conversions
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_goal_conversions`
    WHERE Date <= '2023-06-04'
),

_merged_step1 AS(
    SELECT * FROM ga4_conversions
    UNION ALL
    SELECT * FROM ua_conversions
),

_final AS(
    SELECT *
    FROM _merged_step1
)

SELECT * FROM _final
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`Date`, `ZielvorhabenName`, `ZielvorhabenID`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Conversions`)
    values
        (`Date`, `ZielvorhabenName`, `ZielvorhabenID`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Conversions`)


    
[0m08:41:10.557691 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m08:41:10.559649 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_merged_ua_ga4_transactions_summarized` as DBT_INTERNAL_DEST
        using (WITH _raw AS(
  SELECT 
    event_date as Date,
    Campaign,
    Medium,
    Source,
    item_category as ProductCategory,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  WHERE 
    transaction_id NOT LIKE 'TEST%'
),

_aggregation_on_day AS(
  SELECT
    Date,
    Campaign,
    Medium,
    Source,
    ProductCategory,
    count(Date) as Transactions,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    MAX(Partner) as Partner,
    CampaignID
  FROM _raw
  WHERE Date >= '2023-06-05'
  GROUP BY 1,2,3,4,5,10
),

evo_ecommerce_ua AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_transactions`
  WHERE Date < '2023-06-05'
),

_merged_step1 AS(
  SELECT * FROM _aggregation_on_day
  UNION ALL
  SELECT * FROM evo_ecommerce_ua
),

_final AS(
  SELECT * FROM _merged_step1
)

SELECT * FROM _final
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`Date`, `Campaign`, `Medium`, `Source`, `ProductCategory`, `Transactions`, `Keyword`, `KeywordMatchType`, `Partner`, `CampaignID`)
    values
        (`Date`, `Campaign`, `Medium`, `Source`, `ProductCategory`, `Transactions`, `Keyword`, `KeywordMatchType`, `Partner`, `CampaignID`)


    
[0m08:41:10.773312 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a4f200ea-6404-474a-b620-48f43392363c&page=queryresults
[0m08:41:10.794640 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:af18d1bb-5ac5-4aa8-a016-e78d09c3f283&page=queryresults
[0m08:41:10.892427 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e244c2b6-c4ba-4638-a5ee-4d10f095a63b&page=queryresults
[0m08:41:11.956636 [debug] [Thread-1 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:41:11.958624 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m08:41:11.959587 [debug] [Thread-1 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.Date = DBT_INTERNAL_DEST.Date
                ) and (
                    DBT_INTERNAL_SOURCE.CampaignID = DBT_INTERNAL_DEST.CampaignID
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Sessions` = DBT_INTERNAL_SOURCE.`Sessions`,`Sessions_Engaged` = DBT_INTERNAL_SOURCE.`Sessions_Engaged`,`Engagement_Rate` = DBT_INTERNAL_SOURCE.`Engagement_Rate`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`
    

    when not matched then insert
        (`Date`, `CampaignID`, `Sessions`, `Sessions_Engaged`, `Engagement_Rate`, `Medium`, `Source`, `Partner`, `Keyword`, `KeywordMatchType`)
    values
        (`Date`, `CampaignID`, `Sessions`, `Sessions_Engaged`, `Engagement_Rate`, `Medium`, `Source`, `Partner`, `Keyword`, `KeywordMatchType`)


    
[0m08:41:12.144415 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6b80c791-a1ea-4e63-9c79-794f89e8bd43&page=queryresults
[0m08:41:14.206393 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (execute): 08:41:03.905705 => 08:41:14.206393
[0m08:41:14.207389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F2379310>]}
[0m08:41:14.208373 [info ] [Thread-1 (]: 26 of 32 OK created sql incremental model mart.mrt_google_analytics_campaign_webperformance  [[32mMERGE (409.0 rows, 1.3 MiB processed)[0m in 10.32s]
[0m08:41:14.209350 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m08:41:18.236672 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (execute): 08:41:09.874204 => 08:41:18.235677
[0m08:41:18.237670 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F2209BD0>]}
[0m08:41:18.239628 [info ] [Thread-3 (]: 32 of 32 OK created sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [[32mMERGE (5.5k rows, 717.0 MiB processed)[0m in 8.37s]
[0m08:41:18.241662 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m08:41:18.420505 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (execute): 08:41:09.815748 => 08:41:18.420505
[0m08:41:18.422534 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F0B270D0>]}
[0m08:41:18.422534 [info ] [Thread-4 (]: 30 of 32 OK created sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [[32mMERGE (25.0k rows, 719.7 MiB processed)[0m in 8.63s]
[0m08:41:18.424493 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m08:41:18.496696 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (execute): 08:41:09.819737 => 08:41:18.496696
[0m08:41:18.497727 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6933a5f-aeeb-4e58-956d-81defc3ec8e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251F2233E90>]}
[0m08:41:18.498738 [info ] [Thread-2 (]: 31 of 32 OK created sql table model mart.mrt_metainformation_campaigns ......... [[32mCREATE TABLE (2.2k rows, 716.5 MiB processed)[0m in 8.70s]
[0m08:41:18.499685 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_metainformation_campaigns
[0m08:41:18.501680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:41:18.502677 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:41:18.502677 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:41:18.503675 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:41:18.503675 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m08:41:18.504672 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m08:41:18.504672 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m08:41:18.506019 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance' was properly closed.
[0m08:41:18.506751 [debug] [MainThread]: Connection 'model.bq_evo.mrt_metainformation_campaigns' was properly closed.
[0m08:41:18.506751 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized' was properly closed.
[0m08:41:18.507751 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized' was properly closed.
[0m08:41:18.507751 [info ] [MainThread]: 
[0m08:41:18.508748 [info ] [MainThread]: Finished running 24 view models, 7 incremental models, 1 table model in 0 hours 0 minutes and 26.58 seconds (26.58s).
[0m08:41:18.514770 [debug] [MainThread]: Command end result
[0m08:41:18.532242 [info ] [MainThread]: 
[0m08:41:18.534239 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:41:18.535234 [info ] [MainThread]: 
[0m08:41:18.535234 [error] [MainThread]:   Database Error in model stg_meta_campaign_information (models\staging\meta\stg_meta_campaign_information.sql)
  Unrecognized name: campaign_name at [26:18]
  compiled Code at target\run\bq_evo\models\staging\meta\stg_meta_campaign_information.sql
[0m08:41:18.536230 [info ] [MainThread]: 
[0m08:41:18.537228 [error] [MainThread]:   Database Error in model stg_meta_campaign_stats (models\staging\meta\stg_meta_campaign_stats.sql)
  Unrecognized name: _fivetran_id at [15:9]
  compiled Code at target\run\bq_evo\models\staging\meta\stg_meta_campaign_stats.sql
[0m08:41:18.538225 [info ] [MainThread]: 
[0m08:41:18.540220 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=2 SKIP=3 TOTAL=32
[0m08:41:18.541218 [debug] [MainThread]: Command `dbt run` failed at 08:41:18.541218 after 29.49 seconds
[0m08:41:18.542214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EF833D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EFA697D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251E9AD2D50>]}
[0m08:41:18.542214 [debug] [MainThread]: Flushing usage events
[0m08:43:16.698446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40516EB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B404908710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B404515D10>]}


============================== 08:43:16.703467 | 97b7bd1f-bb00-4c07-a039-db9b1324554e ==============================
[0m08:43:16.703467 [info ] [MainThread]: Running with dbt=1.6.2
[0m08:43:16.705015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:43:17.051673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B405177ED0>]}
[0m08:43:17.060649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B405BCF9D0>]}
[0m08:43:17.060649 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m08:43:17.112428 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m08:43:17.212809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:43:17.213807 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\meta\stg_meta_campaign_information.sql
[0m08:43:17.213807 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\meta\stg_meta_campaign_stats.sql
[0m08:43:17.266182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40668BA50>]}
[0m08:43:17.286128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4065A93D0>]}
[0m08:43:17.286128 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m08:43:17.287126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B405B72010>]}
[0m08:43:17.290150 [info ] [MainThread]: 
[0m08:43:17.292111 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:43:17.294140 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:43:17.295104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:43:17.296102 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:43:17.297101 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:43:17.298063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:43:17.299066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:43:20.021050 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m08:43:20.022082 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m08:43:20.022082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:43:20.023045 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m08:43:20.024079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:43:20.026038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:43:20.690223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B405BBD550>]}
[0m08:43:20.691257 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:43:20.692217 [info ] [MainThread]: 
[0m08:43:20.696407 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_bing_ads_campaign_history
[0m08:43:20.697407 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m08:43:20.697407 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_google_ads_campaign_history
[0m08:43:20.697407 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_google_ads_campaign_stats
[0m08:43:20.698439 [info ] [Thread-1 (]: 1 of 32 START sql view model staging.stg_bing_ads_campaign_history ............. [RUN]
[0m08:43:20.699403 [info ] [Thread-2 (]: 2 of 32 START sql view model staging.stg_bing_ads_campaign_performance_daily_report  [RUN]
[0m08:43:20.700401 [info ] [Thread-3 (]: 3 of 32 START sql view model staging.stg_google_ads_campaign_history ........... [RUN]
[0m08:43:20.702394 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_history'
[0m08:43:20.701396 [info ] [Thread-4 (]: 4 of 32 START sql view model staging.stg_google_ads_campaign_stats ............. [RUN]
[0m08:43:20.704389 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_bing_ads_campaign_performance_daily_report'
[0m08:43:20.705393 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_history'
[0m08:43:20.706383 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_history
[0m08:43:20.707407 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.stg_google_ads_campaign_stats'
[0m08:43:20.707933 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m08:43:20.708934 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_history
[0m08:43:20.716914 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m08:43:20.717944 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_google_ads_campaign_stats
[0m08:43:20.721898 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m08:43:20.725155 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_history"
[0m08:43:20.729500 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m08:43:20.730498 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (compile): 08:43:20.708934 => 08:43:20.730498
[0m08:43:20.732460 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (compile): 08:43:20.717944 => 08:43:20.731460
[0m08:43:20.734452 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (compile): 08:43:20.723156 => 08:43:20.733459
[0m08:43:20.734452 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_history
[0m08:43:20.735450 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (compile): 08:43:20.726470 => 08:43:20.735450
[0m08:43:20.735450 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m08:43:20.736447 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_google_ads_campaign_history
[0m08:43:20.771008 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_history"
[0m08:43:20.771008 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_google_ads_campaign_stats
[0m08:43:20.774996 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"
[0m08:43:20.777987 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_history"
[0m08:43:20.781943 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_google_ads_campaign_stats"
[0m08:43:20.782944 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:43:20.783939 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:43:20.784938 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:43:20.785935 [debug] [Thread-1 (]: On model.bq_evo.stg_bing_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_history`
),


_added_columns AS (
    SELECT
        *,
        'cpc' as Medium,
        'bing' as Source,
        (CASE 
            WHEN account_id = 156001989 THEN 'EVO'
        END) as Partner,
    FROM _raw
),

_added_campaignid AS (
    SELECT 
        *,
        LOWER (CONCAT(name, Source, Medium, Partner)) as CampaignID
    FROM _added_columns
),

_final AS(
    SELECT *
    FROM _added_campaignid
)

SELECT * FROM _final;


[0m08:43:20.786937 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:43:20.786937 [debug] [Thread-2 (]: On model.bq_evo.stg_bing_ads_campaign_performance_daily_report: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_bing_ads_campaign_performance_daily_report"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`bingads`.`campaign_performance_daily_report`
),

_renamed_columns AS(
    SELECT 
        _fivetran_id,
        _fivetran_synced,
        account_id,
        ad_distribution,
        ad_relevance,
        all_conversions,
        all_conversions_qualified,
        all_return_on_ad_spend,
        all_revenue,
        assists,
        average_cpc,
        average_position,
        bid_match_type,
        budget_association_status,
        campaign_id,
        campaign_name,
        campaign_status,
        clicks as Clicks,
        conversions,
        conversions_qualified,
        ctr,
        currency_code,
        date as Date,
        delivered_match_type,
        device_os,
        device_type,
        expected_ctr,
        historical_ad_relevance,
        historical_expected_ctr,
        historical_landing_page_experience,
        historical_quality_score,
        impressions as Impressions,
        landing_page_experience,
        low_quality_clicks,
        low_quality_clicks_percent,
        low_quality_conversion_rate,
        low_quality_conversions,
        low_quality_conversions_qualified,
        low_quality_general_clicks,
        low_quality_impressions,
        low_quality_impressions_percent,
        low_quality_sophisticated_clicks,
        network,
        phone_calls,
        phone_impressions,
        quality_score,
        return_on_ad_spend,
        revenue,
        spend as Cost,
        top_vs_other,
        view_through_conversions
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m08:43:20.787929 [debug] [Thread-3 (]: On model.bq_evo.stg_google_ads_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt die \u00c4nderungshistorie der Kampagnen"""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_history`
),

_renamed_columns AS(
  SELECT
    _fivetran_start,
    id,
    _fivetran_active,
    _fivetran_end,
    _fivetran_synced,
    ad_serving_optimization_status,
    advertising_channel_subtype,
    advertising_channel_type,
    base_campaign_id,
    customer_id,
    end_date,
    experiment_type,
    final_url_suffix,
    frequency_caps,
    name as campaign,
    optimization_score,
    payment_mode,
    serving_status,
    start_date,
    status,
    tracking_url_template,
    updated_at,
    vanity_pharma_display_url_mode,
    vanity_pharma_text,
    video_brand_safety_suitability
  FROM _raw
),

_add_new_columns AS(
  SELECT 
    *,
    'google' as Source,
    'cpc' as Medium,
    (CASE
      WHEN customer_id = 6607387807 THEN 'EVO'  
      ELSE '(null)'
    END) as Partner
  FROM _renamed_columns
),

_final AS(
  SELECT
    *,
    LOWER(CONCAT(campaign, Source, Medium, Partner)) as CampaignID
  FROM _add_new_columns
)

SELECT * FROM _final;


[0m08:43:20.789924 [debug] [Thread-4 (]: On model.bq_evo.stg_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Google Ads Kampagnen"""
    )
  as WITH _raw AS(
    SELECT * 
    FROM `oss-big-query-dashboard-prod`.`google_ads`.`campaign_stats`

),

_transformed_cost AS(
    SELECT
        _fivetran_id,
        customer_id,
        date,
        _fivetran_synced,
        active_view_impressions,
        active_view_measurability,
        active_view_measurable_cost_micros,
        active_view_measurable_impressions,
        active_view_viewability,
        ad_network_type,
        base_campaign,
        clicks,
        conversions,
        conversions_value,
        cost_micros/1000000 as cost,
        device,
        id,
        impressions,
        interaction_event_types,
        interactions,
        view_through_conversions,
    FROM _raw
),

_final AS(
    SELECT * FROM _transformed_cost
)

SELECT * FROM _final;


[0m08:43:21.608856 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:9e054830-93c8-406f-b554-cb28a2a5e346&page=queryresults
[0m08:43:21.621548 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:b0eeab83-e7aa-45f1-a342-84cc14808bc9&page=queryresults
[0m08:43:21.640241 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:881feeb1-dfe3-4c44-a42b-d2b99de3d8b2&page=queryresults
[0m08:43:21.643232 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7dd8c231-492e-4a87-8823-e5ff2a6fc8f9&page=queryresults
[0m08:43:22.061805 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_performance_daily_report (execute): 08:43:20.772003 => 08:43:22.060812
[0m08:43:22.062765 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4067217D0>]}
[0m08:43:22.063762 [info ] [Thread-2 (]: 2 of 32 OK created sql view model staging.stg_bing_ads_campaign_performance_daily_report  [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m08:43:22.064320 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_performance_daily_report
[0m08:43:22.065321 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_google_analytics_352128287
[0m08:43:22.066323 [info ] [Thread-2 (]: 5 of 32 START sql view model staging.stg_google_analytics_352128287 ............ [RUN]
[0m08:43:22.067316 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_performance_daily_report, now model.bq_evo.stg_google_analytics_352128287)
[0m08:43:22.068316 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_google_analytics_352128287
[0m08:43:22.072324 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_352128287"
[0m08:43:22.073331 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (compile): 08:43:22.068756 => 08:43:22.073331
[0m08:43:22.074291 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_google_analytics_352128287
[0m08:43:22.079304 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_352128287"
[0m08:43:22.080278 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:43:22.081272 [debug] [Thread-2 (]: On model.bq_evo.stg_google_analytics_352128287: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_352128287"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
  OPTIONS(
      description="""Enth\u00e4lt alle GA4-Events in Tabellenform ohne Schachtelung. Bereinigt fehlerhafte Events ohne Session-ID. Offzielle Doku Google > https://support.google.com/analytics/answer/7029846?hl=en#zippy="""
    )
  as WITH _source AS(
  SELECT
    PARSE_DATE('%Y%m%d', event_date) as event_date,
    TIMESTAMP_MICROS(event_timestamp) as event_ts,
    
    MAX(CASE WHEN params.key = 'ga_session_id' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_id,
    user_pseudo_id,
    TIMESTAMP_MICROS(user_first_touch_timestamp) as user_first_touch_ts,

    event_name,

    params.key as params_key,
    params.value.string_value as params_string_value,
    params.value.int_value as params_int_value,
    params.value.float_value as params_float_value,
    params.value.double_value as params_double_value,

    (CASE WHEN traffic_source.name IS NULL THEN '(not set)' ELSE traffic_source.name END) as utm_campaign,
    (CASE WHEN traffic_source.medium IS NULL THEN '(not set)' ELSE traffic_source.medium END) as utm_medium,
    (CASE WHEN traffic_source.source IS NULL THEN '(not set)' ELSE traffic_source.source END) as utm_source,
    'EVO' as Partner,

    MAX(CASE WHEN params.key = 'page_title' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_title,
    MAX(CASE WHEN params.key = 'page_location' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_location,
    MAX(CASE WHEN params.key = 'page_referrer' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_referrer,
    MAX(CASE WHEN params.key = 'page_path' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as page_path,
    MAX(CASE WHEN params.key = 'percent_scrolled' THEN value.int_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as percent_scrolled,
    MAX(CASE WHEN params.key = 'session_engaged' THEN value.string_value ELSE NULL END) OVER (PARTITION BY event_timestamp, user_pseudo_id) as session_engaged,

    privacy_info.analytics_storage as analytics_storage,
    privacy_info.ads_storage as ads_storage,
    privacy_info.uses_transient_token as uses_transient_token,

    user_ltv.revenue as ltv_revenue,
    user_ltv.currency as ltv_currency,

    device.category as device_category,
    device.mobile_brand_name as device_brand,
    device.mobile_model_name as device_model_name,
    device.mobile_marketing_name as device_marketing_name,
    device.mobile_os_hardware_model as device_mobile_os_hardware_model,
    device.operating_system as device_os,
    device.operating_system_version as device_os_version,
    device.vendor_id as device_vendor_id,
    device.advertising_id as device_advertising_id,
    device.language as device_language,
    device.is_limited_ad_tracking as device_is_limited_ad_tracking,
    device.time_zone_offset_seconds as device_time_zone_offset_seconds,
    device.browser as device_browser,
    device.browser_version as device_browser_version,
    device.web_info.browser as device_web_info_browser,
    device.web_info.browser_version as device_web_info_browser_version,
    device.web_info.hostname as browser_web_info_hostname,

    geo.continent as continent,
    geo.country as country,
    geo.region as region,
    geo.city as city,
    geo.sub_continent as sub_continent,
    geo.metro as metropolitan_area,

    app_info.id as app_id,
    app_info.version as app_version,
    app_info.install_store as app_install_store,
    app_info.firebase_app_id as app_firebase_app_id,
    app_info.install_source as app_install_source,

    event_dimensions.hostname as event_hostname,

    ecommerce.total_item_quantity as total_item_quantity,
    ecommerce.purchase_revenue_in_usd as purchase_revenue_in_usd,
    ecommerce.purchase_revenue as purchase_revenue,
    ecommerce.refund_value_in_usd as refund_value_in_usd,
    ecommerce.refund_value as refund_value,
    ecommerce.shipping_value_in_usd as shipping_value_in_usd,
    ecommerce.shipping_value as shipping_value,
    ecommerce.tax_value_in_usd as tax_value_in_usd,
    ecommerce.tax_value as tax_value,
    ecommerce.unique_items as unique_items,
    ecommerce.transaction_id as transaction_id,
    
    items.item_id as item_id,
    items.item_name as item_name,
    items.item_brand as item_brand,
    items.item_variant as item_variant,
    items.item_category as item_category,
    items.item_category2 as item_category2,
    items.item_category3 as item_category3,
    items.item_category4 as item_category4,
    items.item_category5 as item_category5,
    items.price_in_usd as price_in_usd,
    items.price as price,
    items.quantity as quantity,
    items.item_revenue_in_usd as item_revenue_in_usd,
    items.item_revenue as item_revenue,
    items.item_refund_in_usd as item_refund_in_usd,
    items.item_refund as item_refund,
    items.coupon as coupon,
    items.affiliation as affiliation,
    items.location_id as location_id,
    items.item_list_id as item_list_id,
    items.item_list_name as item_list_name,
    items.item_list_index as item_list_index,
    items.promotion_id as promotion_id,
    items.promotion_name as promotion_name,
    items.creative_name as creative_name,
    items.creative_slot as creative_slot,

    collected_traffic_source.manual_campaign_id as manual_campaign_id,
    collected_traffic_source.manual_campaign_name as manual_campaign_name,
    collected_traffic_source.manual_source as manual_source,
    collected_traffic_source.manual_medium as manual_medium,
    collected_traffic_source.manual_term as manual_term,
    collected_traffic_source.manual_content as manual_content,
    collected_traffic_source.gclid as gclid,
    collected_traffic_source.dclid as dclid,
    collected_traffic_source.srsltid as srsltid

  FROM `oss-big-query-dashboard-prod`.`analytics_352128287`.`events_*` as events
  LEFT JOIN UNNEST (event_params) as params
  /*LEFT JOIN UNNEST (privacy_info) as privacy_info
  LEFT JOIN UNNEST (user_ltv) as user_ltv*/
  LEFT JOIN UNNEST(items) as items 
),

events_aggregated as (
  SELECT
    event_date,
    event_ts,
    session_id,
    user_pseudo_id,
    user_first_touch_ts,
    event_name,

--Kampagneninformationen
    MAX(utm_campaign) as utm_campaign,
    MAX(utm_medium) as utm_medium,
    (CASE WHEN MAX(utm_source) = 'ig' THEN 'instagram' ELSE MAX(utm_source) END) as utm_source,
  --  (CASE WHEN MAX(utm_campaign) IS NULL THEN '(not set)' ELSE MAX(utm_campaign) END) as utm_campaign,
  --  (CASE WHEN MAX(utm_medium) IS NULL THEN '(not set)' ELSE MAX(utm_medium) END) as utm_medium,
  --  (CASE WHEN MAX(utm_source) IS NULL THEN '(not set)' ELSE MAX(utm_source) END) as utm_source,

--Seiteninformationen
    MAX(page_title) as page_title,
    MAX(page_location) as page_location,
    MAX(page_referrer) as page_referrer,
    MAX(page_path) as page_path,
    MAX(percent_scrolled) as percent_scrolled,
    MAX(session_engaged) as session_engaged,

--Privacy-Infos
    MAX(analytics_storage) as analytics_storage,
    MAX(ads_storage) as ads_storage,
    MAX(uses_transient_token) as uses_transient_token,

--Kundenwertinformationen
    MAX(ltv_revenue) as ltv_revenue,
    MAX(ltv_currency) as ltv_currency,

--Geräteinformationen
    MAX(device_category) as device_category,
    MAX(device_brand) as device_brand,
    MAX(device_model_name) as device_model_name,
    MAX(device_marketing_name) as device_marketing_name,
    MAX(device_mobile_os_hardware_model) as device_mobile_os_hardware_model,
    MAX(device_os) as device_os,
    MAX(device_os_version) as device_os_version,
    MAX(device_vendor_id) as device_vendor_id,
    MAX(device_advertising_id) as device_advertising_id,
    MAX(device_language) as device_language,
    MAX(device_is_limited_ad_tracking) as device_is_limited_ad_tracking,
    MAX(device_time_zone_offset_seconds) as device_time_zone_offset_seconds,
    MAX(device_browser) as device_browser,
    MAX(device_browser_version) as device_browser_version,
    MAX(device_web_info_browser) as device_web_info_browser,
    MAX(device_web_info_browser_version) as device_web_info_browser_version,
    MAX(browser_web_info_hostname) as browser_web_info_hostname,

--Gebietsinformationen
    MAX(continent) as continent,
    MAX(country) as country,
    MAX(region) as region,
    MAX(city) as city,
    MAX(sub_continent) as sub_continent,
    MAX(metropolitan_area) as metropolitan_area,

--App-Informationen
    MAX(app_id) as app_id,
    MAX(app_version) as app_version,
    MAX(app_install_store) as app_install_store,
    MAX(app_firebase_app_id) as app_firebase_app_id,
    MAX(app_install_source) as app_install_source,

    MAX(event_hostname) as event_hostname,

--E-Commerceinformationen
    MAX(total_item_quantity) as total_item_quantity,
    MAX(purchase_revenue_in_usd) as purchase_revenue_in_usd,
    MAX(purchase_revenue) as purchase_revenue,
    MAX(refund_value_in_usd) as refund_value_in_usd,
    MAX(refund_value) as refund_value,
    MAX(shipping_value_in_usd) as shipping_value_in_usd,
    MAX(shipping_value) as shipping_value,
    MAX(tax_value_in_usd) as tax_value_in_usd,
    MAX(tax_value) as tax_value,
    MAX(unique_items) as unique_items,
    MAX(transaction_id) as transaction_id,

--Warenkorbinformationen
    MAX(item_id) as item_id,
    MAX(item_name) as item_name,
    MAX(item_brand) as item_brand,
    MAX(item_variant) as item_variant,
    MAX(item_category) as item_category,
    MAX(item_category2) as item_category2,
    MAX(item_category3) as item_category3,
    MAX(item_category4) as item_category4,
    MAX(item_category5) as item_category5,
    MAX(price_in_usd) as price_in_usd,
    MAX(price) as price,
    MAX(quantity) as quantity,
    MAX(item_revenue_in_usd) as item_revenue_in_usd,
    MAX(item_revenue) as item_revenue,
    MAX(item_refund_in_usd) as item_refund_in_usd,
    MAX(item_refund) as item_refund,
    MAX(coupon) as coupon,
    MAX(affiliation) as affiliation,
    MAX(location_id) as location_id,
    MAX(item_list_id) as item_list_id,
    MAX(item_list_name) as item_list_name,
    MAX(item_list_index) as item_list_index,
    MAX(promotion_id) as promotion_id,
    MAX(promotion_name) as promotion_name,
    MAX(creative_name) as creative_name,
    MAX(creative_slot) as creative_slot,

--Manuelle Trackingparameter
    MAX(manual_campaign_id) as manual_campaign_id,
    MAX(manual_campaign_name) as manual_campaign_name,
    MAX(manual_source) as manual_source,
    MAX(manual_medium) as manual_medium,
    MAX(manual_term) as manual_term,
    MAX(manual_content) as manual_content,
    MAX(gclid) as gclid,
    MAX(dclid) as dclid,
    MAX(srsltid) as srsltid

  FROM _source
  WHERE session_id <> 0
  GROUP BY 1,2,3,4,5,6
)

SELECT *
  --DISTINCT event_date
FROM events_aggregated;


[0m08:43:22.091902 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_ads_campaign_history (execute): 08:43:20.774996 => 08:43:22.091902
[0m08:43:22.092903 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B405BBD550>]}
[0m08:43:22.094478 [info ] [Thread-3 (]: 3 of 32 OK created sql view model staging.stg_google_ads_campaign_history ...... [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m08:43:22.096121 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_google_ads_campaign_history
[0m08:43:22.096121 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_google_analytics_historic_campaigns
[0m08:43:22.097150 [info ] [Thread-3 (]: 6 of 32 START sql view model staging.stg_google_analytics_historic_campaigns ... [RUN]
[0m08:43:22.098114 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_ads_campaign_history, now model.bq_evo.stg_google_analytics_historic_campaigns)
[0m08:43:22.099112 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_campaigns
[0m08:43:22.102139 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_campaigns"
[0m08:43:22.104102 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_analytics_historic_campaigns (compile): 08:43:22.099112 => 08:43:22.103134
[0m08:43:22.105098 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_google_analytics_historic_campaigns
[0m08:43:22.109121 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_campaigns"
[0m08:43:22.111080 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:43:22.111080 [debug] [Thread-3 (]: On model.bq_evo.stg_google_analytics_historic_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle historischen Kampagnen aus Universal Analytics / GA3"""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_campaigns`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m08:43:22.339493 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_bing_ads_campaign_history (execute): 08:43:20.737468 => 08:43:22.338496
[0m08:43:22.340491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40644D6D0>]}
[0m08:43:22.340491 [info ] [Thread-1 (]: 1 of 32 OK created sql view model staging.stg_bing_ads_campaign_history ........ [[32mCREATE VIEW (0 processed)[0m in 1.64s]
[0m08:43:22.342485 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_bing_ads_campaign_history
[0m08:43:22.343482 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m08:43:22.344480 [info ] [Thread-1 (]: 7 of 32 START sql view model staging.stg_google_analytics_historic_goal_conversions  [RUN]
[0m08:43:22.345477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_bing_ads_campaign_history, now model.bq_evo.stg_google_analytics_historic_goal_conversions)
[0m08:43:22.346475 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m08:43:22.349466 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_goal_conversions"
[0m08:43:22.351462 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_historic_goal_conversions (compile): 08:43:22.347472 => 08:43:22.350464
[0m08:43:22.351462 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m08:43:22.355451 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_goal_conversions"
[0m08:43:22.356448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:43:22.357580 [debug] [Thread-1 (]: On model.bq_evo.stg_google_analytics_historic_goal_conversions: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_goal_conversions"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_goal_conversions`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_goal_conversions`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m08:43:22.360440 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_ads_campaign_stats (execute): 08:43:20.778977 => 08:43:22.360440
[0m08:43:22.362434 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40642A450>]}
[0m08:43:22.363432 [info ] [Thread-4 (]: 4 of 32 OK created sql view model staging.stg_google_ads_campaign_stats ........ [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m08:43:22.364429 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_google_ads_campaign_stats
[0m08:43:22.365426 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_google_analytics_historic_transactions
[0m08:43:22.366424 [info ] [Thread-4 (]: 8 of 32 START sql view model staging.stg_google_analytics_historic_transactions  [RUN]
[0m08:43:22.367422 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_ads_campaign_stats, now model.bq_evo.stg_google_analytics_historic_transactions)
[0m08:43:22.368419 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_google_analytics_historic_transactions
[0m08:43:22.370413 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_google_analytics_historic_transactions"
[0m08:43:22.373002 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_analytics_historic_transactions (compile): 08:43:22.368419 => 08:43:22.371920
[0m08:43:22.374009 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_google_analytics_historic_transactions
[0m08:43:22.377050 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_google_analytics_historic_transactions"
[0m08:43:22.378054 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:43:22.379058 [debug] [Thread-4 (]: On model.bq_evo.stg_google_analytics_historic_transactions: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_google_analytics_historic_transactions"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_transactions`
  OPTIONS(
      description=""""""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`manual_data_upload`.`universal_analytics_historic_transactions`
),

_final AS(
    SELECT *
    FROM _raw
)

SELECT * FROM _final;


[0m08:43:22.836829 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:11a32b5e-6784-4ec9-b1d1-90a88ca25923&page=queryresults
[0m08:43:22.844842 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:580b995b-9791-4964-a939-ab081c9e6e54&page=queryresults
[0m08:43:23.099945 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:fd33ea8c-7acc-498e-8706-11446c7d6859&page=queryresults
[0m08:43:23.352879 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:75aaf9ea-eb93-479e-8301-4cb93c3d475c&page=queryresults
[0m08:43:23.483212 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_google_analytics_historic_goal_conversions (execute): 08:43:22.352459 => 08:43:23.483212
[0m08:43:23.484209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4065881D0>]}
[0m08:43:23.485208 [info ] [Thread-1 (]: 7 of 32 OK created sql view model staging.stg_google_analytics_historic_goal_conversions  [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m08:43:23.486203 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_google_analytics_historic_goal_conversions
[0m08:43:23.487201 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m08:43:23.488199 [info ] [Thread-1 (]: 9 of 32 START sql view model staging.stg_linkedin_ad_analytics_by_campaign ..... [RUN]
[0m08:43:23.489198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_historic_goal_conversions, now model.bq_evo.stg_linkedin_ad_analytics_by_campaign)
[0m08:43:23.490196 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m08:43:23.493219 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m08:43:23.495179 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (compile): 08:43:23.490196 => 08:43:23.494212
[0m08:43:23.496176 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m08:43:23.500202 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"
[0m08:43:23.502162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:43:23.503158 [debug] [Thread-1 (]: On model.bq_evo.stg_linkedin_ad_analytics_by_campaign: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_ad_analytics_by_campaign"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Linkedin-Kampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS (
    SELECT *    
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`ad_analytics_by_campaign`
),

_renamed_columns AS (
    SELECT
        campaign_id,
        day as Date,
        _fivetran_synced,
        action_clicks,
        ad_unit_clicks,
        approximate_unique_impressions,
        card_clicks,
        card_impressions,
        clicks as Clicks,
        comment_likes,
        comments,
        company_page_clicks,
        conversion_value_in_local_currency,
        cost_in_local_currency as Cost,
        cost_in_usd,
        external_website_conversions,
        external_website_post_click_conversions,
        external_website_post_view_conversions,
        follows,
        full_screen_plays,
        impressions as Impressions,
        landing_page_clicks,
        lead_generation_mail_contact_info_shares,
        lead_generation_mail_interested_clicks,
        likes,
        one_click_lead_form_opens,
        one_click_leads,
        opens,
        other_engagements,
        sends,
        shares,
        text_url_clicks,
        total_engagements,
        video_completions,
        video_first_quartile_completions,
        video_midpoint_completions,
        video_starts,
        video_third_quartile_completions,
        video_views,
        viral_card_clicks,
        viral_card_impressions,
        viral_clicks,
        viral_comment_likes,
        viral_comments,
        viral_company_page_clicks,
        viral_external_website_conversions,
        viral_external_website_post_click_conversions,
        viral_external_website_post_view_conversions,
        viral_follows,
        viral_full_screen_plays,
        viral_impressions,
        viral_landing_page_clicks,
        viral_likes,
        viral_one_click_lead_form_opens,
        viral_one_click_leads,
        viral_other_engagements,
        viral_shares,
        viral_total_engagements,
        viral_video_completions,
        viral_video_first_quartile_completions,
        viral_video_midpoint_completions,
        viral_video_starts,
        viral_video_third_quartile_completions,
        viral_video_views
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m08:43:23.523178 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_google_analytics_historic_campaigns (execute): 08:43:22.106093 => 08:43:23.523178
[0m08:43:23.525200 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_google_analytics_352128287 (execute): 08:43:22.075289 => 08:43:23.524189
[0m08:43:23.525200 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40651C8D0>]}
[0m08:43:23.526361 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4067A4250>]}
[0m08:43:23.527361 [info ] [Thread-3 (]: 6 of 32 OK created sql view model staging.stg_google_analytics_historic_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m08:43:23.528359 [info ] [Thread-2 (]: 5 of 32 OK created sql view model staging.stg_google_analytics_352128287 ....... [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m08:43:23.529356 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_google_analytics_historic_campaigns
[0m08:43:23.530353 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_google_analytics_352128287
[0m08:43:23.531351 [debug] [Thread-3 (]: Began running node model.bq_evo.stg_linkedin_campaign_history
[0m08:43:23.532561 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_meta_campaign_information
[0m08:43:23.533563 [info ] [Thread-3 (]: 10 of 32 START sql view model staging.stg_linkedin_campaign_history ............ [RUN]
[0m08:43:23.534559 [info ] [Thread-2 (]: 11 of 32 START sql view model staging.stg_meta_campaign_information ............ [RUN]
[0m08:43:23.535557 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_historic_campaigns, now model.bq_evo.stg_linkedin_campaign_history)
[0m08:43:23.536555 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_352128287, now model.bq_evo.stg_meta_campaign_information)
[0m08:43:23.537579 [debug] [Thread-3 (]: Began compiling node model.bq_evo.stg_linkedin_campaign_history
[0m08:43:23.538548 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_meta_campaign_information
[0m08:43:23.542538 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.stg_linkedin_campaign_history"
[0m08:43:23.546567 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_meta_campaign_information"
[0m08:43:23.547526 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (compile): 08:43:23.539546 => 08:43:23.547526
[0m08:43:23.548522 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_meta_campaign_information (compile): 08:43:23.543570 => 08:43:23.548522
[0m08:43:23.549521 [debug] [Thread-3 (]: Began executing node model.bq_evo.stg_linkedin_campaign_history
[0m08:43:23.549521 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_meta_campaign_information
[0m08:43:23.553511 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.stg_linkedin_campaign_history"
[0m08:43:23.557514 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_meta_campaign_information"
[0m08:43:23.559501 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:43:23.560498 [debug] [Thread-3 (]: On model.bq_evo.stg_linkedin_campaign_history: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_linkedin_campaign_history"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`linkedin_ads`.`campaign_history`
),

_renamed_columns AS(
    SELECT
        id,
        last_modified_time,
        _fivetran_synced,
        account_id,
        associated_entity,
        audience_expansion_enabled,
        campaign_group_id,
        cost_type,
        created_time,
        creative_selection,
        daily_budget_amount,
        daily_budget_currency_code,
        format,
        locale_country,
        locale_language,
        name as Campaign,
        objective_type,
        offsite_delivery_enabled,
        optimization_target_type,
        run_schedule_end,
        run_schedule_start,
        status,
        type,
        unit_cost_amount,
        unit_cost_currency_code,
        version_tag
    FROM _raw
),

_final AS(
    SELECT *
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m08:43:23.562517 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:43:23.563488 [debug] [Thread-2 (]: On model.bq_evo.stg_meta_campaign_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_meta_campaign_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen. Inklusive Informationen \u00fcber zugeh\u00f6rige Anzeigengruppen und Anzeigen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`facebook_ads`.`fb_campaign_information`
),

_renamed_columns AS(
    SELECT 
        * EXCEPT (campaign_name),
        campaign_name as Campaign
    FROM _raw
),

_added_more_metadata AS(
    SELECT 
        *,
        'cpc' as Medium,
        'EVO' as Partner,
        CASE
            WHEN Campaign LIKE '%:IG%' AND Campaign NOT LIKE '%:FB:IG:%' THEN 'instagram'
            WHEN Campaign LIKE '%:FB:IG:%' OR Campaign LIKE '%:FB:%' THEN 'facebook'
            ELSE '(not set)'
        END AS Source,
        'true' as IsPaid,
        LOWER (CONCAT(Campaign, Source, Medium, Partner)) as CampaignID
    FROM _renamed_columns
),

_final AS(
    SELECT *
    FROM _added_more_metadata
)

SELECT * FROM _final;


[0m08:43:23.763025 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_google_analytics_historic_transactions (execute): 08:43:22.374009 => 08:43:23.763025
[0m08:43:23.764022 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4066C3B90>]}
[0m08:43:23.765019 [info ] [Thread-4 (]: 8 of 32 OK created sql view model staging.stg_google_analytics_historic_transactions  [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m08:43:23.766017 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_google_analytics_historic_transactions
[0m08:43:23.767015 [debug] [Thread-4 (]: Began running node model.bq_evo.stg_meta_campaign_stats
[0m08:43:23.768012 [info ] [Thread-4 (]: 12 of 32 START sql view model staging.stg_meta_campaign_stats .................. [RUN]
[0m08:43:23.770007 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_google_analytics_historic_transactions, now model.bq_evo.stg_meta_campaign_stats)
[0m08:43:23.770007 [debug] [Thread-4 (]: Began compiling node model.bq_evo.stg_meta_campaign_stats
[0m08:43:23.772998 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.stg_meta_campaign_stats"
[0m08:43:23.774504 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_meta_campaign_stats (compile): 08:43:23.771004 => 08:43:23.774504
[0m08:43:23.775505 [debug] [Thread-4 (]: Began executing node model.bq_evo.stg_meta_campaign_stats
[0m08:43:23.779493 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.stg_meta_campaign_stats"
[0m08:43:23.780491 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:43:23.781488 [debug] [Thread-4 (]: On model.bq_evo.stg_meta_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_meta_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Metakampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`facebook_ads`.`fb_basic_performance_per_day`
),

_renamed_columns AS (
    SELECT
        _fivetran_id,
        ad_id,
        date as Date,
        _fivetran_synced,
        account_id,
        adset_name,
        campaign_name as Campaign,
        clicks as Clicks,
        cpc,
        cpm,
        ctr,
        impressions as Impressions,
        reach,
        spend as Cost
    FROM _raw
),

_final AS (
    SELECT *    
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m08:43:24.247379 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:00d36445-c970-4327-a106-7c277f9a0378&page=queryresults
[0m08:43:24.333030 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7df5b9a8-6e44-4e1e-a613-66fcb75451c1&page=queryresults
[0m08:43:24.353072 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:81217694-215b-408b-987e-58f22b15dfb5&page=queryresults
[0m08:43:24.476887 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:0f7762ad-9d59-454c-8ee3-966265acec51&page=queryresults
[0m08:43:24.486342 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: Source at [31:33]')
[0m08:43:24.652150 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_linkedin_ad_analytics_by_campaign (execute): 08:43:23.496176 => 08:43:24.652150
[0m08:43:24.655138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4067E59D0>]}
[0m08:43:24.657160 [info ] [Thread-1 (]: 9 of 32 OK created sql view model staging.stg_linkedin_ad_analytics_by_campaign  [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m08:43:24.658625 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_linkedin_ad_analytics_by_campaign
[0m08:43:24.659666 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m08:43:24.660662 [info ] [Thread-1 (]: 13 of 32 START sql view model intermediate.int_google_ads_unique_campaigns ..... [RUN]
[0m08:43:24.662623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_linkedin_ad_analytics_by_campaign, now model.bq_evo.int_google_ads_unique_campaigns)
[0m08:43:24.662623 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m08:43:24.667643 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m08:43:24.669638 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 08:43:24.663653 => 08:43:24.668640
[0m08:43:24.669638 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m08:43:24.674592 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m08:43:24.676590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:43:24.676590 [debug] [Thread-1 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id ,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m08:43:24.717726 [debug] [Thread-3 (]: Timing info for model.bq_evo.stg_linkedin_campaign_history (execute): 08:43:23.550549 => 08:43:24.717726
[0m08:43:24.718722 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4066D1D10>]}
[0m08:43:24.718722 [info ] [Thread-3 (]: 10 of 32 OK created sql view model staging.stg_linkedin_campaign_history ....... [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m08:43:24.720723 [debug] [Thread-3 (]: Finished running node model.bq_evo.stg_linkedin_campaign_history
[0m08:43:24.721682 [debug] [Thread-3 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m08:43:24.722679 [info ] [Thread-3 (]: 14 of 32 START sql view model intermediate.int_bing_ads_unique_campaigns ....... [RUN]
[0m08:43:24.723679 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_linkedin_campaign_history, now model.bq_evo.int_bing_ads_unique_campaigns)
[0m08:43:24.724700 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_bing_ads_unique_campaigns
[0m08:43:24.730692 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m08:43:24.732667 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (compile): 08:43:24.724700 => 08:43:24.731694
[0m08:43:24.732667 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_bing_ads_unique_campaigns
[0m08:43:24.736642 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m08:43:24.738636 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:43:24.739635 [debug] [Thread-3 (]: On model.bq_evo.int_bing_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Bing Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id,
        MAX(name) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m08:43:24.870896 [debug] [Thread-4 (]: Timing info for model.bq_evo.stg_meta_campaign_stats (execute): 08:43:23.776502 => 08:43:24.870896
[0m08:43:24.871893 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40676E990>]}
[0m08:43:24.872891 [info ] [Thread-4 (]: 12 of 32 OK created sql view model staging.stg_meta_campaign_stats ............. [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m08:43:24.873888 [debug] [Thread-4 (]: Finished running node model.bq_evo.stg_meta_campaign_stats
[0m08:43:24.874885 [debug] [Thread-4 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m08:43:24.876880 [info ] [Thread-4 (]: 15 of 32 START sql view model intermediate.int_google_analytics_all_events ..... [RUN]
[0m08:43:24.877384 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_meta_campaign_stats, now model.bq_evo.int_google_analytics_all_events)
[0m08:43:24.878383 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m08:43:24.881375 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m08:43:24.882373 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 08:43:24.878383 => 08:43:24.882373
[0m08:43:24.883370 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m08:43:24.886362 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m08:43:24.887360 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:43:24.888358 [debug] [Thread-4 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_final AS(
    SELECT *
    FROM _rename_columns
)

SELECT * FROM _final;


[0m08:43:25.365894 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a623c864-0b72-415a-a89c-c11186b26fc5&page=queryresults
[0m08:43:25.483470 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ae479a74-2f05-4b99-acde-92feeb759606&page=queryresults
[0m08:43:25.565638 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:babe3596-61b1-467e-ad89-85920b3ba72f&page=queryresults
[0m08:43:25.636637 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6f34c6a0-ec91-4463-9bc5-16c92b4ca572&page=queryresults
[0m08:43:25.757004 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6f34c6a0-ec91-4463-9bc5-16c92b4ca572&page=queryresults
[0m08:43:25.759386 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_meta_campaign_information (execute): 08:43:23.553511 => 08:43:25.759386
[0m08:43:25.777375 [debug] [Thread-2 (]: Database Error in model stg_meta_campaign_information (models\staging\meta\stg_meta_campaign_information.sql)
  Unrecognized name: Source at [31:33]
  compiled Code at target\run\bq_evo\models\staging\meta\stg_meta_campaign_information.sql
[0m08:43:25.778917 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4066A0310>]}
[0m08:43:25.779919 [error] [Thread-2 (]: 11 of 32 ERROR creating sql view model staging.stg_meta_campaign_information ... [[31mERROR[0m in 2.24s]
[0m08:43:25.780954 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_meta_campaign_information
[0m08:43:25.781913 [debug] [Thread-2 (]: Began running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m08:43:25.782910 [info ] [Thread-2 (]: 16 of 32 START sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [RUN]
[0m08:43:25.783940 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_meta_campaign_information, now model.bq_evo.int_linkedin_unique_campaigns_reduced_information)
[0m08:43:25.783940 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m08:43:25.786927 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m08:43:25.788897 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (compile): 08:43:25.784904 => 08:43:25.788897
[0m08:43:25.789891 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m08:43:25.792883 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m08:43:25.794887 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:43:25.795878 [debug] [Thread-2 (]: On model.bq_evo.int_linkedin_unique_campaigns_reduced_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Linkedin-Kampagnen - gg\u00fc. Quelldaten nur ausgew\u00e4hlte Spalten f\u00fcr Weiterverarbeitung NDG."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
),

_selected_columns AS (
    SELECT
        id as campaign_id,
        Campaign, 
        "EVO" as Partner, 
        "cpc" as Medium, 
        "linkedin" as Source, 
        LOWER(CONCAT(Campaign, "linkedin", "cpc", "EVO")) AS CampaignID 
    
    FROM _raw
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _selected_columns
)

SELECT * FROM _final;


[0m08:43:26.026929 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 08:43:24.671600 => 08:43:26.025934
[0m08:43:26.027928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B406A3F950>]}
[0m08:43:26.027928 [info ] [Thread-1 (]: 13 of 32 OK created sql view model intermediate.int_google_ads_unique_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m08:43:26.029922 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m08:43:26.029922 [debug] [Thread-1 (]: Began running node model.bq_evo.int_meta_unique_campaigns
[0m08:43:26.030886 [info ] [Thread-1 (]: 17 of 32 SKIP relation intermediate.int_meta_unique_campaigns .................. [[33mSKIP[0m]
[0m08:43:26.031882 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_meta_unique_campaigns
[0m08:43:26.032914 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m08:43:26.033905 [info ] [Thread-1 (]: 18 of 32 START sql view model intermediate.int_google_ads_campaign_stats ....... [RUN]
[0m08:43:26.034875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_unique_campaigns, now model.bq_evo.int_google_ads_campaign_stats)
[0m08:43:26.035874 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m08:43:26.039861 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m08:43:26.041860 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 08:43:26.036871 => 08:43:26.040859
[0m08:43:26.042861 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m08:43:26.046879 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m08:43:26.047874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:43:26.048839 [debug] [Thread-1 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
),

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m08:43:26.163177 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (execute): 08:43:24.733651 => 08:43:26.163177
[0m08:43:26.164174 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B406A56810>]}
[0m08:43:26.165180 [info ] [Thread-3 (]: 14 of 32 OK created sql view model intermediate.int_bing_ads_unique_campaigns .. [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m08:43:26.166171 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m08:43:26.167170 [debug] [Thread-3 (]: Began running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:43:26.167170 [info ] [Thread-3 (]: 19 of 32 SKIP relation intermediate.int_meta_campaign_stats_joined_campaign_names  [[33mSKIP[0m]
[0m08:43:26.168166 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:43:26.169198 [debug] [Thread-3 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m08:43:26.170162 [info ] [Thread-3 (]: 20 of 32 START sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [RUN]
[0m08:43:26.171159 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_unique_campaigns, now model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names)
[0m08:43:26.172157 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m08:43:26.175149 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m08:43:26.177162 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (compile): 08:43:26.172157 => 08:43:26.176144
[0m08:43:26.177162 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m08:43:26.183712 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m08:43:26.184708 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:43:26.185682 [debug] [Thread-3 (]: On model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne inkl. Klartext der Kampagne."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m08:43:26.251944 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 08:43:24.883370 => 08:43:26.251944
[0m08:43:26.252981 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4064F9510>]}
[0m08:43:26.254009 [info ] [Thread-4 (]: 15 of 32 OK created sql view model intermediate.int_google_analytics_all_events  [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m08:43:26.255044 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m08:43:26.255044 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:43:26.256498 [info ] [Thread-4 (]: 21 of 32 SKIP relation mart.mrt_meta_basic_campaign_stats ...................... [[33mSKIP[0m]
[0m08:43:26.257559 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:43:26.258563 [debug] [Thread-4 (]: Began running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m08:43:26.259560 [info ] [Thread-4 (]: 22 of 32 START sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [RUN]
[0m08:43:26.260620 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_events, now model.bq_evo.int_google_analytics_NDG_conversionevents_GA4)
[0m08:43:26.261666 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m08:43:26.263740 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m08:43:26.265820 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (compile): 08:43:26.261666 => 08:43:26.264777
[0m08:43:26.265820 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m08:43:26.270341 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m08:43:26.271339 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:43:26.272335 [debug] [Thread-4 (]: On model.bq_evo.int_google_analytics_NDG_conversionevents_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle relevanten Conversionevents aus Google Analytics 4 f\u00fcr NDG-Vermarktung. Inklusive aller E-Commerce-Events (ohne Metainformationen)."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_conversions_NDG as(
  SELECT 
    event_date as Date,
    event_name as ZielvorhabenName, 
    CampaignID,
    Source,
    Medium,

    MAX(Partner) as Partner,

    count(event_date) as Conversions,

  FROM _raw
  WHERE (
    event_name = 'lead_form_evo_solar_lp' OR
    event_name = 'evo_solar_pva_check_sent_available' OR
    event_name = 'contact_form_button' OR
    event_name = 'click_online_application' OR
    event_name = 'oss_registration_doi' OR
    event_name = 'click_tarifrechnernutzung' OR
    event_name = 'conversion_solarrechner' OR
    event_name = 'purchase'
  )

  GROUP BY 1,2,3,4,5
),

_added_columns AS(
  SELECT 
      Date,
      ZielvorhabenName,
      LOWER(CONCAT(ZielvorhabenName, Partner)) as ZielvorhabenID,
      CampaignID,
      Source,
      Medium,
      Partner,
      '(not set)' as Keyword,
      '(not set)' as KeywordMatchType,
      Conversions
  FROM _conversions_NDG
),

_final AS(
  SELECT *
  FROM _added_columns
)

SELECT * FROM _final;


[0m08:43:26.495042 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:131e1e70-81fa-45d9-bbdf-e25831d445d3&page=queryresults
[0m08:43:26.796849 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:12677b40-295c-4f8d-8a6d-6ef84aadc789&page=queryresults
[0m08:43:26.884546 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (execute): 08:43:25.789891 => 08:43:26.884546
[0m08:43:26.885585 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B406725310>]}
[0m08:43:26.886578 [info ] [Thread-2 (]: 16 of 32 OK created sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m08:43:26.888222 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m08:43:26.889222 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_analytics_all_campaigns
[0m08:43:26.889222 [info ] [Thread-2 (]: 23 of 32 START sql view model intermediate.int_google_analytics_all_campaigns .. [RUN]
[0m08:43:26.890221 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_linkedin_unique_campaigns_reduced_information, now model.bq_evo.int_google_analytics_all_campaigns)
[0m08:43:26.891217 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_analytics_all_campaigns
[0m08:43:26.894209 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m08:43:26.895206 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (compile): 08:43:26.891217 => 08:43:26.895206
[0m08:43:26.896204 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_analytics_all_campaigns
[0m08:43:26.901190 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m08:43:26.902188 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:43:26.903196 [debug] [Thread-2 (]: On model.bq_evo.int_google_analytics_all_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagnen aus GA4 und GA3."""
    )
  as WITH _historic_ua_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
),

ga4_campaigns AS(
    SELECT 
        MAX(Campaign),
        MAX(Partner),
        MAX(Source),
        MAX(Medium),
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
    GROUP BY 5
),

_final AS(
    SELECT * FROM _historic_ua_campaigns
    UNION DISTINCT
    SELECT * FROM ga4_campaigns
)

SELECT * FROM _final;


[0m08:43:26.974025 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e09ff603-b193-4a99-b9ef-ceb929db5b46&page=queryresults
[0m08:43:27.022484 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:675eb7a9-c68b-451c-8ce7-5f5e30865179&page=queryresults
[0m08:43:27.476492 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 08:43:26.042861 => 08:43:27.475494
[0m08:43:27.478513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40678B890>]}
[0m08:43:27.478513 [info ] [Thread-1 (]: 18 of 32 OK created sql view model intermediate.int_google_ads_campaign_stats .. [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m08:43:27.480509 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m08:43:27.480509 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m08:43:27.481990 [info ] [Thread-1 (]: 24 of 32 START sql view model intermediate.int_google_analytics_all_purchases_GA4  [RUN]
[0m08:43:27.483026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_campaign_stats, now model.bq_evo.int_google_analytics_all_purchases_GA4)
[0m08:43:27.483026 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m08:43:27.486017 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m08:43:27.487980 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (compile): 08:43:27.484005 => 08:43:27.487013
[0m08:43:27.487980 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m08:43:27.492975 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m08:43:27.496956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:43:27.496956 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_all_purchases_GA4: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_purchases_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle <purchase-events> aus Google Analytics 4. Inkl. aller zugeh\u00f6rigen Metainformationen aus GA4."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_select_purchase_events AS(
  SELECT * FROM _raw
  WHERE event_name = "purchase"
),

_final AS(
    SELECT *
    FROM _select_purchase_events
)

SELECT * FROM _final;


[0m08:43:27.543466 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c3b40ab1-e0d0-40b6-b2f1-7463b34103a3&page=queryresults
[0m08:43:27.626863 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (execute): 08:43:26.267280 => 08:43:27.626863
[0m08:43:27.627822 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4064FB2D0>]}
[0m08:43:27.628853 [info ] [Thread-4 (]: 22 of 32 OK created sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m08:43:27.629815 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m08:43:27.629815 [debug] [Thread-4 (]: Began running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m08:43:27.630813 [info ] [Thread-4 (]: 25 of 32 START sql incremental model mart.mrt_google_analytics_campaign_webperformance  [RUN]
[0m08:43:27.631843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_NDG_conversionevents_GA4, now model.bq_evo.mrt_google_analytics_campaign_webperformance)
[0m08:43:27.632809 [debug] [Thread-4 (]: Began compiling node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m08:43:27.641785 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m08:43:27.643781 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (compile): 08:43:27.633806 => 08:43:27.642782
[0m08:43:27.643781 [debug] [Thread-4 (]: Began executing node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m08:43:27.703136 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:43:27.704133 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (execute): 08:43:26.178139 => 08:43:27.704133
[0m08:43:27.705130 [debug] [Thread-4 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt grundlegende Web-Performancewerte aller \u00fcber GA4 erfassten Kampagnen.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`

    

      WHERE
      --Update table for the past seven days + today
      event_date >= current_date()-7
        
    
),

sessions_by_campaign AS(
  SELECT
    event_date as Date,
    CampaignID,

    COUNT(DISTINCT(CONCAT(user_pseudo_id,session_id))) as Sessions,
    COUNT(DISTINCT 
      CASE 
        WHEN session_engaged = '1' THEN CONCAT(user_pseudo_id,session_id) 
      END) as Sessions_Engaged,
    MAX(Medium) as Medium,
    MAX(Source) as Source,
    MAX(Partner) as Partner,

  FROM _raw
  GROUP BY 1,2
),

_add_engagement_rate AS(
    SELECT 
        Date,
        CampaignID,
        Sessions,
        Sessions_Engaged,
        (CASE
            WHEN Sessions > 0 THEN (Sessions_Engaged / Sessions) 
            ELSE 0
        END) as Engagement_Rate,
        Medium,
        Source,
        Partner
    FROM sessions_by_campaign
),

_added_columns AS(
    SELECT
        *,
        '(not set)' as Keyword,
        '(not set)' as KeywordMatchType
    FROM _add_engagement_rate
),

_final AS(
    SELECT *
    FROM _added_columns
)

SELECT * FROM _final
    );
  
[0m08:43:27.706128 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40657AD10>]}
[0m08:43:27.709118 [info ] [Thread-3 (]: 20 of 32 OK created sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.54s]
[0m08:43:27.711114 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m08:43:27.712110 [debug] [Thread-3 (]: Began running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m08:43:27.713109 [info ] [Thread-3 (]: 26 of 32 START sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [RUN]
[0m08:43:27.714106 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names, now model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names)
[0m08:43:27.715103 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m08:43:27.718096 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m08:43:27.720091 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (compile): 08:43:27.715103 => 08:43:27.719093
[0m08:43:27.721086 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m08:43:27.724080 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m08:43:27.725078 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:43:27.726075 [debug] [Thread-3 (]: On model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.campaign_id = _raw_performance.campaign_id
),

_drop_campaign_id AS(
    SELECT * EXCEPT (campaign_id)
    FROM _joined
),

_final AS(
    SELECT 
        * EXCEPT(Date),
        CAST(Date AS DATE) as Date
    FROM _drop_campaign_id
)

SELECT * FROM _final;


[0m08:43:28.188284 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:32158e03-6003-46f1-b836-788cd3b2500d&page=queryresults
[0m08:43:28.224887 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (execute): 08:43:26.897201 => 08:43:28.223932
[0m08:43:28.226881 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4067C00D0>]}
[0m08:43:28.226881 [info ] [Thread-2 (]: 23 of 32 OK created sql view model intermediate.int_google_analytics_all_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m08:43:28.228877 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_analytics_all_campaigns
[0m08:43:28.229875 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m08:43:28.230873 [info ] [Thread-2 (]: 27 of 32 START sql incremental model mart.mrt_google_ads_basic_campaign_stats .. [RUN]
[0m08:43:28.231898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_campaigns, now model.bq_evo.mrt_google_ads_basic_campaign_stats)
[0m08:43:28.232865 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m08:43:28.235893 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m08:43:28.237855 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (compile): 08:43:28.232865 => 08:43:28.237855
[0m08:43:28.238851 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m08:43:28.242839 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:43:28.243837 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`

    

      WHERE
      --Update table for the past seven days + today
      date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    date as Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    impressions as Impressions,
    clicks as Clicks,
    cost as Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m08:43:28.446673 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:531a6546-08ee-4928-84c0-fb2d7cdc9f66&page=queryresults
[0m08:43:28.447701 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ec275d24-142e-4482-b667-a78ed4d03ab5&page=queryresults
[0m08:43:28.838162 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (execute): 08:43:27.721086 => 08:43:28.838162
[0m08:43:28.840185 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (execute): 08:43:27.488976 => 08:43:28.840185
[0m08:43:28.841149 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4065D6950>]}
[0m08:43:28.842145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4065B4990>]}
[0m08:43:28.843144 [info ] [Thread-3 (]: 26 of 32 OK created sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m08:43:28.843645 [info ] [Thread-1 (]: 24 of 32 OK created sql view model intermediate.int_google_analytics_all_purchases_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m08:43:28.845027 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m08:43:28.845714 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m08:43:28.846716 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m08:43:28.846716 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m08:43:28.847711 [info ] [Thread-3 (]: 28 of 32 START sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [RUN]
[0m08:43:28.848744 [info ] [Thread-1 (]: 29 of 32 START sql incremental model mart.mrt_bing_ads_basic_campaign_stats .... [RUN]
[0m08:43:28.850737 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names, now model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized)
[0m08:43:28.851701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_purchases_GA4, now model.bq_evo.mrt_bing_ads_basic_campaign_stats)
[0m08:43:28.852700 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m08:43:28.852700 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m08:43:28.856720 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m08:43:28.862671 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m08:43:28.863670 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (compile): 08:43:28.853695 => 08:43:28.863670
[0m08:43:28.864667 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (compile): 08:43:28.857721 => 08:43:28.864667
[0m08:43:28.865666 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m08:43:28.866664 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m08:43:28.870656 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:43:28.874643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:43:28.876640 [debug] [Thread-1 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt alle Vermarktungsstatistiken f\u00fcr das Performancereporting. Keine Conversioninformationen enthalten, somit keine Bewertung der Kampagnen m\u00f6glich. Lediglich deskriptive Informationen. Muss in Performancereporting mit Conversioninformationen verkn\u00fcpft werden.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
 
    

      WHERE
      --Update table for the past seven days + today
      Date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m08:43:28.908536 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a32e9012-069b-4fc0-8267-e434abfdedad&page=queryresults
[0m08:43:29.496394 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"
[0m08:43:29.498353 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized` as DBT_INTERNAL_DEST
        using (WITH ga4_conversions AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
    WHERE 
        Date > '2023-06-04'
),

ua_conversions AS(
    SELECT
        Date,
        NameZielvorhaben as ZielvorhabenName,
        LOWER(CONCAT(NameZielvorhaben, Partner)) as ZielvorhabenID,
        CampaignID,
        Source,
        Medium,
        Partner,
        Keyword,
        KeywordMatchType,
        Conversions
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_goal_conversions`
    WHERE Date <= '2023-06-04'
),

_merged_step1 AS(
    SELECT * FROM ga4_conversions
    UNION ALL
    SELECT * FROM ua_conversions
),

_final AS(
    SELECT *
    FROM _merged_step1
)

SELECT * FROM _final
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`Date`, `ZielvorhabenName`, `ZielvorhabenID`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Conversions`)
    values
        (`Date`, `ZielvorhabenName`, `ZielvorhabenID`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Conversions`)


    
[0m08:43:29.645077 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:1f0a763d-6960-4dbf-8069-8782b373d775&page=queryresults
[0m08:43:29.782888 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:b8eb904f-5ac1-4191-bbfd-9b0bf0d23026&page=queryresults
[0m08:43:30.934083 [debug] [Thread-2 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:43:30.936077 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_google_ads_basic_campaign_stats"
[0m08:43:30.937041 [debug] [Thread-2 (]: On model.bq_evo.mrt_google_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_ads_basic_campaign_stats"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_ads_basic_campaign_stats__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.date = DBT_INTERNAL_DEST.date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m08:43:31.159410 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:1c161801-4812-4012-a8b6-bd69ae8470e6&page=queryresults
[0m08:43:31.425617 [debug] [Thread-1 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:43:31.427604 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_bing_ads_basic_campaign_stats"
[0m08:43:31.428568 [debug] [Thread-1 (]: On model.bq_evo.mrt_bing_ads_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_bing_ads_basic_campaign_stats"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_bing_ads_basic_campaign_stats__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.Date = DBT_INTERNAL_DEST.Date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m08:43:31.648199 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ba4af9de-8b0c-4094-9ef6-c93a56f687a6&page=queryresults
[0m08:43:33.354196 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_bing_ads_basic_campaign_stats (execute): 08:43:28.870656 => 08:43:33.354196
[0m08:43:33.355193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B408214CD0>]}
[0m08:43:33.453439 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_google_ads_basic_campaign_stats (execute): 08:43:28.238851 => 08:43:33.453439
[0m08:43:33.454436 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4067ECAD0>]}
[0m08:43:34.317961 [info ] [Thread-1 (]: 29 of 32 OK created sql incremental model mart.mrt_bing_ads_basic_campaign_stats  [[32mMERGE (0.0 rows, 387.5 KiB processed)[0m in 4.50s]
[0m08:43:34.318898 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_bing_ads_basic_campaign_stats
[0m08:43:34.317961 [info ] [Thread-2 (]: 27 of 32 OK created sql incremental model mart.mrt_google_ads_basic_campaign_stats  [[32mMERGE (172.0 rows, 11.3 MiB processed)[0m in 5.22s]
[0m08:43:34.319898 [debug] [Thread-1 (]: Began running node model.bq_evo.mrt_metainformation_campaigns
[0m08:43:34.320897 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_google_ads_basic_campaign_stats
[0m08:43:34.321893 [info ] [Thread-1 (]: 30 of 32 START sql table model mart.mrt_metainformation_campaigns .............. [RUN]
[0m08:43:34.322893 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m08:43:34.323890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_bing_ads_basic_campaign_stats, now model.bq_evo.mrt_metainformation_campaigns)
[0m08:43:34.325889 [debug] [Thread-1 (]: Began compiling node model.bq_evo.mrt_metainformation_campaigns
[0m08:43:34.324887 [info ] [Thread-2 (]: 31 of 32 START sql incremental model mart.mrt_linkedin_basic_campaign_stats .... [RUN]
[0m08:43:34.329871 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.mrt_metainformation_campaigns"
[0m08:43:34.330871 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_google_ads_basic_campaign_stats, now model.bq_evo.mrt_linkedin_basic_campaign_stats)
[0m08:43:34.332889 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m08:43:34.337854 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_linkedin_basic_campaign_stats"
[0m08:43:34.338861 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (compile): 08:43:34.325889 => 08:43:34.338861
[0m08:43:34.339903 [debug] [Thread-1 (]: Began executing node model.bq_evo.mrt_metainformation_campaigns
[0m08:43:34.340905 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (compile): 08:43:34.332889 => 08:43:34.340905
[0m08:43:34.351876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:43:34.352873 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m08:43:34.358855 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:43:34.359887 [debug] [Thread-2 (]: On model.bq_evo.mrt_linkedin_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_linkedin_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats__dbt_tmp`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der LinkedinKampagnen.""",
    
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`

    

      WHERE
      --Update table for the past seven days + today
      Date >= current_date()-7
        
    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,
    
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m08:43:34.935325 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.mrt_metainformation_campaigns"
[0m08:43:34.936304 [debug] [Thread-1 (]: On model.bq_evo.mrt_metainformation_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_metainformation_campaigns"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_metainformation_campaigns`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt Kampagnen aus allen Quelldatensystemen mit Metainformationen."""
    )
    as (
      

WITH _googleads_campaigns AS(
    SELECT
        campaign as Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_google_analytics_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        CASE
            WHEN Medium IN ('cpc', 'ppc','cpa', 'cpm', 'cpv', 'cpp') THEN 'true' 
            ELSE 'false'
        END as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
),

_bingads_campaigns AS(
    SELECT
        Campaign,
        Medium,
        Partner,
        Source,
        'true' as IsPaid,
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_merged_googleads_and_analytics AS(
    SELECT * FROM _googleads_campaigns
    UNION ALL
    SELECT * FROM _google_analytics_campaigns
),

_merged_bingads AS(
    SELECT * FROM _merged_googleads_and_analytics
    UNION ALL
    SELECT * FROM _bingads_campaigns    
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _merged_bingads
)

SELECT * FROM _final
    );
  
[0m08:43:35.081127 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e1f83cc2-bb52-4456-832d-aa31654583c7&page=queryresults
[0m08:43:35.228699 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4e1937a3-db2d-406c-8205-e4e43730a7ab&page=queryresults
[0m08:43:35.706493 [debug] [Thread-4 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:43:35.709447 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_campaign_webperformance"
[0m08:43:35.711440 [debug] [Thread-4 (]: On model.bq_evo.mrt_google_analytics_campaign_webperformance: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_campaign_webperformance"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_campaign_webperformance__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.Date = DBT_INTERNAL_DEST.Date
                ) and (
                    DBT_INTERNAL_SOURCE.CampaignID = DBT_INTERNAL_DEST.CampaignID
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Sessions` = DBT_INTERNAL_SOURCE.`Sessions`,`Sessions_Engaged` = DBT_INTERNAL_SOURCE.`Sessions_Engaged`,`Engagement_Rate` = DBT_INTERNAL_SOURCE.`Engagement_Rate`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`
    

    when not matched then insert
        (`Date`, `CampaignID`, `Sessions`, `Sessions_Engaged`, `Engagement_Rate`, `Medium`, `Source`, `Partner`, `Keyword`, `KeywordMatchType`)
    values
        (`Date`, `CampaignID`, `Sessions`, `Sessions_Engaged`, `Engagement_Rate`, `Medium`, `Source`, `Partner`, `Keyword`, `KeywordMatchType`)


    
[0m08:43:35.921334 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:91ab72f3-71c2-4ab3-b9be-fd48875b3571&page=queryresults
[0m08:43:36.653598 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized (execute): 08:43:28.867659 => 08:43:36.653598
[0m08:43:36.654562 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B405BBD550>]}
[0m08:43:36.655590 [info ] [Thread-3 (]: 28 of 32 OK created sql incremental model mart.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized  [[32mMERGE (25.0k rows, 719.7 MiB processed)[0m in 7.80s]
[0m08:43:36.656555 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized
[0m08:43:36.657554 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m08:43:36.658550 [info ] [Thread-3 (]: 32 of 32 START sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [RUN]
[0m08:43:36.659548 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.mrt_google_analytics_NDG_merged_ua_ga4_conversions_summarized, now model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized)
[0m08:43:36.659548 [debug] [Thread-3 (]: Began compiling node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m08:43:36.664535 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m08:43:36.666529 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (compile): 08:43:36.660545 => 08:43:36.665533
[0m08:43:36.667527 [debug] [Thread-3 (]: Began executing node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m08:43:36.670518 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:43:36.789186 [debug] [Thread-2 (]: 
    In `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:43:36.791181 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_linkedin_basic_campaign_stats"
[0m08:43:36.792177 [debug] [Thread-2 (]: On model.bq_evo.mrt_linkedin_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_linkedin_basic_campaign_stats"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats` as DBT_INTERNAL_DEST
        using (
        select
        * from `oss-big-query-dashboard-prod`.`mart`.`mrt_linkedin_basic_campaign_stats__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.Date = DBT_INTERNAL_DEST.Date
                ) and (
                    DBT_INTERNAL_SOURCE.Campaign = DBT_INTERNAL_DEST.Campaign
                )

    
    when matched then update set
        `Date` = DBT_INTERNAL_SOURCE.`Date`,`Campaign` = DBT_INTERNAL_SOURCE.`Campaign`,`CampaignID` = DBT_INTERNAL_SOURCE.`CampaignID`,`Source` = DBT_INTERNAL_SOURCE.`Source`,`Medium` = DBT_INTERNAL_SOURCE.`Medium`,`Partner` = DBT_INTERNAL_SOURCE.`Partner`,`Keyword` = DBT_INTERNAL_SOURCE.`Keyword`,`KeywordMatchType` = DBT_INTERNAL_SOURCE.`KeywordMatchType`,`Impressions` = DBT_INTERNAL_SOURCE.`Impressions`,`Clicks` = DBT_INTERNAL_SOURCE.`Clicks`,`Cost` = DBT_INTERNAL_SOURCE.`Cost`
    

    when not matched then insert
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)
    values
        (`Date`, `Campaign`, `CampaignID`, `Source`, `Medium`, `Partner`, `Keyword`, `KeywordMatchType`, `Impressions`, `Clicks`, `Cost`)


    
[0m08:43:36.991880 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:4a2ef7ab-7bc2-48a5-b578-5759a9b07a50&page=queryresults
[0m08:43:37.196102 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"
[0m08:43:37.198088 [debug] [Thread-3 (]: On model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `oss-big-query-dashboard-prod`.`mart`.`mrt_google_analytics_merged_ua_ga4_transactions_summarized` as DBT_INTERNAL_DEST
        using (WITH _raw AS(
  SELECT 
    event_date as Date,
    Campaign,
    Medium,
    Source,
    item_category as ProductCategory,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  WHERE 
    transaction_id NOT LIKE 'TEST%'
),

_aggregation_on_day AS(
  SELECT
    Date,
    Campaign,
    Medium,
    Source,
    ProductCategory,
    count(Date) as Transactions,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    MAX(Partner) as Partner,
    CampaignID
  FROM _raw
  WHERE Date >= '2023-06-05'
  GROUP BY 1,2,3,4,5,10
),

evo_ecommerce_ua AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_transactions`
  WHERE Date < '2023-06-05'
),

_merged_step1 AS(
  SELECT * FROM _aggregation_on_day
  UNION ALL
  SELECT * FROM evo_ecommerce_ua
),

_final AS(
  SELECT * FROM _merged_step1
)

SELECT * FROM _final
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`Date`, `Campaign`, `Medium`, `Source`, `ProductCategory`, `Transactions`, `Keyword`, `KeywordMatchType`, `Partner`, `CampaignID`)
    values
        (`Date`, `Campaign`, `Medium`, `Source`, `ProductCategory`, `Transactions`, `Keyword`, `KeywordMatchType`, `Partner`, `CampaignID`)


    
[0m08:43:37.449906 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ed84e132-a067-452c-bdc1-f163ef728576&page=queryresults
[0m08:43:37.941256 [debug] [Thread-4 (]: Timing info for model.bq_evo.mrt_google_analytics_campaign_webperformance (execute): 08:43:27.644777 => 08:43:37.941256
[0m08:43:37.943250 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40650CC10>]}
[0m08:43:37.944217 [info ] [Thread-4 (]: 25 of 32 OK created sql incremental model mart.mrt_google_analytics_campaign_webperformance  [[32mMERGE (409.0 rows, 1.3 MiB processed)[0m in 10.31s]
[0m08:43:37.947203 [debug] [Thread-4 (]: Finished running node model.bq_evo.mrt_google_analytics_campaign_webperformance
[0m08:43:38.675095 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_linkedin_basic_campaign_stats (execute): 08:43:34.354869 => 08:43:38.674088
[0m08:43:38.677108 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4065BA850>]}
[0m08:43:38.677108 [info ] [Thread-2 (]: 31 of 32 OK created sql incremental model mart.mrt_linkedin_basic_campaign_stats  [[32mMERGE (0.0 rows, 63.2 KiB processed)[0m in 4.35s]
[0m08:43:38.679069 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_linkedin_basic_campaign_stats
[0m08:43:42.230044 [debug] [Thread-1 (]: Timing info for model.bq_evo.mrt_metainformation_campaigns (execute): 08:43:34.340905 => 08:43:42.229047
[0m08:43:42.231042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4067E5650>]}
[0m08:43:42.232998 [info ] [Thread-1 (]: 30 of 32 OK created sql table model mart.mrt_metainformation_campaigns ......... [[32mCREATE TABLE (2.2k rows, 716.5 MiB processed)[0m in 7.91s]
[0m08:43:42.235031 [debug] [Thread-1 (]: Finished running node model.bq_evo.mrt_metainformation_campaigns
[0m08:43:44.352719 [debug] [Thread-3 (]: Timing info for model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized (execute): 08:43:36.667527 => 08:43:44.351714
[0m08:43:44.353709 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b7bd1f-bb00-4c07-a039-db9b1324554e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40820D150>]}
[0m08:43:44.355672 [info ] [Thread-3 (]: 32 of 32 OK created sql incremental model mart.mrt_google_analytics_merged_ua_ga4_transactions_summarized  [[32mMERGE (5.5k rows, 717.0 MiB processed)[0m in 7.70s]
[0m08:43:44.356665 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized
[0m08:43:44.360690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:43:44.361687 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:43:44.362650 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:43:44.362650 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:43:44.363651 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m08:43:44.364642 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m08:43:44.365648 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m08:43:44.366637 [debug] [MainThread]: Connection 'model.bq_evo.mrt_metainformation_campaigns' was properly closed.
[0m08:43:44.367671 [debug] [MainThread]: Connection 'model.bq_evo.mrt_linkedin_basic_campaign_stats' was properly closed.
[0m08:43:44.367671 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_merged_ua_ga4_transactions_summarized' was properly closed.
[0m08:43:44.368652 [debug] [MainThread]: Connection 'model.bq_evo.mrt_google_analytics_campaign_webperformance' was properly closed.
[0m08:43:44.369631 [info ] [MainThread]: 
[0m08:43:44.370667 [info ] [MainThread]: Finished running 24 view models, 7 incremental models, 1 table model in 0 hours 0 minutes and 27.08 seconds (27.08s).
[0m08:43:44.377609 [debug] [MainThread]: Command end result
[0m08:43:44.397555 [info ] [MainThread]: 
[0m08:43:44.398555 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:43:44.399550 [info ] [MainThread]: 
[0m08:43:44.400548 [error] [MainThread]:   Database Error in model stg_meta_campaign_information (models\staging\meta\stg_meta_campaign_information.sql)
  Unrecognized name: Source at [31:33]
  compiled Code at target\run\bq_evo\models\staging\meta\stg_meta_campaign_information.sql
[0m08:43:44.401577 [info ] [MainThread]: 
[0m08:43:44.401577 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=3 TOTAL=32
[0m08:43:44.402542 [debug] [MainThread]: Command `dbt run` failed at 08:43:44.402542 after 27.72 seconds
[0m08:43:44.403573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4049954D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47F14D6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47F0E7D90>]}
[0m08:43:44.404537 [debug] [MainThread]: Flushing usage events
[0m08:47:20.975786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6995A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F69CF53D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6903B7D0>]}


============================== 08:47:20.980656 | 27aea60b-0fd3-4180-8551-bede657891f7 ==============================
[0m08:47:20.980656 [info ] [MainThread]: Running with dbt=1.6.2
[0m08:47:20.982186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m *meta_*', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:47:21.326097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27aea60b-0fd3-4180-8551-bede657891f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6AF1D8D0>]}
[0m08:47:21.334077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27aea60b-0fd3-4180-8551-bede657891f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6976C790>]}
[0m08:47:21.335072 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m08:47:21.387538 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m08:47:21.484894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:47:21.484894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:47:21.492872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27aea60b-0fd3-4180-8551-bede657891f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F69790210>]}
[0m08:47:21.511790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27aea60b-0fd3-4180-8551-bede657891f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6B37F950>]}
[0m08:47:21.512786 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m08:47:21.513783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27aea60b-0fd3-4180-8551-bede657891f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6AA8AA90>]}
[0m08:47:21.515812 [info ] [MainThread]: 
[0m08:47:21.516815 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:47:21.518796 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:47:21.519794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:21.519794 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:47:21.521763 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:47:21.521763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:21.522764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:24.203654 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m08:47:24.204655 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m08:47:24.205653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:24.205653 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m08:47:24.206650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:24.208677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:24.861983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27aea60b-0fd3-4180-8551-bede657891f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6AECFF50>]}
[0m08:47:24.862957 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:47:24.863944 [info ] [MainThread]: 
[0m08:47:24.868430 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_meta_campaign_information
[0m08:47:24.868430 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_meta_campaign_stats
[0m08:47:24.869431 [info ] [Thread-1 (]: 1 of 5 START sql view model staging.stg_meta_campaign_information .............. [RUN]
[0m08:47:24.869906 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_meta_campaign_stats .................... [RUN]
[0m08:47:24.871904 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_meta_campaign_information'
[0m08:47:24.872900 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_meta_campaign_stats'
[0m08:47:24.872900 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_meta_campaign_information
[0m08:47:24.873900 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_meta_campaign_stats
[0m08:47:24.882439 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_meta_campaign_information"
[0m08:47:24.886427 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_meta_campaign_stats"
[0m08:47:24.887937 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_meta_campaign_information (compile): 08:47:24.874896 => 08:47:24.887937
[0m08:47:24.888934 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_meta_campaign_stats (compile): 08:47:24.883435 => 08:47:24.887937
[0m08:47:24.888934 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_meta_campaign_information
[0m08:47:24.889933 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_meta_campaign_stats
[0m08:47:24.921845 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_meta_campaign_information"
[0m08:47:24.924872 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_meta_campaign_stats"
[0m08:47:24.925835 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:47:24.926832 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:47:24.927830 [debug] [Thread-1 (]: On model.bq_evo.stg_meta_campaign_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_meta_campaign_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen. Inklusive Informationen \u00fcber zugeh\u00f6rige Anzeigengruppen und Anzeigen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`facebook_ads`.`fb_campaign_information`
),

_renamed_columns AS(
    SELECT 
        * EXCEPT (campaign_name),
        campaign_name as Campaign
    FROM _raw
),

_added_more_metadata AS(
    SELECT 
        *,
        'cpc' as Medium,
        'EVO' as Partner,
        CASE
            WHEN Campaign LIKE '%:IG%' AND Campaign NOT LIKE '%:FB:IG:%' THEN 'instagram'
            WHEN Campaign LIKE '%:FB:IG:%' OR Campaign LIKE '%:FB:%' THEN 'facebook'
            ELSE '(not set)'
        END AS Source,
        'true' as IsPaid,
        LOWER (CONCAT(Campaign, Source, Medium, Partner)) as CampaignID
    FROM _renamed_columns
),

_final AS(
    SELECT *
    FROM _added_more_metadata
)

SELECT * FROM _final;


[0m08:47:24.927830 [debug] [Thread-2 (]: On model.bq_evo.stg_meta_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_meta_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Metakampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`facebook_ads`.`fb_basic_performance_per_day`
),

_renamed_columns AS (
    SELECT
        _fivetran_id,
        ad_id,
        date as Date,
        _fivetran_synced,
        account_id,
        adset_name,
        campaign_name as Campaign,
        clicks as Clicks,
        cpc,
        cpm,
        ctr,
        impressions as Impressions,
        reach,
        spend as Cost
    FROM _raw
),

_final AS (
    SELECT *    
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m08:47:25.656317 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:42121d44-5ec4-4b6a-ba45-582fae78bd44&page=queryresults
[0m08:47:25.657352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8197bb20-a30c-4d7e-9b16-b155a08ec32e&page=queryresults
[0m08:47:25.830254 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: Source at [31:33]')
[0m08:47:25.861511 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_meta_campaign_stats (execute): 08:47:24.921845 => 08:47:25.861511
[0m08:47:25.862509 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27aea60b-0fd3-4180-8551-bede657891f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6B657D50>]}
[0m08:47:25.863473 [info ] [Thread-2 (]: 2 of 5 OK created sql view model staging.stg_meta_campaign_stats ............... [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m08:47:25.864471 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_meta_campaign_stats
[0m08:47:26.097719 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:cb66e544-be91-485f-b2dd-d974276d6c45&page=queryresults
[0m08:47:26.248101 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:cb66e544-be91-485f-b2dd-d974276d6c45&page=queryresults
[0m08:47:26.250063 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_meta_campaign_information (execute): 08:47:24.889933 => 08:47:26.249086
[0m08:47:26.258041 [debug] [Thread-1 (]: Database Error in model stg_meta_campaign_information (models\staging\meta\stg_meta_campaign_information.sql)
  Unrecognized name: Source at [31:33]
  compiled Code at target\run\bq_evo\models\staging\meta\stg_meta_campaign_information.sql
[0m08:47:26.259039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27aea60b-0fd3-4180-8551-bede657891f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6B3254D0>]}
[0m08:47:26.260036 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model staging.stg_meta_campaign_information ..... [[31mERROR[0m in 1.39s]
[0m08:47:26.261034 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_meta_campaign_information
[0m08:47:26.262033 [debug] [Thread-4 (]: Began running node model.bq_evo.int_meta_unique_campaigns
[0m08:47:26.263065 [info ] [Thread-4 (]: 3 of 5 SKIP relation intermediate.int_meta_unique_campaigns .................... [[33mSKIP[0m]
[0m08:47:26.265023 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_meta_unique_campaigns
[0m08:47:26.266018 [debug] [Thread-2 (]: Began running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:47:26.267015 [info ] [Thread-2 (]: 4 of 5 SKIP relation intermediate.int_meta_campaign_stats_joined_campaign_names  [[33mSKIP[0m]
[0m08:47:26.268019 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:47:26.269012 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:47:26.269012 [info ] [Thread-3 (]: 5 of 5 SKIP relation mart.mrt_meta_basic_campaign_stats ........................ [[33mSKIP[0m]
[0m08:47:26.271007 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:47:26.273002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:47:26.274035 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:47:26.274035 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:47:26.275028 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:47:26.275028 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m08:47:26.275994 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m08:47:26.275994 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m08:47:26.277005 [debug] [MainThread]: Connection 'model.bq_evo.stg_meta_campaign_information' was properly closed.
[0m08:47:26.277005 [debug] [MainThread]: Connection 'model.bq_evo.stg_meta_campaign_stats' was properly closed.
[0m08:47:26.278003 [info ] [MainThread]: 
[0m08:47:26.278995 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 4.76 seconds (4.76s).
[0m08:47:26.280982 [debug] [MainThread]: Command end result
[0m08:47:26.293466 [info ] [MainThread]: 
[0m08:47:26.294463 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:47:26.295498 [info ] [MainThread]: 
[0m08:47:26.296460 [error] [MainThread]:   Database Error in model stg_meta_campaign_information (models\staging\meta\stg_meta_campaign_information.sql)
  Unrecognized name: Source at [31:33]
  compiled Code at target\run\bq_evo\models\staging\meta\stg_meta_campaign_information.sql
[0m08:47:26.298455 [info ] [MainThread]: 
[0m08:47:26.299452 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=3 TOTAL=5
[0m08:47:26.300449 [debug] [MainThread]: Command `dbt run` failed at 08:47:26.300449 after 5.34 seconds
[0m08:47:26.300449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F69C23B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F6A25EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F698268D0>]}
[0m08:47:26.301445 [debug] [MainThread]: Flushing usage events
[0m08:49:34.588857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B301FC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B309FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B35FDF90>]}


============================== 08:49:34.593789 | 70cf32cc-5057-42cf-9aec-e1f29e6213df ==============================
[0m08:49:34.593789 [info ] [MainThread]: Running with dbt=1.6.2
[0m08:49:34.595102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m *meta_*', 'send_anonymous_usage_stats': 'True'}
[0m08:49:34.933053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70cf32cc-5057-42cf-9aec-e1f29e6213df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B431DA90>]}
[0m08:49:34.942991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70cf32cc-5057-42cf-9aec-e1f29e6213df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B42D8350>]}
[0m08:49:34.943989 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m08:49:34.994145 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m08:49:35.090467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:49:35.091467 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\staging\meta\stg_meta_campaign_information.sql
[0m08:49:35.139845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70cf32cc-5057-42cf-9aec-e1f29e6213df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B4766F90>]}
[0m08:49:35.158654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70cf32cc-5057-42cf-9aec-e1f29e6213df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B4BBFD50>]}
[0m08:49:35.159653 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m08:49:35.160685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70cf32cc-5057-42cf-9aec-e1f29e6213df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B3D16A10>]}
[0m08:49:35.163676 [info ] [MainThread]: 
[0m08:49:35.164640 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:49:35.166633 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:49:35.167630 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:49:35.167630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:35.168663 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:49:35.169663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:35.171134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:37.767733 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m08:49:37.768691 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m08:49:37.769724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:37.770686 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m08:49:37.771685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:37.774675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:38.437462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70cf32cc-5057-42cf-9aec-e1f29e6213df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B27E1350>]}
[0m08:49:38.438500 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:49:38.439459 [info ] [MainThread]: 
[0m08:49:38.443449 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_meta_campaign_information
[0m08:49:38.444463 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_meta_campaign_stats
[0m08:49:38.444463 [info ] [Thread-1 (]: 1 of 5 START sql view model staging.stg_meta_campaign_information .............. [RUN]
[0m08:49:38.445444 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_meta_campaign_stats .................... [RUN]
[0m08:49:38.447454 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_meta_campaign_information'
[0m08:49:38.448436 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_meta_campaign_stats'
[0m08:49:38.449434 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_meta_campaign_information
[0m08:49:38.449434 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_meta_campaign_stats
[0m08:49:38.457914 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_meta_campaign_information"
[0m08:49:38.461915 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_meta_campaign_stats"
[0m08:49:38.462878 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_meta_campaign_information (compile): 08:49:38.450905 => 08:49:38.462878
[0m08:49:38.463877 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_meta_campaign_information
[0m08:49:38.464874 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_meta_campaign_stats (compile): 08:49:38.458911 => 08:49:38.464874
[0m08:49:38.497802 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_meta_campaign_information"
[0m08:49:38.497802 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_meta_campaign_stats
[0m08:49:38.501790 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_meta_campaign_stats"
[0m08:49:38.502793 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:49:38.503793 [debug] [Thread-1 (]: On model.bq_evo.stg_meta_campaign_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_meta_campaign_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen. Inklusive Informationen \u00fcber zugeh\u00f6rige Anzeigengruppen und Anzeigen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`facebook_ads`.`fb_campaign_information`
),

_renamed_columns AS(
    SELECT 
        * EXCEPT (campaign_name),
        campaign_name as Campaign
    FROM _raw
),

_added_more_metadata AS(
    SELECT 
        *,
        'cpc' as Medium,
        'EVO' as Partner,
        CASE
            WHEN Campaign LIKE '%:IG%' AND Campaign NOT LIKE '%:FB:IG:%' THEN 'instagram'
            WHEN Campaign LIKE '%:FB:IG:%' OR Campaign LIKE '%:FB:%' THEN 'facebook'
            ELSE '(not set)'
        END AS Source,
        'true' as IsPaid
    FROM _renamed_columns
),

_added_campaignid AS(
    SELECT
        *,
        LOWER (CONCAT(Campaign, Source, Medium, Partner)) as CampaignID
    FROM _added_more_metadata
),

_final AS(
    SELECT *
    FROM _added_campaignid
)

SELECT * FROM _final;


[0m08:49:38.503793 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:49:38.506776 [debug] [Thread-2 (]: On model.bq_evo.stg_meta_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_meta_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Metakampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`facebook_ads`.`fb_basic_performance_per_day`
),

_renamed_columns AS (
    SELECT
        _fivetran_id,
        ad_id,
        date as Date,
        _fivetran_synced,
        account_id,
        adset_name,
        campaign_name as Campaign,
        clicks as Clicks,
        cpc,
        cpm,
        ctr,
        impressions as Impressions,
        reach,
        spend as Cost
    FROM _raw
),

_final AS (
    SELECT *    
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m08:49:39.204446 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:a2c9b2d9-dd4a-4f6f-9215-00fcf8c86de4&page=queryresults
[0m08:49:39.218848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:efcae669-e03a-4e19-aa6b-56b4a29b8e2d&page=queryresults
[0m08:49:39.640926 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_meta_campaign_stats (execute): 08:49:38.498793 => 08:49:39.639928
[0m08:49:39.641922 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70cf32cc-5057-42cf-9aec-e1f29e6213df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B474EE90>]}
[0m08:49:39.641922 [info ] [Thread-2 (]: 2 of 5 OK created sql view model staging.stg_meta_campaign_stats ............... [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m08:49:39.643884 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_meta_campaign_stats
[0m08:49:39.647907 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_meta_campaign_information (execute): 08:49:38.465872 => 08:49:39.647907
[0m08:49:39.648906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70cf32cc-5057-42cf-9aec-e1f29e6213df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B374D650>]}
[0m08:49:39.649867 [info ] [Thread-1 (]: 1 of 5 OK created sql view model staging.stg_meta_campaign_information ......... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m08:49:39.650866 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_meta_campaign_information
[0m08:49:39.652874 [debug] [Thread-4 (]: Began running node model.bq_evo.int_meta_unique_campaigns
[0m08:49:39.653859 [info ] [Thread-4 (]: 3 of 5 START sql view model intermediate.int_meta_unique_campaigns ............. [RUN]
[0m08:49:39.655853 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_meta_unique_campaigns'
[0m08:49:39.655853 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_meta_unique_campaigns
[0m08:49:39.659844 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_meta_unique_campaigns"
[0m08:49:39.661836 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_meta_unique_campaigns (compile): 08:49:39.656851 => 08:49:39.661836
[0m08:49:39.662832 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_meta_unique_campaigns
[0m08:49:39.666822 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_meta_unique_campaigns"
[0m08:49:39.668817 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:49:39.669815 [debug] [Thread-4 (]: On model.bq_evo.int_meta_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_meta_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_information`
),

_distinct_campaigns AS(
    SELECT
        MAX(Campaign) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 5
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m08:49:40.321369 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:3f33cceb-9d52-4f68-98cc-97f88b191c02&page=queryresults
[0m08:49:40.778730 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_meta_unique_campaigns (execute): 08:49:39.663833 => 08:49:40.778730
[0m08:49:40.779766 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70cf32cc-5057-42cf-9aec-e1f29e6213df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B4C3E650>]}
[0m08:49:40.779766 [info ] [Thread-4 (]: 3 of 5 OK created sql view model intermediate.int_meta_unique_campaigns ........ [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m08:49:40.781248 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_meta_unique_campaigns
[0m08:49:40.782252 [debug] [Thread-2 (]: Began running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:49:40.783270 [info ] [Thread-2 (]: 4 of 5 START sql view model intermediate.int_meta_campaign_stats_joined_campaign_names  [RUN]
[0m08:49:40.784273 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_meta_campaign_stats, now model.bq_evo.int_meta_campaign_stats_joined_campaign_names)
[0m08:49:40.785296 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:49:40.788361 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"
[0m08:49:40.790323 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_meta_campaign_stats_joined_campaign_names (compile): 08:49:40.786329 => 08:49:40.789356
[0m08:49:40.790323 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:49:40.795309 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"
[0m08:49:40.796364 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:49:40.797302 [debug] [Thread-2 (]: On model.bq_evo.int_meta_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.Campaign = _raw_performance.Campaign
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m08:49:41.438199 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:055c68c7-85fe-4dff-a817-b1298f7fd68e&page=queryresults
[0m08:49:41.614350 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW has columns with duplicate name Campaign at [8:6]')
[0m08:49:42.654175 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:59db9223-3d4d-4ae1-8e82-9294b30bfadc&page=queryresults
[0m08:49:42.795984 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:59db9223-3d4d-4ae1-8e82-9294b30bfadc&page=queryresults
[0m08:49:42.796979 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_meta_campaign_stats_joined_campaign_names (execute): 08:49:40.791320 => 08:49:42.796979
[0m08:49:42.803283 [debug] [Thread-2 (]: Database Error in model int_meta_campaign_stats_joined_campaign_names (models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql)
  CREATE VIEW has columns with duplicate name Campaign at [8:6]
  compiled Code at target\run\bq_evo\models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql
[0m08:49:42.804280 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70cf32cc-5057-42cf-9aec-e1f29e6213df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B4BBB810>]}
[0m08:49:42.805280 [error] [Thread-2 (]: 4 of 5 ERROR creating sql view model intermediate.int_meta_campaign_stats_joined_campaign_names  [[31mERROR[0m in 2.02s]
[0m08:49:42.807453 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:49:42.808462 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:49:42.809621 [info ] [Thread-3 (]: 5 of 5 SKIP relation mart.mrt_meta_basic_campaign_stats ........................ [[33mSKIP[0m]
[0m08:49:42.810269 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:49:42.813291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:49:42.814292 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:49:42.814292 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:49:42.815258 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:49:42.815258 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m08:49:42.816265 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m08:49:42.816265 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m08:49:42.817280 [debug] [MainThread]: Connection 'model.bq_evo.stg_meta_campaign_information' was properly closed.
[0m08:49:42.818251 [debug] [MainThread]: Connection 'model.bq_evo.int_meta_campaign_stats_joined_campaign_names' was properly closed.
[0m08:49:42.818251 [debug] [MainThread]: Connection 'model.bq_evo.int_meta_unique_campaigns' was properly closed.
[0m08:49:42.819758 [info ] [MainThread]: 
[0m08:49:42.820775 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 7.66 seconds (7.66s).
[0m08:49:42.822753 [debug] [MainThread]: Command end result
[0m08:49:42.842700 [info ] [MainThread]: 
[0m08:49:42.843697 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:49:42.844695 [info ] [MainThread]: 
[0m08:49:42.845718 [error] [MainThread]:   Database Error in model int_meta_campaign_stats_joined_campaign_names (models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql)
  CREATE VIEW has columns with duplicate name Campaign at [8:6]
  compiled Code at target\run\bq_evo\models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql
[0m08:49:42.847687 [info ] [MainThread]: 
[0m08:49:42.848685 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m08:49:42.849707 [debug] [MainThread]: Command `dbt run` failed at 08:49:42.849707 after 8.28 seconds
[0m08:49:42.850678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B30F77D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B2DE5D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B2DE6D90>]}
[0m08:49:42.851678 [debug] [MainThread]: Flushing usage events
[0m08:52:05.225925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919FE820D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191A01500D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191A0112850>]}


============================== 08:52:05.229915 | a85fe3b3-edf6-4936-ad4a-a994eb0050f8 ==============================
[0m08:52:05.229915 [info ] [MainThread]: Running with dbt=1.6.2
[0m08:52:05.231910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m *meta_*', 'send_anonymous_usage_stats': 'True'}
[0m08:52:05.589340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a85fe3b3-edf6-4936-ad4a-a994eb0050f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919FEFCD50>]}
[0m08:52:05.599278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a85fe3b3-edf6-4936-ad4a-a994eb0050f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919FE81690>]}
[0m08:52:05.600276 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m08:52:05.654399 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m08:52:05.761526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:52:05.763525 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql
[0m08:52:05.814930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a85fe3b3-edf6-4936-ad4a-a994eb0050f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191A1C5C8D0>]}
[0m08:52:05.834484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a85fe3b3-edf6-4936-ad4a-a994eb0050f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191A1EBFF50>]}
[0m08:52:05.835516 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m08:52:05.836480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a85fe3b3-edf6-4936-ad4a-a994eb0050f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191A1DA9210>]}
[0m08:52:05.838507 [info ] [MainThread]: 
[0m08:52:05.839472 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:52:05.841465 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:52:05.842462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:05.842462 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:52:05.843490 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:52:05.844491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:05.845455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:08.519937 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m08:52:08.520919 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m08:52:08.520919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:08.521885 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m08:52:08.522826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:08.524344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:09.169358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a85fe3b3-edf6-4936-ad4a-a994eb0050f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919FF0CA50>]}
[0m08:52:09.170337 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:09.170337 [info ] [MainThread]: 
[0m08:52:09.175146 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_meta_campaign_information
[0m08:52:09.176167 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_meta_campaign_stats
[0m08:52:09.177140 [info ] [Thread-1 (]: 1 of 5 START sql view model staging.stg_meta_campaign_information .............. [RUN]
[0m08:52:09.179136 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_meta_campaign_information'
[0m08:52:09.177140 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_meta_campaign_stats .................... [RUN]
[0m08:52:09.179136 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_meta_campaign_information
[0m08:52:09.180160 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_meta_campaign_stats'
[0m08:52:09.188146 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_meta_campaign_information"
[0m08:52:09.189144 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_meta_campaign_stats
[0m08:52:09.193097 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_meta_campaign_stats"
[0m08:52:09.194098 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_meta_campaign_information (compile): 08:52:09.181130 => 08:52:09.193097
[0m08:52:09.195091 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_meta_campaign_information
[0m08:52:09.196089 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_meta_campaign_stats (compile): 08:52:09.190112 => 08:52:09.196089
[0m08:52:09.227037 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_meta_campaign_information"
[0m08:52:09.228074 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_meta_campaign_stats
[0m08:52:09.232339 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_meta_campaign_stats"
[0m08:52:09.232339 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:52:09.233491 [debug] [Thread-1 (]: On model.bq_evo.stg_meta_campaign_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_meta_campaign_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen. Inklusive Informationen \u00fcber zugeh\u00f6rige Anzeigengruppen und Anzeigen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`facebook_ads`.`fb_campaign_information`
),

_renamed_columns AS(
    SELECT 
        * EXCEPT (campaign_name),
        campaign_name as Campaign
    FROM _raw
),

_added_more_metadata AS(
    SELECT 
        *,
        'cpc' as Medium,
        'EVO' as Partner,
        CASE
            WHEN Campaign LIKE '%:IG%' AND Campaign NOT LIKE '%:FB:IG:%' THEN 'instagram'
            WHEN Campaign LIKE '%:FB:IG:%' OR Campaign LIKE '%:FB:%' THEN 'facebook'
            ELSE '(not set)'
        END AS Source,
        'true' as IsPaid
    FROM _renamed_columns
),

_added_campaignid AS(
    SELECT
        *,
        LOWER (CONCAT(Campaign, Source, Medium, Partner)) as CampaignID
    FROM _added_more_metadata
),

_final AS(
    SELECT *
    FROM _added_campaignid
)

SELECT * FROM _final;


[0m08:52:09.235692 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:52:09.236717 [debug] [Thread-2 (]: On model.bq_evo.stg_meta_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_meta_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Metakampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`facebook_ads`.`fb_basic_performance_per_day`
),

_renamed_columns AS (
    SELECT
        _fivetran_id,
        ad_id,
        date as Date,
        _fivetran_synced,
        account_id,
        adset_name,
        campaign_name as Campaign,
        clicks as Clicks,
        cpc,
        cpm,
        ctr,
        impressions as Impressions,
        reach,
        spend as Cost
    FROM _raw
),

_final AS (
    SELECT *    
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m08:52:09.936521 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ebb38234-8488-4950-a409-9c7db134bd08&page=queryresults
[0m08:52:09.953323 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:30d04367-e85c-446b-b468-d58aecc64f66&page=queryresults
[0m08:52:10.123477 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_meta_campaign_stats (execute): 08:52:09.229167 => 08:52:10.123477
[0m08:52:10.124474 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a85fe3b3-edf6-4936-ad4a-a994eb0050f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191A1D63C10>]}
[0m08:52:10.125473 [info ] [Thread-2 (]: 2 of 5 OK created sql view model staging.stg_meta_campaign_stats ............... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m08:52:10.126469 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_meta_campaign_stats
[0m08:52:10.386279 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_meta_campaign_information (execute): 08:52:09.196089 => 08:52:10.385278
[0m08:52:10.390266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a85fe3b3-edf6-4936-ad4a-a994eb0050f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191A1292FD0>]}
[0m08:52:10.392210 [info ] [Thread-1 (]: 1 of 5 OK created sql view model staging.stg_meta_campaign_information ......... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m08:52:10.395201 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_meta_campaign_information
[0m08:52:10.397194 [debug] [Thread-4 (]: Began running node model.bq_evo.int_meta_unique_campaigns
[0m08:52:10.398191 [info ] [Thread-4 (]: 3 of 5 START sql view model intermediate.int_meta_unique_campaigns ............. [RUN]
[0m08:52:10.400185 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_meta_unique_campaigns'
[0m08:52:10.401198 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_meta_unique_campaigns
[0m08:52:10.404210 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_meta_unique_campaigns"
[0m08:52:10.406169 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_meta_unique_campaigns (compile): 08:52:10.401198 => 08:52:10.405198
[0m08:52:10.407168 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_meta_unique_campaigns
[0m08:52:10.411188 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_meta_unique_campaigns"
[0m08:52:10.412190 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:52:10.413152 [debug] [Thread-4 (]: On model.bq_evo.int_meta_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_meta_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_information`
),

_distinct_campaigns AS(
    SELECT
        MAX(Campaign) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 5
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m08:52:11.086011 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:f62560c9-7565-4b8f-8d32-87c703d4306c&page=queryresults
[0m08:52:11.510569 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_meta_unique_campaigns (execute): 08:52:10.407168 => 08:52:11.510569
[0m08:52:11.511531 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a85fe3b3-edf6-4936-ad4a-a994eb0050f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191A1F1F490>]}
[0m08:52:11.512529 [info ] [Thread-4 (]: 3 of 5 OK created sql view model intermediate.int_meta_unique_campaigns ........ [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m08:52:11.513530 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_meta_unique_campaigns
[0m08:52:11.514523 [debug] [Thread-2 (]: Began running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:52:11.515520 [info ] [Thread-2 (]: 4 of 5 START sql view model intermediate.int_meta_campaign_stats_joined_campaign_names  [RUN]
[0m08:52:11.516519 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_meta_campaign_stats, now model.bq_evo.int_meta_campaign_stats_joined_campaign_names)
[0m08:52:11.517516 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:52:11.520508 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"
[0m08:52:11.522502 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_meta_campaign_stats_joined_campaign_names (compile): 08:52:11.517516 => 08:52:11.521505
[0m08:52:11.522502 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:52:11.526492 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"
[0m08:52:11.528496 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:52:11.529487 [debug] [Thread-2 (]: On model.bq_evo.int_meta_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
),

_rename_join_column AS(
    SELECT 
        * EXCEPT (Campaign),
        Campaign as CampaignJoin
    FROM _raw_unique_campaigns
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _rename_join_column.CampaignJoin = _raw_performance.Campaign
),

_final AS(
    SELECT * EXCEPT (CampaignJoin)
    FROM _joined
)

SELECT * FROM _final;


[0m08:52:12.225739 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:0e11f5a8-1101-4c8e-a81b-fa5789556ed9&page=queryresults
[0m08:52:12.332289 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: _rename_join_column at [28:8]')
[0m08:52:13.216827 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:64daf62d-9c60-4136-99e2-526db9064571&page=queryresults
[0m08:52:13.387848 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:64daf62d-9c60-4136-99e2-526db9064571&page=queryresults
[0m08:52:13.390783 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_meta_campaign_stats_joined_campaign_names (execute): 08:52:11.523501 => 08:52:13.389785
[0m08:52:13.399758 [debug] [Thread-2 (]: Database Error in model int_meta_campaign_stats_joined_campaign_names (models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql)
  Unrecognized name: _rename_join_column at [28:8]
  compiled Code at target\run\bq_evo\models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql
[0m08:52:13.399758 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a85fe3b3-edf6-4936-ad4a-a994eb0050f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191A1F8AB90>]}
[0m08:52:13.400756 [error] [Thread-2 (]: 4 of 5 ERROR creating sql view model intermediate.int_meta_campaign_stats_joined_campaign_names  [[31mERROR[0m in 1.88s]
[0m08:52:13.401781 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:52:13.403755 [debug] [Thread-3 (]: Began running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:52:13.404764 [info ] [Thread-3 (]: 5 of 5 SKIP relation mart.mrt_meta_basic_campaign_stats ........................ [[33mSKIP[0m]
[0m08:52:13.405746 [debug] [Thread-3 (]: Finished running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:52:13.407739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:13.408736 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:52:13.408736 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:52:13.409732 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:52:13.409732 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m08:52:13.410730 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m08:52:13.411728 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m08:52:13.411728 [debug] [MainThread]: Connection 'model.bq_evo.stg_meta_campaign_information' was properly closed.
[0m08:52:13.412724 [debug] [MainThread]: Connection 'model.bq_evo.int_meta_campaign_stats_joined_campaign_names' was properly closed.
[0m08:52:13.412724 [debug] [MainThread]: Connection 'model.bq_evo.int_meta_unique_campaigns' was properly closed.
[0m08:52:13.413721 [info ] [MainThread]: 
[0m08:52:13.414719 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 7.57 seconds (7.57s).
[0m08:52:13.416934 [debug] [MainThread]: Command end result
[0m08:52:13.431896 [info ] [MainThread]: 
[0m08:52:13.432892 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:52:13.432892 [info ] [MainThread]: 
[0m08:52:13.433897 [error] [MainThread]:   Database Error in model int_meta_campaign_stats_joined_campaign_names (models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql)
  Unrecognized name: _rename_join_column at [28:8]
  compiled Code at target\run\bq_evo\models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql
[0m08:52:13.435883 [info ] [MainThread]: 
[0m08:52:13.436910 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m08:52:13.438876 [debug] [MainThread]: Command `dbt run` failed at 08:52:13.437878 after 8.23 seconds
[0m08:52:13.438876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191A095B090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191A0970F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191A0970410>]}
[0m08:52:13.439899 [debug] [MainThread]: Flushing usage events
[0m08:52:26.383618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F24212D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F5957850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F5835210>]}


============================== 08:52:26.387606 | 13c3b4b7-2243-4267-ab9a-cd12d6245bed ==============================
[0m08:52:26.387606 [info ] [MainThread]: Running with dbt=1.6.2
[0m08:52:26.388603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m *meta_*', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:52:26.727810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13c3b4b7-2243-4267-ab9a-cd12d6245bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F4E84ED0>]}
[0m08:52:26.736820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13c3b4b7-2243-4267-ab9a-cd12d6245bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F4B1C350>]}
[0m08:52:26.737849 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m08:52:26.789643 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m08:52:26.893112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:26.893112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:26.901092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13c3b4b7-2243-4267-ab9a-cd12d6245bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F6DA6B90>]}
[0m08:52:26.920193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13c3b4b7-2243-4267-ab9a-cd12d6245bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F6C99010>]}
[0m08:52:26.920193 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m08:52:26.921225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c3b4b7-2243-4267-ab9a-cd12d6245bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F637F890>]}
[0m08:52:26.923218 [info ] [MainThread]: 
[0m08:52:26.925205 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:52:26.926177 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:52:26.927199 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:52:26.928187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:26.928187 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:52:26.929195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:26.930166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:29.664895 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m08:52:29.665865 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m08:52:29.665865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:29.666864 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m08:52:29.667859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:29.669854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:30.349536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c3b4b7-2243-4267-ab9a-cd12d6245bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F6D9A510>]}
[0m08:52:30.351568 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:30.353543 [info ] [MainThread]: 
[0m08:52:30.362232 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_meta_campaign_information
[0m08:52:30.363266 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_meta_campaign_stats
[0m08:52:30.364264 [info ] [Thread-1 (]: 1 of 5 START sql view model staging.stg_meta_campaign_information .............. [RUN]
[0m08:52:30.367217 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_meta_campaign_information'
[0m08:52:30.366224 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_meta_campaign_stats .................... [RUN]
[0m08:52:30.368215 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_meta_campaign_information
[0m08:52:30.369212 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_meta_campaign_stats'
[0m08:52:30.379186 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_meta_campaign_information"
[0m08:52:30.379606 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_meta_campaign_stats
[0m08:52:30.383213 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_meta_campaign_stats"
[0m08:52:30.383213 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_meta_campaign_information (compile): 08:52:30.370212 => 08:52:30.383213
[0m08:52:30.384178 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_meta_campaign_information
[0m08:52:30.385175 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_meta_campaign_stats (compile): 08:52:30.380185 => 08:52:30.385175
[0m08:52:30.419598 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_meta_campaign_information"
[0m08:52:30.419598 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_meta_campaign_stats
[0m08:52:30.424143 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_meta_campaign_stats"
[0m08:52:30.425147 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:52:30.426288 [debug] [Thread-1 (]: On model.bq_evo.stg_meta_campaign_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_meta_campaign_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen. Inklusive Informationen \u00fcber zugeh\u00f6rige Anzeigengruppen und Anzeigen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`facebook_ads`.`fb_campaign_information`
),

_renamed_columns AS(
    SELECT 
        * EXCEPT (campaign_name),
        campaign_name as Campaign
    FROM _raw
),

_added_more_metadata AS(
    SELECT 
        *,
        'cpc' as Medium,
        'EVO' as Partner,
        CASE
            WHEN Campaign LIKE '%:IG%' AND Campaign NOT LIKE '%:FB:IG:%' THEN 'instagram'
            WHEN Campaign LIKE '%:FB:IG:%' OR Campaign LIKE '%:FB:%' THEN 'facebook'
            ELSE '(not set)'
        END AS Source,
        'true' as IsPaid
    FROM _renamed_columns
),

_added_campaignid AS(
    SELECT
        *,
        LOWER (CONCAT(Campaign, Source, Medium, Partner)) as CampaignID
    FROM _added_more_metadata
),

_final AS(
    SELECT *
    FROM _added_campaignid
)

SELECT * FROM _final;


[0m08:52:30.428283 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:52:30.428283 [debug] [Thread-2 (]: On model.bq_evo.stg_meta_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_meta_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Metakampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`facebook_ads`.`fb_basic_performance_per_day`
),

_renamed_columns AS (
    SELECT
        _fivetran_id,
        ad_id,
        date as Date,
        _fivetran_synced,
        account_id,
        adset_name,
        campaign_name as Campaign,
        clicks as Clicks,
        cpc,
        cpm,
        ctr,
        impressions as Impressions,
        reach,
        spend as Cost
    FROM _raw
),

_final AS (
    SELECT *    
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m08:52:31.126883 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c9361d80-c7fb-43e9-97ee-0515a9062b2c&page=queryresults
[0m08:52:31.137138 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:74d0bb4a-9aae-4e48-aa9d-0600a6de0488&page=queryresults
[0m08:52:31.308635 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_meta_campaign_information (execute): 08:52:30.386173 => 08:52:31.308635
[0m08:52:31.311624 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_meta_campaign_stats (execute): 08:52:30.421064 => 08:52:31.311624
[0m08:52:31.311624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c3b4b7-2243-4267-ab9a-cd12d6245bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F6C53CD0>]}
[0m08:52:31.313586 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c3b4b7-2243-4267-ab9a-cd12d6245bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F6D39650>]}
[0m08:52:31.314622 [info ] [Thread-1 (]: 1 of 5 OK created sql view model staging.stg_meta_campaign_information ......... [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m08:52:31.315580 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_meta_campaign_information
[0m08:52:31.314622 [info ] [Thread-2 (]: 2 of 5 OK created sql view model staging.stg_meta_campaign_stats ............... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m08:52:31.316578 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_meta_campaign_stats
[0m08:52:31.318130 [debug] [Thread-4 (]: Began running node model.bq_evo.int_meta_unique_campaigns
[0m08:52:31.318698 [info ] [Thread-4 (]: 3 of 5 START sql view model intermediate.int_meta_unique_campaigns ............. [RUN]
[0m08:52:31.319701 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_meta_unique_campaigns'
[0m08:52:31.320697 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_meta_unique_campaigns
[0m08:52:31.323688 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_meta_unique_campaigns"
[0m08:52:31.326733 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_meta_unique_campaigns (compile): 08:52:31.321694 => 08:52:31.326733
[0m08:52:31.327677 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_meta_unique_campaigns
[0m08:52:31.331666 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_meta_unique_campaigns"
[0m08:52:31.333671 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:52:31.334659 [debug] [Thread-4 (]: On model.bq_evo.int_meta_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_meta_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_information`
),

_distinct_campaigns AS(
    SELECT
        MAX(Campaign) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 5
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m08:52:31.951527 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e7ae8273-caba-4731-96e5-cd80a44560d2&page=queryresults
[0m08:52:32.372335 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_meta_unique_campaigns (execute): 08:52:31.328674 => 08:52:32.372335
[0m08:52:32.373308 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c3b4b7-2243-4267-ab9a-cd12d6245bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F6EA5E10>]}
[0m08:52:32.374305 [info ] [Thread-4 (]: 3 of 5 OK created sql view model intermediate.int_meta_unique_campaigns ........ [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m08:52:32.375327 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_meta_unique_campaigns
[0m08:52:32.377313 [debug] [Thread-1 (]: Began running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:52:32.377313 [info ] [Thread-1 (]: 4 of 5 START sql view model intermediate.int_meta_campaign_stats_joined_campaign_names  [RUN]
[0m08:52:32.379292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_meta_campaign_information, now model.bq_evo.int_meta_campaign_stats_joined_campaign_names)
[0m08:52:32.379292 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:52:32.383314 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"
[0m08:52:32.385275 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_meta_campaign_stats_joined_campaign_names (compile): 08:52:32.380288 => 08:52:32.385275
[0m08:52:32.386273 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:52:32.390263 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"
[0m08:52:32.392261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:32.393256 [debug] [Thread-1 (]: On model.bq_evo.int_meta_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
),

_rename_join_column AS(
    SELECT 
        * EXCEPT (Campaign),
        Campaign as CampaignJoin
    FROM _raw_unique_campaigns
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _rename_join_column.CampaignJoin = _raw_performance.Campaign
),

_final AS(
    SELECT * EXCEPT (CampaignJoin)
    FROM _joined
)

SELECT * FROM _final;


[0m08:52:33.043837 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:551472c4-369c-4f21-8df0-19918b9aa439&page=queryresults
[0m08:52:33.194593 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: _rename_join_column at [28:8]')
[0m08:52:33.788510 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8c3b71a5-fee4-46a1-bdd8-12300ea18ce6&page=queryresults
[0m08:52:33.963229 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8c3b71a5-fee4-46a1-bdd8-12300ea18ce6&page=queryresults
[0m08:52:33.968201 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_meta_campaign_stats_joined_campaign_names (execute): 08:52:32.386273 => 08:52:33.967207
[0m08:52:33.976164 [debug] [Thread-1 (]: Database Error in model int_meta_campaign_stats_joined_campaign_names (models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql)
  Unrecognized name: _rename_join_column at [28:8]
  compiled Code at target\run\bq_evo\models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql
[0m08:52:33.977128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c3b4b7-2243-4267-ab9a-cd12d6245bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F6F015D0>]}
[0m08:52:33.978125 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model intermediate.int_meta_campaign_stats_joined_campaign_names  [[31mERROR[0m in 1.60s]
[0m08:52:33.979122 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:52:33.980119 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:52:33.981131 [info ] [Thread-2 (]: 5 of 5 SKIP relation mart.mrt_meta_basic_campaign_stats ........................ [[33mSKIP[0m]
[0m08:52:33.983112 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:52:33.985652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:33.985652 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:52:33.986627 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:52:33.986627 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:52:33.987610 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m08:52:33.987610 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m08:52:33.988608 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m08:52:33.989605 [debug] [MainThread]: Connection 'model.bq_evo.int_meta_campaign_stats_joined_campaign_names' was properly closed.
[0m08:52:33.989605 [debug] [MainThread]: Connection 'model.bq_evo.stg_meta_campaign_stats' was properly closed.
[0m08:52:33.990602 [debug] [MainThread]: Connection 'model.bq_evo.int_meta_unique_campaigns' was properly closed.
[0m08:52:33.991617 [info ] [MainThread]: 
[0m08:52:33.992597 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 7.07 seconds (7.07s).
[0m08:52:33.994626 [debug] [MainThread]: Command end result
[0m08:52:34.012580 [info ] [MainThread]: 
[0m08:52:34.013580 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:52:34.015573 [info ] [MainThread]: 
[0m08:52:34.016639 [error] [MainThread]:   Database Error in model int_meta_campaign_stats_joined_campaign_names (models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql)
  Unrecognized name: _rename_join_column at [28:8]
  compiled Code at target\run\bq_evo\models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql
[0m08:52:34.017567 [info ] [MainThread]: 
[0m08:52:34.018563 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m08:52:34.019561 [debug] [MainThread]: Command `dbt run` failed at 08:52:34.019561 after 7.65 seconds
[0m08:52:34.020558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F4E6C490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F5957B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F51A4150>]}
[0m08:52:34.020558 [debug] [MainThread]: Flushing usage events
[0m08:53:12.714025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C06F9E6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C06F924F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C07002B190>]}


============================== 08:53:12.720699 | 550e2890-9fef-4d3c-abf4-379b4ae13a03 ==============================
[0m08:53:12.720699 [info ] [MainThread]: Running with dbt=1.6.2
[0m08:53:12.721440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\NDD-BA23\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\NDD-BA23\\OneDrive - Next Digital Group GmbH\\Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m *meta_*', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:53:13.056291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '550e2890-9fef-4d3c-abf4-379b4ae13a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C06F924FD0>]}
[0m08:53:13.065267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '550e2890-9fef-4d3c-abf4-379b4ae13a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C071013150>]}
[0m08:53:13.066264 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m08:53:13.118714 [debug] [MainThread]: checksum: 8d66c46a7c5c0e5717f369273dbde9db64740684d9ba42e6442c1808d698ae9f, vars: {}, profile: , target: , version: 1.6.2
[0m08:53:13.216072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:53:13.217070 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\meta\int_meta_campaign_stats_joined_campaign_names.sql
[0m08:53:13.266292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '550e2890-9fef-4d3c-abf4-379b4ae13a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C071486050>]}
[0m08:53:13.285484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '550e2890-9fef-4d3c-abf4-379b4ae13a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0716C4190>]}
[0m08:53:13.286480 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m08:53:13.287511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '550e2890-9fef-4d3c-abf4-379b4ae13a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0711D5010>]}
[0m08:53:13.289507 [info ] [MainThread]: 
[0m08:53:13.290502 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:53:13.292463 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:53:13.292463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:13.293462 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:53:13.294287 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m08:53:13.295316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:13.295316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:15.865961 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m08:53:15.868948 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m08:53:15.870895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:15.873883 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m08:53:15.875881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:15.882869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:16.587842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '550e2890-9fef-4d3c-abf4-379b4ae13a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C071012610>]}
[0m08:53:16.588840 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:53:16.589838 [info ] [MainThread]: 
[0m08:53:16.594722 [debug] [Thread-1 (]: Began running node model.bq_evo.stg_meta_campaign_information
[0m08:53:16.594722 [debug] [Thread-2 (]: Began running node model.bq_evo.stg_meta_campaign_stats
[0m08:53:16.595756 [info ] [Thread-1 (]: 1 of 5 START sql view model staging.stg_meta_campaign_information .............. [RUN]
[0m08:53:16.596721 [info ] [Thread-2 (]: 2 of 5 START sql view model staging.stg_meta_campaign_stats .................... [RUN]
[0m08:53:16.597717 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.stg_meta_campaign_information'
[0m08:53:16.599712 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.stg_meta_campaign_stats'
[0m08:53:16.599712 [debug] [Thread-1 (]: Began compiling node model.bq_evo.stg_meta_campaign_information
[0m08:53:16.600747 [debug] [Thread-2 (]: Began compiling node model.bq_evo.stg_meta_campaign_stats
[0m08:53:16.610685 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.stg_meta_campaign_information"
[0m08:53:16.613712 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.stg_meta_campaign_stats"
[0m08:53:16.614674 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_meta_campaign_information (compile): 08:53:16.601706 => 08:53:16.614674
[0m08:53:16.615672 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_meta_campaign_stats (compile): 08:53:16.610685 => 08:53:16.615672
[0m08:53:16.616672 [debug] [Thread-1 (]: Began executing node model.bq_evo.stg_meta_campaign_information
[0m08:53:16.617670 [debug] [Thread-2 (]: Began executing node model.bq_evo.stg_meta_campaign_stats
[0m08:53:16.651100 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.stg_meta_campaign_information"
[0m08:53:16.655130 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.stg_meta_campaign_stats"
[0m08:53:16.657081 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:53:16.658080 [debug] [Thread-1 (]: On model.bq_evo.stg_meta_campaign_information: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_meta_campaign_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagneninformationen der Metakampagnen. Inklusive Informationen \u00fcber zugeh\u00f6rige Anzeigengruppen und Anzeigen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`facebook_ads`.`fb_campaign_information`
),

_renamed_columns AS(
    SELECT 
        * EXCEPT (campaign_name),
        campaign_name as Campaign
    FROM _raw
),

_added_more_metadata AS(
    SELECT 
        *,
        'cpc' as Medium,
        'EVO' as Partner,
        CASE
            WHEN Campaign LIKE '%:IG%' AND Campaign NOT LIKE '%:FB:IG:%' THEN 'instagram'
            WHEN Campaign LIKE '%:FB:IG:%' OR Campaign LIKE '%:FB:%' THEN 'facebook'
            ELSE '(not set)'
        END AS Source,
        'true' as IsPaid
    FROM _renamed_columns
),

_added_campaignid AS(
    SELECT
        *,
        LOWER (CONCAT(Campaign, Source, Medium, Partner)) as CampaignID
    FROM _added_more_metadata
),

_final AS(
    SELECT *
    FROM _added_campaignid
)

SELECT * FROM _final;


[0m08:53:16.659076 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:53:16.661070 [debug] [Thread-2 (]: On model.bq_evo.stg_meta_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.stg_meta_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt alle Performancestatistiken der Metakampagnen. Enth\u00e4lt keine Conversioninformationen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`facebook_ads`.`fb_basic_performance_per_day`
),

_renamed_columns AS (
    SELECT
        _fivetran_id,
        ad_id,
        date as Date,
        _fivetran_synced,
        account_id,
        adset_name,
        campaign_name as Campaign,
        clicks as Clicks,
        cpc,
        cpm,
        ctr,
        impressions as Impressions,
        reach,
        spend as Cost
    FROM _raw
),

_final AS (
    SELECT *    
    FROM _renamed_columns
)

SELECT * FROM _final;


[0m08:53:17.368715 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5874243b-dcc3-4f30-b42f-ff9ec727c309&page=queryresults
[0m08:53:17.407664 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:0f43abad-4432-4bf3-a63f-cf246d216d73&page=queryresults
[0m08:53:17.544012 [debug] [Thread-1 (]: Timing info for model.bq_evo.stg_meta_campaign_information (execute): 08:53:16.618668 => 08:53:17.544012
[0m08:53:17.545011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '550e2890-9fef-4d3c-abf4-379b4ae13a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C07155DC50>]}
[0m08:53:17.545972 [info ] [Thread-1 (]: 1 of 5 OK created sql view model staging.stg_meta_campaign_information ......... [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m08:53:17.546969 [debug] [Thread-1 (]: Finished running node model.bq_evo.stg_meta_campaign_information
[0m08:53:17.547967 [debug] [Thread-4 (]: Began running node model.bq_evo.int_meta_unique_campaigns
[0m08:53:17.548964 [info ] [Thread-4 (]: 3 of 5 START sql view model intermediate.int_meta_unique_campaigns ............. [RUN]
[0m08:53:17.550960 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_meta_unique_campaigns'
[0m08:53:17.550960 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_meta_unique_campaigns
[0m08:53:17.554983 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_meta_unique_campaigns"
[0m08:53:17.555960 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_meta_unique_campaigns (compile): 08:53:17.551990 => 08:53:17.555960
[0m08:53:17.556943 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_meta_unique_campaigns
[0m08:53:17.559969 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_meta_unique_campaigns"
[0m08:53:17.560966 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:53:17.561939 [debug] [Thread-4 (]: On model.bq_evo.int_meta_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_meta_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_information`
),

_distinct_campaigns AS(
    SELECT
        MAX(Campaign) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 5
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m08:53:17.612829 [debug] [Thread-2 (]: Timing info for model.bq_evo.stg_meta_campaign_stats (execute): 08:53:16.652096 => 08:53:17.612829
[0m08:53:17.613826 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '550e2890-9fef-4d3c-abf4-379b4ae13a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C071748D50>]}
[0m08:53:17.614823 [info ] [Thread-2 (]: 2 of 5 OK created sql view model staging.stg_meta_campaign_stats ............... [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m08:53:17.615821 [debug] [Thread-2 (]: Finished running node model.bq_evo.stg_meta_campaign_stats
[0m08:53:18.202482 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2518fd49-bbc6-4784-9780-1b02ddfe5d0c&page=queryresults
[0m08:53:18.633802 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_meta_unique_campaigns (execute): 08:53:17.556943 => 08:53:18.633802
[0m08:53:18.634834 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '550e2890-9fef-4d3c-abf4-379b4ae13a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C07155C6D0>]}
[0m08:53:18.635826 [info ] [Thread-4 (]: 3 of 5 OK created sql view model intermediate.int_meta_unique_campaigns ........ [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m08:53:18.636796 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_meta_unique_campaigns
[0m08:53:18.637818 [debug] [Thread-1 (]: Began running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:53:18.638789 [info ] [Thread-1 (]: 4 of 5 START sql view model intermediate.int_meta_campaign_stats_joined_campaign_names  [RUN]
[0m08:53:18.640803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_meta_campaign_information, now model.bq_evo.int_meta_campaign_stats_joined_campaign_names)
[0m08:53:18.640803 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:53:18.644773 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"
[0m08:53:18.646769 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_meta_campaign_stats_joined_campaign_names (compile): 08:53:18.641781 => 08:53:18.645770
[0m08:53:18.646769 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:53:18.651755 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"
[0m08:53:18.653750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:18.654746 [debug] [Thread-1 (]: On model.bq_evo.int_meta_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
),

_rename_join_column AS(
    SELECT 
        * EXCEPT (Campaign),
        Campaign as CampaignJoin
    FROM _raw_unique_campaigns
),

_joined AS(
    SELECT * FROM _rename_join_column
    INNER JOIN _raw_performance
    ON _rename_join_column.CampaignJoin = _raw_performance.Campaign
),

_final AS(
    SELECT * EXCEPT (CampaignJoin)
    FROM _joined
)

SELECT * FROM _final;


[0m08:53:19.338110 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:94f4d39c-bdbc-41be-ab3a-395c36d7f9fa&page=queryresults
[0m08:53:19.749542 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_meta_campaign_stats_joined_campaign_names (execute): 08:53:18.647765 => 08:53:19.749542
[0m08:53:19.750539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '550e2890-9fef-4d3c-abf4-379b4ae13a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0717323D0>]}
[0m08:53:19.751503 [info ] [Thread-1 (]: 4 of 5 OK created sql view model intermediate.int_meta_campaign_stats_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m08:53:19.752535 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m08:53:19.753497 [debug] [Thread-2 (]: Began running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:53:19.754529 [info ] [Thread-2 (]: 5 of 5 START sql incremental model mart.mrt_meta_basic_campaign_stats .......... [RUN]
[0m08:53:19.755490 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.stg_meta_campaign_stats, now model.bq_evo.mrt_meta_basic_campaign_stats)
[0m08:53:19.756489 [debug] [Thread-2 (]: Began compiling node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:53:19.767459 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.mrt_meta_basic_campaign_stats"
[0m08:53:19.769455 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_meta_basic_campaign_stats (compile): 08:53:19.756489 => 08:53:19.768456
[0m08:53:19.770451 [debug] [Thread-2 (]: Began executing node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:53:19.829877 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.mrt_meta_basic_campaign_stats"
[0m08:53:19.830915 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:53:19.831876 [debug] [Thread-2 (]: On model.bq_evo.mrt_meta_basic_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.2", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.mrt_meta_basic_campaign_stats"} */

  
    

    create or replace table `oss-big-query-dashboard-prod`.`mart`.`mrt_meta_basic_campaign_stats`
      
    
    

    OPTIONS(
      description="""Enth\u00e4lt die Performancedaten der Metakampagnen."""
    )
    as (
      

WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_campaign_stats_joined_campaign_names`

    
),

_selected_columns AS(
  SELECT 
    Date,
    Campaign,   
    CampaignID,
    Source,
    Medium,
    Partner,
    '(not set)' as Keyword,
    '(not set)' as KeywordMatchType,
    
    Impressions,
    Clicks,
    Cost

  FROM _raw
),

_final_aggregation AS(
  SELECT 
    Date,
    Campaign,
    
    MAX(CampaignID) as CampaignID,
    MAX(Source) as Source,
    MAX(Medium) as Medium,
    MAX(Partner) as Partner,
    MAX(Keyword) as Keyword,
    MAX(KeywordMatchType) as KeywordMatchType,
    
    SUM(Impressions) as Impressions,
    SUM(Clicks) as Clicks,
    SUM(Cost) as Cost

  FROM _selected_columns
  GROUP BY 1,2
)

SELECT * FROM _final_aggregation
    );
  
[0m08:53:20.570296 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:82ebcc12-7cce-4aa1-b7fe-7e5a202a36b1&page=queryresults
[0m08:53:22.483935 [debug] [Thread-2 (]: Timing info for model.bq_evo.mrt_meta_basic_campaign_stats (execute): 08:53:19.771533 => 08:53:22.482931
[0m08:53:22.485881 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '550e2890-9fef-4d3c-abf4-379b4ae13a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C071577410>]}
[0m08:53:22.486911 [info ] [Thread-2 (]: 5 of 5 OK created sql incremental model mart.mrt_meta_basic_campaign_stats ..... [[32mCREATE TABLE (480.0 rows, 126.0 KiB processed)[0m in 2.73s]
[0m08:53:22.487875 [debug] [Thread-2 (]: Finished running node model.bq_evo.mrt_meta_basic_campaign_stats
[0m08:53:22.489903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:53:22.490901 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:53:22.490901 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:53:22.491865 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m08:53:22.491865 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m08:53:22.492862 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m08:53:22.492862 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m08:53:22.493860 [debug] [MainThread]: Connection 'model.bq_evo.int_meta_campaign_stats_joined_campaign_names' was properly closed.
[0m08:53:22.493860 [debug] [MainThread]: Connection 'model.bq_evo.mrt_meta_basic_campaign_stats' was properly closed.
[0m08:53:22.494857 [debug] [MainThread]: Connection 'model.bq_evo.int_meta_unique_campaigns' was properly closed.
[0m08:53:22.495408 [info ] [MainThread]: 
[0m08:53:22.496409 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 9.20 seconds (9.20s).
[0m08:53:22.498430 [debug] [MainThread]: Command end result
[0m08:53:22.513363 [info ] [MainThread]: 
[0m08:53:22.514360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:53:22.516356 [info ] [MainThread]: 
[0m08:53:22.517352 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:53:22.518363 [debug] [MainThread]: Command `dbt run` succeeded at 08:53:22.518363 after 9.82 seconds
[0m08:53:22.519347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C069F271D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C069F6FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C06A13DD90>]}
[0m08:53:22.520347 [debug] [MainThread]: Flushing usage events
[0m15:45:05.867212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F6002AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F60107390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5FB95510>]}


============================== 15:45:06.376604 | 76379f86-c0e4-4c4f-9e9c-6058cbd457e0 ==============================
[0m15:45:06.376604 [info ] [MainThread]: Running with dbt=1.6.3
[0m15:45:06.377600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BenedictAltgassen\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BenedictAltgassen\\Next Digital Group GmbH\\Next Digital Data - Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m int_google_analytics_all_events', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:45:06.380621 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'bq_evo'
[0m15:45:06.380621 [debug] [MainThread]: Command `dbt run` failed at 15:45:06.380621 after 0.80 seconds
[0m15:45:06.381617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F600493D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5A748B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5A748A90>]}
[0m15:45:06.381617 [debug] [MainThread]: Flushing usage events
[0m15:46:12.356939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD84BDFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD7E2B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD8A1D150>]}


============================== 15:46:12.359940 | 3b16a3f6-10dc-4f29-b6e4-6f92de90c0c5 ==============================
[0m15:46:12.359940 [info ] [MainThread]: Running with dbt=1.6.3
[0m15:46:12.360939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BenedictAltgassen\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BenedictAltgassen\\Next Digital Group GmbH\\Next Digital Data - Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m int_google_analytics_all_events', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:46:12.572939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b16a3f6-10dc-4f29-b6e4-6f92de90c0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD9696610>]}
[0m15:46:12.577945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b16a3f6-10dc-4f29-b6e4-6f92de90c0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD8A85BD0>]}
[0m15:46:12.587947 [info ] [MainThread]: Registered adapter: bigquery=1.6.5
[0m15:46:12.597937 [debug] [MainThread]: checksum: 800ab10c53db38b54e69cd328777f0c48b6374b8a89466e8ff54aa9acb452b75, vars: {}, profile: , target: , version: 1.6.3
[0m15:46:12.857374 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:46:12.858394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3b16a3f6-10dc-4f29-b6e4-6f92de90c0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD9EC5DD0>]}
[0m15:46:20.504235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b16a3f6-10dc-4f29-b6e4-6f92de90c0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD9EA4C50>]}
[0m15:46:20.529081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b16a3f6-10dc-4f29-b6e4-6f92de90c0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDA257DD0>]}
[0m15:46:20.530081 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:46:20.530081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b16a3f6-10dc-4f29-b6e4-6f92de90c0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD9E0ACD0>]}
[0m15:46:20.531081 [info ] [MainThread]: 
[0m15:46:20.532097 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:46:20.533106 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:46:20.533106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:22.065961 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m15:46:22.066961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:22.068960 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m15:46:22.069959 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m15:46:22.073957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:22.074956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:22.692520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b16a3f6-10dc-4f29-b6e4-6f92de90c0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD7F81150>]}
[0m15:46:22.693627 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:46:22.694657 [info ] [MainThread]: 
[0m15:46:22.707692 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m15:46:22.708689 [info ] [Thread-1 (]: 1 of 1 START sql view model intermediate.int_google_analytics_all_events ....... [RUN]
[0m15:46:22.709688 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_analytics_all_events'
[0m15:46:22.709688 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m15:46:22.714706 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m15:46:22.715702 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 15:46:22.709688 => 15:46:22.715702
[0m15:46:22.715702 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m15:46:22.735691 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m15:46:22.736690 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:46:22.736690 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_add_default_channel_groupings AS(
    SELECT *,
        case
            when (Source = 'direct' or Source is null) 
                and (regexp_contains(Medium, r'^(\(not set\)|\(none\))$') or Medium is null) 
                then 'direct'
            when regexp_contains(Campaign, r'^(.*shop.*)$') 
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'shopping_paid'
            when regexp_contains(Source, r'^(google|bing)$') 
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'search_paid'
            when regexp_contains(Source, r'^(twitter|facebook|fb|instagram|ig|linkedin|pinterest)$')
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*|social_paid)$') 
                then 'social_paid'
            when regexp_contains(Source, r'^(youtube)$')
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'video_paid'
            when regexp_contains(Medium, r'^(display|banner|expandable|interstitial|cpm)$') 
                then 'display'
            when regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'other_paid'
            when regexp_contains(Medium, r'^(.*shop.*)$') 
                then 'shopping_organic'
            when regexp_contains(Source, r'^.*(twitter|t\.co|facebook|instagram|linkedin|lnkd\.in|pinterest).*') 
                or regexp_contains(Medium, r'^(social|social_advertising|social-advertising|social_network|social-network|social_media|social-media|sm|social-unpaid|social_unpaid)$') 
                then 'social_organic'
            when regexp_contains(Medium, r'^(.*video.*)$') 
                then 'video_organic'
            when regexp_contains(Source, r'^(google|bing|yahoo|baidu|duckduckgo|yandex|ask)$') 
                or Medium = 'organic'
                then 'search_organic'
            when regexp_contains(Source, r'^(email|mail|e-mail|e_mail|e mail|mail\.google\.com)$') 
                or regexp_contains(Medium, r'^(email|mail|e-mail|e_mail|e mail)$') 
                then 'email'
            when regexp_contains(Medium, r'^(affiliate|affiliates)$') 
                then 'affiliate'
            when Medium = 'referral'
                then 'referral'
            when Medium = 'audio' 
                then 'audio'
            when Medium = 'sms'
                then 'sms'
            when ends_with(Medium, 'push')
                or regexp_contains(Medium, r'.*(mobile|notification).*') 
                then 'mobile_push'
            else '(other)'
        end AS default_channel_grouping
),

_final AS(
    SELECT *
    FROM _add_default_channel_groupings
)

SELECT * FROM _final;


[0m15:46:23.309368 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6a69d8b2-7fbc-4228-b626-32f27d8e0bc7&page=queryresults
[0m15:46:23.539833 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT * must have a FROM clause at [31:12]')
[0m15:46:24.702244 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:873d6793-e1e9-4ffa-a11a-30b7a4bcaf4f&page=queryresults
[0m15:46:24.877008 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:873d6793-e1e9-4ffa-a11a-30b7a4bcaf4f&page=queryresults
[0m15:46:24.877008 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 15:46:22.716688 => 15:46:24.877008
[0m15:46:24.949471 [debug] [Thread-1 (]: Database Error in model int_google_analytics_all_events (models\intermediate\google_analytics\int_google_analytics_all_events.sql)
  SELECT * must have a FROM clause at [31:12]
  compiled Code at target\run\bq_evo\models\intermediate\google_analytics\int_google_analytics_all_events.sql
[0m15:46:24.949471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b16a3f6-10dc-4f29-b6e4-6f92de90c0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDA21A6D0>]}
[0m15:46:24.950905 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model intermediate.int_google_analytics_all_events  [[31mERROR[0m in 2.24s]
[0m15:46:24.950905 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m15:46:24.952909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:24.952909 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:46:24.952909 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m15:46:24.953908 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m15:46:24.953908 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m15:46:24.953908 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_events' was properly closed.
[0m15:46:24.954910 [info ] [MainThread]: 
[0m15:46:24.954910 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.42 seconds (4.42s).
[0m15:46:24.959909 [debug] [MainThread]: Command end result
[0m15:46:24.967910 [info ] [MainThread]: 
[0m15:46:24.968910 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:46:24.968910 [info ] [MainThread]: 
[0m15:46:24.969911 [error] [MainThread]:   Database Error in model int_google_analytics_all_events (models\intermediate\google_analytics\int_google_analytics_all_events.sql)
  SELECT * must have a FROM clause at [31:12]
  compiled Code at target\run\bq_evo\models\intermediate\google_analytics\int_google_analytics_all_events.sql
[0m15:46:24.970910 [info ] [MainThread]: 
[0m15:46:24.970910 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:46:24.971910 [debug] [MainThread]: Command `dbt run` failed at 15:46:24.971910 after 12.63 seconds
[0m15:46:24.971910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD7F99A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD8A7DE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD8A85010>]}
[0m15:46:24.971910 [debug] [MainThread]: Flushing usage events
[0m15:46:44.430419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D3C1955D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D3CB3FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D3C6C4150>]}


============================== 15:46:44.433437 | 21d3b4fb-6229-4f36-b5ad-9f3cb6827c89 ==============================
[0m15:46:44.433437 [info ] [MainThread]: Running with dbt=1.6.3
[0m15:46:44.434440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BenedictAltgassen\\Next Digital Group GmbH\\Next Digital Data - Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'profiles_dir': 'C:\\Users\\BenedictAltgassen\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m int_google_analytics_all_events', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:46:44.629528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21d3b4fb-6229-4f36-b5ad-9f3cb6827c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D3D8A8050>]}
[0m15:46:44.634431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21d3b4fb-6229-4f36-b5ad-9f3cb6827c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D3D8B2C50>]}
[0m15:46:44.636086 [info ] [MainThread]: Registered adapter: bigquery=1.6.5
[0m15:46:44.640480 [debug] [MainThread]: checksum: 800ab10c53db38b54e69cd328777f0c48b6374b8a89466e8ff54aa9acb452b75, vars: {}, profile: , target: , version: 1.6.3
[0m15:46:44.779567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:46:44.779567 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\google_analytics\int_google_analytics_all_events.sql
[0m15:46:44.825505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21d3b4fb-6229-4f36-b5ad-9f3cb6827c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D3DF9BC10>]}
[0m15:46:44.837534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21d3b4fb-6229-4f36-b5ad-9f3cb6827c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D3E1CBF90>]}
[0m15:46:44.838539 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:46:44.839539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21d3b4fb-6229-4f36-b5ad-9f3cb6827c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D3E0FB290>]}
[0m15:46:44.840539 [info ] [MainThread]: 
[0m15:46:44.841584 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:46:44.842538 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:46:44.842538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:46.279120 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m15:46:46.280120 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m15:46:46.281126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:46.282145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:46.284128 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m15:46:46.289123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:46.900840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21d3b4fb-6229-4f36-b5ad-9f3cb6827c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D3DFAAD10>]}
[0m15:46:46.901844 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:46:46.902837 [info ] [MainThread]: 
[0m15:46:46.906923 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m15:46:46.907915 [info ] [Thread-1 (]: 1 of 1 START sql view model intermediate.int_google_analytics_all_events ....... [RUN]
[0m15:46:46.908904 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_analytics_all_events'
[0m15:46:46.908904 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m15:46:46.914906 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m15:46:46.916906 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 15:46:46.908904 => 15:46:46.915906
[0m15:46:46.916906 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m15:46:46.935906 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m15:46:46.937907 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:46:46.937907 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_add_default_channel_groupings AS(
    SELECT *,
        case
            when (Source = 'direct' or Source is null) 
                and (regexp_contains(Medium, r'^(\(not set\)|\(none\))$') or Medium is null) 
                then 'direct'
            when regexp_contains(Campaign, r'^(.*shop.*)$') 
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'shopping_paid'
            when regexp_contains(Source, r'^(google|bing)$') 
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'search_paid'
            when regexp_contains(Source, r'^(twitter|facebook|fb|instagram|ig|linkedin|pinterest)$')
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*|social_paid)$') 
                then 'social_paid'
            when regexp_contains(Source, r'^(youtube)$')
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'video_paid'
            when regexp_contains(Medium, r'^(display|banner|expandable|interstitial|cpm)$') 
                then 'display'
            when regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'other_paid'
            when regexp_contains(Medium, r'^(.*shop.*)$') 
                then 'shopping_organic'
            when regexp_contains(Source, r'^.*(twitter|t\.co|facebook|instagram|linkedin|lnkd\.in|pinterest).*') 
                or regexp_contains(Medium, r'^(social|social_advertising|social-advertising|social_network|social-network|social_media|social-media|sm|social-unpaid|social_unpaid)$') 
                then 'social_organic'
            when regexp_contains(Medium, r'^(.*video.*)$') 
                then 'video_organic'
            when regexp_contains(Source, r'^(google|bing|yahoo|baidu|duckduckgo|yandex|ask)$') 
                or Medium = 'organic'
                then 'search_organic'
            when regexp_contains(Source, r'^(email|mail|e-mail|e_mail|e mail|mail\.google\.com)$') 
                or regexp_contains(Medium, r'^(email|mail|e-mail|e_mail|e mail)$') 
                then 'email'
            when regexp_contains(Medium, r'^(affiliate|affiliates)$') 
                then 'affiliate'
            when Medium = 'referral'
                then 'referral'
            when Medium = 'audio' 
                then 'audio'
            when Medium = 'sms'
                then 'sms'
            when ends_with(Medium, 'push')
                or regexp_contains(Medium, r'.*(mobile|notification).*') 
                then 'mobile_push'
            else '(other)'
        end AS default_channel_grouping
    FROM _rename_columns
),

_final AS(
    SELECT *
    FROM _add_default_channel_groupings
)

SELECT * FROM _final;


[0m15:46:47.435985 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7bce83bc-101b-42cb-b88e-5a404402c705&page=queryresults
[0m15:46:48.002024 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 15:46:46.917920 => 15:46:48.001010
[0m15:46:48.004021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21d3b4fb-6229-4f36-b5ad-9f3cb6827c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D3D8DD890>]}
[0m15:46:48.005030 [info ] [Thread-1 (]: 1 of 1 OK created sql view model intermediate.int_google_analytics_all_events .. [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m15:46:48.007327 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m15:46:48.010325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:48.010325 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:46:48.011324 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m15:46:48.011324 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m15:46:48.012324 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m15:46:48.013341 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_events' was properly closed.
[0m15:46:48.014368 [info ] [MainThread]: 
[0m15:46:48.015351 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m15:46:48.016348 [debug] [MainThread]: Command end result
[0m15:46:48.025667 [info ] [MainThread]: 
[0m15:46:48.026661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:46:48.027661 [info ] [MainThread]: 
[0m15:46:48.027661 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:46:48.028695 [debug] [MainThread]: Command `dbt run` succeeded at 15:46:48.028695 after 3.61 seconds
[0m15:46:48.029662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D3CC7DF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D3C6086D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D3C643310>]}
[0m15:46:48.029662 [debug] [MainThread]: Flushing usage events
[0m15:47:02.391319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB51A85610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB514684D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB50F77210>]}


============================== 15:47:02.393338 | d30ba548-97c6-4770-8607-23ecd1bb2862 ==============================
[0m15:47:02.393338 [info ] [MainThread]: Running with dbt=1.6.3
[0m15:47:02.394339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BenedictAltgassen\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BenedictAltgassen\\Next Digital Group GmbH\\Next Digital Data - Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh -m int_google_analytics_all_events', 'send_anonymous_usage_stats': 'True'}
[0m15:47:02.584225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd30ba548-97c6-4770-8607-23ecd1bb2862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB526A9110>]}
[0m15:47:02.587751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd30ba548-97c6-4770-8607-23ecd1bb2862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB52675D10>]}
[0m15:47:02.588783 [info ] [MainThread]: Registered adapter: bigquery=1.6.5
[0m15:47:02.594782 [debug] [MainThread]: checksum: 800ab10c53db38b54e69cd328777f0c48b6374b8a89466e8ff54aa9acb452b75, vars: {}, profile: , target: , version: 1.6.3
[0m15:47:02.713194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:47:02.713194 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:47:02.717195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd30ba548-97c6-4770-8607-23ecd1bb2862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB52E9F4D0>]}
[0m15:47:02.729182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd30ba548-97c6-4770-8607-23ecd1bb2862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB52266E50>]}
[0m15:47:02.730179 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:47:02.730179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd30ba548-97c6-4770-8607-23ecd1bb2862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB51A8D3D0>]}
[0m15:47:02.731176 [info ] [MainThread]: 
[0m15:47:02.732199 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:47:02.733176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:47:02.734201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:04.127465 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m15:47:04.127465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:04.128527 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m15:47:04.130536 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m15:47:04.132528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:04.133427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:04.756673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd30ba548-97c6-4770-8607-23ecd1bb2862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB52EA4E50>]}
[0m15:47:04.756673 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:47:04.757691 [info ] [MainThread]: 
[0m15:47:04.761046 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m15:47:04.761046 [info ] [Thread-1 (]: 1 of 1 START sql view model intermediate.int_google_analytics_all_events ....... [RUN]
[0m15:47:04.761927 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_analytics_all_events'
[0m15:47:04.761927 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m15:47:04.766932 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m15:47:04.767932 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 15:47:04.762933 => 15:47:04.766932
[0m15:47:04.767932 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m15:47:04.786040 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m15:47:04.788042 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:47:04.789042 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_add_default_channel_groupings AS(
    SELECT *,
        case
            when (Source = 'direct' or Source is null) 
                and (regexp_contains(Medium, r'^(\(not set\)|\(none\))$') or Medium is null) 
                then 'direct'
            when regexp_contains(Campaign, r'^(.*shop.*)$') 
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'shopping_paid'
            when regexp_contains(Source, r'^(google|bing)$') 
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'search_paid'
            when regexp_contains(Source, r'^(twitter|facebook|fb|instagram|ig|linkedin|pinterest)$')
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*|social_paid)$') 
                then 'social_paid'
            when regexp_contains(Source, r'^(youtube)$')
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'video_paid'
            when regexp_contains(Medium, r'^(display|banner|expandable|interstitial|cpm)$') 
                then 'display'
            when regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'other_paid'
            when regexp_contains(Medium, r'^(.*shop.*)$') 
                then 'shopping_organic'
            when regexp_contains(Source, r'^.*(twitter|t\.co|facebook|instagram|linkedin|lnkd\.in|pinterest).*') 
                or regexp_contains(Medium, r'^(social|social_advertising|social-advertising|social_network|social-network|social_media|social-media|sm|social-unpaid|social_unpaid)$') 
                then 'social_organic'
            when regexp_contains(Medium, r'^(.*video.*)$') 
                then 'video_organic'
            when regexp_contains(Source, r'^(google|bing|yahoo|baidu|duckduckgo|yandex|ask)$') 
                or Medium = 'organic'
                then 'search_organic'
            when regexp_contains(Source, r'^(email|mail|e-mail|e_mail|e mail|mail\.google\.com)$') 
                or regexp_contains(Medium, r'^(email|mail|e-mail|e_mail|e mail)$') 
                then 'email'
            when regexp_contains(Medium, r'^(affiliate|affiliates)$') 
                then 'affiliate'
            when Medium = 'referral'
                then 'referral'
            when Medium = 'audio' 
                then 'audio'
            when Medium = 'sms'
                then 'sms'
            when ends_with(Medium, 'push')
                or regexp_contains(Medium, r'.*(mobile|notification).*') 
                then 'mobile_push'
            else '(other)'
        end AS default_channel_grouping
    FROM _rename_columns
),

_final AS(
    SELECT *
    FROM _add_default_channel_groupings
)

SELECT * FROM _final;


[0m15:47:05.328136 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:41badbe4-e4d5-43b0-8b39-1ded51a086ef&page=queryresults
[0m15:47:05.921977 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 15:47:04.767932 => 15:47:05.921977
[0m15:47:05.923999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd30ba548-97c6-4770-8607-23ecd1bb2862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB52675450>]}
[0m15:47:05.924991 [info ] [Thread-1 (]: 1 of 1 OK created sql view model intermediate.int_google_analytics_all_events .. [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m15:47:05.925971 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m15:47:05.927994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:05.927994 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:47:05.928970 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m15:47:05.928970 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m15:47:05.929971 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m15:47:05.929971 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_events' was properly closed.
[0m15:47:05.929971 [info ] [MainThread]: 
[0m15:47:05.930970 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m15:47:05.931971 [debug] [MainThread]: Command end result
[0m15:47:05.939970 [info ] [MainThread]: 
[0m15:47:05.940989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:47:05.940989 [info ] [MainThread]: 
[0m15:47:05.941972 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:47:05.942971 [debug] [MainThread]: Command `dbt run` succeeded at 15:47:05.941972 after 3.56 seconds
[0m15:47:05.942971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB51A7DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB4B86FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB5268AED0>]}
[0m15:47:05.942971 [debug] [MainThread]: Flushing usage events
[0m15:49:16.742337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022045263E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002204581FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220418292D0>]}


============================== 15:49:16.744340 | da67c60b-e002-49c1-acd9-ecb46b4baaaa ==============================
[0m15:49:16.744340 [info ] [MainThread]: Running with dbt=1.6.3
[0m15:49:16.745341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BenedictAltgassen\\Next Digital Group GmbH\\Next Digital Data - Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'profiles_dir': 'C:\\Users\\BenedictAltgassen\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh -m int_google_analytics_all_events', 'send_anonymous_usage_stats': 'True'}
[0m15:49:16.940502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da67c60b-e002-49c1-acd9-ecb46b4baaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022045D8BB10>]}
[0m15:49:16.945483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da67c60b-e002-49c1-acd9-ecb46b4baaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022045E3E810>]}
[0m15:49:16.946489 [info ] [MainThread]: Registered adapter: bigquery=1.6.5
[0m15:49:16.951503 [debug] [MainThread]: checksum: 800ab10c53db38b54e69cd328777f0c48b6374b8a89466e8ff54aa9acb452b75, vars: {}, profile: , target: , version: 1.6.3
[0m15:49:17.068976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:49:17.068976 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\google_analytics\int_google_analytics_all_events.sql
[0m15:49:17.117465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da67c60b-e002-49c1-acd9-ecb46b4baaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220470773D0>]}
[0m15:49:17.129508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da67c60b-e002-49c1-acd9-ecb46b4baaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022047147F10>]}
[0m15:49:17.130508 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:49:17.131508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da67c60b-e002-49c1-acd9-ecb46b4baaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022047204410>]}
[0m15:49:17.132509 [info ] [MainThread]: 
[0m15:49:17.133509 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:49:17.134509 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:49:17.134509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:18.567837 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m15:49:18.569853 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m15:49:18.570853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:18.572852 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m15:49:18.573851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:18.576926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:19.159821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da67c60b-e002-49c1-acd9-ecb46b4baaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220470AECD0>]}
[0m15:49:19.160865 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:49:19.161865 [info ] [MainThread]: 
[0m15:49:19.164866 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m15:49:19.165866 [info ] [Thread-1 (]: 1 of 1 START sql view model intermediate.int_google_analytics_all_events ....... [RUN]
[0m15:49:19.166866 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_analytics_all_events'
[0m15:49:19.167867 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m15:49:19.172865 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m15:49:19.174866 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 15:49:19.167867 => 15:49:19.174866
[0m15:49:19.174866 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m15:49:19.192885 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m15:49:19.193885 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:49:19.194865 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_add_default_channel_groupings AS(
    SELECT *,
        case
            when (Source = 'direct' or Source is null or Source = '(direct)') 
                and (regexp_contains(Medium, r'^(\(not set\)|\(none\))$') or Medium is null) 
                then 'direct'
            when regexp_contains(Campaign, r'^(.*shop.*)$') 
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'shopping_paid'
            when regexp_contains(Source, r'^(google|bing)$') 
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'search_paid'
            when regexp_contains(Source, r'^(twitter|facebook|fb|instagram|ig|linkedin|pinterest)$')
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*|social_paid)$') 
                then 'social_paid'
            when regexp_contains(Source, r'^(youtube)$')
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'video_paid'
            when regexp_contains(Medium, r'^(display|banner|expandable|interstitial|cpm)$') 
                then 'display'
            when regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'other_paid'
            when regexp_contains(Medium, r'^(.*shop.*)$') 
                then 'shopping_organic'
            when regexp_contains(Source, r'^.*(twitter|t\.co|facebook|instagram|linkedin|lnkd\.in|pinterest).*') 
                or regexp_contains(Medium, r'^(social|social_advertising|social-advertising|social_network|social-network|social_media|social-media|sm|social-unpaid|social_unpaid)$') 
                then 'social_organic'
            when regexp_contains(Medium, r'^(.*video.*)$') 
                then 'video_organic'
            when regexp_contains(Source, r'^(google|bing|yahoo|baidu|duckduckgo|yandex|ask)$') 
                or Medium = 'organic'
                then 'search_organic'
            when regexp_contains(Source, r'^(email|mail|e-mail|e_mail|e mail|mail\.google\.com)$') 
                or regexp_contains(Medium, r'^(email|mail|e-mail|e_mail|e mail)$') 
                then 'email'
            when regexp_contains(Medium, r'^(affiliate|affiliates)$') 
                then 'affiliate'
            when Medium = 'referral'
                then 'referral'
            when Medium = 'audio' 
                then 'audio'
            when Medium = 'sms'
                then 'sms'
            when ends_with(Medium, 'push')
                or regexp_contains(Medium, r'.*(mobile|notification).*') 
                then 'mobile_push'
            else '(other)'
        end AS default_channel_grouping
    FROM _rename_columns
),

_final AS(
    SELECT *
    FROM _add_default_channel_groupings
)

SELECT * FROM _final;


[0m15:49:20.387437 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:203882a8-002a-4045-810f-419e0d7c5f0b&page=queryresults
[0m15:49:20.906493 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 15:49:19.174866 => 15:49:20.906493
[0m15:49:20.908398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da67c60b-e002-49c1-acd9-ecb46b4baaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002204701D950>]}
[0m15:49:20.909395 [info ] [Thread-1 (]: 1 of 1 OK created sql view model intermediate.int_google_analytics_all_events .. [[32mCREATE VIEW (0 processed)[0m in 1.74s]
[0m15:49:20.910376 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m15:49:20.913397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:20.913397 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:49:20.914375 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m15:49:20.914375 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m15:49:20.914375 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m15:49:20.915374 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_events' was properly closed.
[0m15:49:20.915374 [info ] [MainThread]: 
[0m15:49:20.917375 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m15:49:20.918376 [debug] [MainThread]: Command end result
[0m15:49:20.927397 [info ] [MainThread]: 
[0m15:49:20.928539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:20.928539 [info ] [MainThread]: 
[0m15:49:20.929543 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:49:20.929543 [debug] [MainThread]: Command `dbt run` succeeded at 15:49:20.929543 after 4.20 seconds
[0m15:49:20.929543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022045285550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022044F2F190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220452624D0>]}
[0m15:49:20.931092 [debug] [MainThread]: Flushing usage events
[0m15:51:43.952529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A679487AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A67899C150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A678EBFE10>]}


============================== 15:51:43.955531 | 5023043f-04a5-4f7c-8016-b0ecc8c371a6 ==============================
[0m15:51:43.955531 [info ] [MainThread]: Running with dbt=1.6.3
[0m15:51:43.956531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BenedictAltgassen\\Next Digital Group GmbH\\Next Digital Data - Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'profiles_dir': 'C:\\Users\\BenedictAltgassen\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh -m int_google_analytics_all_purchases*', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:51:44.159706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5023043f-04a5-4f7c-8016-b0ecc8c371a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A67A84D810>]}
[0m15:51:44.164702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5023043f-04a5-4f7c-8016-b0ecc8c371a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A679497F90>]}
[0m15:51:44.165683 [info ] [MainThread]: Registered adapter: bigquery=1.6.5
[0m15:51:44.171702 [debug] [MainThread]: checksum: 800ab10c53db38b54e69cd328777f0c48b6374b8a89466e8ff54aa9acb452b75, vars: {}, profile: , target: , version: 1.6.3
[0m15:51:44.296691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:51:44.296691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:51:44.304678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5023043f-04a5-4f7c-8016-b0ecc8c371a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A67A406BD0>]}
[0m15:51:44.317457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5023043f-04a5-4f7c-8016-b0ecc8c371a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A679D76610>]}
[0m15:51:44.317457 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:51:44.318455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5023043f-04a5-4f7c-8016-b0ecc8c371a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A678937F10>]}
[0m15:51:44.319573 [warn ] [MainThread]: The selection criterion 'int_google_analytics_all_purchases*' does not match any nodes
[0m15:51:44.320563 [info ] [MainThread]: 
[0m15:51:44.320563 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:51:44.321480 [debug] [MainThread]: Command end result
[0m15:51:44.331015 [debug] [MainThread]: Command `dbt run` succeeded at 15:51:44.330012 after 0.39 seconds
[0m15:51:44.331015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A679480C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A678382010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A67336FB50>]}
[0m15:51:44.331015 [debug] [MainThread]: Flushing usage events
[0m15:52:00.309685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09C6FD810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09C7C2ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09CD89310>]}


============================== 15:52:00.311704 | 9d67ca8b-5b13-4719-a0fd-4dabefa7b5ec ==============================
[0m15:52:00.311704 [info ] [MainThread]: Running with dbt=1.6.3
[0m15:52:00.312763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BenedictAltgassen\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BenedictAltgassen\\Next Digital Group GmbH\\Next Digital Data - Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh -m int_google_analytics_all_purchases_GA4', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:52:00.511381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d67ca8b-5b13-4719-a0fd-4dabefa7b5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09DC29110>]}
[0m15:52:00.515708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d67ca8b-5b13-4719-a0fd-4dabefa7b5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09C2854D0>]}
[0m15:52:00.516707 [info ] [MainThread]: Registered adapter: bigquery=1.6.5
[0m15:52:00.522707 [debug] [MainThread]: checksum: 800ab10c53db38b54e69cd328777f0c48b6374b8a89466e8ff54aa9acb452b75, vars: {}, profile: , target: , version: 1.6.3
[0m15:52:00.621695 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:52:00.621695 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:52:00.626695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d67ca8b-5b13-4719-a0fd-4dabefa7b5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09E19FA50>]}
[0m15:52:00.638483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d67ca8b-5b13-4719-a0fd-4dabefa7b5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09B7625D0>]}
[0m15:52:00.639530 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:52:00.639530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d67ca8b-5b13-4719-a0fd-4dabefa7b5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09D7C4510>]}
[0m15:52:00.640484 [info ] [MainThread]: 
[0m15:52:00.641483 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:52:00.642531 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m15:52:00.642531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:02.132202 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m15:52:02.133203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:02.134205 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m15:52:02.136204 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m15:52:02.140204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:02.141204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:02.809376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d67ca8b-5b13-4719-a0fd-4dabefa7b5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09D796810>]}
[0m15:52:02.810520 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:52:02.811686 [info ] [MainThread]: 
[0m15:52:02.815693 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:52:02.816693 [info ] [Thread-1 (]: 1 of 1 START sql view model intermediate.int_google_analytics_all_purchases_GA4  [RUN]
[0m15:52:02.817693 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_analytics_all_purchases_GA4'
[0m15:52:02.818692 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:52:02.822721 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m15:52:02.824693 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (compile): 15:52:02.818692 => 15:52:02.823693
[0m15:52:02.825692 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:52:02.843699 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m15:52:02.844204 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:52:02.845210 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_all_purchases_GA4: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_purchases_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle <purchase-events> aus Google Analytics 4. Inkl. aller zugeh\u00f6rigen Metainformationen aus GA4."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_select_purchase_events AS(
  SELECT * FROM _raw
  WHERE event_name = "purchase"
),

_final AS(
    SELECT *
    FROM _select_purchase_events
)

SELECT * FROM _final;


[0m15:52:03.408287 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:bc227416-6ddf-487c-98ba-48522f9728e7&page=queryresults
[0m15:52:03.999013 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (execute): 15:52:02.825692 => 15:52:03.999013
[0m15:52:04.001012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d67ca8b-5b13-4719-a0fd-4dabefa7b5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09E03D910>]}
[0m15:52:04.002999 [info ] [Thread-1 (]: 1 of 1 OK created sql view model intermediate.int_google_analytics_all_purchases_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m15:52:04.004999 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m15:52:04.008363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:04.009356 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m15:52:04.010340 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m15:52:04.011340 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m15:52:04.012339 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m15:52:04.012339 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_purchases_GA4' was properly closed.
[0m15:52:04.013339 [info ] [MainThread]: 
[0m15:52:04.014340 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m15:52:04.015510 [debug] [MainThread]: Command end result
[0m15:52:04.025685 [info ] [MainThread]: 
[0m15:52:04.026683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:52:04.026683 [info ] [MainThread]: 
[0m15:52:04.027684 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:52:04.027684 [debug] [MainThread]: Command `dbt run` succeeded at 15:52:04.027684 after 3.73 seconds
[0m15:52:04.028705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09C284490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09C7C2ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09C6FEED0>]}
[0m15:52:04.028705 [debug] [MainThread]: Flushing usage events
[0m16:10:51.929589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C190EF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C1924150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C1E84F90>]}


============================== 16:10:51.937142 | 7ed1705e-fe23-4a54-b2a4-625fcfdb4bac ==============================
[0m16:10:51.937142 [info ] [MainThread]: Running with dbt=1.6.3
[0m16:10:51.938169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BenedictAltgassen\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BenedictAltgassen\\Next Digital Group GmbH\\Next Digital Data - Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh -m inttermediate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:10:54.190154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ed1705e-fe23-4a54-b2a4-625fcfdb4bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C315D8D0>]}
[0m16:10:54.194154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ed1705e-fe23-4a54-b2a4-625fcfdb4bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C1926090>]}
[0m16:10:54.206263 [info ] [MainThread]: Registered adapter: bigquery=1.6.5
[0m16:10:54.218205 [debug] [MainThread]: checksum: 800ab10c53db38b54e69cd328777f0c48b6374b8a89466e8ff54aa9acb452b75, vars: {}, profile: , target: , version: 1.6.3
[0m16:10:55.534278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:10:55.534278 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\google_analytics\int_google_analytics_all_events.sql
[0m16:10:55.582451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ed1705e-fe23-4a54-b2a4-625fcfdb4bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C2B37C10>]}
[0m16:10:55.607336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ed1705e-fe23-4a54-b2a4-625fcfdb4bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C326FFD0>]}
[0m16:10:55.608333 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m16:10:55.609332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ed1705e-fe23-4a54-b2a4-625fcfdb4bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C3304A50>]}
[0m16:10:55.610332 [warn ] [MainThread]: The selection criterion 'inttermediate' does not match any nodes
[0m16:10:55.612356 [info ] [MainThread]: 
[0m16:10:55.612356 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:10:55.613396 [debug] [MainThread]: Command end result
[0m16:10:55.620400 [debug] [MainThread]: Command `dbt run` succeeded at 16:10:55.620400 after 3.72 seconds
[0m16:10:55.621507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C1398650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C1399390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C139A010>]}
[0m16:10:55.621507 [debug] [MainThread]: Flushing usage events
[0m16:11:01.830459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BF934590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BF4879D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BF499A50>]}


============================== 16:11:01.832460 | 4d3e37f1-992c-48f8-8d24-fbe21643f070 ==============================
[0m16:11:01.832460 [info ] [MainThread]: Running with dbt=1.6.3
[0m16:11:01.833458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BenedictAltgassen\\Next Digital Group GmbH\\Next Digital Data - Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BenedictAltgassen\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh -m intermediate', 'send_anonymous_usage_stats': 'True'}
[0m16:11:02.063877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C0D41110>]}
[0m16:11:02.069789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C0CA9E90>]}
[0m16:11:02.069789 [info ] [MainThread]: Registered adapter: bigquery=1.6.5
[0m16:11:02.075789 [debug] [MainThread]: checksum: 800ab10c53db38b54e69cd328777f0c48b6374b8a89466e8ff54aa9acb452b75, vars: {}, profile: , target: , version: 1.6.3
[0m16:11:02.191469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:02.191469 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:02.196492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BF95D610>]}
[0m16:11:02.208477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C13BAF50>]}
[0m16:11:02.209944 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m16:11:02.209944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C155B690>]}
[0m16:11:02.210949 [info ] [MainThread]: 
[0m16:11:02.211949 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:11:02.213956 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m16:11:02.213956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:03.954415 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m16:11:03.955392 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m16:11:03.956408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:03.957395 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m16:11:03.958394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:03.962391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:04.597545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C14A4A90>]}
[0m16:11:04.597545 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:04.598545 [info ] [MainThread]: 
[0m16:11:04.602545 [debug] [Thread-1 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m16:11:04.602545 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m16:11:04.603546 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m16:11:04.603546 [debug] [Thread-4 (]: Began running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m16:11:04.603546 [info ] [Thread-1 (]: 1 of 12 START sql view model intermediate.int_bing_ads_unique_campaigns ........ [RUN]
[0m16:11:04.604545 [info ] [Thread-2 (]: 2 of 12 START sql view model intermediate.int_google_ads_unique_campaigns ...... [RUN]
[0m16:11:04.604545 [info ] [Thread-3 (]: 3 of 12 START sql view model intermediate.int_google_analytics_all_events ...... [RUN]
[0m16:11:04.605544 [info ] [Thread-4 (]: 4 of 12 START sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [RUN]
[0m16:11:04.605544 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_bing_ads_unique_campaigns'
[0m16:11:04.606546 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_ads_unique_campaigns'
[0m16:11:04.607545 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_analytics_all_events'
[0m16:11:04.607545 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information'
[0m16:11:04.607545 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_bing_ads_unique_campaigns
[0m16:11:04.608545 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m16:11:04.608545 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m16:11:04.609544 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m16:11:04.613545 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m16:11:04.619582 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m16:11:04.622051 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m16:11:04.624056 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m16:11:04.626056 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (compile): 16:11:04.609544 => 16:11:04.625080
[0m16:11:04.626056 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 16:11:04.617544 => 16:11:04.626056
[0m16:11:04.627055 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 16:11:04.620546 => 16:11:04.626056
[0m16:11:04.627055 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_bing_ads_unique_campaigns
[0m16:11:04.627055 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (compile): 16:11:04.623059 => 16:11:04.627055
[0m16:11:04.628056 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m16:11:04.628056 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m16:11:04.649060 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m16:11:04.650057 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m16:11:04.653062 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m16:11:04.655062 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m16:11:04.658062 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m16:11:04.658062 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:11:04.659061 [debug] [Thread-1 (]: On model.bq_evo.int_bing_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Bing Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id,
        MAX(name) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m16:11:04.660061 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:11:04.661061 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:11:04.661061 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:11:04.661061 [debug] [Thread-2 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id ,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m16:11:04.662061 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_add_default_channel_groupings AS(
    SELECT *,
        case
            when (Source = 'direct' or Source is null or Source = '(direct)') 
                and (regexp_contains(Medium, r'^(\(not set\)|\(none\))$') or Medium is null) 
                then 'direct'
            when regexp_contains(Campaign, r'^(.*shop.*)$') 
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'shopping_paid'
            when regexp_contains(Source, r'^(google|bing)$') 
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'search_paid'
            when regexp_contains(Source, r'^(twitter|facebook|fb|instagram|ig|linkedin|pinterest)$')
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*|social_paid)$') 
                then 'social_paid'
            when regexp_contains(Source, r'^(youtube)$')
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'video_paid'
            when regexp_contains(Medium, r'^(display|banner|expandable|interstitial|cpm)$') 
                then 'display'
            when regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'other_paid'
            when regexp_contains(Medium, r'^(.*shop.*)$') 
                then 'shopping_organic'
            when regexp_contains(Source, r'^.*(twitter|t\.co|facebook|instagram|linkedin|lnkd\.in|pinterest).*') 
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'social_paid'
            when regexp_contains(Source, r'^.*(twitter|t\.co|facebook|instagram|linkedin|lnkd\.in|pinterest).*') 
                or regexp_contains(Medium, r'^(social|social_advertising|social-advertising|social_network|social-network|social_media|social-media|sm|social-unpaid|social_unpaid)$') 
                then 'social_organic'
            when regexp_contains(Medium, r'^(.*video.*)$') 
                then 'video_organic'
            when regexp_contains(Source, r'^(google|bing|yahoo|baidu|duckduckgo|yandex|ask)$') 
                or Medium = 'organic'
                then 'search_organic'
            when regexp_contains(Source, r'^(email|mail|e-mail|e_mail|e mail|mail\.google\.com)$') 
                or regexp_contains(Medium, r'^(email|mail|e-mail|e_mail|e mail)$') 
                then 'email'
            when regexp_contains(Medium, r'^(affiliate|affiliates)$') 
                then 'affiliate'
            when Medium = 'referral'
                then 'referral'
            when Medium = 'audio' 
                then 'audio'
            when Medium = 'sms'
                then 'sms'
            when ends_with(Medium, 'push')
                or regexp_contains(Medium, r'.*(mobile|notification).*') 
                then 'mobile_push'
            else '(other)'
        end AS default_channel_grouping
    FROM _rename_columns
),

_final AS(
    SELECT *
    FROM _add_default_channel_groupings
)

SELECT * FROM _final;


[0m16:11:04.662061 [debug] [Thread-4 (]: On model.bq_evo.int_linkedin_unique_campaigns_reduced_information: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Linkedin-Kampagnen - gg\u00fc. Quelldaten nur ausgew\u00e4hlte Spalten f\u00fcr Weiterverarbeitung NDG."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
),

_selected_columns AS (
    SELECT
        id as campaign_id,
        Campaign, 
        "EVO" as Partner, 
        "cpc" as Medium, 
        "linkedin" as Source, 
        LOWER(CONCAT(Campaign, "linkedin", "cpc", "EVO")) AS CampaignID 
    
    FROM _raw
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _selected_columns
)

SELECT * FROM _final;


[0m16:11:05.437540 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:d676d25f-6459-4c71-9b95-91eb707f513e&page=queryresults
[0m16:11:05.449475 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:47feed55-46fd-44a0-975f-0412b83269e1&page=queryresults
[0m16:11:05.456981 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:5670d7b2-7da3-4f17-8137-1fd8e7e46eb8&page=queryresults
[0m16:11:05.681941 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (execute): 16:11:04.656062 => 16:11:05.681941
[0m16:11:05.682896 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C13AE110>]}
[0m16:11:05.682896 [info ] [Thread-4 (]: 4 of 12 OK created sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m16:11:05.683896 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m16:11:05.684895 [debug] [Thread-4 (]: Began running node model.bq_evo.int_meta_unique_campaigns
[0m16:11:05.684895 [info ] [Thread-4 (]: 5 of 12 START sql view model intermediate.int_meta_unique_campaigns ............ [RUN]
[0m16:11:05.686202 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_linkedin_unique_campaigns_reduced_information, now model.bq_evo.int_meta_unique_campaigns)
[0m16:11:05.686202 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_meta_unique_campaigns
[0m16:11:05.688208 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_meta_unique_campaigns"
[0m16:11:05.689207 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_meta_unique_campaigns (compile): 16:11:05.686202 => 16:11:05.688208
[0m16:11:05.689207 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_meta_unique_campaigns
[0m16:11:05.690208 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_meta_unique_campaigns"
[0m16:11:05.692211 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:05.692211 [debug] [Thread-4 (]: On model.bq_evo.int_meta_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_meta_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_information`
),

_distinct_campaigns AS(
    SELECT
        MAX(Campaign) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 5
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m16:11:05.964449 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (execute): 16:11:04.628056 => 16:11:05.964449
[0m16:11:05.964449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C13B9F10>]}
[0m16:11:05.965952 [info ] [Thread-1 (]: 1 of 12 OK created sql view model intermediate.int_bing_ads_unique_campaigns ... [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m16:11:05.966958 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m16:11:05.966958 [debug] [Thread-1 (]: Began running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m16:11:05.966958 [info ] [Thread-1 (]: 6 of 12 START sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [RUN]
[0m16:11:05.967975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_unique_campaigns, now model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names)
[0m16:11:05.968957 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m16:11:05.970977 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m16:11:05.970977 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (compile): 16:11:05.968957 => 16:11:05.970977
[0m16:11:05.971959 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m16:11:05.975957 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m16:11:05.976958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:05.976958 [debug] [Thread-1 (]: On model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.campaign_id = _raw_performance.campaign_id
),

_drop_campaign_id AS(
    SELECT * EXCEPT (campaign_id)
    FROM _joined
),

_final AS(
    SELECT 
        * EXCEPT(Date),
        CAST(Date AS DATE) as Date
    FROM _drop_campaign_id
)

SELECT * FROM _final;


[0m16:11:06.026526 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 16:11:04.653062 => 16:11:06.025516
[0m16:11:06.026526 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C1317490>]}
[0m16:11:06.027500 [info ] [Thread-3 (]: 3 of 12 OK created sql view model intermediate.int_google_analytics_all_events . [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m16:11:06.027500 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m16:11:06.028911 [debug] [Thread-3 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m16:11:06.029924 [info ] [Thread-3 (]: 7 of 12 START sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [RUN]
[0m16:11:06.030922 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_events, now model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names)
[0m16:11:06.030922 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m16:11:06.032979 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m16:11:06.033921 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (compile): 16:11:06.031924 => 16:11:06.033921
[0m16:11:06.034925 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m16:11:06.036925 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m16:11:06.036925 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:06.037924 [debug] [Thread-3 (]: On model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne inkl. Klartext der Kampagne."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m16:11:06.110581 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:1fad71dd-cc42-4e58-9b21-2a34402dcacf&page=queryresults
[0m16:11:06.206581 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:eb43a02b-425c-48dd-ab2c-1b47963ae180&page=queryresults
[0m16:11:06.406037 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_meta_unique_campaigns (execute): 16:11:05.689207 => 16:11:06.405020
[0m16:11:06.409043 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C148C490>]}
[0m16:11:06.412326 [info ] [Thread-4 (]: 5 of 12 OK created sql view model intermediate.int_meta_unique_campaigns ....... [[32mCREATE VIEW (0 processed)[0m in 0.72s]
[0m16:11:06.413337 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_meta_unique_campaigns
[0m16:11:06.414338 [debug] [Thread-4 (]: Began running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m16:11:06.415338 [info ] [Thread-4 (]: 8 of 12 START sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [RUN]
[0m16:11:06.416334 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_meta_unique_campaigns, now model.bq_evo.int_google_analytics_NDG_conversionevents_GA4)
[0m16:11:06.417334 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m16:11:06.419334 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m16:11:06.420334 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (compile): 16:11:06.417334 => 16:11:06.420334
[0m16:11:06.420334 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m16:11:06.422335 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m16:11:06.423333 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:06.423333 [debug] [Thread-4 (]: On model.bq_evo.int_google_analytics_NDG_conversionevents_GA4: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle relevanten Conversionevents aus Google Analytics 4 f\u00fcr NDG-Vermarktung. Inklusive aller E-Commerce-Events (ohne Metainformationen)."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_conversions_NDG as(
  SELECT 
    event_date as Date,
    event_name as ZielvorhabenName, 
    CampaignID,
    Source,
    Medium,

    MAX(Partner) as Partner,

    count(event_date) as Conversions,

  FROM _raw
  WHERE (
    event_name = 'lead_form_evo_solar_lp' OR
    event_name = 'evo_solar_pva_check_sent_available' OR
    event_name = 'contact_form_button' OR
    event_name = 'click_online_application' OR
    event_name = 'oss_registration_doi' OR
    event_name = 'click_tarifrechnernutzung' OR
    event_name = 'conversion_solarrechner' OR
    event_name = 'purchase'
  )

  GROUP BY 1,2,3,4,5
),

_added_columns AS(
  SELECT 
      Date,
      ZielvorhabenName,
      LOWER(CONCAT(ZielvorhabenName, Partner)) as ZielvorhabenID,
      CampaignID,
      Source,
      Medium,
      Partner,
      '(not set)' as Keyword,
      '(not set)' as KeywordMatchType,
      Conversions
  FROM _conversions_NDG
),

_final AS(
  SELECT *
  FROM _added_columns
)

SELECT * FROM _final;


[0m16:11:06.576179 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7d57f9d2-1b9d-47b2-8998-d2cf353f45b1&page=queryresults
[0m16:11:06.586178 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:b58f1d97-97a0-4de5-93ce-8dec82d0f6fd&page=queryresults
[0m16:11:06.640090 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 16:11:04.650057 => 16:11:06.640090
[0m16:11:06.641117 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C1396E90>]}
[0m16:11:06.641117 [info ] [Thread-2 (]: 2 of 12 OK created sql view model intermediate.int_google_ads_unique_campaigns . [[32mCREATE VIEW (0 processed)[0m in 2.03s]
[0m16:11:06.642480 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m16:11:06.642480 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_analytics_all_campaigns
[0m16:11:06.643484 [info ] [Thread-2 (]: 9 of 12 START sql view model intermediate.int_google_analytics_all_campaigns ... [RUN]
[0m16:11:06.644485 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_unique_campaigns, now model.bq_evo.int_google_analytics_all_campaigns)
[0m16:11:06.644485 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_analytics_all_campaigns
[0m16:11:06.646485 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m16:11:06.647485 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (compile): 16:11:06.644485 => 16:11:06.647485
[0m16:11:06.648485 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_analytics_all_campaigns
[0m16:11:06.649486 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m16:11:06.650485 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:06.650485 [debug] [Thread-2 (]: On model.bq_evo.int_google_analytics_all_campaigns: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagnen aus GA4 und GA3."""
    )
  as WITH _historic_ua_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
),

ga4_campaigns AS(
    SELECT 
        MAX(Campaign),
        MAX(Partner),
        MAX(Source),
        MAX(Medium),
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
    GROUP BY 5
),

_final AS(
    SELECT * FROM _historic_ua_campaigns
    UNION DISTINCT
    SELECT * FROM ga4_campaigns
)

SELECT * FROM _final;


[0m16:11:06.732553 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (execute): 16:11:05.971959 => 16:11:06.732553
[0m16:11:06.732553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C189E150>]}
[0m16:11:06.733553 [info ] [Thread-1 (]: 6 of 12 OK created sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m16:11:06.734552 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m16:11:06.734552 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m16:11:06.734552 [info ] [Thread-1 (]: 10 of 12 START sql view model intermediate.int_google_analytics_all_purchases_GA4  [RUN]
[0m16:11:06.735551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names, now model.bq_evo.int_google_analytics_all_purchases_GA4)
[0m16:11:06.736551 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m16:11:06.737584 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m16:11:06.738571 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (compile): 16:11:06.736551 => 16:11:06.738571
[0m16:11:06.739553 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m16:11:06.740552 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m16:11:06.741552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:06.741552 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_all_purchases_GA4: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_purchases_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle <purchase-events> aus Google Analytics 4. Inkl. aller zugeh\u00f6rigen Metainformationen aus GA4."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_select_purchase_events AS(
  SELECT * FROM _raw
  WHERE event_name = "purchase"
),

_final AS(
    SELECT *
    FROM _select_purchase_events
)

SELECT * FROM _final;


[0m16:11:07.223096 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2eab6cb0-2ef2-4962-aa77-59b662d478d7&page=queryresults
[0m16:11:07.246679 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:819fdb67-136d-4f2a-b225-06a530f22002&page=queryresults
[0m16:11:07.300799 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (execute): 16:11:06.034925 => 16:11:07.299805
[0m16:11:07.302799 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C13AFED0>]}
[0m16:11:07.303783 [info ] [Thread-3 (]: 7 of 12 OK created sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m16:11:07.305783 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m16:11:07.306806 [debug] [Thread-3 (]: Began running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m16:11:07.306806 [info ] [Thread-3 (]: 11 of 12 START sql view model intermediate.int_meta_campaign_stats_joined_campaign_names  [RUN]
[0m16:11:07.308784 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names, now model.bq_evo.int_meta_campaign_stats_joined_campaign_names)
[0m16:11:07.309782 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m16:11:07.312753 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"
[0m16:11:07.313759 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_meta_campaign_stats_joined_campaign_names (compile): 16:11:07.309782 => 16:11:07.312753
[0m16:11:07.313759 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m16:11:07.317759 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"
[0m16:11:07.318759 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:07.318759 [debug] [Thread-3 (]: On model.bq_evo.int_meta_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
),

_rename_join_column AS(
    SELECT 
        * EXCEPT (Campaign),
        Campaign as CampaignJoin
    FROM _raw_unique_campaigns
),

_joined AS(
    SELECT * FROM _rename_join_column
    INNER JOIN _raw_performance
    ON _rename_join_column.CampaignJoin = _raw_performance.Campaign
),

_final AS(
    SELECT * EXCEPT (CampaignJoin)
    FROM _joined
)

SELECT * FROM _final;


[0m16:11:07.627765 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:95cd477a-6d8e-48e4-a43a-89ae2276dc0c&page=queryresults
[0m16:11:07.911375 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (execute): 16:11:06.648485 => 16:11:07.910383
[0m16:11:07.914364 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C1803F50>]}
[0m16:11:07.916807 [info ] [Thread-2 (]: 9 of 12 OK created sql view model intermediate.int_google_analytics_all_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m16:11:07.918338 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_analytics_all_campaigns
[0m16:11:07.919338 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m16:11:07.920337 [info ] [Thread-2 (]: 12 of 12 START sql view model intermediate.int_google_ads_campaign_stats ....... [RUN]
[0m16:11:07.921337 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_campaigns, now model.bq_evo.int_google_ads_campaign_stats)
[0m16:11:07.922335 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m16:11:07.926369 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m16:11:07.928333 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 16:11:07.923333 => 16:11:07.927333
[0m16:11:07.928333 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m16:11:07.930332 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m16:11:07.931355 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:07.932331 [debug] [Thread-2 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
),

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m16:11:07.986491 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (execute): 16:11:06.739553 => 16:11:07.986491
[0m16:11:07.987511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C190D550>]}
[0m16:11:07.987511 [info ] [Thread-1 (]: 10 of 12 OK created sql view model intermediate.int_google_analytics_all_purchases_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m16:11:07.988492 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m16:11:08.091626 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (execute): 16:11:06.421334 => 16:11:08.090622
[0m16:11:08.091626 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C15F8990>]}
[0m16:11:08.092622 [info ] [Thread-4 (]: 8 of 12 OK created sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.68s]
[0m16:11:08.093623 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m16:11:08.514604 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:59126f88-777f-40df-aeb0-e8a53773d413&page=queryresults
[0m16:11:08.687499 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_meta_campaign_stats_joined_campaign_names (execute): 16:11:07.313759 => 16:11:08.686498
[0m16:11:08.688499 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C183D050>]}
[0m16:11:08.690773 [info ] [Thread-3 (]: 11 of 12 OK created sql view model intermediate.int_meta_campaign_stats_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m16:11:08.691101 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m16:11:09.092697 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:b9990ad0-a8bd-4777-b241-07763070c379&page=queryresults
[0m16:11:09.567025 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 16:11:07.928333 => 16:11:09.567025
[0m16:11:09.569537 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e37f1-992c-48f8-8d24-fbe21643f070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BF935C10>]}
[0m16:11:09.570550 [info ] [Thread-2 (]: 12 of 12 OK created sql view model intermediate.int_google_ads_campaign_stats .. [[32mCREATE VIEW (0 processed)[0m in 1.65s]
[0m16:11:09.573096 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m16:11:09.576777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:09.577797 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m16:11:09.577797 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m16:11:09.578970 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m16:11:09.579978 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m16:11:09.579978 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_all_purchases_GA4' was properly closed.
[0m16:11:09.580981 [debug] [MainThread]: Connection 'model.bq_evo.int_google_ads_campaign_stats' was properly closed.
[0m16:11:09.580981 [debug] [MainThread]: Connection 'model.bq_evo.int_meta_campaign_stats_joined_campaign_names' was properly closed.
[0m16:11:09.581977 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_NDG_conversionevents_GA4' was properly closed.
[0m16:11:09.581977 [info ] [MainThread]: 
[0m16:11:09.582978 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 7.37 seconds (7.37s).
[0m16:11:09.584977 [debug] [MainThread]: Command end result
[0m16:11:09.595976 [info ] [MainThread]: 
[0m16:11:09.596975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:09.596975 [info ] [MainThread]: 
[0m16:11:09.596975 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m16:11:09.597976 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:09.597976 after 7.78 seconds
[0m16:11:09.597976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BFFA8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BFFA0BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297BA281E50>]}
[0m16:11:09.598976 [debug] [MainThread]: Flushing usage events
[0m17:17:41.661784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E78847D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E6E9AC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E7207A90>]}


============================== 17:17:41.669535 | 8923ba88-b3a6-4512-a392-95d5cbe737a6 ==============================
[0m17:17:41.669535 [info ] [MainThread]: Running with dbt=1.6.3
[0m17:17:41.670504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BenedictAltgassen\\Next Digital Group GmbH\\Next Digital Data - Projekte (DMS)\\00_Intern\\11_GithubDBT\\bq_evo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BenedictAltgassen\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh -m intermediate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:17:44.454816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8B5CAD0>]}
[0m17:17:44.459386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E6D70350>]}
[0m17:17:44.464652 [info ] [MainThread]: Registered adapter: bigquery=1.6.5
[0m17:17:44.480970 [debug] [MainThread]: checksum: 800ab10c53db38b54e69cd328777f0c48b6374b8a89466e8ff54aa9acb452b75, vars: {}, profile: , target: , version: 1.6.3
[0m17:17:46.035194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:46.036203 [debug] [MainThread]: Partial parsing: updated file: bq_evo://models\intermediate\google_analytics\int_google_analytics_all_events.sql
[0m17:17:46.088034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8D03C10>]}
[0m17:17:46.108033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8BF2810>]}
[0m17:17:46.108033 [info ] [MainThread]: Found 32 models, 20 tests, 12 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:17:46.109030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8D042D0>]}
[0m17:17:46.111030 [info ] [MainThread]: 
[0m17:17:46.112030 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:17:46.113031 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod'
[0m17:17:46.114031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:47.875528 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_staging'
[0m17:17:47.876528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:47.878516 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_intermediate'
[0m17:17:47.879528 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_oss-big-query-dashboard-prod_mart'
[0m17:17:47.882529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:47.883528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:48.452044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8534650>]}
[0m17:17:48.453160 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:17:48.453765 [info ] [MainThread]: 
[0m17:17:48.456881 [debug] [Thread-1 (]: Began running node model.bq_evo.int_bing_ads_unique_campaigns
[0m17:17:48.456881 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_ads_unique_campaigns
[0m17:17:48.457771 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_analytics_all_events
[0m17:17:48.457771 [debug] [Thread-4 (]: Began running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m17:17:48.457771 [info ] [Thread-1 (]: 1 of 12 START sql view model intermediate.int_bing_ads_unique_campaigns ........ [RUN]
[0m17:17:48.461810 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.bq_evo.int_bing_ads_unique_campaigns'
[0m17:17:48.461810 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_bing_ads_unique_campaigns
[0m17:17:48.458770 [info ] [Thread-2 (]: 2 of 12 START sql view model intermediate.int_google_ads_unique_campaigns ...... [RUN]
[0m17:17:48.460070 [info ] [Thread-3 (]: 3 of 12 START sql view model intermediate.int_google_analytics_all_events ...... [RUN]
[0m17:17:48.460574 [info ] [Thread-4 (]: 4 of 12 START sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [RUN]
[0m17:17:48.468844 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.bq_evo.int_linkedin_unique_campaigns_reduced_information'
[0m17:17:48.469850 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m17:17:48.468844 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_analytics_all_events'
[0m17:17:48.466836 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m17:17:48.467845 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.bq_evo.int_google_ads_unique_campaigns'
[0m17:17:48.473283 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_ads_unique_campaigns
[0m17:17:48.472262 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_analytics_all_events
[0m17:17:48.472262 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m17:17:48.474778 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m17:17:48.476790 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_events"
[0m17:17:48.476790 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (compile): 17:17:48.462318 => 17:17:48.476790
[0m17:17:48.477789 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (compile): 17:17:48.469850 => 17:17:48.477789
[0m17:17:48.477789 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (compile): 17:17:48.473283 => 17:17:48.477789
[0m17:17:48.479025 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (compile): 17:17:48.474778 => 17:17:48.479025
[0m17:17:48.479025 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_bing_ads_unique_campaigns
[0m17:17:48.479601 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m17:17:48.480107 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_ads_unique_campaigns
[0m17:17:48.480107 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_analytics_all_events
[0m17:17:48.498181 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_unique_campaigns"
[0m17:17:48.501156 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"
[0m17:17:48.502156 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_unique_campaigns"
[0m17:17:48.504158 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_events"
[0m17:17:48.506155 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:17:48.506155 [debug] [Thread-4 (]: On model.bq_evo.int_linkedin_unique_campaigns_reduced_information: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_unique_campaigns_reduced_information"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
  OPTIONS(
      description="""Enth\u00e4lt alle Linkedin-Kampagnen - gg\u00fc. Quelldaten nur ausgew\u00e4hlte Spalten f\u00fcr Weiterverarbeitung NDG."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_campaign_history`
),

_selected_columns AS (
    SELECT
        id as campaign_id,
        Campaign, 
        "EVO" as Partner, 
        "cpc" as Medium, 
        "linkedin" as Source, 
        LOWER(CONCAT(Campaign, "linkedin", "cpc", "EVO")) AS CampaignID 
    
    FROM _raw
),

_final AS(
    SELECT 
        DISTINCT *
    FROM _selected_columns
)

SELECT * FROM _final;


[0m17:17:48.506155 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:17:48.506155 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:17:48.507155 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:17:48.508155 [debug] [Thread-1 (]: On model.bq_evo.int_bing_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Bing Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id,
        MAX(name) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m17:17:48.509156 [debug] [Thread-2 (]: On model.bq_evo.int_google_ads_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt gruppierte Google Ads Kampagnen ohne historische Informationen. Dient als einfache Datenbank der wichtigsten Metainfos der Kampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_history`
),

_distinct_campaigns AS(
    SELECT
        MAX(id) as id ,
        MAX(campaign) as campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 6
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m17:17:48.509156 [debug] [Thread-3 (]: On model.bq_evo.int_google_analytics_all_events: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_events"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
  OPTIONS(
      description="""Enth\u00e4lt alle Events und NDG-Kampagnenschl\u00fcssel."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_352128287`
),

_added_partner AS(
    SELECT 
        *,
        'EVO' as Partner
    FROM _raw
),

_rename_columns AS(
    SELECT
        * EXCEPT(utm_campaign, utm_source, utm_medium),
        utm_campaign as Campaign,
        utm_source as Source,
        utm_medium as Medium,
        LOWER (CONCAT(utm_campaign, utm_source, utm_medium, Partner)) as CampaignID
    FROM _added_partner
),

_add_default_channel_groupings AS(
    SELECT *,
        case
            when (Source = 'direct' or Source is null or Source = '(direct)') 
                and (regexp_contains(Medium, r'^(\(not set\)|\(none\))$') or Medium is null) 
                then 'direct'
            when regexp_contains(Campaign, r'^(.*pmax.*|.*cross-network.*)$') 
                then 'cross-network'
            when regexp_contains(Campaign, r'^(.*shop.*)$') 
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'shopping_paid'
            when regexp_contains(Source, r'^(google|bing)$') 
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'search_paid'
            when regexp_contains(Source, r'^(twitter|facebook|fb|instagram|ig|linkedin|pinterest)$')
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*|social_paid)$') 
                then 'social_paid'
            when regexp_contains(Source, r'^(youtube)$')
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'video_paid'
            when regexp_contains(Medium, r'^(display|banner|expandable|interstitial|cpm)$') 
                then 'display'
            when regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'other_paid'
            when regexp_contains(Medium, r'^(.*shop.*)$') 
                then 'shopping_organic'
            when regexp_contains(Source, r'^.*(twitter|t\.co|facebook|instagram|linkedin|lnkd\.in|pinterest).*') 
                and regexp_contains(Medium, r'^(.*cp.*|ppc|paid.*)$') 
                then 'social_paid'
            when regexp_contains(Source, r'^.*(twitter|t\.co|facebook|instagram|linkedin|lnkd\.in|pinterest).*') 
                or regexp_contains(Medium, r'^(social|social_advertising|social-advertising|social_network|social-network|social_media|social-media|sm|social-unpaid|social_unpaid)$') 
                then 'social_organic'
            when regexp_contains(Medium, r'^(.*video.*)$') 
                then 'video_organic'
            when regexp_contains(Source, r'^(google|bing|yahoo|baidu|duckduckgo|yandex|ask)$') 
                or Medium = 'organic'
                then 'search_organic'
            when regexp_contains(Source, r'^(email|mail|e-mail|e_mail|e mail|mail\.google\.com)$') 
                or regexp_contains(Medium, r'^(email|mail|e-mail|e_mail|e mail)$') 
                then 'email'
            when regexp_contains(Medium, r'^(affiliate|affiliates)$') 
                then 'affiliate'
            when Medium = 'referral'
                then 'referral'
            when Medium = 'audio' 
                then 'audio'
            when Medium = 'sms'
                then 'sms'
            when ends_with(Medium, 'push')
                or regexp_contains(Medium, r'.*(mobile|notification).*') 
                then 'mobile_push'
            else '(other)'
        end AS default_channel_grouping
    FROM _rename_columns
),

_final AS(
    SELECT *
    FROM _add_default_channel_groupings
)

SELECT * FROM _final;


[0m17:17:49.277783 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:73fa86bc-72a3-4d88-9408-1ec8f7ac4087&page=queryresults
[0m17:17:49.278789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:c94c10fa-6012-469a-bdc0-e11f670114f5&page=queryresults
[0m17:17:49.279735 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:ec2d6086-28c0-45a9-a837-c50cc52ea8f2&page=queryresults
[0m17:17:49.280788 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2760098b-cb85-474d-a023-182a29defbd1&page=queryresults
[0m17:17:49.497238 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_linkedin_unique_campaigns_reduced_information (execute): 17:17:48.499175 => 17:17:49.497238
[0m17:17:49.499208 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8E53550>]}
[0m17:17:49.500209 [info ] [Thread-4 (]: 4 of 12 OK created sql view model intermediate.int_linkedin_unique_campaigns_reduced_information  [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m17:17:49.501208 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_linkedin_unique_campaigns_reduced_information
[0m17:17:49.501208 [debug] [Thread-4 (]: Began running node model.bq_evo.int_meta_unique_campaigns
[0m17:17:49.502207 [info ] [Thread-4 (]: 5 of 12 START sql view model intermediate.int_meta_unique_campaigns ............ [RUN]
[0m17:17:49.502207 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_linkedin_unique_campaigns_reduced_information, now model.bq_evo.int_meta_unique_campaigns)
[0m17:17:49.503207 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_meta_unique_campaigns
[0m17:17:49.506227 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_meta_unique_campaigns"
[0m17:17:49.507211 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_meta_unique_campaigns (compile): 17:17:49.503207 => 17:17:49.507211
[0m17:17:49.507211 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_meta_unique_campaigns
[0m17:17:49.509212 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_meta_unique_campaigns"
[0m17:17:49.510207 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:17:49.510207 [debug] [Thread-4 (]: On model.bq_evo.int_meta_unique_campaigns: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_meta_unique_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Metakampagnen."""
    )
  as WITH _raw AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_information`
),

_distinct_campaigns AS(
    SELECT
        MAX(Campaign) as Campaign,
        MAX(Source) as Source,
        MAX(Medium) as Medium,
        MAX(Partner) as Partner,
        CampaignID
    FROM _raw
    GROUP BY 5
),

_final AS(
    SELECT * 
    FROM _distinct_campaigns
)

SELECT * FROM _final;


[0m17:17:49.819634 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_analytics_all_events (execute): 17:17:48.503157 => 17:17:49.819634
[0m17:17:49.822630 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8B5E650>]}
[0m17:17:49.823628 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_ads_unique_campaigns (execute): 17:17:48.501156 => 17:17:49.823628
[0m17:17:49.826628 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8C7F910>]}
[0m17:17:49.825630 [info ] [Thread-3 (]: 3 of 12 OK created sql view model intermediate.int_google_analytics_all_events . [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m17:17:49.827628 [info ] [Thread-2 (]: 2 of 12 OK created sql view model intermediate.int_google_ads_unique_campaigns . [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m17:17:49.828673 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_analytics_all_events
[0m17:17:49.828673 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_ads_unique_campaigns
[0m17:17:49.829627 [debug] [Thread-3 (]: Began running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m17:17:49.830625 [debug] [Thread-2 (]: Began running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m17:17:49.830625 [info ] [Thread-3 (]: 6 of 12 START sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [RUN]
[0m17:17:49.831858 [info ] [Thread-2 (]: 7 of 12 START sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [RUN]
[0m17:17:49.831858 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_events, now model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names)
[0m17:17:49.833362 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_ads_unique_campaigns, now model.bq_evo.int_google_analytics_NDG_conversionevents_GA4)
[0m17:17:49.833362 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m17:17:49.833362 [debug] [Thread-2 (]: Began compiling node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m17:17:49.835367 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m17:17:49.837368 [debug] [Thread-2 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m17:17:49.839368 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (compile): 17:17:49.834367 => 17:17:49.838379
[0m17:17:49.839368 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (compile): 17:17:49.836367 => 17:17:49.839368
[0m17:17:49.839368 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m17:17:49.839368 [debug] [Thread-2 (]: Began executing node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m17:17:49.841392 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"
[0m17:17:49.843368 [debug] [Thread-2 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"
[0m17:17:49.844367 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:17:49.844367 [debug] [Thread-3 (]: On model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_linkedin_ad_analytics_by_campaign`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_linkedin_unique_campaigns_reduced_information`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.campaign_id = _raw_performance.campaign_id
),

_drop_campaign_id AS(
    SELECT * EXCEPT (campaign_id)
    FROM _joined
),

_final AS(
    SELECT 
        * EXCEPT(Date),
        CAST(Date AS DATE) as Date
    FROM _drop_campaign_id
)

SELECT * FROM _final;


[0m17:17:49.844367 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:17:49.846367 [debug] [Thread-2 (]: On model.bq_evo.int_google_analytics_NDG_conversionevents_GA4: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_NDG_conversionevents_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_NDG_conversionevents_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle relevanten Conversionevents aus Google Analytics 4 f\u00fcr NDG-Vermarktung. Inklusive aller E-Commerce-Events (ohne Metainformationen)."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_conversions_NDG as(
  SELECT 
    event_date as Date,
    event_name as ZielvorhabenName, 
    CampaignID,
    Source,
    Medium,

    MAX(Partner) as Partner,

    count(event_date) as Conversions,

  FROM _raw
  WHERE (
    event_name = 'lead_form_evo_solar_lp' OR
    event_name = 'evo_solar_pva_check_sent_available' OR
    event_name = 'contact_form_button' OR
    event_name = 'click_online_application' OR
    event_name = 'oss_registration_doi' OR
    event_name = 'click_tarifrechnernutzung' OR
    event_name = 'conversion_solarrechner' OR
    event_name = 'purchase'
  )

  GROUP BY 1,2,3,4,5
),

_added_columns AS(
  SELECT 
      Date,
      ZielvorhabenName,
      LOWER(CONCAT(ZielvorhabenName, Partner)) as ZielvorhabenID,
      CampaignID,
      Source,
      Medium,
      Partner,
      '(not set)' as Keyword,
      '(not set)' as KeywordMatchType,
      Conversions
  FROM _conversions_NDG
),

_final AS(
  SELECT *
  FROM _added_columns
)

SELECT * FROM _final;


[0m17:17:49.872376 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_unique_campaigns (execute): 17:17:48.480107 => 17:17:49.872376
[0m17:17:49.873394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8C0E690>]}
[0m17:17:49.874393 [info ] [Thread-1 (]: 1 of 12 OK created sql view model intermediate.int_bing_ads_unique_campaigns ... [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m17:17:49.875395 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_bing_ads_unique_campaigns
[0m17:17:49.875395 [debug] [Thread-1 (]: Began running node model.bq_evo.int_google_analytics_all_campaigns
[0m17:17:49.876398 [info ] [Thread-1 (]: 8 of 12 START sql view model intermediate.int_google_analytics_all_campaigns ... [RUN]
[0m17:17:49.877377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_bing_ads_unique_campaigns, now model.bq_evo.int_google_analytics_all_campaigns)
[0m17:17:49.877377 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_google_analytics_all_campaigns
[0m17:17:49.880399 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m17:17:49.881374 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (compile): 17:17:49.878375 => 17:17:49.881374
[0m17:17:49.882376 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_google_analytics_all_campaigns
[0m17:17:49.883786 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_campaigns"
[0m17:17:49.884811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:49.885790 [debug] [Thread-1 (]: On model.bq_evo.int_google_analytics_all_campaigns: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_campaigns"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_campaigns`
  OPTIONS(
      description="""Enth\u00e4lt alle Kampagnen aus GA4 und GA3."""
    )
  as WITH _historic_ua_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_analytics_historic_campaigns`
),

ga4_campaigns AS(
    SELECT 
        MAX(Campaign),
        MAX(Partner),
        MAX(Source),
        MAX(Medium),
        CampaignID
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
    GROUP BY 5
),

_final AS(
    SELECT * FROM _historic_ua_campaigns
    UNION DISTINCT
    SELECT * FROM ga4_campaigns
)

SELECT * FROM _final;


[0m17:17:50.004511 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:e92bd204-8215-4a72-9b8a-dd3090afbc4f&page=queryresults
[0m17:17:50.211737 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_meta_unique_campaigns (execute): 17:17:49.507211 => 17:17:50.210719
[0m17:17:50.212718 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8B1CE50>]}
[0m17:17:50.212718 [info ] [Thread-4 (]: 5 of 12 OK created sql view model intermediate.int_meta_unique_campaigns ....... [[32mCREATE VIEW (0 processed)[0m in 0.71s]
[0m17:17:50.213717 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_meta_unique_campaigns
[0m17:17:50.214423 [debug] [Thread-4 (]: Began running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m17:17:50.214423 [info ] [Thread-4 (]: 9 of 12 START sql view model intermediate.int_google_analytics_all_purchases_GA4  [RUN]
[0m17:17:50.215458 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_meta_unique_campaigns, now model.bq_evo.int_google_analytics_all_purchases_GA4)
[0m17:17:50.216459 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m17:17:50.217480 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m17:17:50.218478 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (compile): 17:17:50.216459 => 17:17:50.218478
[0m17:17:50.218478 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m17:17:50.220444 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_google_analytics_all_purchases_GA4"
[0m17:17:50.221477 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:17:50.222457 [debug] [Thread-4 (]: On model.bq_evo.int_google_analytics_all_purchases_GA4: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_analytics_all_purchases_GA4"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_purchases_GA4`
  OPTIONS(
      description="""Enth\u00e4lt alle <purchase-events> aus Google Analytics 4. Inkl. aller zugeh\u00f6rigen Metainformationen aus GA4."""
    )
  as WITH _raw AS(
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_analytics_all_events`
),

_select_purchase_events AS(
  SELECT * FROM _raw
  WHERE event_name = "purchase"
),

_final AS(
    SELECT *
    FROM _select_purchase_events
)

SELECT * FROM _final;


[0m17:17:50.520914 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:2748d0ff-9a51-4d9f-b01f-2e98dba973e6&page=queryresults
[0m17:17:50.574598 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:6b6c16a3-8d0b-4f9d-97f9-eb9b92ed8dda&page=queryresults
[0m17:17:50.757856 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:8ea59573-2978-4821-a816-3f2488b02226&page=queryresults
[0m17:17:50.777549 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:998bfce0-4dd8-4a1e-b141-f10cbc918649&page=queryresults
[0m17:17:50.987138 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names (execute): 17:17:49.840367 => 17:17:50.987138
[0m17:17:50.990139 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8F76210>]}
[0m17:17:50.992138 [info ] [Thread-3 (]: 6 of 12 OK created sql view model intermediate.int_linkedin_campaign_stats_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m17:17:50.993139 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names
[0m17:17:50.994139 [debug] [Thread-3 (]: Began running node model.bq_evo.int_google_ads_campaign_stats
[0m17:17:50.995139 [info ] [Thread-3 (]: 10 of 12 START sql view model intermediate.int_google_ads_campaign_stats ....... [RUN]
[0m17:17:50.997569 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_linkedin_campaign_stats_joined_campaign_names, now model.bq_evo.int_google_ads_campaign_stats)
[0m17:17:50.997569 [debug] [Thread-3 (]: Began compiling node model.bq_evo.int_google_ads_campaign_stats
[0m17:17:51.001564 [debug] [Thread-3 (]: Writing injected SQL for node "model.bq_evo.int_google_ads_campaign_stats"
[0m17:17:51.002565 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (compile): 17:17:50.998565 => 17:17:51.002565
[0m17:17:51.003564 [debug] [Thread-3 (]: Began executing node model.bq_evo.int_google_ads_campaign_stats
[0m17:17:51.005564 [debug] [Thread-3 (]: Writing runtime sql for node "model.bq_evo.int_google_ads_campaign_stats"
[0m17:17:51.005564 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:17:51.006564 [debug] [Thread-3 (]: On model.bq_evo.int_google_ads_campaign_stats: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_google_ads_campaign_stats"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_campaign_stats`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne."""
    )
  as WITH _raw_stats AS (
  SELECT *
  FROM `oss-big-query-dashboard-prod`.`staging`.`stg_google_ads_campaign_stats`
),

_select_stats_columns AS(
  SELECT
      date,
      
      --Dimensionen
      id,
      ad_network_type,
      device,

      --Basismetriken
      impressions,
      clicks,
      cost,
      conversions,

      --Erweiterte Metriken
      conversions_value,
      interactions,
      view_through_conversions,
      active_view_impressions,
      active_view_measurability,
      active_view_measurable_cost_micros,
      active_view_measurable_impressions,
      active_view_viewability
  FROM _raw_stats
),

_unique_campaigns AS(
  SELECT 
    id as c_id,
    campaign as Campaign,
    Source,
    Medium,
    Partner,
    CampaignID
  FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_google_ads_unique_campaigns`
),

_final AS(
  SELECT *
  FROM _raw_stats
  LEFT OUTER JOIN _unique_campaigns ON _raw_stats.id = _unique_campaigns.c_id 
)

SELECT * FROM _final;


[0m17:17:51.091689 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_google_analytics_all_campaigns (execute): 17:17:49.882376 => 17:17:51.091689
[0m17:17:51.091689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8E00550>]}
[0m17:17:51.092688 [info ] [Thread-1 (]: 8 of 12 OK created sql view model intermediate.int_google_analytics_all_campaigns  [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m17:17:51.093670 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_google_analytics_all_campaigns
[0m17:17:51.093670 [debug] [Thread-1 (]: Began running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m17:17:51.093670 [info ] [Thread-1 (]: 11 of 12 START sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [RUN]
[0m17:17:51.094669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_campaigns, now model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names)
[0m17:17:51.094669 [debug] [Thread-1 (]: Began compiling node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m17:17:51.097668 [debug] [Thread-1 (]: Writing injected SQL for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m17:17:51.098667 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (compile): 17:17:51.095702 => 17:17:51.098667
[0m17:17:51.098667 [debug] [Thread-1 (]: Began executing node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m17:17:51.100699 [debug] [Thread-1 (]: Writing runtime sql for node "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"
[0m17:17:51.101669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:51.101669 [debug] [Thread-1 (]: On model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_campaign_performance_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt eine \u00dcbersicht aller Performanceinfos jeder Kampagne inkl. Klartext der Kampagne."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_bing_ads_campaign_performance_daily_report`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_bing_ads_unique_campaigns`
),

_joined AS(
    SELECT * FROM _raw_unique_campaigns
    INNER JOIN _raw_performance
    ON _raw_unique_campaigns.id = _raw_performance.campaign_id
),

_final AS(
    SELECT *
    FROM _joined
)

SELECT * FROM _final;


[0m17:17:51.238841 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_google_analytics_all_purchases_GA4 (execute): 17:17:50.219914 => 17:17:51.238841
[0m17:17:51.239841 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E810DB50>]}
[0m17:17:51.239841 [info ] [Thread-4 (]: 9 of 12 OK created sql view model intermediate.int_google_analytics_all_purchases_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m17:17:51.240841 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_google_analytics_all_purchases_GA4
[0m17:17:51.240841 [debug] [Thread-4 (]: Began running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m17:17:51.241843 [info ] [Thread-4 (]: 12 of 12 START sql view model intermediate.int_meta_campaign_stats_joined_campaign_names  [RUN]
[0m17:17:51.241843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bq_evo.int_google_analytics_all_purchases_GA4, now model.bq_evo.int_meta_campaign_stats_joined_campaign_names)
[0m17:17:51.242842 [debug] [Thread-4 (]: Began compiling node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m17:17:51.244843 [debug] [Thread-4 (]: Writing injected SQL for node "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"
[0m17:17:51.245843 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_meta_campaign_stats_joined_campaign_names (compile): 17:17:51.242842 => 17:17:51.245843
[0m17:17:51.246582 [debug] [Thread-4 (]: Began executing node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m17:17:51.248601 [debug] [Thread-4 (]: Writing runtime sql for node "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"
[0m17:17:51.249602 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:17:51.249602 [debug] [Thread-4 (]: On model.bq_evo.int_meta_campaign_stats_joined_campaign_names: /* {"app": "dbt", "dbt_version": "1.6.3", "profile_name": "bq_evo", "target_name": "dev", "node_id": "model.bq_evo.int_meta_campaign_stats_joined_campaign_names"} */


  create or replace view `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_campaign_stats_joined_campaign_names`
  OPTIONS(
      description="""Enth\u00e4lt Performanceinformationen aller Metakampagnen."""
    )
  as WITH _raw_performance AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`staging`.`stg_meta_campaign_stats`
),

_raw_unique_campaigns AS(
    SELECT *
    FROM `oss-big-query-dashboard-prod`.`intermediate`.`int_meta_unique_campaigns`
),

_rename_join_column AS(
    SELECT 
        * EXCEPT (Campaign),
        Campaign as CampaignJoin
    FROM _raw_unique_campaigns
),

_joined AS(
    SELECT * FROM _rename_join_column
    INNER JOIN _raw_performance
    ON _rename_join_column.CampaignJoin = _raw_performance.Campaign
),

_final AS(
    SELECT * EXCEPT (CampaignJoin)
    FROM _joined
)

SELECT * FROM _final;


[0m17:17:51.275600 [debug] [Thread-2 (]: Timing info for model.bq_evo.int_google_analytics_NDG_conversionevents_GA4 (execute): 17:17:49.842367 => 17:17:51.275600
[0m17:17:51.276601 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8E1B910>]}
[0m17:17:51.276601 [info ] [Thread-2 (]: 7 of 12 OK created sql view model intermediate.int_google_analytics_NDG_conversionevents_GA4  [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m17:17:51.277604 [debug] [Thread-2 (]: Finished running node model.bq_evo.int_google_analytics_NDG_conversionevents_GA4
[0m17:17:51.684900 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:fa503199-2183-4c0e-8a96-feeca45811b7&page=queryresults
[0m17:17:51.782062 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:bea1e7bc-c1e1-4642-b8d5-24b0bbde4a28&page=queryresults
[0m17:17:52.175878 [debug] [Thread-4 (]: Timing info for model.bq_evo.int_meta_campaign_stats_joined_campaign_names (execute): 17:17:51.246582 => 17:17:52.174876
[0m17:17:52.175878 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8E61910>]}
[0m17:17:52.177878 [info ] [Thread-4 (]: 12 of 12 OK created sql view model intermediate.int_meta_campaign_stats_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m17:17:52.179080 [debug] [Thread-4 (]: Finished running node model.bq_evo.int_meta_campaign_stats_joined_campaign_names
[0m17:17:52.191110 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=oss-big-query-dashboard-prod&j=bq:europe-west3:7d6457c3-00f6-459c-897b-10fbc5d645a4&page=queryresults
[0m17:17:52.303146 [debug] [Thread-1 (]: Timing info for model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names (execute): 17:17:51.099668 => 17:17:52.302130
[0m17:17:52.305128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8E4A8D0>]}
[0m17:17:52.306146 [info ] [Thread-1 (]: 11 of 12 OK created sql view model intermediate.int_bing_ads_campaign_performance_joined_campaign_names  [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m17:17:52.308146 [debug] [Thread-1 (]: Finished running node model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names
[0m17:17:52.863592 [debug] [Thread-3 (]: Timing info for model.bq_evo.int_google_ads_campaign_stats (execute): 17:17:51.003564 => 17:17:52.863592
[0m17:17:52.864586 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8923ba88-b3a6-4512-a392-95d5cbe737a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E8E59A90>]}
[0m17:17:52.865587 [info ] [Thread-3 (]: 10 of 12 OK created sql view model intermediate.int_google_ads_campaign_stats .. [[32mCREATE VIEW (0 processed)[0m in 1.87s]
[0m17:17:52.867619 [debug] [Thread-3 (]: Finished running node model.bq_evo.int_google_ads_campaign_stats
[0m17:17:52.869086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:52.870196 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod' was properly closed.
[0m17:17:52.870196 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_staging' was properly closed.
[0m17:17:52.871096 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_intermediate' was properly closed.
[0m17:17:52.871096 [debug] [MainThread]: Connection 'list_oss-big-query-dashboard-prod_mart' was properly closed.
[0m17:17:52.871096 [debug] [MainThread]: Connection 'model.bq_evo.int_bing_ads_campaign_performance_joined_campaign_names' was properly closed.
[0m17:17:52.872096 [debug] [MainThread]: Connection 'model.bq_evo.int_google_analytics_NDG_conversionevents_GA4' was properly closed.
[0m17:17:52.872096 [debug] [MainThread]: Connection 'model.bq_evo.int_google_ads_campaign_stats' was properly closed.
[0m17:17:52.872096 [debug] [MainThread]: Connection 'model.bq_evo.int_meta_campaign_stats_joined_campaign_names' was properly closed.
[0m17:17:52.873095 [info ] [MainThread]: 
[0m17:17:52.874099 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 6.76 seconds (6.76s).
[0m17:17:52.875104 [debug] [MainThread]: Command end result
[0m17:17:52.887968 [info ] [MainThread]: 
[0m17:17:52.888983 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:52.889967 [info ] [MainThread]: 
[0m17:17:52.889967 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m17:17:52.890971 [debug] [MainThread]: Command `dbt run` succeeded at 17:17:52.890971 after 11.28 seconds
[0m17:17:52.891968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E6D696D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E788D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E1A12F90>]}
[0m17:17:52.891968 [debug] [MainThread]: Flushing usage events
